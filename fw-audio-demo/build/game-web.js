(function(e){function t(a){if(r[a])return r[a].exports;var n=r[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,a){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var r=e&&e.__esModule?function(){return e['default']}:function(){return e};return t.d(r,'a',r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p='',t(t.s=103)})([function(e,t,r){'use strict';function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function n(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0,t.autoDetectRenderer=t.Application=t.Filter=t.SpriteMaskFilter=t.Quad=t.RenderTarget=t.ObjectRenderer=t.WebGLManager=t.Shader=t.CanvasRenderTarget=t.TextureUvs=t.VideoBaseTexture=t.BaseRenderTexture=t.RenderTexture=t.BaseTexture=t.TextureMatrix=t.Texture=t.Spritesheet=t.CanvasGraphicsRenderer=t.GraphicsRenderer=t.GraphicsData=t.Graphics=t.TextMetrics=t.TextStyle=t.Text=t.SpriteRenderer=t.CanvasTinter=t.CanvasSpriteRenderer=t.Sprite=t.TransformBase=t.TransformStatic=t.Transform=t.Container=t.DisplayObject=t.Bounds=t.glCore=t.WebGLRenderer=t.CanvasRenderer=t.ticker=t.utils=t.settings=void 0;var o=r(1);Object.keys(o).forEach(function(e){'default'===e||'__esModule'===e||Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var i=r(4);Object.keys(i).forEach(function(e){'default'===e||'__esModule'===e||Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var s=r(7);Object.defineProperty(t,'glCore',{enumerable:!0,get:function(){return n(s).default}});var l=r(36);Object.defineProperty(t,'Bounds',{enumerable:!0,get:function(){return n(l).default}});var d=r(58);Object.defineProperty(t,'DisplayObject',{enumerable:!0,get:function(){return n(d).default}});var u=r(15);Object.defineProperty(t,'Container',{enumerable:!0,get:function(){return n(u).default}});var p=r(60);Object.defineProperty(t,'Transform',{enumerable:!0,get:function(){return n(p).default}});var c=r(59);Object.defineProperty(t,'TransformStatic',{enumerable:!0,get:function(){return n(c).default}});var h=r(38);Object.defineProperty(t,'TransformBase',{enumerable:!0,get:function(){return n(h).default}});var g=r(39);Object.defineProperty(t,'Sprite',{enumerable:!0,get:function(){return n(g).default}});var f=r(133);Object.defineProperty(t,'CanvasSpriteRenderer',{enumerable:!0,get:function(){return n(f).default}});var m=r(43);Object.defineProperty(t,'CanvasTinter',{enumerable:!0,get:function(){return n(m).default}});var y=r(136);Object.defineProperty(t,'SpriteRenderer',{enumerable:!0,get:function(){return n(y).default}});var x=r(152);Object.defineProperty(t,'Text',{enumerable:!0,get:function(){return n(x).default}});var _=r(73);Object.defineProperty(t,'TextStyle',{enumerable:!0,get:function(){return n(_).default}});var b=r(74);Object.defineProperty(t,'TextMetrics',{enumerable:!0,get:function(){return n(b).default}});var T=r(154);Object.defineProperty(t,'Graphics',{enumerable:!0,get:function(){return n(T).default}});var v=r(75);Object.defineProperty(t,'GraphicsData',{enumerable:!0,get:function(){return n(v).default}});var E=r(156);Object.defineProperty(t,'GraphicsRenderer',{enumerable:!0,get:function(){return n(E).default}});var S=r(163);Object.defineProperty(t,'CanvasGraphicsRenderer',{enumerable:!0,get:function(){return n(S).default}});var C=r(164);Object.defineProperty(t,'Spritesheet',{enumerable:!0,get:function(){return n(C).default}});var P=r(11);Object.defineProperty(t,'Texture',{enumerable:!0,get:function(){return n(P).default}});var w=r(71);Object.defineProperty(t,'TextureMatrix',{enumerable:!0,get:function(){return n(w).default}});var M=r(14);Object.defineProperty(t,'BaseTexture',{enumerable:!0,get:function(){return n(M).default}});var A=r(42);Object.defineProperty(t,'RenderTexture',{enumerable:!0,get:function(){return n(A).default}});var I=r(66);Object.defineProperty(t,'BaseRenderTexture',{enumerable:!0,get:function(){return n(I).default}});var R=r(63);Object.defineProperty(t,'VideoBaseTexture',{enumerable:!0,get:function(){return n(R).default}});var D=r(64);Object.defineProperty(t,'TextureUvs',{enumerable:!0,get:function(){return n(D).default}});var O=r(67);Object.defineProperty(t,'CanvasRenderTarget',{enumerable:!0,get:function(){return n(O).default}});var k=r(18);Object.defineProperty(t,'Shader',{enumerable:!0,get:function(){return n(k).default}});var L=r(17);Object.defineProperty(t,'WebGLManager',{enumerable:!0,get:function(){return n(L).default}});var N=r(25);Object.defineProperty(t,'ObjectRenderer',{enumerable:!0,get:function(){return n(N).default}});var F=r(27);Object.defineProperty(t,'RenderTarget',{enumerable:!0,get:function(){return n(F).default}});var B=r(72);Object.defineProperty(t,'Quad',{enumerable:!0,get:function(){return n(B).default}});var U=r(69);Object.defineProperty(t,'SpriteMaskFilter',{enumerable:!0,get:function(){return n(U).default}});var G=r(70);Object.defineProperty(t,'Filter',{enumerable:!0,get:function(){return n(G).default}});var V=r(77);Object.defineProperty(t,'Application',{enumerable:!0,get:function(){return n(V).default}});var W=r(78);Object.defineProperty(t,'autoDetectRenderer',{enumerable:!0,get:function(){return W.autoDetectRenderer}});var X=r(2),H=a(X),Y=r(41),z=a(Y),j=r(3),q=n(j),Z=r(16),K=n(Z),J=r(26),Q=n(J);t.settings=q.default,t.utils=H,t.ticker=z,t.CanvasRenderer=K.default,t.WebGLRenderer=Q.default},function(e,t){'use strict';var r=Math.PI;t.__esModule=!0;var a=t.VERSION='4.7.0',n=t.PI_2=2*r,o=t.RAD_TO_DEG=180/r,i=t.DEG_TO_RAD=r/180,s=t.RENDERER_TYPE={UNKNOWN:0,WEBGL:1,CANVAS:2},l=t.BLEND_MODES={NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16,NORMAL_NPM:17,ADD_NPM:18,SCREEN_NPM:19},d=t.DRAW_MODES={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},u=t.SCALE_MODES={LINEAR:0,NEAREST:1},p=t.WRAP_MODES={CLAMP:0,REPEAT:1,MIRRORED_REPEAT:2},c=t.GC_MODES={AUTO:0,MANUAL:1},h=t.URL_FILE_EXTENSION=/\.(\w{3,4})(?:$|\?|#)/i,g=t.DATA_URI=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;(charset=[\w-]+|base64))?,(.*)/i,f=t.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,m=t.SHAPES={POLY:0,RECT:1,CIRC:2,ELIP:3,RREC:4},y=t.PRECISION={LOW:'lowp',MEDIUM:'mediump',HIGH:'highp'},x=t.TRANSFORM_MODE={STATIC:0,DYNAMIC:1},_=t.TEXT_GRADIENT={LINEAR_VERTICAL:0,LINEAR_HORIZONTAL:1},b=t.UPDATE_PRIORITY={INTERACTION:50,HIGH:25,NORMAL:0,LOW:-25,UTILITY:-50}},function(e,t,r){'use strict';function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function n(e){return e&&e.__esModule?e:{default:e}}function o(){return++E}function i(e){if(!S){if(-1<navigator.userAgent.toLowerCase().indexOf('chrome')){var t=['\n %c %c %c PixiJS '+l.VERSION+' - \u2730 '+e+' \u2730  %c  %c  http://www.pixijs.com/  %c %c \u2665%c\u2665%c\u2665 \n\n','background: #ff66a5; padding:5px 0;','background: #ff66a5; padding:5px 0;','color: #ff66a5; background: #030307; padding:5px 0;','background: #ff66a5; padding:5px 0;','background: #ffc3dc; padding:5px 0;','background: #ff66a5; padding:5px 0;','color: #ff2424; background: #fff; padding:5px 0;','color: #ff2424; background: #fff; padding:5px 0;','color: #ff2424; background: #fff; padding:5px 0;'];window.console.log.apply(console,t)}else window.console&&window.console.log('PixiJS '+l.VERSION+' - '+e+' - http://www.pixijs.com/');S=!0}}var s=Math.round;t.__esModule=!0,t.premultiplyBlendMode=t.BaseTextureCache=t.TextureCache=t.mixins=t.pluginTarget=t.EventEmitter=t.removeItems=t.isMobile=void 0,t.uid=o,t.hex2rgb=function(e,t){return t=t||[],t[0]=(255&e>>16)/255,t[1]=(255&e>>8)/255,t[2]=(255&e)/255,t},t.hex2string=function(e){return e=e.toString(16),e='000000'.substr(0,6-e.length)+e,'#'+e},t.rgb2hex=function(e){return(255*e[0]<<16)+(255*e[1]<<8)+(0|255*e[2])},t.getResolutionOfUrl=function(e,t){var r=u.default.RETINA_PREFIX.exec(e);return r?parseFloat(r[1]):t===void 0?1:t},t.decomposeDataUri=function(e){var t=l.DATA_URI.exec(e);return t?{mediaType:t[1]?t[1].toLowerCase():void 0,subType:t[2]?t[2].toLowerCase():void 0,encoding:t[3]?t[3].toLowerCase():void 0,data:t[4]}:void 0},t.getUrlFileExtension=function(e){var t=l.URL_FILE_EXTENSION.exec(e);return t?t[1].toLowerCase():void 0},t.getSvgSize=function(e){var t=l.SVG_SIZE.exec(e),r={};return t&&(r[t[1]]=s(parseFloat(t[3])),r[t[5]]=s(parseFloat(t[7]))),r},t.skipHello=function(){S=!0},t.sayHello=i,t.isWebGLSupported=function(){var e={stencil:!0,failIfMajorPerformanceCaveat:!0};try{if(!window.WebGLRenderingContext)return!1;var t=document.createElement('canvas'),r=t.getContext('webgl',e)||t.getContext('experimental-webgl',e),a=!!(r&&r.getContextAttributes().stencil);if(r){var n=r.getExtension('WEBGL_lose_context');n&&n.loseContext()}return r=null,a}catch(t){return!1}},t.sign=function(e){return 0===e?0:0>e?-1:1},t.destroyTextureCache=function(){for(var e in C)C[e].destroy();for(e in P)P[e].destroy()},t.clearTextureCache=function(){for(var e in C)delete C[e];for(e in P)delete P[e]},t.correctBlendMode=function(e,t){return w[t?1:0][e]},t.premultiplyTint=function(e,t){if(1===t)return(255*t<<24)+e;if(0===t)return 0;var r=255&e>>16,a=255&e>>8,n=255&e;return r=0|r*t+.5,a=0|a*t+.5,n=0|n*t+.5,(255*t<<24)+(r<<16)+(a<<8)+n},t.premultiplyRgba=function(e,t,r,a){return r=r||new Float32Array(4),a||void 0===a?(r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t):(r[0]=e[0],r[1]=e[1],r[2]=e[2]),r[3]=t,r},t.premultiplyTintToRgba=function(e,t,r,a){return r=r||new Float32Array(4),r[0]=(255&e>>16)/255,r[1]=(255&e>>8)/255,r[2]=(255&e)/255,(a||void 0===a)&&(r[0]*=t,r[1]*=t,r[2]*=t),r[3]=t,r};var l=r(1),d=r(3),u=n(d),p=r(12),c=n(p),h=r(121),g=n(h),f=r(122),m=a(f),y=r(37),x=a(y),_=r(123),b=n(_),T=r(124),v=n(T),E=0,S=!1;t.isMobile=x,t.removeItems=b.default,t.EventEmitter=c.default,t.pluginTarget=g.default,t.mixins=m;var C=t.TextureCache=Object.create(null),P=t.BaseTextureCache=Object.create(null),w=t.premultiplyBlendMode=(0,v.default)()},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var n=r(119),o=a(n),i=r(120),s=a(i);t.default={TARGET_FPMS:.06,MIPMAP_TEXTURES:!0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:(0,o.default)(32),SPRITE_BATCH_SIZE:4096,RETINA_PREFIX:/@([0-9\.]+)x/,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoResize:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,roundPixels:!1,width:800,height:600,legacy:!1},TRANSFORM_MODE:0,GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:0,SCALE_MODE:0,PRECISION_VERTEX:'highp',PRECISION_FRAGMENT:'mediump',CAN_UPLOAD_SAME_BUFFER:(0,s.default)(),MESH_CANVAS_PADDING:0}},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var n=r(32);Object.defineProperty(t,'Point',{enumerable:!0,get:function(){return a(n).default}});var o=r(47);Object.defineProperty(t,'ObservablePoint',{enumerable:!0,get:function(){return a(o).default}});var i=r(33);Object.defineProperty(t,'Matrix',{enumerable:!0,get:function(){return a(i).default}});var s=r(48);Object.defineProperty(t,'GroupD8',{enumerable:!0,get:function(){return a(s).default}});var l=r(109);Object.defineProperty(t,'Circle',{enumerable:!0,get:function(){return a(l).default}});var d=r(110);Object.defineProperty(t,'Ellipse',{enumerable:!0,get:function(){return a(d).default}});var u=r(111);Object.defineProperty(t,'Polygon',{enumerable:!0,get:function(){return a(u).default}});var p=r(34);Object.defineProperty(t,'Rectangle',{enumerable:!0,get:function(){return a(p).default}});var c=r(112);Object.defineProperty(t,'RoundedRectangle',{enumerable:!0,get:function(){return a(c).default}})},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});const a=r(6),n=r(21),o=r(205),i=r(8),s=r(99),l=r(8);class d{static loadResources(){return new Promise((e)=>{let t=a.loader,r={loadType:1,xhrType:'arraybuffer'};t.add('main_spritesheet',n.ASSET_DIR+'/main-spritesheet.json').add('ui_spritesheet',n.ASSET_DIR+'/ui-spritesheet.json').add('foldwars_json',n.ASSET_DIR+'/foldwars.json').add('foldwars_atlas',n.ASSET_DIR+'/foldwars.atlas').add('foldwars_png',n.ASSET_DIR+'/foldwars.png').add('screens',n.ASSET_DIR+'/screens-plain.svg',{loadType:1,xhrType:'text'}).add('background',n.ASSET_DIR+'/audio/background.mp3',r).add('walker-0',n.ASSET_DIR+'/audio/walker-0.mp3',r).add('walker-1',n.ASSET_DIR+'/audio/walker-1.mp3',r).add('walker-2',n.ASSET_DIR+'/audio/walker-2.mp3',r).add('walker-3',n.ASSET_DIR+'/audio/walker-3.mp3',r).add('walker-4',n.ASSET_DIR+'/audio/walker-4.mp3',r).add('walker-5',n.ASSET_DIR+'/audio/walker-5.mp3',r).add('bouncer-0',n.ASSET_DIR+'/audio/bouncer-0.mp3',r).add('bouncer-1',n.ASSET_DIR+'/audio/bouncer-1.mp3',r).add('bouncer-2',n.ASSET_DIR+'/audio/bouncer-2.mp3',r).add('bouncer-3',n.ASSET_DIR+'/audio/bouncer-3.mp3',r).add('bouncer-4',n.ASSET_DIR+'/audio/bouncer-4.mp3',r).add('bouncer-5',n.ASSET_DIR+'/audio/bouncer-5.mp3',r).add('fire-hit',n.ASSET_DIR+'/audio/fire-hit.mp3',r).add('ship-horn',n.ASSET_DIR+'/audio/ship-horn.mp3',r).add('out-of-ammo',n.ASSET_DIR+'/audio/out-of-ammo.mp3',r).add('beat-break',n.ASSET_DIR+'/audio/beat-break.mp3',r).add('time-fwd',n.ASSET_DIR+'/audio/time-fwd.mp3',r).load((e,t)=>{e,d.resources=t;const r=t.foldwars_atlas.data,a=new PIXI.spine.core.TextureAtlas(r,function(e,t){e,t(PIXI.BaseTexture.from('foldwars_png'))}),n=new PIXI.spine.core.AtlasAttachmentLoader(a);d.spineJsonParser=new PIXI.spine.core.SkeletonJson(n),d.spineData=t.foldwars_json.data}),t.onProgress.add(()=>{d.updateLoadMeter(t.progress/100)}),t.onComplete.add(()=>{d.audio=new o.Audio,d.audio.load(d.resources).then(()=>{d.resourcesLoaded=!0,e()})})})}static showLoadMeter(){let e=l.createSVGElement('svg');e.setAttribute('width',`${d.vpWidth}`),e.setAttribute('height',`${d.vpHeight}`),e.setAttribute('id','load-meter'),e.style.position='absolute',e.style.left='50%',e.style.top='50%',e.style.marginLeft=`-${d.vpWidth/2}`,e.style.marginTop=`-${d.vpHeight/2}`,e.setAttribute('viewBox','0 0 1920 1080');let t=d.docWidth/2,r=d.docHeight/2,a=d.docWidth/5,n=9*a/32,o=n;e.innerHTML=`
    <path d="M ${t-a/2+o/2},${r-n/2}
      L ${t+a/2+o/2},${r-n/2}
      L ${t+a/2-o/2},${r+n/2}
      L ${t-a/2-o/2},${r+n/2}
      Z
    " style="stroke:none;fill:#555555" id="meter-background">
    </path>
    <path d="M ${t-a/2+o/2},${r-n/2}
      L ${t-a/2+o/2},${r-n/2}
      L ${t-a/2-o/2},${r+n/2}
      L ${t-a/2-o/2},${r+n/2}
      Z
    " style="stroke:none;fill:#ffffff" id="meter-foreground">
    </path>
    `,document.body.appendChild(e)}static removeLoadMeter(){document.querySelector('#load-meter').remove()}static updateLoadMeter(e){e=Math.max(0,Math.min(1,e));let t=d.docWidth/2,r=d.docHeight/2,a=d.docWidth/5,n=9*a/32,o=n,i=document.body.querySelector('#meter-foreground');i.setAttribute('d',`
      M ${t-a/2+o/2},${r-n/2}
      L ${t-a/2+o/2+e*a},${r-n/2}
      L ${t-a/2-o/2+e*a},${r+n/2}
      L ${t-a/2-o/2},${r+n/2}
      Z
    `)}static start(){document.body.style.background='#000000',d.computeViewportDimensions(),d.showLoadMeter(),this.loadResources().then(()=>{if(d.removeLoadMeter(),d.screenMan=new s.ScreenManager(d.resources.screens.data,d.vpWidth,d.vpHeight),i.hasLevelParam()){let e=i.getLevelParam(),t=i.getDifficultyParam()||'normal';this.screenMan.loadLevel(e,t)}else d.screenMan.show(s.ScreenType.TITLE)}),d.registerFocusEvents()}static computeViewportDimensions(){let e=n.DOCWIDTH/n.DOCHEIGHT,t=window.innerWidth/n.DOCWIDTH,r=window.innerHeight/n.DOCHEIGHT;t<r?(d.vpWidth=window.innerWidth,d.vpHeight=d.vpWidth/e):(d.vpHeight=window.innerHeight,d.vpWidth=d.vpHeight*e),d.docWidth=n.DOCWIDTH,d.docHeight=n.DOCHEIGHT}static registerFocusEvents(){window.onblur=()=>{},window.onkeydown=(e)=>{d.screenMan&&d.screenMan.handleKeyDown(e)},window.onkeyup=(e)=>{d.screenMan&&d.screenMan.handleKeyUp(e)},window.onkeypress=(e)=>{d.screenMan&&d.screenMan.handleKeyPress(e)},window.onresize=()=>{d.computeViewportDimensions(),d.screenMan.resize()}}}d.version=21,d.spineTexMap={},d.resourcesLoaded=!1,t.Game=d},function(e,t,r){'use strict';(function(e){function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}t.__esModule=!0,t.loader=t.prepare=t.particles=t.mesh=t.loaders=t.interaction=t.filters=t.extras=t.extract=t.accessibility=void 0;var n=r(104);Object.keys(n).forEach(function(e){'default'===e||'__esModule'===e||Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})});var o=r(0);Object.keys(o).forEach(function(e){'default'===e||'__esModule'===e||Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var i=r(165),s=function(e){return e&&e.__esModule?e:{default:e}}(i),l=r(166),d=a(l),u=r(168),p=a(u),c=r(80),h=a(c),g=r(178),f=a(g),m=r(185),y=a(m),x=r(187),_=a(x),b=r(191),T=a(b),v=r(196),E=a(v),S=r(201),C=a(S);o.utils.mixins.performMixins();var P=_.shared||null;t.accessibility=d,t.extract=p,t.extras=h,t.filters=f,t.interaction=y,t.loaders=_,t.mesh=T,t.particles=E,t.prepare=C,t.loader=P,'function'==typeof s.default&&(0,s.default)(t),e.PIXI=t}).call(t,r(31))},function(e,t,r){var a={createContext:r(113),setVertexAttribArrays:r(49),GLBuffer:r(114),GLFramebuffer:r(115),GLShader:r(116),GLTexture:r(50),VertexArrayObject:r(117),shader:r(118)};'undefined'!=typeof e&&e.exports&&(e.exports=a),'undefined'!=typeof window&&(window.PIXI=window.PIXI||{},window.PIXI.glCore=a)},function(e,t){'use strict';function r(e,r=t.EPSILON){return n(e)<r}var a=Math.sqrt,n=Math.abs,o=Math.max,i=Math.min,s=Math.round,l=Math.PI;Object.defineProperty(t,'__esModule',{value:!0});t.CubicBezier=class{constructor(e){this.cpoints=e,console.assert(4===e.length)}evaluate(e){let t=this.cpoints,r=e*e,a=e*r,n=(1-e)*(1-e),o=(1-e)*n,i=o*t[0][0]+3*e*n*t[1][0]+3*r*(1-e)*t[2][0]+a*t[3][0],s=o*t[0][1]+3*e*n*t[1][1]+3*r*(1-e)*t[2][1]+a*t[3][1];return[i,s]}};t.QuadraticBezier=class{constructor(e){this.cpoints=e,console.assert(3===e.length)}evaluate(e){let[t,r]=this.cpoints[0],[a,n]=this.cpoints[1],[o,i]=this.cpoints[2];return[(t-2*a+o)*e*e+2*(a-t)*e+t,(r-2*n+i)*e*e+2*(n-r)*e+r]}};t.Timer=class{constructor(e,t){this.interval=e,this.callback=t,this.frozen=!1,this.count=0,this.tlast=NaN}freezeTrigger(){this.frozen=!0}unfreezeTrigger(){this.frozen&&(this.tlast=NaN),this.frozen=!1}tick(e){if(!this.frozen)if(isNaN(this.tlast))this.callback(this.count++),this.tlast=e;else{let t=e-this.tlast;t>=this.interval&&(this.callback(this.count++),this.tlast=e)}}},t.EPSILON=1e-4,t.vec2={add:function(...e){let t=[0,0];for(let r of e)t[0]+=r[0],t[1]+=r[1];return t},sub:function(e,t){return[e[0]-t[0],e[1]-t[1]]},mul:function(e,t){return[e[0]*t,e[1]*t]},isNonZero:function(e,r=t.EPSILON){return n(e[0])>r||n(e[1])>r},isZero:function(e,r=t.EPSILON){return!t.vec2.isNonZero(e,r)},lenSq:function(e){return e[0]*e[0]+e[1]*e[1]},len:function(e){return a(t.vec2.lenSq(e))},unit:function(e){let r=t.vec2.len(e);return 0===r?[0,0]:t.vec2.mul(e,1/t.vec2.len(e))},distSq:function(e,r){return t.vec2.lenSq(t.vec2.sub(e,r))},dist:function(e,r){return a(t.vec2.distSq(e,r))},dot:function(e,t){return e[0]*t[0]+e[1]*t[1]},cross:function(e,t){return e[0]*t[1]-e[1]*t[0]},toInt:function(e){return[s(e[0]),s(e[1])]},equal:function(e,r,a=t.EPSILON){return n(e[0]-r[0])<a&&n(e[1]-r[1])<a},low:function(...e){let t=Infinity,r=Infinity;for(let a of e)t=i(a[0],t),r=i(a[1],r);return[t,r]},high:function(...e){let t=-Infinity,r=-Infinity;for(let a of e)t=o(a[0],t),r=o(a[1],r);return[t,r]},format:function(e){return'['+e[0].toFixed(2)+','+e[1].toFixed(2)+']'},dir:function(e,r){return t.vec2.unit(t.vec2.sub(r,e))},orthogonal:function(e){let[t,r]=e;return[r,-t]},dirToAngle:function(e){return Math.atan2(e[1],e[0])},angleToDir:function(e){return[Math.cos(e),Math.sin(e)]}},t.wrapAngle=function(e){for(;0>e;)e+=2*l;for(;e>2*l;)e-=2*l;return e},t.toDeg=function(e){return 180*e/l},t.toRad=function(e){return e*l/180},t.isZero=r,t.isEqualFloat=function(e,a,n=t.EPSILON){return r(e-a,n)};t.createSVGElement=function(e){return document.createElementNS('http://www.w3.org/2000/svg',e)},t.hasLevelParam=function(){return /level=(\d+)/.test(window.location.href)},t.getLevelParam=function(){return parseInt(/level=(\d+)/.exec(window.location.href)[1])},t.isFastShip=function(){return /fastship=(\d+)/.test(window.location.href)},t.getDifficultyParam=function(){return /diff=(\w+)/.test(window.location.href)&&/diff=(\w+)/.exec(window.location.href)[1]}},function(e,t,r){(function(e){function r(e,t){for(var r=0,a=e.length-1,n;0<=a;a--)n=e[a],'.'===n?e.splice(a,1):'..'===n?(e.splice(a,1),r++):r&&(e.splice(a,1),r--);if(t)for(;r--;r)e.unshift('..');return e}function a(e,t){if(e.filter)return e.filter(t);for(var r=[],a=0;a<e.length;a++)t(e[a],a,e)&&r.push(e[a]);return r}var n=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,o=function(e){return n.exec(e).slice(1)};t.resolve=function(){for(var t='',n=!1,o=arguments.length-1,i;-1<=o&&!n;o--){if(i=0<=o?arguments[o]:e.cwd(),'string'!=typeof i)throw new TypeError('Arguments to path.resolve must be strings');else if(!i)continue;t=i+'/'+t,n='/'===i.charAt(0)}return t=r(a(t.split('/'),function(e){return!!e}),!n).join('/'),(n?'/':'')+t||'.'},t.normalize=function(e){var n=t.isAbsolute(e),o='/'===i(e,-1);return e=r(a(e.split('/'),function(e){return!!e}),!n).join('/'),e||n||(e='.'),e&&o&&(e+='/'),(n?'/':'')+e},t.isAbsolute=function(e){return'/'===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(a(e,function(e){if('string'!=typeof e)throw new TypeError('Arguments to path.join must be strings');return e}).join('/'))},t.relative=function(e,r){function a(e){for(var t=0;t<e.length&&''===e[t];t++);for(var r=e.length-1;0<=r&&''===e[r];r--);return t>r?[]:e.slice(t,r-t+1)}e=t.resolve(e).substr(1),r=t.resolve(r).substr(1);for(var n=a(e.split('/')),o=a(r.split('/')),s=Math.min(n.length,o.length),l=s,d=0;d<s;d++)if(n[d]!==o[d]){l=d;break}for(var i=[],d=l;d<n.length;d++)i.push('..');return i=i.concat(o.slice(l)),i.join('/')},t.sep='/',t.delimiter=':',t.dirname=function(e){var t=o(e),r=t[0],a=t[1];return r||a?(a&&(a=a.substr(0,a.length-1)),r+a):'.'},t.basename=function(e,t){var r=o(e)[2];return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r},t.extname=function(e){return o(e)[3]};var i=function(e,t,r){return e.substr(t,r)}}).call(t,r(139))},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});const a=r(5),n=r(21);class o{static debug(...e){3<=o.verbosity&&console.debug(...e)}static info(...e){2<=o.verbosity&&console.info(...e)}static warn(...e){1<=o.verbosity&&console.warn(...e)}static error(...e){0<=o.verbosity&&(console.error(...e),window.gtag&&window.gtag('event',`ERR_v${a.Game.version}`,{label:e.join(' ')}))}static assert(e,t){e||o.error('Assertion failed:',t),n.ISDEV&&console.assert(e)}}o.verbosity=1,t.Log=o},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){e.destroy=function(){},e.on=function(){},e.once=function(){},e.emit=function(){}}t.__esModule=!0;var l=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),d=r(14),u=a(d),p=r(63),c=a(p),h=r(64),g=a(h),f=r(12),m=a(f),y=r(4),x=r(2),_=r(3),b=a(_),T=function(e){function t(r,a,i,s,l){n(this,t);var d=o(this,e.call(this));if(d.noFrame=!1,a||(d.noFrame=!0,a=new y.Rectangle(0,0,1,1)),r instanceof t&&(r=r.baseTexture),d.baseTexture=r,d._frame=a,d.trim=s,d.valid=!1,d.requiresUpdate=!1,d._uvs=null,d.orig=i||a,d._rotate=+(l||0),!0===l)d._rotate=2;else if(0!=d._rotate%2)throw new Error('attempt to use diamond-shaped UVs. If you are sure, set rotation manually');return r.hasLoaded?(d.noFrame&&(a=new y.Rectangle(0,0,r.width,r.height),r.on('update',d.onBaseTextureUpdated,d)),d.frame=a):r.once('loaded',d.onBaseTextureLoaded,d),d._updateID=0,d.transform=null,d.textureCacheIds=[],d}return i(t,e),t.prototype.update=function(){this.baseTexture.update()},t.prototype.onBaseTextureLoaded=function(e){this._updateID++,this.frame=this.noFrame?new y.Rectangle(0,0,e.width,e.height):this._frame,this.baseTexture.on('update',this.onBaseTextureUpdated,this),this.emit('update',this)},t.prototype.onBaseTextureUpdated=function(e){this._updateID++,this._frame.width=e.width,this._frame.height=e.height,this.emit('update',this)},t.prototype.destroy=function(e){this.baseTexture&&(e&&(x.TextureCache[this.baseTexture.imageUrl]&&t.removeFromCache(this.baseTexture.imageUrl),this.baseTexture.destroy()),this.baseTexture.off('update',this.onBaseTextureUpdated,this),this.baseTexture.off('loaded',this.onBaseTextureLoaded,this),this.baseTexture=null),this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,t.removeFromCache(this),this.textureCacheIds=null},t.prototype.clone=function(){return new t(this.baseTexture,this.frame,this.orig,this.trim,this.rotate)},t.prototype._updateUvs=function(){this._uvs||(this._uvs=new g.default),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},t.fromImage=function(e,r,a,n){var o=x.TextureCache[e];return o||(o=new t(u.default.fromImage(e,r,a,n)),t.addToCache(o,e)),o},t.fromFrame=function(e){var t=x.TextureCache[e];if(!t)throw new Error('The frameId "'+e+'" does not exist in the texture cache');return t},t.fromCanvas=function(e,r){var a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:'canvas';return new t(u.default.fromCanvas(e,r,a))},t.fromVideo=function(e,r){return'string'==typeof e?t.fromVideoUrl(e,r):new t(c.default.fromVideo(e,r))},t.fromVideoUrl=function(e,r){return new t(c.default.fromUrl(e,r))},t.from=function(e){if('string'==typeof e){var r=x.TextureCache[e];if(!r){var a=null!==e.match(/\.(mp4|webm|ogg|h264|avi|mov)$/);return a?t.fromVideoUrl(e):t.fromImage(e)}return r}return e instanceof HTMLImageElement?new t(u.default.from(e)):e instanceof HTMLCanvasElement?t.fromCanvas(e,b.default.SCALE_MODE,'HTMLCanvasElement'):e instanceof HTMLVideoElement?t.fromVideo(e):e instanceof u.default?new t(e):e},t.fromLoader=function(e,r,a){var n=new u.default(e,void 0,(0,x.getResolutionOfUrl)(r)),o=new t(n);return n.imageUrl=r,a||(a=r),u.default.addToCache(o.baseTexture,a),t.addToCache(o,a),a!==r&&(u.default.addToCache(o.baseTexture,r),t.addToCache(o,r)),o},t.addToCache=function(e,t){t&&(-1===e.textureCacheIds.indexOf(t)&&e.textureCacheIds.push(t),x.TextureCache[t]&&console.warn('Texture added to the cache with an id ['+t+'] that already had an entry'),x.TextureCache[t]=e)},t.removeFromCache=function(e){if('string'==typeof e){var t=x.TextureCache[e];if(t){var r=t.textureCacheIds.indexOf(e);return-1<r&&t.textureCacheIds.splice(r,1),delete x.TextureCache[e],t}}else if(e&&e.textureCacheIds){for(var a=0;a<e.textureCacheIds.length;++a)x.TextureCache[e.textureCacheIds[a]]===e&&delete x.TextureCache[e.textureCacheIds[a]];return e.textureCacheIds.length=0,e}return null},l(t,[{key:'frame',get:function(){return this._frame},set:function(e){this._frame=e,this.noFrame=!1;var t=e.x,r=e.y,a=e.width,n=e.height,o=t+a>this.baseTexture.width,i=r+n>this.baseTexture.height;if(o||i){var s=o&&i?'and':'or',l='X: '+t+' + '+a+' = '+(t+a)+' > '+this.baseTexture.width,d='Y: '+r+' + '+n+' = '+(r+n)+' > '+this.baseTexture.height;throw new Error('Texture Error: frame does not fit inside the base Texture dimensions: '+(l+' '+s+' '+d))}this.valid=a&&n&&this.baseTexture.hasLoaded,this.trim||this.rotate||(this.orig=e),this.valid&&this._updateUvs()}},{key:'rotate',get:function(){return this._rotate},set:function(e){this._rotate=e,this.valid&&this._updateUvs()}},{key:'width',get:function(){return this.orig.width}},{key:'height',get:function(){return this.orig.height}}]),t}(m.default);t.default=T,T.EMPTY=new T(new u.default()),s(T.EMPTY),s(T.EMPTY.baseTexture),T.WHITE=function(){var e=document.createElement('canvas');e.width=10,e.height=10;var t=e.getContext('2d');return t.fillStyle='white',t.fillRect(0,0,10,10),new T(new u.default(e))}(),s(T.WHITE),s(T.WHITE.baseTexture)},function(e){'use strict';function t(){}function r(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function a(){this._events=new t,this._eventsCount=0}var n=Object.prototype.hasOwnProperty,o='~';Object.create&&(t.prototype=Object.create(null),!new t().__proto__&&(o=!1)),a.prototype.eventNames=function(){var e=[],t,r;if(0===this._eventsCount)return e;for(r in t=this._events)n.call(t,r)&&e.push(o?r.slice(1):r);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e},a.prototype.listeners=function(e,t){var r=o?o+e:e,a=this._events[r];if(t)return!!a;if(!a)return[];if(a.fn)return[a.fn];for(var n=0,i=a.length,s=Array(i);n<i;n++)s[n]=a[n].fn;return s},a.prototype.emit=function(e,t,r,a,n,s){var l=o?o+e:e;if(!this._events[l])return!1;var d=this._events[l],u=arguments.length,p,c;if(d.fn){switch(d.once&&this.removeListener(e,d.fn,void 0,!0),u){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,t),!0;case 3:return d.fn.call(d.context,t,r),!0;case 4:return d.fn.call(d.context,t,r,a),!0;case 5:return d.fn.call(d.context,t,r,a,n),!0;case 6:return d.fn.call(d.context,t,r,a,n,s),!0;}for(c=1,p=Array(u-1);c<u;c++)p[c-1]=arguments[c];d.fn.apply(d.context,p)}else{var i=d.length,h;for(c=0;c<i;c++)switch(d[c].once&&this.removeListener(e,d[c].fn,void 0,!0),u){case 1:d[c].fn.call(d[c].context);break;case 2:d[c].fn.call(d[c].context,t);break;case 3:d[c].fn.call(d[c].context,t,r);break;case 4:d[c].fn.call(d[c].context,t,r,a);break;default:if(!p)for(h=1,p=Array(u-1);h<u;h++)p[h-1]=arguments[h];d[c].fn.apply(d[c].context,p);}}return!0},a.prototype.on=function(e,t,a){var n=new r(t,a||this),i=o?o+e:e;return this._events[i]?this._events[i].fn?this._events[i]=[this._events[i],n]:this._events[i].push(n):(this._events[i]=n,this._eventsCount++),this},a.prototype.once=function(e,t,a){var n=new r(t,a||this,!0),i=o?o+e:e;return this._events[i]?this._events[i].fn?this._events[i]=[this._events[i],n]:this._events[i].push(n):(this._events[i]=n,this._eventsCount++),this},a.prototype.removeListener=function(e,r,a,n){var s=o?o+e:e;if(!this._events[s])return this;if(!r)return 0==--this._eventsCount?this._events=new t:delete this._events[s],this;var l=this._events[s];if(l.fn)l.fn!==r||n&&!l.once||a&&l.context!==a||(0==--this._eventsCount?this._events=new t:delete this._events[s]);else{for(var d=0,i=[],u=l.length;d<u;d++)(l[d].fn!==r||n&&!l[d].once||a&&l[d].context!==a)&&i.push(l[d]);i.length?this._events[s]=1===i.length?i[0]:i:0==--this._eventsCount?this._events=new t:delete this._events[s]}return this},a.prototype.removeAllListeners=function(e){var r;return e?(r=o?o+e:e,this._events[r]&&(0==--this._eventsCount?this._events=new t:delete this._events[r])):(this._events=new t,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prototype.setMaxListeners=function(){return this},a.prefixed=o,a.EventEmitter=a,e.exports=a},function(e,t){'use strict';var r=Math.PI;Object.defineProperty(t,'__esModule',{value:!0}),t.spec={towers:{gun:{construction:{cost:20,delay:3e3},angspeed:r,rate:1,range:200,ammo:{cost:0,damage:{health:1,shield:1}}},canon:{construction:{cost:40,delay:3e3},angspeed:r,rate:.5,range:300,ammo:{cost:0,damage:{health:3,shield:3}}},block:{construction:{cost:10,delay:3e3},angspeed:0,rate:0,range:0,ammo:{cost:0,damage:{health:0,shield:0}}},laser:{construction:{cost:40,delay:3e3},angspeed:3*r,rate:10,range:300,ammo:{cost:0,damage:{health:.2,shield:.04}}}},ghosts:{walker:{maxhealth:5,maxspeed:5,maxshield:5,capacity:1},bouncer:{maxhealth:10,maxspeed:3.5,maxshield:10,capacity:1},sprinter:{maxhealth:5,maxspeed:10,maxshield:5,capacity:1}}}},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=Math.round;t.__esModule=!0;var l=r(2),d=r(3),u=a(d),p=r(12),c=a(p),h=r(61),g=a(h),f=r(40),m=a(f),y=function(e){function t(r,a,i){n(this,t);var s=o(this,e.call(this));return s.uid=(0,l.uid)(),s.touched=0,s.resolution=i||u.default.RESOLUTION,s.width=100,s.height=100,s.realWidth=100,s.realHeight=100,s.scaleMode=void 0===a?u.default.SCALE_MODE:a,s.hasLoaded=!1,s.isLoading=!1,s.source=null,s.origSource=null,s.imageType=null,s.sourceScale=1,s.premultipliedAlpha=!0,s.imageUrl=null,s.isPowerOfTwo=!1,s.mipmap=u.default.MIPMAP_TEXTURES,s.wrapMode=u.default.WRAP_MODE,s._glTextures={},s._enabled=0,s._virtalBoundId=-1,s._destroyed=!1,s.textureCacheIds=[],r&&s.loadSource(r),s}return i(t,e),t.prototype.update=function(){'svg'!==this.imageType&&(this.realWidth=this.source.naturalWidth||this.source.videoWidth||this.source.width,this.realHeight=this.source.naturalHeight||this.source.videoHeight||this.source.height,this._updateDimensions()),this.emit('update',this)},t.prototype._updateDimensions=function(){this.width=this.realWidth/this.resolution,this.height=this.realHeight/this.resolution,this.isPowerOfTwo=m.default.isPow2(this.realWidth)&&m.default.isPow2(this.realHeight)},t.prototype.loadSource=function(e){var t=this.isLoading;this.hasLoaded=!1,this.isLoading=!1,t&&this.source&&(this.source.onload=null,this.source.onerror=null);var r=!this.source;if(this.source=e,(e.src&&e.complete||e.getContext)&&e.width&&e.height)this._updateImageType(),'svg'===this.imageType?this._loadSvgSource():this._sourceLoaded(),r&&this.emit('loaded',this);else if(!e.getContext){this.isLoading=!0;var a=this;if(e.onload=function(){if(a._updateImageType(),e.onload=null,e.onerror=null,!!a.isLoading)return a.isLoading=!1,a._sourceLoaded(),'svg'===a.imageType?void a._loadSvgSource():void a.emit('loaded',a)},e.onerror=function(){e.onload=null,e.onerror=null,a.isLoading&&(a.isLoading=!1,a.emit('error',a))},e.complete&&e.src){if(e.onload=null,e.onerror=null,'svg'===a.imageType)return void a._loadSvgSource();this.isLoading=!1,e.width&&e.height?(this._sourceLoaded(),t&&this.emit('loaded',this)):t&&this.emit('error',this)}}},t.prototype._updateImageType=function(){if(this.imageUrl){var e=(0,l.decomposeDataUri)(this.imageUrl),t;if(e&&'image'===e.mediaType){var r=e.subType.split('+')[0];if(t=(0,l.getUrlFileExtension)('.'+r),!t)throw new Error('Invalid image type in data URI.')}else t=(0,l.getUrlFileExtension)(this.imageUrl),t||(t='png');this.imageType=t}},t.prototype._loadSvgSource=function(){if('svg'===this.imageType){var e=(0,l.decomposeDataUri)(this.imageUrl);e?this._loadSvgSourceUsingDataUri(e):this._loadSvgSourceUsingXhr()}},t.prototype._loadSvgSourceUsingDataUri=function(e){var t;if('base64'===e.encoding){if(!atob)throw new Error('Your browser doesn\'t support base64 conversions.');t=atob(e.data)}else t=e.data;this._loadSvgSourceUsingString(t)},t.prototype._loadSvgSourceUsingXhr=function(){var e=this,t=new XMLHttpRequest;t.onload=function(){if(t.readyState!==t.DONE||200!==t.status)throw new Error('Failed to load SVG using XHR.');e._loadSvgSourceUsingString(t.response)},t.onerror=function(){return e.emit('error',e)},t.open('GET',this.imageUrl,!0),t.send()},t.prototype._loadSvgSourceUsingString=function(e){var r=(0,l.getSvgSize)(e),a=r.width,n=r.height;if(!a||!n)throw new Error('The SVG image must have width and height defined (in pixels), canvas API needs them.');this.realWidth=s(a*this.sourceScale),this.realHeight=s(n*this.sourceScale),this._updateDimensions();var o=document.createElement('canvas');o.width=this.realWidth,o.height=this.realHeight,o._pixiId='canvas_'+(0,l.uid)(),o.getContext('2d').drawImage(this.source,0,0,a,n,0,0,this.realWidth,this.realHeight),this.origSource=this.source,this.source=o,t.addToCache(this,o._pixiId),this.isLoading=!1,this._sourceLoaded(),this.emit('loaded',this)},t.prototype._sourceLoaded=function(){this.hasLoaded=!0,this.update()},t.prototype.destroy=function(){this.imageUrl&&(delete l.TextureCache[this.imageUrl],this.imageUrl=null,!navigator.isCocoonJS&&(this.source.src='')),this.source=null,this.dispose(),t.removeFromCache(this),this.textureCacheIds=null,this._destroyed=!0},t.prototype.dispose=function(){this.emit('dispose',this)},t.prototype.updateSourceImage=function(e){this.source.src=e,this.loadSource(this.source)},t.fromImage=function(e,r,a,n){var o=l.BaseTextureCache[e];if(!o){var i=new Image;void 0===r&&0!==e.indexOf('data:')?i.crossOrigin=(0,g.default)(e):r&&(i.crossOrigin='string'==typeof r?r:'anonymous'),o=new t(i,a),o.imageUrl=e,n&&(o.sourceScale=n),o.resolution=(0,l.getResolutionOfUrl)(e),i.src=e,t.addToCache(o,e)}return o},t.fromCanvas=function(e,r){var a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:'canvas';e._pixiId||(e._pixiId=a+'_'+(0,l.uid)());var n=l.BaseTextureCache[e._pixiId];return n||(n=new t(e,r),t.addToCache(n,e._pixiId)),n},t.from=function(e,r,a){if('string'==typeof e)return t.fromImage(e,void 0,r,a);if(e instanceof HTMLImageElement){var n=e.src,o=l.BaseTextureCache[n];return o||(o=new t(e,r),o.imageUrl=n,a&&(o.sourceScale=a),o.resolution=(0,l.getResolutionOfUrl)(n),t.addToCache(o,n)),o}return e instanceof HTMLCanvasElement?t.fromCanvas(e,r):e},t.addToCache=function(e,t){t&&(-1===e.textureCacheIds.indexOf(t)&&e.textureCacheIds.push(t),l.BaseTextureCache[t]&&console.warn('BaseTexture added to the cache with an id ['+t+'] that already had an entry'),l.BaseTextureCache[t]=e)},t.removeFromCache=function(e){if('string'==typeof e){var t=l.BaseTextureCache[e];if(t){var r=t.textureCacheIds.indexOf(e);return-1<r&&t.textureCacheIds.splice(r,1),delete l.BaseTextureCache[e],t}}else if(e&&e.textureCacheIds){for(var a=0;a<e.textureCacheIds.length;++a)delete l.BaseTextureCache[e.textureCacheIds[a]];return e.textureCacheIds.length=0,e}return null},t}(c.default);t.default=y},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function n(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function o(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var i=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),s=r(2),l=r(58),d=function(e){return e&&e.__esModule?e:{default:e}}(l),u=function(e){function t(){a(this,t);var r=n(this,e.call(this));return r.children=[],r}return o(t,e),t.prototype.onChildrenChange=function(){},t.prototype.addChild=function(e){var t=arguments.length;if(1<t)for(var r=0;r<t;r++)this.addChild(arguments[r]);else e.parent&&e.parent.removeChild(e),e.parent=this,e.transform._parentID=-1,this.children.push(e),this._boundsID++,this.onChildrenChange(this.children.length-1),e.emit('added',this);return e},t.prototype.addChildAt=function(e,t){if(0>t||t>this.children.length)throw new Error(e+'addChildAt: The index '+t+' supplied is out of bounds '+this.children.length);return e.parent&&e.parent.removeChild(e),e.parent=this,e.transform._parentID=-1,this.children.splice(t,0,e),this._boundsID++,this.onChildrenChange(t),e.emit('added',this),e},t.prototype.swapChildren=function(e,t){if(e!==t){var r=this.getChildIndex(e),a=this.getChildIndex(t);this.children[r]=t,this.children[a]=e,this.onChildrenChange(r<a?r:a)}},t.prototype.getChildIndex=function(e){var t=this.children.indexOf(e);if(-1===t)throw new Error('The supplied DisplayObject must be a child of the caller');return t},t.prototype.setChildIndex=function(e,t){if(0>t||t>=this.children.length)throw new Error('The supplied index is out of bounds');var r=this.getChildIndex(e);(0,s.removeItems)(this.children,r,1),this.children.splice(t,0,e),this.onChildrenChange(t)},t.prototype.getChildAt=function(e){if(0>e||e>=this.children.length)throw new Error('getChildAt: Index ('+e+') does not exist.');return this.children[e]},t.prototype.removeChild=function(e){var t=arguments.length;if(1<t)for(var r=0;r<t;r++)this.removeChild(arguments[r]);else{var a=this.children.indexOf(e);if(-1===a)return null;e.parent=null,e.transform._parentID=-1,(0,s.removeItems)(this.children,a,1),this._boundsID++,this.onChildrenChange(a),e.emit('removed',this)}return e},t.prototype.removeChildAt=function(e){var t=this.getChildAt(e);return t.parent=null,t.transform._parentID=-1,(0,s.removeItems)(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit('removed',this),t},t.prototype.removeChildren=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=arguments[1],r=e,a='number'==typeof t?t:this.children.length,n=a-r,o;if(0<n&&n<=a){o=this.children.splice(r,n);for(var s=0;s<o.length;++s)o[s].parent=null,o[s].transform&&(o[s].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(var i=0;i<o.length;++i)o[i].emit('removed',this);return o}if(0==n&&0===this.children.length)return[];throw new RangeError('removeChildren: numeric values are outside the acceptable range.')},t.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var e=0,t=this.children.length,r;e<t;++e)r=this.children[e],r.visible&&r.updateTransform()},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var e=0,t;e<this.children.length;e++)(t=this.children[e],t.visible&&t.renderable)&&(t.calculateBounds(),t._mask?(t._mask.calculateBounds(),this._bounds.addBoundsMask(t._bounds,t._mask._bounds)):t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds));this._lastBoundsID=this._boundsID},t.prototype._calculateBounds=function(){},t.prototype.renderWebGL=function(e){if(this.visible&&!(0>=this.worldAlpha)&&this.renderable)if(this._mask||this._filters)this.renderAdvancedWebGL(e);else{this._renderWebGL(e);for(var t=0,r=this.children.length;t<r;++t)this.children[t].renderWebGL(e)}},t.prototype.renderAdvancedWebGL=function(e){e.flush();var t=this._filters,r=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var a=0;a<t.length;a++)t[a].enabled&&this._enabledFilters.push(t[a]);this._enabledFilters.length&&e.filterManager.pushFilter(this,this._enabledFilters)}r&&e.maskManager.pushMask(this,this._mask),this._renderWebGL(e);for(var n=0,o=this.children.length;n<o;n++)this.children[n].renderWebGL(e);e.flush(),r&&e.maskManager.popMask(this,this._mask),t&&this._enabledFilters&&this._enabledFilters.length&&e.filterManager.popFilter()},t.prototype._renderWebGL=function(){},t.prototype._renderCanvas=function(){},t.prototype.renderCanvas=function(e){if(this.visible&&!(0>=this.worldAlpha)&&this.renderable){this._mask&&e.maskManager.pushMask(this._mask),this._renderCanvas(e);for(var t=0,r=this.children.length;t<r;++t)this.children[t].renderCanvas(e);this._mask&&e.maskManager.popMask(e)}},t.prototype.destroy=function(t){e.prototype.destroy.call(this);var r='boolean'==typeof t?t:t&&t.children,a=this.removeChildren(0,this.children.length);if(r)for(var n=0;n<a.length;++n)a[n].destroy(t)},i(t,[{key:'width',get:function(){return this.scale.x*this.getLocalBounds().width},set:function(e){var t=this.getLocalBounds().width;this.scale.x=0===t?1:e/t,this._width=e}},{key:'height',get:function(){return this.scale.y*this.getLocalBounds().height},set:function(e){var t=this.getLocalBounds().height;this.scale.y=0===t?1:e/t,this._height=e}}]),t}(d.default);t.default=u,u.prototype.containerUpdateTransform=u.prototype.updateTransform},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=r(65),l=a(s),d=r(134),u=a(d),p=r(67),c=a(p),h=r(135),g=a(h),f=r(2),m=r(1),y=r(3),x=a(y),_=function(e){function t(r,a,i){n(this,t);var s=o(this,e.call(this,'Canvas',r,a,i));return s.type=m.RENDERER_TYPE.CANVAS,s.rootContext=s.view.getContext('2d',{alpha:s.transparent}),s.context=s.rootContext,s.refresh=!0,s.maskManager=new u.default(s),s.smoothProperty='imageSmoothingEnabled',s.rootContext.imageSmoothingEnabled||(s.rootContext.webkitImageSmoothingEnabled?s.smoothProperty='webkitImageSmoothingEnabled':s.rootContext.mozImageSmoothingEnabled?s.smoothProperty='mozImageSmoothingEnabled':s.rootContext.oImageSmoothingEnabled?s.smoothProperty='oImageSmoothingEnabled':s.rootContext.msImageSmoothingEnabled&&(s.smoothProperty='msImageSmoothingEnabled')),s.initPlugins(),s.blendModes=(0,g.default)(),s._activeBlendMode=null,s.renderingToScreen=!1,s.resize(s.options.width,s.options.height),s}return i(t,e),t.prototype.render=function(e,t,r,a,n){if(this.view){this.renderingToScreen=!t,this.emit('prerender');var o=this.resolution;t?(t=t.baseTexture||t,!t._canvasRenderTarget&&(t._canvasRenderTarget=new c.default(t.width,t.height,t.resolution),t.source=t._canvasRenderTarget.canvas,t.valid=!0),this.context=t._canvasRenderTarget.context,this.resolution=t._canvasRenderTarget.resolution):this.context=this.rootContext;var i=this.context;if(t||(this._lastObjectRendered=e),!n){var s=e.parent,l=this._tempDisplayObjectParent.transform.worldTransform;a?(a.copy(l),this._tempDisplayObjectParent.transform._worldID=-1):l.identity(),e.parent=this._tempDisplayObjectParent,e.updateTransform(),e.parent=s}i.save(),i.setTransform(1,0,0,1,0,0),i.globalAlpha=1,this._activeBlendMode=m.BLEND_MODES.NORMAL,i.globalCompositeOperation=this.blendModes[m.BLEND_MODES.NORMAL],navigator.isCocoonJS&&this.view.screencanvas&&(i.fillStyle='black',i.clear()),(void 0===r?this.clearBeforeRender:r)&&this.renderingToScreen&&(this.transparent?i.clearRect(0,0,this.width,this.height):(i.fillStyle=this._backgroundColorString,i.fillRect(0,0,this.width,this.height)));var d=this.context;this.context=i,e.renderCanvas(this),this.context=d,i.restore(),this.resolution=o,this.emit('postrender')}},t.prototype.clear=function(e){var t=this.context;e=e||this._backgroundColorString,!this.transparent&&e?(t.fillStyle=e,t.fillRect(0,0,this.width,this.height)):t.clearRect(0,0,this.width,this.height)},t.prototype.setBlendMode=function(e){this._activeBlendMode===e||(this._activeBlendMode=e,this.context.globalCompositeOperation=this.blendModes[e])},t.prototype.destroy=function(t){this.destroyPlugins(),e.prototype.destroy.call(this,t),this.context=null,this.refresh=!0,this.maskManager.destroy(),this.maskManager=null,this.smoothProperty=null},t.prototype.resize=function(t,r){e.prototype.resize.call(this,t,r),this.smoothProperty&&(this.rootContext[this.smoothProperty]=x.default.SCALE_MODE===m.SCALE_MODES.LINEAR)},t.prototype.invalidateBlendMode=function(){this._activeBlendMode=this.blendModes.indexOf(this.context.globalCompositeOperation)},t}(l.default);t.default=_,f.pluginTarget.mixin(_)},function(e,t){'use strict';function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var a=function(){function e(t){r(this,e),this.renderer=t,this.renderer.on('context',this.onContextChange,this)}return e.prototype.onContextChange=function(){},e.prototype.destroy=function(){this.renderer.off('context',this.onContextChange,this),this.renderer=null},e}();t.default=a},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function n(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function o(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){if(e instanceof Array){if('precision'!==e[0].substring(0,9)){var r=e.slice(0);return r.unshift('precision '+t+' float;'),r}}else if('precision'!==e.trim().substring(0,9))return'precision '+t+' float;\n'+e;return e}t.__esModule=!0;var s=r(7),l=r(3),d=function(e){return e&&e.__esModule?e:{default:e}}(l),u=function(e){function t(r,o,s,l,u){return a(this,t),n(this,e.call(this,r,i(o,u||d.default.PRECISION_VERTEX),i(s,u||d.default.PRECISION_FRAGMENT),void 0,l))}return o(t,e),t}(s.GLShader);t.default=u},function(e,t,r){'use strict';var a=r(188).default,n=r(45).default,o=r(93),i=r(94);a.Resource=n,a.async=o,a.base64=i,e.exports=a,e.exports.default=a},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function n(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function o(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var i=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),s=r(0),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(s),d=r(11),u=function(e){return e&&e.__esModule?e:{default:e}}(d),p=new l.Point,c=new l.Polygon,h=function(e){function t(r,o,i,s,d){a(this,t);var p=n(this,e.call(this));return p._texture=r||u.default.EMPTY,p.uvs=i||new Float32Array([0,0,1,0,1,1,0,1]),p.vertices=o||new Float32Array([0,0,100,0,100,100,0,100]),p.indices=s||new Uint16Array([0,1,3,2]),p.dirty=0,p.indexDirty=0,p.blendMode=l.BLEND_MODES.NORMAL,p.canvasPadding=l.settings.MESH_CANVAS_PADDING,p.drawMode=d||t.DRAW_MODES.TRIANGLE_MESH,p.shader=null,p.tintRgb=new Float32Array([1,1,1]),p._glDatas={},p._uvTransform=new l.TextureMatrix(p._texture),p.uploadUvTransform=!1,p.pluginName='mesh',p}return o(t,e),t.prototype._renderWebGL=function(e){this.refresh(),e.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)},t.prototype._renderCanvas=function(e){this.refresh(),e.plugins[this.pluginName].render(this)},t.prototype._onTextureUpdate=function(){this._uvTransform.texture=this._texture,this.refresh()},t.prototype.multiplyUvs=function(){this.uploadUvTransform||this._uvTransform.multiplyUvs(this.uvs)},t.prototype.refresh=function(e){this._uvTransform.update(e)&&this._refresh()},t.prototype._refresh=function(){},t.prototype._calculateBounds=function(){this._bounds.addVertices(this.transform,this.vertices,0,this.vertices.length)},t.prototype.containsPoint=function(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,p);for(var r=this.vertices,a=c.points,n=this.indices,o=this.indices.length,s=this.drawMode===t.DRAW_MODES.TRIANGLES?3:1,l=0;l+2<o;l+=s){var i=2*n[l],d=2*n[l+1],u=2*n[l+2];if(a[0]=r[i],a[1]=r[i+1],a[2]=r[d],a[3]=r[d+1],a[4]=r[u],a[5]=r[u+1],c.contains(p.x,p.y))return!0}return!1},i(t,[{key:'texture',get:function(){return this._texture},set:function(e){this._texture===e||(this._texture=e,e&&(e.baseTexture.hasLoaded?this._onTextureUpdate():e.once('update',this._onTextureUpdate,this)))}},{key:'tint',get:function(){return l.utils.rgb2hex(this.tintRgb)},set:function(e){this.tintRgb=l.utils.hex2rgb(e,this.tintRgb)}}]),t}(l.Container);t.default=h,h.DRAW_MODES={TRIANGLE_MESH:0,TRIANGLES:1}},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t.ASSET_DIR='assets',t.ISDEV=!1,t.DOCWIDTH=1920,t.DOCHEIGHT=1080,t.FG_BEAT_VOLUME=.5},function(e,t,r){'use strict';var a=Math.ceil,o=Math.max,n=Math.round,i=Math.PI;Object.defineProperty(t,'__esModule',{value:!0});const s=r(6);r(23);const l=r(100),d=r(208),u=r(209),p=r(210),c=r(29),h=r(8),g=r(13),f=r(211),m=r(212),y=r(213),x=r(214),_=r(215),b=r(216),T=r(5),v=r(10),E=r(21),S=r(24),C=r(30),P=r(217),w=r(221),M=r(222);class A{constructor(e,t){this.time=e,this.callback=t,this.t0=NaN,this.expired=!1}tick(e){return this.expired?void 0:isNaN(this.t0)?void(this.t0=e):void(e-this.t0>=this.time&&(this.expired=!0,this.callback()))}}t.Level=class{constructor(e,t){this.markup=t,this.eventCallbacks={},this.lastInstant=0,this.backgroundVolume=.3,this.ghosts=[],this.towers=[],this.towerMap={},this.concluded=!1,this.allTowerRangesOn=!1,this.timers=[],this.delays=[],this.productionRate=0,this.wallPairs=[],this.endwallPairs=[],this.reservedCells=[],this.towerIdCount=0,this.ghostIdCount=0,this.maxTowers=0,this.maxGhosts=0,this.recycledTowerIds=[],this.timeScale=1,this.nGhostsAtWaveDeployFinish=0,this.debugGraphics={},this.initApp(T.Game.vpWidth,T.Game.vpHeight,e),this.initLayers(),this.setupResourceMeter(),this.curInstant=0,this.animator=new p.Animator,this.economy=new f.Economy(this),this.towerTypes=['gun'],this.towerPlaceHolders=new s.Graphics,this.layers.cursors.addChild(this.towerPlaceHolders),this.wallGraphics=new s.Graphics,this.layers.walls.addChild(this.wallGraphics),this.towerMetricGraphic=new s.Graphics,this.layers.cursors.addChild(this.towerMetricGraphic),this.towerMetricGraphic.visible=!1,E.ISDEV&&(this.debugGraphics.grid=new s.Graphics,this.debugGraphics.ghostlanes=new s.Graphics,this.debugTextContainer=new s.Container)}on(e,t){this.eventCallbacks[e]=t}trigger(e,t){this.eventCallbacks[e]&&this.eventCallbacks[e](t)}initIdPool(e,t){this.towerIdCount=0,this.ghostIdCount=0,this.maxTowers=e,this.maxGhosts=t,this.recycledTowerIds=[]}genTowerId(){return this.towerIdCount<this.maxTowers?this.towerIdCount++:0<this.recycledTowerIds.length?this.recycledTowerIds.shift():(v.Log.assert(!1,'Running out of tower IDs'),-1)}genGhostId(){return this.ghostIdCount<this.maxGhosts?this.ghostIdCount++:(v.Log.assert(!1,'Running out of ghost IDs'),-1)}recycleTowerId(e){this.recycledTowerIds.push(e.uid)}delay(e){return new Promise((t)=>{let r=new A(e,()=>{let e=this.delays.indexOf(r);0<=e&&this.delays.splice(e,1),t()});this.delays.push(r)})}initLayers(){this.layers={},this.layers.pavilion=new s.Container,this.layers.cursors=new s.Container,this.layers.shells=new s.Container,this.layers.towers=new s.Container,this.layers.walls=new s.Container,this.layers.structures=new s.Container,this.layers.city=new s.Container,this.layers['city-slabs']=new s.Container,this.layers.ghosts=new s.Container,this.layers['ghosts-with-gold']=new s.Container,this.layers.background=new s.Container,this.layers.ui=new s.Container,this.layers.debug=new s.Container,this.layers.curtain=new s.Container,this.app.stage.addChild(this.layers.background),this.app.stage.addChild(this.layers['city-slabs']),this.app.stage.addChild(this.layers.city),this.app.stage.addChild(this.layers.structures),this.app.stage.addChild(this.layers.ghosts),this.app.stage.addChild(this.layers['ghosts-with-gold']),this.app.stage.addChild(this.layers.walls),this.app.stage.addChild(this.layers.shells),this.app.stage.addChild(this.layers.towers),this.app.stage.addChild(this.layers.cursors),this.app.stage.addChild(this.layers.pavilion),this.app.stage.addChild(this.layers.ui),this.app.stage.addChild(this.layers.debug),this.app.stage.addChild(this.layers.curtain)}promoteGhost(e){this.layers.ghosts.removeChild(e.container),this.layers['ghosts-with-gold'].addChild(e.container)}setupResourceMeter(){this.resourceMeter=new y.ResourceMeter(this),this.resourceMeter.position.set(T.Game.docWidth-200,0),this.layers.ui.addChild(this.resourceMeter)}isCellDamagable(e){return!this.terra.isWallAt(e)||this.pavilion.occupiesCell(e)||!this.isTowerAt(e)}updateTowerMetric(){let e=this.towerMetricGraphic;const t=15;e.clear(),this.towers.forEach((r)=>{let[a,n]=r.position;e.lineStyle(0),e.beginFill(16777215,.5);let o=2*r.getEfficiency()*i;e.moveTo(a,n),e.lineTo(a+t,n),e.arc(a,n,t,0,o),e.lineTo(a,n),e.endFill(),e.lineStyle(1,16777215,.5),e.drawCircle(a,n,t)})}showTowerMetric(){this.towerMetricGraphic.visible=!0,this.updateTowerMetric(),this.towerMetricUpdateTimer=new h.Timer(1e3,()=>{this.updateTowerMetric()}),this.timers.push(this.towerMetricUpdateTimer)}hideTowerMetric(){this.towerMetricGraphic.visible=!1;let e=this.timers.indexOf(this.towerMetricUpdateTimer);0<=e?this.timers.splice(e,1):v.Log.error('Failed to remove tower metric update timer')}updateHeatmap(){const e=4,t=this.terra.cellsize,r=t/e;this.heatmap||(this.heatmap=new s.Graphics,this.damageGrid=new P.Grid(this.terra.nrows*e,this.terra.ncols*e,{type:'uint16'}));let a=-Infinity;this.damageGrid.fill(0),this.terra.forEachCell((n,i)=>{if(this.isCellDamagable([n,i])){let[s,l]=h.vec2.sub(this.terra.getCellCenter(n,i),[t/2,t/2]);for(let t=0;t<e;t++)for(let d=0;d<e;d++){let u=[s+r/2+t*r,l+r/2+d*r],p=0;for(let e of this.towers)p+=e.getDamageInflictedPerSecondAt(u);a=o(a,p),this.damageGrid.set(n*e+d,i*e+t,p)}}}),this.heatmap.clear(),this.heatmap.lineStyle(0),this.terra.forEachCell((n,o)=>{if(this.isCellDamagable([n,o])){let[i,s]=h.vec2.sub(this.terra.getCellCenter(n,o),[t/2,t/2]);for(let t=0;t<e;t++)for(let l=0;l<e;l++){let d=this.damageGrid.get(n*e+l,o*e+t),u=d/a;this.heatmap.beginFill(16777215,u),this.heatmap.drawRect(i+t*r,s+l*r,r,r),this.heatmap.endFill()}}})}showAllTowerRanges(){this.allTowerRangesOn=!0,this.towers.forEach((e)=>{e.rangeGraphic.visible=!0})}hideAllTowerRanges(){this.allTowerRangesOn=!1,this.towers.forEach((e)=>{e.rangeGraphic.visible=!1})}isPlaying(){return this.app.ticker.started}pause(){this.app.ticker.stop(),T.Game.audio.mute('background'),this.ship.curBeatTrack&&(this.ship.curBeatTrack.gain.gain.value=0)}resume(){this.app.ticker.start(),T.Game.audio.play('background',this.backgroundVolume),this.ship.curBeatTrack&&(this.ship.curBeatTrack.gain.gain.value=E.FG_BEAT_VOLUME)}showTowerMenu(){this.towerMenu.show()}resetTowerAdd(){this.towerAddCell=void 0,this.towerMenu.hide()}isTowerMenuActive(){return this.towerMenu&&this.towerMenu.visible}createTowerAddCursor(){let e=new s.Graphics;e.lineStyle(0),e.beginFill(16777215,.1);let t=this.terra.cellsize/2;return e.drawRect(-t/2,-t/2,t,t),e.endFill(),e}createTowerAddPlaceholder(){let e=new s.Graphics;e.lineStyle(0),e.beginFill(16777215,.8);let t=this.terra.cellsize/2;return e.drawRect(-t/2,-t/2,t,t),e.endFill(),e}createTowerDeleteCursor(){let e=new s.Graphics;e.lineStyle(0);let t=this.terra.cellsize;return e.lineStyle(15,16777215,1),e.moveTo(-t/6,-t/6),e.lineTo(t/6,t/6),e.moveTo(-t/6,t/6),e.lineTo(t/6,-t/6),e.alpha=.5,e}getBestTowerByDamageRate(){let e=-Infinity,r='';for(let a of this.towerTypes)e<d.Tower.getBestAmmoDamageRate(a)&&(e=d.Tower.getBestAmmoDamageRate(a),r=a);return[r,e]}getExistingDamageRate(){let e=0;for(let t of this.towers)e+=d.Tower.getBestAmmoDamageRate(t.type);return e}announceWave(e){this.productionRate=e.resrate}announceWave2(e){let t={walker:g.spec.ghosts.walker,bouncer:g.spec.ghosts.bouncer,sprinter:g.spec.ghosts.sprinter},r=t[e.type],a=e.total*r.maxshield,n=e.total*r.maxhealth,[o,i]=this.getBestTowerByDamageRate(),s=this.getExistingDamageRate(),l=s*e.duration,u=1.5*(n+a-l)/(i*e.duration),p=u*d.Tower.getTowerConstructionCost(o);this.productionRate=p/e.duration,this.delay(1e3*e.duration).then(()=>{this.productionRate=0})}announceWave1(e){let t=e.duration+30,r={walker:g.spec.ghosts.walker,bouncer:g.spec.ghosts.bouncer,sprinter:g.spec.ghosts.sprinter},a=r[e.type],n=e.total*a.maxshield,i=e.total*a.maxhealth,s=g.spec.towers.gun.ammo,l=n/s.damage.shield+i/s.damage.health,d=300*.1,u=o(s.damage.health,s.damage.shield)*d,p=.6*l/u*g.spec.towers.gun.construction.cost,c=3*g.spec.towers.gun.construction.delay/1e3,h=t-d-c;this.productionRate=p/h,v.Log.info(this.productionRate,h),this.delay(1e3*h).then(()=>{this.productionRate=0})}finish(){this.app.ticker.stop(),this.app.destroy(!0)}conclude(e){if(this.concluded)return;let t=new s.Graphics;t.beginFill(0,1),t.drawRect(0,0,T.Game.docWidth,T.Game.docHeight),t.endFill(),this.layers.curtain.addChild(t),this.score.close(this.getGameTime());let r=this.timers.indexOf(this.scoreTimer);if(console.assert(0<=r),this.timers.splice(r,1),this.animator.add(new c.Animation(3e3,c.Animation.LINEAR,(e)=>{t.alpha=e},()=>{this.finish(),T.Game.screenMan.unloadLevel(e,this.score)})),window.gtag){let t=n(this.getGameTime()/1e3);window.gtag('event',`${e?'WIN':'LOSS'}_L${this.id}_${this.difficulty}`,{value:t})}this.ship.curBeatTrack&&(this.ship.curBeatTrack.source.stop(),T.Game.audio.mute('background',1e3)),this.concluded=!0}checkOutcome(){let e=0,t=!0,r=this.ship;return e+=r.gold,t=t&&r.allWavesDeployed,e>=this.pavilion.nfactoids?void this.conclude(!1):t&&0>=this.ghosts.length?void this.conclude(!0):void 0}showTowerCursorAt(e,t){let r=this.terra.getCellCenter(e[0],e[1]);this.towerAddCursor.position.set(r[0],r[1]),this.towerAddCursor.tint=t,this.towerAddCursor.visible=!0}showTowerAddPlaceholderAt(e){let t=this.terra.getCellCenter(e[0],e[1]);this.towerAddPlaceholder.position.set(t[0],t[1]),this.towerAddPlaceholder.visible=!0}hideTowerAddPlaceholder(){this.towerAddPlaceholder.visible=!1}showTowerDeleteCursorAt(e){let t=this.terra.getCellCenter(e[0],e[1]);this.towerDeleteCursor.position.set(t[0],t[1]),this.towerDeleteCursor.visible=!0}hideTowerCursor(){this.towerAddCursor.visible=!1}hideTowerDeleteCursor(){this.towerDeleteCursor.visible=!1}canAddTowerWithoutBlocking(e,t){for(let r of this.reservedCells)if(r[0]===e&&r[1]===t)return!1;return!0}canAddTowerAt(e,t){let[r,a]=this.ship.source;return!this.terra.isWallAt(e,t)&&!this.isTowerAt([e,t])&&!this.pavilion.occupiesCell([e,t])&&(e!==r||t!==a)&&this.canAddTowerWithoutBlocking(e,t)}createTowerPlaceHolders(){this.towerPlaceHolders.clear(),this.towerPlaceHolders.lineStyle(0),this.towerPlaceHolders.beginFill(16777215,.02);let e=this.terra.cellsize/4;this.terra.forEachCell((t,r)=>{if(this.canAddTowerAt(t,r)){let[a,n]=this.terra.getCellCenter(t,r);this.towerPlaceHolders.drawRect(a-e/2,n-e/2,e,e)}}),this.towerPlaceHolders.endFill()}tickTime(e){let t=this.timeScale*e;return this.curInstant+=t,[this.curInstant,t]}getGameTime(){return this.curInstant}getDeltaGameTime(){return this.curInstant-this.lastInstant}getTimeScale(){return this.timeScale}setTimeScale(e){let t=!1,r=!1;1===this.timeScale&&1!==e&&(t=!0),1!==this.timeScale&&1===e&&(r=!0),this.timeScale=e,1===e?this.tray.setTimeScaleText():this.tray.setTimeScaleText(`x${e}`),t&&(T.Game.audio.mute('background'),this.ship.curBeatTrack&&(this.ship.curBeatTrack.gain.gain.value=0),T.Game.audio.play('time-fwd',.3)),r&&(T.Game.audio.mute('time-fwd'),T.Game.audio.play('background',this.backgroundVolume),this.ship.curBeatTrack&&(this.ship.curBeatTrack.gain.gain.value=E.FG_BEAT_VOLUME))}isTimeFwd(){return 1<this.timeScale}play(){this.terra.setPathEndPoints(this.ship.source,this.pavilion.getEntranceCell()),this.refreshTerra(),T.Game.audio.play('background',this.backgroundVolume);let e=this.ship.waves.map((e)=>'pause'===e.type?0:e.total).reduce((e,t)=>e+t,0),t=this.terra.numFreeCells();this.initIdPool(t,e),this.collsys=new u.CollisionSystem(e,t,this),window.gtag&&window.gtag('event',`START_L${this.id}_${this.difficulty}`),this.scoreTimer=new h.Timer(w.Score.sampleRate,()=>{this.score.sample(this.getGameTime())}),this.timers.push(this.scoreTimer),this.score=new w.Score(this),this.towerAddCursor=this.createTowerAddCursor(),this.towerAddPlaceholder=this.createTowerAddPlaceholder(),this.towerAddCursor.visible=!1,this.towerAddPlaceholder.visible=!1,this.towerDeleteCursor=this.createTowerDeleteCursor(),this.towerDeleteCursor.visible=!1,this.layers.cursors.addChild(this.towerAddCursor),this.layers.cursors.addChild(this.towerDeleteCursor),this.layers.cursors.addChild(this.towerAddPlaceholder),this.createTowerPlaceHolders(),this.ship.dock().then(()=>{this.ship.start()}),this.registerMouseInteraction(),this.app.ticker.add(()=>{let[e,t]=this.tickTime(this.app.ticker.elapsedMS);T.Game.screenMan.pstats&&T.Game.screenMan.pstats.begin(),this.economy.produce(this.productionRate*t/1e3),this.animator.tick(e),this.ghosts.forEach((r)=>r.tick(e,t)),this.towers.forEach((r)=>{r.tick(e,t),'laser'===r.type&&r.track&&this.updateLaserBeam(r)}),this.timers.forEach((t)=>t.tick(e)),this.delays.forEach((t)=>t.tick(e)),this.ship.tick(e),this.collsys.analyse(),T.Game.screenMan.pstats&&T.Game.screenMan.pstats.end()})}getTowerAt(e){let[t,a]=e;for(let n of this.towers){let[e,r]=n.cell;if(t===e&&a===r)return n}return null}isTowerAt(e){let[t,a]=e;for(let n of this.towers){let[e,r]=n.cell;if(t===e&&a===r)return!0}return!1}removeTower(e){let t=this.towers.indexOf(e);v.Log.assert(0<=t,'Tower not found for removal'),this.towers.splice(t,1),this.recycleTowerId(e),this.terra.removeWallAt(e.cell[0],e.cell[1]),this.layers.towers.removeChild(e.container),this.reconstructWalls(),this.refreshTerra(),this.economy.produce(.8*e.spec.construction.cost),this.score.countTowerReclaim(this.getGameTime(),this.getMinPathLen())}registerMouseInteraction(){this.app.stage.interactive=!0,this.app.stage.on('mousemove',(e)=>{let t=e.data.originalEvent,[r,a]=this.viewportToDocument([t.offsetX,t.offsetY]),n=this.terra.resolveCell(r,a);if(this.terra.isValidCell(n)){let e=this.getTowerAt(n);this.allTowerRangesOn||this.towers.forEach((e)=>e.rangeGraphic.visible=!1),e?(this.showTowerDeleteCursorAt(n),this.hideTowerCursor(),e.rangeGraphic.visible=!0):this.canAddTowerAt(n[0],n[1])&&(this.showTowerCursorAt(n,16777215),this.hideTowerDeleteCursor())}}),this.app.stage.on('mouseup',(e)=>{let t=e.data.originalEvent,[r,a]=this.viewportToDocument([t.offsetX,t.offsetY]),n=this.terra.resolveCell(r,a),o=this.getTowerAt(n);o?(this.removeTower(o),this.towerMenu.visible&&(this.resetTowerAdd(),this.hideTowerAddPlaceholder())):this.towerMenu.visible?(this.resetTowerAdd(),this.hideTowerAddPlaceholder()):this.canAddTowerAt(n[0],n[1])&&(this.showTowerMenu(),this.showTowerAddPlaceholderAt(n),this.towerAddCell=n)})}handleKeyUp(e){switch(e.code){case'KeyF':e.ctrlKey?document.body.webkitRequestFullScreen():this.setTimeScale(1);}}handleKeyDown(e){switch(e.code){case'Escape':this.isTowerMenuActive()?(this.hideTowerAddPlaceholder(),this.resetTowerAdd()):(this.pause(),this.trigger('pause'));break;case'ArrowUp':this.setTimeScale(Math.min(n(2*this.getTimeScale()),8));break;case'ArrowDown':this.setTimeScale(o(n(this.getTimeScale()/2),1));break;case'KeyQ':0<=this.towerTypes.indexOf('gun')&&this.addTower('gun');break;case'KeyW':0<=this.towerTypes.indexOf('canon')&&this.addTower('canon');break;case'KeyE':0<=this.towerTypes.indexOf('laser')&&this.addTower('laser');break;case'KeyA':0<=this.towerTypes.indexOf('block')&&this.addTower('block');break;case'KeyF':e.ctrlKey||this.setTimeScale(2);break;case'Digit0':e.ctrlKey&&E.ISDEV&&(e.shiftKey?this.hideDebugVisual():this.showDebugVisual());}}handleKeyPress(e){}viewportToDocument(e){let t=this.app.stage.transform.worldTransform.applyInverse(new s.Point(e[0],e[1]));return[t.x,t.y]}documentToViewport(e){let t=this.app.stage.transform.worldTransform.apply(new s.Point(e[0],e[1]));return[t.x,t.y]}loadRes(){let e=T.Game.vpWidth/T.Game.docWidth;this.app.stage.setTransform(0,0,e,e),this.towerMenu=new x.TowerMenu(this.towerTypes,this),this.towerMenu.visible=!1,this.layers.ui.addChild(this.towerMenu),this.tray=new M.Tray(this),this.layers.ui.addChild(this.tray)}getTexture(e,t){console.assert(!!T.Game.spineTexMap[e]);let r=T.Game.spineTexMap[e].skeleton.findSlot(t);return console.assert(r&&r.currentSprite),r.currentSprite.texture}definePavilion(e){console.assert(this.terra.isValidCell(e)&&!this.terra.isWallAt(e)),this.pavilion=new m.Pavilion(e,this),this.layers.pavilion.addChild(this.pavilion)}createTower(e,t){let r=new PIXI.spine.Spine(T.Game.spineJsonParser.readSkeletonData(T.Game.spineData[e]));return r.skeleton.setSkinByName('blue'),new d.Tower(e,r,t,this)}expireGhost(e){if(this.removeGhost(e),e.hasfactoid)if(e.isdead){let t=e.position,r=this.pavilion.getCenter(),a=this.pavilion.getFactoidGraphics();this.layers.ghosts.addChild(a),this.animator.add(new c.Animation(2e3,c.Animation.LINEAR,(e)=>{let n=h.vec2.add(t,h.vec2.mul(h.vec2.sub(r,t),e));a.position.set(n[0],n[1])},()=>{this.layers.ghosts.removeChild(a),this.pavilion.returnFactoid(),this.score.countGoldReturn(this.getGameTime())}))}else this.score.countGoldLoss(this.getGameTime()),e.ship.claimGold();if(this.ship.allWavesDeployed&&this.ship.curBeatTrack&&0<this.nGhostsAtWaveDeployFinish){let e=this.ghosts.length/this.nGhostsAtWaveDeployFinish;this.ship.curBeatTrack.gain.gain.value=e*E.FG_BEAT_VOLUME}}getFireVolume(){return 1/this.towers.length}addFloorPlan(e,t,r,n){this.floorPlan=new _.FloorPlan(e,t,r),this.layers.structures.addChild(this.floorPlan);let o=a(T.Game.docHeight/n),i=a(T.Game.docWidth/n),s=new C.GridBit(o,i),l=n/4;for(let a=0;a<o;a++)for(let e=0;e<i;e++){let t=a*n+n/2,r=e*n+n/2,o=[[r-l,t-l],[r+l,t-l],[r+l,t+l],[r-l,t+l]].every((e)=>this.floorPlan.isPointOnFloor(e));o?s.set(a,e,0):s.set(a,e,1)}this.terra=new S.RectTerraLean({cellsize:n,nrows:o,ncols:i,walls:s.data}),this.app.stage.addChild(this.floorPlan.floor.fmask),this.layers.walls.mask=this.floorPlan.floor.fmask}setupCity(e){let t=new PIXI.spine.Spine(T.Game.spineJsonParser.readSkeletonData(T.Game.spineData[e]));t.state.setAnimation(0,'move',!0),this.layers.city.addChild(t)}setupCitySlabs(e){let t=this.animator;for(let r of e){let e=new s.Container,a=new s.Graphics;a.lineStyle(0),a.beginFill(r.color),a.drawRect(0,0,r.width,r.height),a.endFill();let n=new s.Graphics;n.lineStyle(0),n.beginFill(0,.3),n.drawRect(r.shadowoffset[0],r.shadowoffset[1],r.width,r.height),n.endFill(),e.addChild(n),e.addChild(a),this.layers['city-slabs'].addChild(e),e.position.set(r.from[0],r.from[1]),function a(){t.add(new c.Animation(r.period,c.Animation.LINEAR,(t)=>{let a=h.vec2.sub(r.to,r.from),n=h.vec2.add(r.from,h.vec2.mul(a,t));e.position.set(n[0],n[1])},()=>{a()}))}()}}notifyAllWavesDeployed(){this.nGhostsAtWaveDeployFinish=this.ghosts.length}addShip(e,t,r){v.Log.assert(this.terra.isValidCell(e)&&!this.terra.isWallAt(e),'Ship source is not valid cell'),E.ISDEV&&h.isFastShip()&&(r.duration=1e3),this.ship=new b.Ship(r,e,t,this),this.layers.structures.addChild(this.ship)}addTimer(e){this.timers.push(e)}removeTimer(e){let t=this.timers.indexOf(e);0<=t?this.timers.splice(t,1):v.Log.error('Timer not found')}refreshTerra(){this.terra.updatePointers(),this.createTowerPlaceHolders(),this.updateDebugGridGraphics(),this.updateDebugGhostPathsGraphics()}drawWall(e,t,r){let a=h.vec2.dir(t,r),n=h.vec2.orthogonal(a),o=h.vec2.mul(n,10/2),i=h.vec2.add(t,o),s=h.vec2.sub(t,o),l=h.vec2.sub(r,o),d=h.vec2.add(r,o);e.lineStyle(0),e.beginFill(3110058,1),e.moveTo(i[0],i[1]),e.lineTo(s[0],s[1]),e.lineTo(l[0],l[1]),e.lineTo(d[0],d[1]),e.endFill()}redrawWalls(){let e=this.wallGraphics;e.clear();for(let t of this.wallPairs){let[r,a]=this.splitWallPair(t),n=this.towerMap[r],o=this.towerMap[a];this.drawWall(e,n.position,o.position)}for(let t of this.endwallPairs)this.drawWall(e,t[0],t[1])}makeWallPair(e,t){return e<<16|t}splitWallPair(e){return[e>>16,65535&e]}reconstructWalls(){this.wallPairs=[],this.endwallPairs=[];let e=[];this.towers.forEach((t,r)=>{let[a]=t.getNeighbors();for(let e of a){let r=this.makeWallPair(t.uid,e.uid),a=this.makeWallPair(e.uid,t.uid);0>this.wallPairs.indexOf(r)&&0>this.wallPairs.indexOf(a)&&this.wallPairs.push(r)}0>=a.length&&e.push(r)}),this.towers.forEach((t,r)=>{let a=0;for(let e of this.wallPairs){let[r,n]=this.splitWallPair(e);(r===t.uid||n===t.uid)&&a++}1==a&&e.push(r)});for(let t of e){let r=this.towers[t],a=r.getNeighbors()[1];for(let t of a){let a=this.towers.indexOf(t);if(0<=e.indexOf(a)){this.wallPairs.push(this.makeWallPair(r.uid,t.uid));break}}for(let e of this.terra.getNeighbors(r.cell)){let t=this.terra.nrows,a=this.terra.ncols,n=this.terra.cellsize,[o,i]=r.position;if(0===r.cell[0]){this.endwallPairs.push([r.position,[o,i-n]]);break}else if(r.cell[0]===t-1){this.endwallPairs.push([r.position,[o,i+n]]);break}else if(0===r.cell[1]){this.endwallPairs.push([r.position,[o-n,i]]);break}else if(r.cell[1]===a-1){this.endwallPairs.push([r.position,[o+n,i]]);break}else if(!this.floorPlan.isPointOnFloor(this.terra.getCellCenter(e))){this.endwallPairs.push([r.position,this.terra.getCellCenter(e)]);break}}}this.redrawWalls()}isBottleneck(e){let t=this.ship.source,r=this.pavilion.getEntranceCell(),a=this.terra.clone();return a.setWallAt(e),!a.pathExists(t,r)}getMinPathLen(){let[e,t]=this.ship.source,[r,a]=this.pavilion.entryCell;return this.terra.fwdDistance.get(e,t)+this.terra.rvsDistance.get(r,a)}flashBottleneckPath(e,t){let r=-1;for(let a=0,n;a<e.length;a++)n=e[a],n[0]===t[0]&&n[1]===t[1]&&(r=a);console.assert(0<=r);let a=new s.Graphics,n=15;if(r<e.length-1){let t=n;for(let o=r+1;o<e.length;o++){a.lineStyle(7,16777215,t/n);let[r,i]=this.terra.getCellCenter(e[o-1]),[s,l]=this.terra.getCellCenter(e[o]);if(a.moveTo(r,i),a.lineTo(s,l),t--,!t)break}}if(0<r){let t=n;for(let o=r;0<=o;o--){a.lineStyle(t,16777215,t/n);let[r,i]=this.terra.getCellCenter(e[o-1]),[s,l]=this.terra.getCellCenter(e[o]);if(a.moveTo(r,i),a.lineTo(s,l),t--,!t)break}}let[o,i]=this.terra.getCellCenter(t),l=this.terra.cellsize;a.lineStyle(15,8947848,.7),a.moveTo(o-l/6,i-l/6),a.lineTo(o+l/6,i+l/6),a.moveTo(o-l/6,i+l/6),a.lineTo(o+l/6,i-l/6),this.layers.structures.addChild(a),this.animator.add(new c.Animation(1e3,c.Animation.EASEOUT,(e)=>{a.alpha=1-e},()=>{this.layers.structures.removeChild(a)}))}addTower(e){this.hideTowerAddPlaceholder();let t=0;if('block'===e?t=g.spec.towers.block.construction.cost:'gun'===e?t=g.spec.towers.gun.construction.cost:'canon'===e?t=g.spec.towers.canon.construction.cost:'laser'===e?t=g.spec.towers.laser.construction.cost:v.Log.assert(!1,'Invalid tower type'),!this.economy.canAfford(t))T.Game.audio.playOnce('out-of-ammo'),this.resourceMeter.flashOutOfResources();else if(this.towerAddCell)if(this.isBottleneck(this.towerAddCell))this.flashBottleneckPath(this.terra.searchForwardPath(),this.towerAddCell),T.Game.audio.playOnce('out-of-ammo');else{let t=this.towerAddCell.slice(),r=this.terra.getCellCenter(t);this.terra.setWallAt(t),this.refreshTerra();let a=this.createTower(e,t);a.position=r,this.layers.towers.addChild(a.container),this.economy.consume(a.spec.construction.cost),this.score.countTowerBuild(this.getGameTime(),this.getMinPathLen()),this.animator.add(new c.Animation(a.spec.construction.delay,c.Animation.LINEAR,(e)=>{a.setConstructionProgress(e)},()=>{a.setConstructionProgress(1),this.towers.push(a),this.towerMap[a.uid]=a,this.reconstructWalls()}))}return this.hideTowerCursor(),this.resetTowerAdd(),this.hideTowerAddPlaceholder(),!0}emanateShipWave(){}spawnGhost(e,t){let r=new l.Ghost(e,t,this);return r.initState(t.source),this.ghosts.push(r),this.layers.ghosts.addChild(r.container),r.hide(),r}removeGhost(e){e.hasfactoid?this.layers['ghosts-with-gold'].removeChild(e.container):this.layers.ghosts.removeChild(e.container);let t=this.ghosts.indexOf(e);0<=t?(e.uid!==this.ghosts[t].uid&&v.Log.error('Level wrong ghost removal',e.toString(),this.ghosts[t].toString()),this.ghosts.splice(t,1)):v.Log.error('Level unknown ghost removal',e.toString()),this.towers.forEach((t)=>t.removeGhost(e)),this.checkOutcome()}resize(){this.app.view.style.marginLeft=-T.Game.vpWidth/2+'px',this.app.view.style.marginTop=-T.Game.vpHeight/2+'px';let e=T.Game.vpWidth/T.Game.docWidth;this.app.stage.setTransform(0,0,e,e),this.app.renderer.resize(T.Game.vpWidth,T.Game.vpHeight)}supportsWebGL(){return this.app&&this.app.renderer.type===s.RENDERER_TYPE.WEBGL}initApp(e,t,r){s.utils.skipHello(),this.app=new s.Application(e,t,{backgroundColor:r,antialias:!0,autoStart:!0}),this.app.renderer.type===s.RENDERER_TYPE.WEBGL?v.Log.debug('WebGL backend'):this.app.renderer.type===s.RENDERER_TYPE.CANVAS&&v.Log.debug('Canvas backend'),this.app.view.setAttribute('id','app'),this.app.view.style.position='absolute',this.app.view.style.left='50%',this.app.view.style.top='50%',this.app.view.style.marginLeft=-e/2+'px',this.app.view.style.marginTop=-t/2+'px'}startLaserBeam(e){this.layers.shells.addChild(e.laserGraphic),this.updateLaserBeam(e)}updateLaserBeam(e){let t=e.track;v.Log.assert(!!t,'Laser is not tracking');let r=h.vec2.dist(e.position,t.position),a=h.vec2.dir(e.position,t.position),n=h.vec2.dirToAngle(a);e.laserGraphic.scale.set(r,1),e.laserGraphic.rotation=n;let[o,i]=e.position;e.laserGraphic.position.set(o,i)}stopLaserBeam(e){this.layers.shells.removeChild(e.laserGraphic)}effectLaserDamage(e,t){t.sufferAttack(e.spec.ammo)}fireProjectile(e,t){let r=e.getAmmoSprite();r.visible=!1,r.rotation=e.rotation;let a=h.vec2.dir(e.position,t.position),n=h.vec2.add(e.position,h.vec2.mul(a,e.radius)),o=h.vec2.dist(n,t.position);r.position.set(n[0],n[1]);let i=new c.Animation(1e3*(o/1e3),c.Animation.LINEAR,(e)=>{r.visible=!0;let a=h.vec2.sub(t.position,n),o=h.vec2.add(n,h.vec2.mul(a,e));r.position.set(o[0],o[1])},()=>{v.Log.assert('block'!==e.type,'Block should not fire'),t.sufferAttack(e.spec.ammo),this.layers.shells.removeChild(r)});this.animator.add(i),this.layers.shells.addChild(r)}laneMaker(e,t){let r=this.terra.cellsize/4,a=[-r,0,r][t],n=e;return h.isZero(a)||(v.Log.assert(1<n.length,'Need at least two points to make lane'),n=n.map((t,r)=>{let n;if(0<r&&r<e.length-1){let t=h.vec2.dir(e[r-1],e[r]),a=h.vec2.dir(e[r],e[r+1]);n=h.vec2.unit(h.vec2.add(t,a))}else n=r<e.length-1?h.vec2.dir(t,e[r+1]):h.vec2.dir(e[r-1],t);return h.vec2.add(t,h.vec2.mul(h.vec2.orthogonal(n),a))})),n}animate(e,t,r){return new Promise((a)=>{this.animator.add(new c.Animation(e,t,r,()=>{a()}))})}animateLin(e,t){return new Promise((r)=>{this.animator.add(new c.Animation(e,c.Animation.LINEAR,t,()=>{r()}))})}updateDebugGridGraphics(){if(E.ISDEV&&this.layers.debug.visible){let e=this.debugGraphics.grid;e.clear(),this.debugTextContainer.removeChildren(),this.terra.cornersForEachCell((t,r,a)=>{let n=this.terra.isWallAt(r,a);e.lineStyle(0),e.beginFill(16777215,n?.3:0),e.moveTo(t[0][0],t[0][1]);for(let n=1;n<t.length;n++){let[r,a]=t[n];e.lineTo(r,a)}e.endFill()})}}updateDebugGhostPathsGraphics(){if(E.ISDEV&&this.layers.debug.visible){let e=this.debugGraphics.ghostlanes;e.clear(),e.lineStyle(2,65280,1);for(let t of this.ghosts){if(!t.pathcrv)continue;let r=t.getPathCurve();if(r){e.moveTo(r[0][0],r[0][1]);for(let t=1;t<r.length;t++)e.lineTo(r[t][0],r[t][1])}}}}showDebugVisual(){this.layers.debug.removeChildren(),this.updateDebugGridGraphics(),this.updateDebugGhostPathsGraphics(),this.layers.debug.addChild(this.debugGraphics.grid),this.layers.debug.addChild(this.debugGraphics.ghostlanes),this.layers.debug.addChild(this.debugTextContainer),this.layers.debug.visible=!0}hideDebugVisual(){this.layers.debug.visible=!1}static smoothenPath(e){const t=Math.cos(45*i/180)+.1;let r=[];for(let a=1;a<e.length-1;a++){let n=h.vec2.sub(e[a],e[a-1]),o=h.vec2.mul(n,1/h.vec2.len(n)),i=h.vec2.sub(e[a+1],e[a]),s=h.vec2.mul(i,1/h.vec2.len(i));Math.abs(h.vec2.dot(o,s))<t&&r.push(a)}let a=[.1,.2,.3,.4,.5,.6,.7,.8,.9],n=0;r.forEach((t)=>{let r=t+n,o=new h.CubicBezier([e[r-1],e[r],e[r],e[r+1]]),i=a.map((e)=>o.evaluate(e));e.splice(r,1),i.reverse(),i.forEach((t)=>{e.splice(r,0,t)}),n+=i.length-1})}}},function(){var e=Math.fround,t=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY,n=Math.acos,a=Math.floor,l=Math.sin,u=Math.cos,h=Math.atan2,o=Math.sqrt,p=Math.abs,s=Math.max,i=Math.min,d=Math.PI,c=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function a(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(a.prototype=r.prototype,new a)}}(),g;(function(e){var t;(function(e){var t=function(){function e(e,t,r){if(null==e)throw new Error('name cannot be null.');if(null==t)throw new Error('timelines cannot be null.');this.name=e,this.timelines=t,this.duration=r}return e.prototype.apply=function(e,t,r,a,o,s,l,d){if(null==e)throw new Error('skeleton cannot be null.');a&&0!=this.duration&&(r%=this.duration,0<t&&(t%=this.duration));for(var u=this.timelines,p=0,i=u.length;p<i;p++)u[p].apply(e,t,r,o,s,l,d)},e.binarySearch=function(e,t,r){void 0===r&&(r=1);var a=0,n=e.length/r-2;if(0==n)return r;for(var o=n>>>1;;){if(e[(o+1)*r]<=t?a=o+1:n=o,a==n)return(a+1)*r;o=a+n>>>1}},e.linearSearch=function(e,t,r){for(var a=0,n=e.length-r;a<=n;a+=r)if(e[a]>t)return a;return-1},e}();e.Animation=t;var o;(function(e){e[e.setup=0]='setup',e[e.current=1]='current',e[e.currentLayered=2]='currentLayered'})(o=e.MixPose||(e.MixPose={}));var r;(function(e){e[e['in']=0]='in',e[e.out=1]='out'})(r=e.MixDirection||(e.MixDirection={}));var a;(function(e){e[e.rotate=0]='rotate',e[e.translate=1]='translate',e[e.scale=2]='scale',e[e.shear=3]='shear',e[e.attachment=4]='attachment',e[e.color=5]='color',e[e.deform=6]='deform',e[e.event=7]='event',e[e.drawOrder=8]='drawOrder',e[e.ikConstraint=9]='ikConstraint',e[e.transformConstraint=10]='transformConstraint',e[e.pathConstraintPosition=11]='pathConstraintPosition',e[e.pathConstraintSpacing=12]='pathConstraintSpacing',e[e.pathConstraintMix=13]='pathConstraintMix',e[e.twoColor=14]='twoColor'})(a=e.TimelineType||(e.TimelineType={}));var n=function(){function t(r){if(0>=r)throw new Error('frameCount must be > 0: '+r);this.curves=e.Utils.newFloatArray((r-1)*t.BEZIER_SIZE)}return t.prototype.getFrameCount=function(){return this.curves.length/t.BEZIER_SIZE+1},t.prototype.setLinear=function(e){this.curves[e*t.BEZIER_SIZE]=t.LINEAR},t.prototype.setStepped=function(e){this.curves[e*t.BEZIER_SIZE]=t.STEPPED},t.prototype.getCurveType=function(e){var r=e*t.BEZIER_SIZE;if(r==this.curves.length)return t.LINEAR;var a=this.curves[r];return a==t.LINEAR?t.LINEAR:a==t.STEPPED?t.STEPPED:t.BEZIER},t.prototype.setCurve=function(e,r,a,o,s){var l=.03*(2*-r+o),d=.03*(2*-a+s),u=.006*(3*(r-o)+1),p=.006*(3*(a-s)+1),c=2*l+u,h=2*d+p,g=.3*r+l+.16666667*u,f=.3*a+d+.16666667*p,m=e*t.BEZIER_SIZE,i=this.curves;i[m++]=t.BEZIER;for(var _=g,x=f,y=m+t.BEZIER_SIZE-1;m<y;m+=2)i[m]=_,i[m+1]=x,g+=c,f+=h,c+=u,h+=p,_+=g,x+=f},t.prototype.getCurvePercent=function(r,a){a=e.MathUtils.clamp(a,0,1);var o=this.curves,s=r*t.BEZIER_SIZE,i=o[s];if(i==t.LINEAR)return a;if(i==t.STEPPED)return 0;s++;for(var l=0,d=s,u=s+t.BEZIER_SIZE-1;s<u;s+=2)if(l=o[s],l>=a){var n=void 0,p=void 0;return s==d?(n=0,p=0):(n=o[s-2],p=o[s-1]),p+(o[s+1]-p)*(a-n)/(l-n)}var c=o[s-1];return c+(1-c)*(a-l)/(1-l)},t.LINEAR=0,t.STEPPED=1,t.BEZIER=2,t.BEZIER_SIZE=19,t}();e.CurveTimeline=n;var i=function(r){function n(t){var a=r.call(this,t)||this;return a.frames=e.Utils.newFloatArray(t<<1),a}return c(n,r),n.prototype.getPropertyId=function(){return(a.rotate<<24)+this.boneIndex},n.prototype.setFrame=function(e,t,r){e<<=1,this.frames[e]=t,this.frames[e+n.ROTATION]=r},n.prototype.apply=function(e,a,i,s,l,d){var u=this.frames,p=e.bones[this.boneIndex];if(i<u[0]){switch(d){case o.setup:return void(p.rotation=p.data.rotation);case o.current:var c=p.data.rotation-p.rotation;c-=360*(16384-(0|16384.499999999996-c/360)),p.rotation+=c*l;}return}if(i>=u[u.length-n.ENTRIES]){if(d==o.setup)p.rotation=p.data.rotation+u[u.length+n.PREV_ROTATION]*l;else{var h=p.data.rotation+u[u.length+n.PREV_ROTATION]-p.rotation;h-=360*(16384-(0|16384.499999999996-h/360)),p.rotation+=h*l}return}var g=t.binarySearch(u,i,n.ENTRIES),f=u[g+n.PREV_ROTATION],m=u[g],y=this.getCurvePercent((g>>1)-1,1-(i-m)/(u[g+n.PREV_TIME]-m)),x=u[g+n.ROTATION]-f;x-=360*(16384-(0|16384.499999999996-x/360)),x=f+x*y,d==o.setup?(x-=360*(16384-(0|16384.499999999996-x/360)),p.rotation=p.data.rotation+x*l):(x=p.data.rotation+x-p.rotation,x-=360*(16384-(0|16384.499999999996-x/360)),p.rotation+=x*l)},n.ENTRIES=2,n.PREV_TIME=-2,n.PREV_ROTATION=-1,n.ROTATION=1,n}(n);e.RotateTimeline=i;var s=function(r){function n(t){var a=r.call(this,t)||this;return a.frames=e.Utils.newFloatArray(t*n.ENTRIES),a}return c(n,r),n.prototype.getPropertyId=function(){return(a.translate<<24)+this.boneIndex},n.prototype.setFrame=function(e,t,r,a){e*=n.ENTRIES,this.frames[e]=t,this.frames[e+n.X]=r,this.frames[e+n.Y]=a},n.prototype.apply=function(e,r,a,i,s,l){var d=this.frames,u=e.bones[this.boneIndex];if(a<d[0]){switch(l){case o.setup:return u.x=u.data.x,void(u.y=u.data.y);case o.current:u.x+=(u.data.x-u.x)*s,u.y+=(u.data.y-u.y)*s;}return}var p=0,c=0;if(a>=d[d.length-n.ENTRIES])p=d[d.length+n.PREV_X],c=d[d.length+n.PREV_Y];else{var h=t.binarySearch(d,a,n.ENTRIES);p=d[h+n.PREV_X],c=d[h+n.PREV_Y];var g=d[h],f=this.getCurvePercent(h/n.ENTRIES-1,1-(a-g)/(d[h+n.PREV_TIME]-g));p+=(d[h+n.X]-p)*f,c+=(d[h+n.Y]-c)*f}l==o.setup?(u.x=u.data.x+p*s,u.y=u.data.y+c*s):(u.x+=(u.data.x+p-u.x)*s,u.y+=(u.data.y+c-u.y)*s)},n.ENTRIES=3,n.PREV_TIME=-3,n.PREV_X=-2,n.PREV_Y=-1,n.X=1,n.Y=2,n}(n);e.TranslateTimeline=s;var l=function(n){function i(e){return n.call(this,e)||this}return c(i,n),i.prototype.getPropertyId=function(){return(a.scale<<24)+this.boneIndex},i.prototype.apply=function(a,n,s,l,d,u,c){var h=this.frames,g=a.bones[this.boneIndex];if(s<h[0]){switch(u){case o.setup:return g.scaleX=g.data.scaleX,void(g.scaleY=g.data.scaleY);case o.current:g.scaleX+=(g.data.scaleX-g.scaleX)*d,g.scaleY+=(g.data.scaleY-g.scaleY)*d;}return}var f=0,m=0;if(s>=h[h.length-i.ENTRIES])f=h[h.length+i.PREV_X]*g.data.scaleX,m=h[h.length+i.PREV_Y]*g.data.scaleY;else{var y=t.binarySearch(h,s,i.ENTRIES);f=h[y+i.PREV_X],m=h[y+i.PREV_Y];var x=h[y],_=this.getCurvePercent(y/i.ENTRIES-1,1-(s-x)/(h[y+i.PREV_TIME]-x));f=(f+(h[y+i.X]-f)*_)*g.data.scaleX,m=(m+(h[y+i.Y]-m)*_)*g.data.scaleY}if(1==d)g.scaleX=f,g.scaleY=m;else{var b=0,T=0;u==o.setup?(b=g.data.scaleX,T=g.data.scaleY):(b=g.scaleX,T=g.scaleY),c==r.out?(f=p(f)*e.MathUtils.signum(b),m=p(m)*e.MathUtils.signum(T)):(b=p(b)*e.MathUtils.signum(f),T=p(T)*e.MathUtils.signum(m)),g.scaleX=b+(f-b)*d,g.scaleY=T+(m-T)*d}},i}(s);e.ScaleTimeline=l;var d=function(e){function r(t){return e.call(this,t)||this}return c(r,e),r.prototype.getPropertyId=function(){return(a.shear<<24)+this.boneIndex},r.prototype.apply=function(e,a,n,i,s,l){var d=this.frames,u=e.bones[this.boneIndex];if(n<d[0]){switch(l){case o.setup:return u.shearX=u.data.shearX,void(u.shearY=u.data.shearY);case o.current:u.shearX+=(u.data.shearX-u.shearX)*s,u.shearY+=(u.data.shearY-u.shearY)*s;}return}var p=0,c=0;if(n>=d[d.length-r.ENTRIES])p=d[d.length+r.PREV_X],c=d[d.length+r.PREV_Y];else{var h=t.binarySearch(d,n,r.ENTRIES);p=d[h+r.PREV_X],c=d[h+r.PREV_Y];var g=d[h],f=this.getCurvePercent(h/r.ENTRIES-1,1-(n-g)/(d[h+r.PREV_TIME]-g));p+=(d[h+r.X]-p)*f,c+=(d[h+r.Y]-c)*f}l==o.setup?(u.shearX=u.data.shearX+p*s,u.shearY=u.data.shearY+c*s):(u.shearX+=(u.data.shearX+p-u.shearX)*s,u.shearY+=(u.data.shearY+c-u.shearY)*s)},r}(s);e.ShearTimeline=d;var u=function(r){function n(t){var a=r.call(this,t)||this;return a.frames=e.Utils.newFloatArray(t*n.ENTRIES),a}return c(n,r),n.prototype.getPropertyId=function(){return(a.color<<24)+this.slotIndex},n.prototype.setFrame=function(e,t,o,r,i,s){e*=n.ENTRIES,this.frames[e]=t,this.frames[e+n.R]=o,this.frames[e+n.G]=r,this.frames[e+n.B]=i,this.frames[e+n.A]=s},n.prototype.apply=function(e,s,l,d,u,p){var c=e.slots[this.slotIndex],h=this.frames;if(l<h[0]){switch(p){case o.setup:return void c.color.setFromColor(c.data.color);case o.current:var f=c.color,m=c.data.color;f.add((m.r-f.r)*u,(m.g-f.g)*u,(m.b-f.b)*u,(m.a-f.a)*u);}return}var y=0,r=0,g=0,x=0;if(l>=h[h.length-n.ENTRIES]){var a=h.length;y=h[a+n.PREV_R],r=h[a+n.PREV_G],g=h[a+n.PREV_B],x=h[a+n.PREV_A]}else{var i=t.binarySearch(h,l,n.ENTRIES);y=h[i+n.PREV_R],r=h[i+n.PREV_G],g=h[i+n.PREV_B],x=h[i+n.PREV_A];var _=h[i],b=this.getCurvePercent(i/n.ENTRIES-1,1-(l-_)/(h[i+n.PREV_TIME]-_));y+=(h[i+n.R]-y)*b,r+=(h[i+n.G]-r)*b,g+=(h[i+n.B]-g)*b,x+=(h[i+n.A]-x)*b}if(1==u)c.color.set(y,r,g,x);else{var f=c.color;p==o.setup&&f.setFromColor(c.data.color),f.add((y-f.r)*u,(r-f.g)*u,(g-f.b)*u,(x-f.a)*u)}},n.ENTRIES=5,n.PREV_TIME=-5,n.PREV_R=-4,n.PREV_G=-3,n.PREV_B=-2,n.PREV_A=-1,n.R=1,n.G=2,n.B=3,n.A=4,n}(n);e.ColorTimeline=u;var h=function(r){function n(t){var a=r.call(this,t)||this;return a.frames=e.Utils.newFloatArray(t*n.ENTRIES),a}return c(n,r),n.prototype.getPropertyId=function(){return(a.twoColor<<24)+this.slotIndex},n.prototype.setFrame=function(e,t,o,r,i,s,a,l,d){e*=n.ENTRIES,this.frames[e]=t,this.frames[e+n.R]=o,this.frames[e+n.G]=r,this.frames[e+n.B]=i,this.frames[e+n.A]=s,this.frames[e+n.R2]=a,this.frames[e+n.G2]=l,this.frames[e+n.B2]=d},n.prototype.apply=function(e,s,l,d,u,p){var c=e.slots[this.slotIndex],h=this.frames;if(l<h[0]){switch(p){case o.setup:return c.color.setFromColor(c.data.color),void c.darkColor.setFromColor(c.data.darkColor);case o.current:var f=c.color,m=c.darkColor,y=c.data.color,x=c.data.darkColor;f.add((y.r-f.r)*u,(y.g-f.g)*u,(y.b-f.b)*u,(y.a-f.a)*u),m.add((x.r-m.r)*u,(x.g-m.g)*u,(x.b-m.b)*u,0);}return}var _=0,r=0,g=0,b=0,a=0,T=0,v=0;if(l>=h[h.length-n.ENTRIES]){var E=h.length;_=h[E+n.PREV_R],r=h[E+n.PREV_G],g=h[E+n.PREV_B],b=h[E+n.PREV_A],a=h[E+n.PREV_R2],T=h[E+n.PREV_G2],v=h[E+n.PREV_B2]}else{var i=t.binarySearch(h,l,n.ENTRIES);_=h[i+n.PREV_R],r=h[i+n.PREV_G],g=h[i+n.PREV_B],b=h[i+n.PREV_A],a=h[i+n.PREV_R2],T=h[i+n.PREV_G2],v=h[i+n.PREV_B2];var S=h[i],C=this.getCurvePercent(i/n.ENTRIES-1,1-(l-S)/(h[i+n.PREV_TIME]-S));_+=(h[i+n.R]-_)*C,r+=(h[i+n.G]-r)*C,g+=(h[i+n.B]-g)*C,b+=(h[i+n.A]-b)*C,a+=(h[i+n.R2]-a)*C,T+=(h[i+n.G2]-T)*C,v+=(h[i+n.B2]-v)*C}if(1==u)c.color.set(_,r,g,b),c.darkColor.set(a,T,v,1);else{var f=c.color,m=c.darkColor;p==o.setup&&(f.setFromColor(c.data.color),m.setFromColor(c.data.darkColor)),f.add((_-f.r)*u,(r-f.g)*u,(g-f.b)*u,(b-f.a)*u),m.add((a-m.r)*u,(T-m.g)*u,(v-m.b)*u,0)}},n.ENTRIES=8,n.PREV_TIME=-8,n.PREV_R=-7,n.PREV_G=-6,n.PREV_B=-5,n.PREV_A=-4,n.PREV_R2=-3,n.PREV_G2=-2,n.PREV_B2=-1,n.R=1,n.G=2,n.B=3,n.A=4,n.R2=5,n.G2=6,n.B2=7,n}(n);e.TwoColorTimeline=h;var g=function(){function n(t){this.frames=e.Utils.newFloatArray(t),this.attachmentNames=Array(t)}return n.prototype.getPropertyId=function(){return(a.attachment<<24)+this.slotIndex},n.prototype.getFrameCount=function(){return this.frames.length},n.prototype.setFrame=function(e,t,r){this.frames[e]=t,this.attachmentNames[e]=r},n.prototype.apply=function(e,a,n,i,s,l,d){var u=e.slots[this.slotIndex];if(d==r.out&&l==o.setup){var p=u.data.attachmentName;return void u.setAttachment(null==p?null:e.getAttachment(this.slotIndex,p))}var c=this.frames;if(n<c[0]){if(l==o.setup){var h=u.data.attachmentName;u.setAttachment(null==h?null:e.getAttachment(this.slotIndex,h))}return}var g=0;g=n>=c[c.length-1]?c.length-1:t.binarySearch(c,n,1)-1;var f=this.attachmentNames[g];e.slots[this.slotIndex].setAttachment(null==f?null:e.getAttachment(this.slotIndex,f))},n}();e.AttachmentTimeline=g;var f=null,m=function(r){function n(t){var a=r.call(this,t)||this;return a.frames=e.Utils.newFloatArray(t),a.frameVertices=Array(t),null==f&&(f=e.Utils.newFloatArray(64)),a}return c(n,r),n.prototype.getPropertyId=function(){return(a.deform<<27)+ +this.attachment.id+this.slotIndex},n.prototype.setFrame=function(e,t,r){this.frames[e]=t,this.frameVertices[e]=r},n.prototype.apply=function(r,a,n,s,l,d){var u=r.slots[this.slotIndex],p=u.getAttachment();if(p instanceof e.VertexAttachment&&p.applyDeform(this.attachment)){var c=u.attachmentVertices,h=this.frameVertices,g=h[0].length,m=e.Utils.setArraySize(c,g),y=this.frames;if(n<y[0]){var x=p;switch(d){case o.setup:var _;return null==x.bones?_=x.vertices:(_=f,_.length<g&&(f=_=e.Utils.newFloatArray(g))),void e.Utils.arrayCopy(_,0,m,0,g);case o.current:if(1==l)break;if(null==x.bones)for(var b=x.vertices,T=0;T<g;T++)m[T]+=(b[T]-m[T])*l;else{l=1-l;for(var v=0;v<g;v++)m[v]*=l}}return}if(n>=y[y.length-1]){var i=h[y.length-1];if(1==l)e.Utils.arrayCopy(i,0,m,0,g);else if(d==o.setup){var x=p;if(null==x.bones)for(var b=x.vertices,E=0,S;E<g;E++)S=b[E],m[E]=S+(i[E]-S)*l;else for(var C=0;C<g;C++)m[C]=i[C]*l}else for(var P=0;P<g;P++)m[P]+=(i[P]-m[P])*l;return}var w=t.binarySearch(y,n),M=h[w-1],A=h[w],I=y[w],R=this.getCurvePercent(w-1,1-(n-I)/(y[w-1]-I));if(1==l)for(var D=0,O;D<g;D++)O=M[D],m[D]=O+(A[D]-O)*R;else if(d==o.setup){var x=p;if(null==x.bones)for(var b=x.vertices,k=0;k<g;k++){var O=M[k],S=b[k];m[k]=S+(O+(A[k]-O)*R-S)*l}else for(var L=0,O;L<g;L++)O=M[L],m[L]=(O+(A[L]-O)*R)*l}else for(var N=0,O;N<g;N++)O=M[N],m[N]+=(O+(A[N]-O)*R-m[N])*l}},n}(n);e.DeformTimeline=m;var y=function(){function r(t){this.frames=e.Utils.newFloatArray(t),this.events=Array(t)}return r.prototype.getPropertyId=function(){return a.event<<24},r.prototype.getFrameCount=function(){return this.frames.length},r.prototype.setFrame=function(e,t){this.frames[e]=t.time,this.events[e]=t},r.prototype.apply=function(e,r,a,n,o,i,s){if(null!=n){var l=this.frames,d=this.frames.length;if(r>a)this.apply(e,r,Number.MAX_VALUE,n,o,i,s),r=-1;else if(r>=l[d-1])return;if(!(a<l[0])){var u=0;if(r<l[0])u=0;else{u=t.binarySearch(l,r);for(var p=l[u];0<u&&l[u-1]==p;)u--}for(;u<d&&a>=l[u];u++)n.push(this.events[u])}}},r}();e.EventTimeline=y;var x=function(){function n(t){this.frames=e.Utils.newFloatArray(t),this.drawOrders=Array(t)}return n.prototype.getPropertyId=function(){return a.drawOrder<<24},n.prototype.getFrameCount=function(){return this.frames.length},n.prototype.setFrame=function(e,t,r){this.frames[e]=t,this.drawOrders[e]=r},n.prototype.apply=function(a,s,l,d,u,p,c){var h=a.drawOrder,g=a.slots;if(c==r.out&&p==o.setup)return void e.Utils.arrayCopy(a.slots,0,a.drawOrder,0,a.slots.length);var f=this.frames;if(l<f[0])return void(p==o.setup&&e.Utils.arrayCopy(a.slots,0,a.drawOrder,0,a.slots.length));var m=0;m=l>=f[f.length-1]?f.length-1:t.binarySearch(f,l)-1;var y=this.drawOrders[m];if(null==y)e.Utils.arrayCopy(g,0,h,0,g.length);else for(var x=0,i=y.length;x<i;x++)h[x]=g[y[x]]},n}();e.DrawOrderTimeline=x;var _=function(n){function i(t){var r=n.call(this,t)||this;return r.frames=e.Utils.newFloatArray(t*i.ENTRIES),r}return c(i,n),i.prototype.getPropertyId=function(){return(a.ikConstraint<<24)+this.ikConstraintIndex},i.prototype.setFrame=function(e,t,r,a){e*=i.ENTRIES,this.frames[e]=t,this.frames[e+i.MIX]=r,this.frames[e+i.BEND_DIRECTION]=a},i.prototype.apply=function(e,a,n,s,l,d,u){var p=this.frames,c=e.ikConstraints[this.ikConstraintIndex];if(n<p[0]){switch(d){case o.setup:return c.mix=c.data.mix,void(c.bendDirection=c.data.bendDirection);case o.current:c.mix+=(c.data.mix-c.mix)*l,c.bendDirection=c.data.bendDirection;}return}if(n>=p[p.length-i.ENTRIES])return void(d==o.setup?(c.mix=c.data.mix+(p[p.length+i.PREV_MIX]-c.data.mix)*l,c.bendDirection=u==r.out?c.data.bendDirection:p[p.length+i.PREV_BEND_DIRECTION]):(c.mix+=(p[p.length+i.PREV_MIX]-c.mix)*l,u==r.in&&(c.bendDirection=p[p.length+i.PREV_BEND_DIRECTION])));var h=t.binarySearch(p,n,i.ENTRIES),g=p[h+i.PREV_MIX],f=p[h],m=this.getCurvePercent(h/i.ENTRIES-1,1-(n-f)/(p[h+i.PREV_TIME]-f));d==o.setup?(c.mix=c.data.mix+(g+(p[h+i.MIX]-g)*m-c.data.mix)*l,c.bendDirection=u==r.out?c.data.bendDirection:p[h+i.PREV_BEND_DIRECTION]):(c.mix+=(g+(p[h+i.MIX]-g)*m-c.mix)*l,u==r.in&&(c.bendDirection=p[h+i.PREV_BEND_DIRECTION]))},i.ENTRIES=3,i.PREV_TIME=-3,i.PREV_MIX=-2,i.PREV_BEND_DIRECTION=-1,i.MIX=1,i.BEND_DIRECTION=2,i}(n);e.IkConstraintTimeline=_;var b=function(r){function n(t){var a=r.call(this,t)||this;return a.frames=e.Utils.newFloatArray(t*n.ENTRIES),a}return c(n,r),n.prototype.getPropertyId=function(){return(a.transformConstraint<<24)+this.transformConstraintIndex},n.prototype.setFrame=function(e,t,r,a,o,i){e*=n.ENTRIES,this.frames[e]=t,this.frames[e+n.ROTATE]=r,this.frames[e+n.TRANSLATE]=a,this.frames[e+n.SCALE]=o,this.frames[e+n.SHEAR]=i},n.prototype.apply=function(e,r,a,s,l,d){var u=this.frames,p=e.transformConstraints[this.transformConstraintIndex];if(a<u[0]){var c=p.data;switch(d){case o.setup:return p.rotateMix=c.rotateMix,p.translateMix=c.translateMix,p.scaleMix=c.scaleMix,void(p.shearMix=c.shearMix);case o.current:p.rotateMix+=(c.rotateMix-p.rotateMix)*l,p.translateMix+=(c.translateMix-p.translateMix)*l,p.scaleMix+=(c.scaleMix-p.scaleMix)*l,p.shearMix+=(c.shearMix-p.shearMix)*l;}return}var h=0,g=0,f=0,m=0;if(a>=u[u.length-n.ENTRIES]){var y=u.length;h=u[y+n.PREV_ROTATE],g=u[y+n.PREV_TRANSLATE],f=u[y+n.PREV_SCALE],m=u[y+n.PREV_SHEAR]}else{var i=t.binarySearch(u,a,n.ENTRIES);h=u[i+n.PREV_ROTATE],g=u[i+n.PREV_TRANSLATE],f=u[i+n.PREV_SCALE],m=u[i+n.PREV_SHEAR];var x=u[i],_=this.getCurvePercent(i/n.ENTRIES-1,1-(a-x)/(u[i+n.PREV_TIME]-x));h+=(u[i+n.ROTATE]-h)*_,g+=(u[i+n.TRANSLATE]-g)*_,f+=(u[i+n.SCALE]-f)*_,m+=(u[i+n.SHEAR]-m)*_}if(d==o.setup){var c=p.data;p.rotateMix=c.rotateMix+(h-c.rotateMix)*l,p.translateMix=c.translateMix+(g-c.translateMix)*l,p.scaleMix=c.scaleMix+(f-c.scaleMix)*l,p.shearMix=c.shearMix+(m-c.shearMix)*l}else p.rotateMix+=(h-p.rotateMix)*l,p.translateMix+=(g-p.translateMix)*l,p.scaleMix+=(f-p.scaleMix)*l,p.shearMix+=(m-p.shearMix)*l},n.ENTRIES=5,n.PREV_TIME=-5,n.PREV_ROTATE=-4,n.PREV_TRANSLATE=-3,n.PREV_SCALE=-2,n.PREV_SHEAR=-1,n.ROTATE=1,n.TRANSLATE=2,n.SCALE=3,n.SHEAR=4,n}(n);e.TransformConstraintTimeline=b;var T=function(r){function n(t){var a=r.call(this,t)||this;return a.frames=e.Utils.newFloatArray(t*n.ENTRIES),a}return c(n,r),n.prototype.getPropertyId=function(){return(a.pathConstraintPosition<<24)+this.pathConstraintIndex},n.prototype.setFrame=function(e,t,r){e*=n.ENTRIES,this.frames[e]=t,this.frames[e+n.VALUE]=r},n.prototype.apply=function(e,r,a,i,s,l){var d=this.frames,u=e.pathConstraints[this.pathConstraintIndex];if(a<d[0]){switch(l){case o.setup:return void(u.position=u.data.position);case o.current:u.position+=(u.data.position-u.position)*s;}return}var p=0;if(a>=d[d.length-n.ENTRIES])p=d[d.length+n.PREV_VALUE];else{var c=t.binarySearch(d,a,n.ENTRIES);p=d[c+n.PREV_VALUE];var h=d[c],g=this.getCurvePercent(c/n.ENTRIES-1,1-(a-h)/(d[c+n.PREV_TIME]-h));p+=(d[c+n.VALUE]-p)*g}l==o.setup?u.position=u.data.position+(p-u.data.position)*s:u.position+=(p-u.position)*s},n.ENTRIES=2,n.PREV_TIME=-2,n.PREV_VALUE=-1,n.VALUE=1,n}(n);e.PathConstraintPositionTimeline=T;var v=function(e){function r(t){return e.call(this,t)||this}return c(r,e),r.prototype.getPropertyId=function(){return(a.pathConstraintSpacing<<24)+this.pathConstraintIndex},r.prototype.apply=function(e,a,n,i,s,l){var d=this.frames,u=e.pathConstraints[this.pathConstraintIndex];if(n<d[0]){switch(l){case o.setup:return void(u.spacing=u.data.spacing);case o.current:u.spacing+=(u.data.spacing-u.spacing)*s;}return}var p=0;if(n>=d[d.length-r.ENTRIES])p=d[d.length+r.PREV_VALUE];else{var c=t.binarySearch(d,n,r.ENTRIES);p=d[c+r.PREV_VALUE];var h=d[c],g=this.getCurvePercent(c/r.ENTRIES-1,1-(n-h)/(d[c+r.PREV_TIME]-h));p+=(d[c+r.VALUE]-p)*g}l==o.setup?u.spacing=u.data.spacing+(p-u.data.spacing)*s:u.spacing+=(p-u.spacing)*s},r}(T);e.PathConstraintSpacingTimeline=v;var E=function(r){function n(t){var a=r.call(this,t)||this;return a.frames=e.Utils.newFloatArray(t*n.ENTRIES),a}return c(n,r),n.prototype.getPropertyId=function(){return(a.pathConstraintMix<<24)+this.pathConstraintIndex},n.prototype.setFrame=function(e,t,r,a){e*=n.ENTRIES,this.frames[e]=t,this.frames[e+n.ROTATE]=r,this.frames[e+n.TRANSLATE]=a},n.prototype.apply=function(e,r,a,i,s,l){var d=this.frames,u=e.pathConstraints[this.pathConstraintIndex];if(a<d[0]){switch(l){case o.setup:return u.rotateMix=u.data.rotateMix,void(u.translateMix=u.data.translateMix);case o.current:u.rotateMix+=(u.data.rotateMix-u.rotateMix)*s,u.translateMix+=(u.data.translateMix-u.translateMix)*s;}return}var p=0,c=0;if(a>=d[d.length-n.ENTRIES])p=d[d.length+n.PREV_ROTATE],c=d[d.length+n.PREV_TRANSLATE];else{var h=t.binarySearch(d,a,n.ENTRIES);p=d[h+n.PREV_ROTATE],c=d[h+n.PREV_TRANSLATE];var g=d[h],f=this.getCurvePercent(h/n.ENTRIES-1,1-(a-g)/(d[h+n.PREV_TIME]-g));p+=(d[h+n.ROTATE]-p)*f,c+=(d[h+n.TRANSLATE]-c)*f}l==o.setup?(u.rotateMix=u.data.rotateMix+(p-u.data.rotateMix)*s,u.translateMix=u.data.translateMix+(c-u.data.translateMix)*s):(u.rotateMix+=(p-u.rotateMix)*s,u.translateMix+=(c-u.translateMix)*s)},n.ENTRIES=3,n.PREV_TIME=-3,n.PREV_ROTATE=-2,n.PREV_TRANSLATE=-1,n.ROTATE=1,n.TRANSLATE=2,n}(n);e.PathConstraintMixTimeline=E})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t=function(){function t(t){this.tracks=[],this.events=[],this.listeners=[],this.queue=new n(this),this.propertyIDs=new e.IntSet,this.mixingTo=[],this.animationsChanged=!1,this.timeScale=1,this.trackEntryPool=new e.Pool(function(){return new r}),this.data=t}return t.prototype.update=function(e){e*=this.timeScale;for(var t=this.tracks,r=0,a=t.length,n;r<a;r++)if(n=t[r],null!=n){n.animationLast=n.nextAnimationLast,n.trackLast=n.nextTrackLast;var o=e*n.timeScale;if(0<n.delay){if(n.delay-=o,0<n.delay)continue;o=-n.delay,n.delay=0}var i=n.next;if(null!=i){var s=n.trackLast-i.delay;if(0<=s){for(i.delay=0,i.trackTime=s+e*i.timeScale,n.trackTime+=o,this.setCurrent(r,i,!0);null!=i.mixingFrom;)i.mixTime+=o,i=i.mixingFrom;continue}}else if(n.trackLast>=n.trackEnd&&null==n.mixingFrom){t[r]=null,this.queue.end(n),this.disposeNext(n);continue}if(null!=n.mixingFrom&&this.updateMixingFrom(n,e)){var l=n.mixingFrom;for(n.mixingFrom=null;null!=l;)this.queue.end(l),l=l.mixingFrom}n.trackTime+=o}this.queue.drain()},t.prototype.updateMixingFrom=function(e,t){var r=e.mixingFrom;if(null==r)return!0;var a=this.updateMixingFrom(r,t);return 0<e.mixTime&&(e.mixTime>=e.mixDuration||0==e.timeScale)?(0==r.totalAlpha&&(e.mixingFrom=r.mixingFrom,e.interruptAlpha=r.interruptAlpha,this.queue.end(r)),a):(r.animationLast=r.nextAnimationLast,r.trackLast=r.nextTrackLast,r.trackTime+=t*r.timeScale,e.mixTime+=t*e.timeScale,!1)},t.prototype.apply=function(r){if(null==r)throw new Error('skeleton cannot be null.');this.animationsChanged&&this._animationsChanged();for(var a=this.events,o=this.tracks,s=!1,l=0,i=o.length,n;l<i;l++)if(n=o[l],!(null==n||0<n.delay)){s=!0;var d=0==l?e.MixPose.current:e.MixPose.currentLayered,u=n.alpha;null==n.mixingFrom?n.trackTime>=n.trackEnd&&null==n.next&&(u=0):u*=this.applyMixingFrom(n,r,d);var p=n.animationLast,c=n.getAnimationTime(),h=n.animation.timelines.length,g=n.animation.timelines;if(1==u)for(var f=0;f<h;f++)g[f].apply(r,p,c,a,1,e.MixPose.setup,e.MixDirection.in);else{var m=n.timelineData,y=0==n.timelinesRotation.length;y&&e.Utils.setArraySize(n.timelinesRotation,h<<1,null);for(var x=n.timelinesRotation,f=0;f<h;f++){var _=g[f],b=m[f]>=t.FIRST?e.MixPose.setup:d;_ instanceof e.RotateTimeline?this.applyRotateTimeline(_,r,c,u,b,x,f<<1,y):_.apply(r,p,c,a,u,b,e.MixDirection.in)}}this.queueEvents(n,c),a.length=0,n.nextAnimationLast=c,n.nextTrackLast=n.trackTime}return this.queue.drain(),s},t.prototype.applyMixingFrom=function(r,a,n){var o=r.mixingFrom;null!=o.mixingFrom&&this.applyMixingFrom(o,a,n);var l=0;0==r.mixDuration?l=1:(l=r.mixTime/r.mixDuration,1<l&&(l=1));var d=l<o.eventThreshold?this.events:null,u=l<o.attachmentThreshold,p=l<o.drawOrderThreshold,c=o.animationLast,h=o.getAnimationTime(),g=o.animation.timelines.length,f=o.animation.timelines,m=o.timelineData,y=o.timelineDipMix,x=0==o.timelinesRotation.length;x&&e.Utils.setArraySize(o.timelinesRotation,g<<1,null);var _=o.timelinesRotation,b=o.alpha*r.interruptAlpha,T=b*(1-l),v=0,E;o.totalAlpha=0;for(var S=0,i;S<g;S++){switch(i=f[S],m[S]){case t.SUBSEQUENT:if(!u&&i instanceof e.AttachmentTimeline)continue;if(!p&&i instanceof e.DrawOrderTimeline)continue;E=n,v=T;break;case t.FIRST:E=e.MixPose.setup,v=T;break;case t.DIP:E=e.MixPose.setup,v=b;break;default:E=e.MixPose.setup,v=b;var C=y[S];v*=s(0,1-C.mixTime/C.mixDuration);}o.totalAlpha+=v,i instanceof e.RotateTimeline?this.applyRotateTimeline(i,a,h,v,E,_,S<<1,x):i.apply(a,c,h,d,v,E,e.MixDirection.out)}return 0<r.mixDuration&&this.queueEvents(o,h),this.events.length=0,o.nextAnimationLast=h,o.nextTrackLast=o.trackTime,l},t.prototype.applyRotateTimeline=function(t,r,a,n,o,s,l,i){if(i&&(s[l]=0),1==n)return void t.apply(r,0,a,null,1,o,e.MixDirection.in);var d=t,u=d.frames,c=r.bones[d.boneIndex];if(a<u[0])return void(o==e.MixPose.setup&&(c.rotation=c.data.rotation));var h=0;if(a>=u[u.length-e.RotateTimeline.ENTRIES])h=c.data.rotation+u[u.length+e.RotateTimeline.PREV_ROTATION];else{var g=e.Animation.binarySearch(u,a,e.RotateTimeline.ENTRIES),f=u[g+e.RotateTimeline.PREV_ROTATION],m=u[g],y=d.getCurvePercent((g>>1)-1,1-(a-m)/(u[g+e.RotateTimeline.PREV_TIME]-m));h=u[g+e.RotateTimeline.ROTATION]-f,h-=360*(16384-(0|16384.499999999996-h/360)),h=f+h*y+c.data.rotation,h-=360*(16384-(0|16384.499999999996-h/360))}var x=o==e.MixPose.setup?c.data.rotation:c.rotation,_=0,b=h-x;if(0==b)_=s[l];else{b-=360*(16384-(0|16384.499999999996-b/360));var T=0,v=0;i?(T=0,v=b):(T=s[l],v=s[l+1]);var E=0<b,S=0<=T;e.MathUtils.signum(v)!=e.MathUtils.signum(b)&&90>=p(v)&&(180<p(T)&&(T+=360*e.MathUtils.signum(T)),S=E),_=b+T-T%360,S!=E&&(_+=360*e.MathUtils.signum(T)),s[l]=_}s[l+1]=b,x+=_*n,c.rotation=x-360*(16384-(0|16384.499999999996-x/360))},t.prototype.queueEvents=function(e,t){for(var r=e.animationStart,a=e.animationEnd,o=a-r,s=e.trackLast%o,l=this.events,d=0,i=l.length,n;d<i&&(n=l[d],!(n.time<s));d++)n.time>a||this.queue.event(e,n);for((e.loop?s>e.trackTime%o:t>=a&&e.animationLast<a)&&this.queue.complete(e);d<i;d++){var u=l[d];u.time<r||this.queue.event(e,l[d])}},t.prototype.clearTracks=function(){var e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var t=0,r=this.tracks.length;t<r;t++)this.clearTrack(t);this.tracks.length=0,this.queue.drainDisabled=e,this.queue.drain()},t.prototype.clearTrack=function(e){if(!(e>=this.tracks.length)){var t=this.tracks[e];if(null!=t){this.queue.end(t),this.disposeNext(t);for(var r=t,a;a=r.mixingFrom,null!=a;)this.queue.end(a),r.mixingFrom=null,r=a;this.tracks[t.trackIndex]=null,this.queue.drain()}}},t.prototype.setCurrent=function(e,t,r){var a=this.expandToIndex(e);this.tracks[e]=t,null!=a&&(r&&this.queue.interrupt(a),t.mixingFrom=a,t.mixTime=0,null!=a.mixingFrom&&0<a.mixDuration&&(t.interruptAlpha*=i(1,a.mixTime/a.mixDuration)),a.timelinesRotation.length=0),this.queue.start(t)},t.prototype.setAnimation=function(e,t,r){var a=this.data.skeletonData.findAnimation(t);if(null==a)throw new Error('Animation not found: '+t);return this.setAnimationWith(e,a,r)},t.prototype.setAnimationWith=function(e,t,r){if(null==t)throw new Error('animation cannot be null.');var a=!0,n=this.expandToIndex(e);null!=n&&(-1==n.nextTrackLast?(this.tracks[e]=n.mixingFrom,this.queue.interrupt(n),this.queue.end(n),this.disposeNext(n),n=n.mixingFrom,a=!1):this.disposeNext(n));var o=this.trackEntry(e,t,r,n);return this.setCurrent(e,o,a),this.queue.drain(),o},t.prototype.addAnimation=function(e,t,r,a){var n=this.data.skeletonData.findAnimation(t);if(null==n)throw new Error('Animation not found: '+t);return this.addAnimationWith(e,n,r,a)},t.prototype.addAnimationWith=function(e,t,r,a){if(null==t)throw new Error('animation cannot be null.');var n=this.expandToIndex(e);if(null!=n)for(;null!=n.next;)n=n.next;var o=this.trackEntry(e,t,r,n);if(null==n)this.setCurrent(e,o,!0),this.queue.drain();else if(n.next=o,0>=a){var i=n.animationEnd-n.animationStart;0==i?a=0:a+=i*(1+(0|n.trackTime/i))-this.data.getMix(n.animation,t)}return o.delay=a,o},t.prototype.setEmptyAnimation=function(e,r){var a=this.setAnimationWith(e,t.emptyAnimation,!1);return a.mixDuration=r,a.trackEnd=r,a},t.prototype.addEmptyAnimation=function(e,r,a){0>=a&&(a-=r);var n=this.addAnimationWith(e,t.emptyAnimation,!1,a);return n.mixDuration=r,n.trackEnd=r,n},t.prototype.setEmptyAnimations=function(e){var t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var r=0,a=this.tracks.length,n;r<a;r++)n=this.tracks[r],null!=n&&this.setEmptyAnimation(n.trackIndex,e);this.queue.drainDisabled=t,this.queue.drain()},t.prototype.expandToIndex=function(t){return t<this.tracks.length?this.tracks[t]:(e.Utils.ensureArrayCapacity(this.tracks,t-this.tracks.length+1,null),this.tracks.length=t+1,null)},t.prototype.trackEntry=function(e,t,r,a){var n=this.trackEntryPool.obtain();return n.trackIndex=e,n.animation=t,n.loop=r,n.eventThreshold=0,n.attachmentThreshold=0,n.drawOrderThreshold=0,n.animationStart=0,n.animationEnd=t.duration,n.animationLast=-1,n.nextAnimationLast=-1,n.delay=0,n.trackTime=0,n.trackLast=-1,n.nextTrackLast=-1,n.trackEnd=Number.MAX_VALUE,n.timeScale=1,n.alpha=1,n.interruptAlpha=1,n.mixTime=0,n.mixDuration=null==a?0:this.data.getMix(a.animation,t),n},t.prototype.disposeNext=function(e){for(var t=e.next;null!=t;)this.queue.dispose(t),t=t.next;e.next=null},t.prototype._animationsChanged=function(){this.animationsChanged=!1;var e=this.propertyIDs;e.clear();for(var t=this.mixingTo,r=0,a=this.tracks.length,n;r<a;r++)n=this.tracks[r],null!=n&&n.setTimelineData(null,t,e)},t.prototype.getCurrent=function(e){return e>=this.tracks.length?null:this.tracks[e]},t.prototype.addListener=function(e){if(null==e)throw new Error('listener cannot be null.');this.listeners.push(e)},t.prototype.removeListener=function(e){var t=this.listeners.indexOf(e);0<=t&&this.listeners.splice(t,1)},t.prototype.clearListeners=function(){this.listeners.length=0},t.prototype.clearListenerNotifications=function(){this.queue.clear()},t.prototype.setAnimationByName=function(e,r,a){t.deprecatedWarning1||(t.deprecatedWarning1=!0,console.warn('Deprecation Warning: AnimationState.setAnimationByName is deprecated, please use setAnimation from now on.')),this.setAnimation(e,r,a)},t.prototype.addAnimationByName=function(e,r,a,n){t.deprecatedWarning2||(t.deprecatedWarning2=!0,console.warn('Deprecation Warning: AnimationState.addAnimationByName is deprecated, please use addAnimation from now on.')),this.addAnimation(e,r,a,n)},t.prototype.hasAnimation=function(e){var t=this.data.skeletonData.findAnimation(e);return null!==t},t.prototype.hasAnimationByName=function(e){return t.deprecatedWarning3||(t.deprecatedWarning3=!0,console.warn('Deprecation Warning: AnimationState.hasAnimationByName is deprecated, please use hasAnimation from now on.')),this.hasAnimation(e)},t.emptyAnimation=new e.Animation('<empty>',[],0),t.SUBSEQUENT=0,t.FIRST=1,t.DIP=2,t.DIP_MIX=3,t.deprecatedWarning1=!1,t.deprecatedWarning2=!1,t.deprecatedWarning3=!1,t}();e.AnimationState=t;var r=function(){function r(){this.timelineData=[],this.timelineDipMix=[],this.timelinesRotation=[]}return r.prototype.reset=function(){this.next=null,this.mixingFrom=null,this.animation=null,this.listener=null,this.timelineData.length=0,this.timelineDipMix.length=0,this.timelinesRotation.length=0},r.prototype.setTimelineData=function(r,a,n){null!=r&&a.push(r);var o=null==this.mixingFrom?this:this.mixingFrom.setTimelineData(this,a,n);null!=r&&a.pop();var s=a.length-1,l=this.animation.timelines,d=this.animation.timelines.length,u=e.Utils.setArraySize(this.timelineData,d);this.timelineDipMix.length=0;var p=e.Utils.setArraySize(this.timelineDipMix,d);outer:for(var c=0,i;c<d;c++)if(i=l[c].getPropertyId(),!n.add(i))u[c]=t.SUBSEQUENT;else if(null==r||!r.hasTimeline(i))u[c]=t.FIRST;else{for(var h=s,g;0<=h;h--)if(g=a[h],!g.hasTimeline(i)&&0<g.mixDuration){u[c]=t.DIP_MIX,p[c]=g;continue outer}u[c]=t.DIP}return o},r.prototype.hasTimeline=function(e){for(var t=this.animation.timelines,r=0,a=t.length;r<a;r++)if(t[r].getPropertyId()==e)return!0;return!1},r.prototype.getAnimationTime=function(){if(this.loop){var e=this.animationEnd-this.animationStart;return 0==e?this.animationStart:this.trackTime%e+this.animationStart}return i(this.trackTime+this.animationStart,this.animationEnd)},r.prototype.setAnimationLast=function(e){this.animationLast=e,this.nextAnimationLast=e},r.prototype.isComplete=function(){return this.trackTime>=this.animationEnd-this.animationStart},r.prototype.resetRotationDirections=function(){this.timelinesRotation.length=0},Object.defineProperty(r.prototype,'time',{get:function(){return r.deprecatedWarning1||(r.deprecatedWarning1=!0,console.warn('Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.')),this.trackTime},set:function(e){r.deprecatedWarning1||(r.deprecatedWarning1=!0,console.warn('Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.')),this.trackTime=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,'endTime',{get:function(){return r.deprecatedWarning2||(r.deprecatedWarning2=!0,console.warn('Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.')),this.trackTime},set:function(e){r.deprecatedWarning2||(r.deprecatedWarning2=!0,console.warn('Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.')),this.trackTime=e},enumerable:!0,configurable:!0}),r.prototype.loopsCount=function(){return a(this.trackTime/this.trackEnd)},r.deprecatedWarning1=!1,r.deprecatedWarning2=!1,r}();e.TrackEntry=r;var n=function(){function t(e){this.objects=[],this.drainDisabled=!1,this.animState=e}return t.prototype.start=function(e){this.objects.push(o.start),this.objects.push(e),this.animState.animationsChanged=!0},t.prototype.interrupt=function(e){this.objects.push(o.interrupt),this.objects.push(e)},t.prototype.end=function(e){this.objects.push(o.end),this.objects.push(e),this.animState.animationsChanged=!0},t.prototype.dispose=function(e){this.objects.push(o.dispose),this.objects.push(e)},t.prototype.complete=function(e){this.objects.push(o.complete),this.objects.push(e)},t.prototype.event=function(e,t){this.objects.push(o.event),this.objects.push(e),this.objects.push(t)},t.prototype.deprecateStuff=function(){return t.deprecatedWarning1||(t.deprecatedWarning1=!0,console.warn('Deprecation Warning: onComplete, onStart, onEnd, onEvent art deprecated, please use listeners from now on. \'state.addListener({ complete: function(track, event) { } })\'')),!0},t.prototype.drain=function(){if(!this.drainDisabled){this.drainDisabled=!0;for(var t=this.objects,r=this.animState.listeners,a=0;a<t.length;a+=2){var n=t[a],i=t[a+1];switch(n){case o.start:null!=i.listener&&i.listener.start&&i.listener.start(i);for(var s=0;s<r.length;s++)r[s].start&&r[s].start(i);i.onStart&&this.deprecateStuff()&&i.onStart(i.trackIndex),this.animState.onStart&&this.deprecateStuff()&&this.deprecateStuff&&this.animState.onStart(i.trackIndex);break;case o.interrupt:null!=i.listener&&i.listener.interrupt&&i.listener.interrupt(i);for(var s=0;s<r.length;s++)r[s].interrupt&&r[s].interrupt(i);break;case o.end:null!=i.listener&&i.listener.end&&i.listener.end(i);for(var s=0;s<r.length;s++)r[s].end&&r[s].end(i);i.onEnd&&this.deprecateStuff()&&i.onEnd(i.trackIndex),this.animState.onEnd&&this.deprecateStuff()&&this.animState.onEnd(i.trackIndex);case o.dispose:null!=i.listener&&i.listener.dispose&&i.listener.dispose(i);for(var s=0;s<r.length;s++)r[s].dispose&&r[s].dispose(i);this.animState.trackEntryPool.free(i);break;case o.complete:null!=i.listener&&i.listener.complete&&i.listener.complete(i);for(var s=0;s<r.length;s++)r[s].complete&&r[s].complete(i);var l=e.MathUtils.toInt(i.loopsCount());i.onComplete&&this.deprecateStuff()&&i.onComplete(i.trackIndex,l),this.animState.onComplete&&this.deprecateStuff()&&this.animState.onComplete(i.trackIndex,l);break;case o.event:var d=t[a++ +2];null!=i.listener&&i.listener.event&&i.listener.event(i,d);for(var s=0;s<r.length;s++)r[s].event&&r[s].event(i,d);i.onEvent&&this.deprecateStuff()&&i.onEvent(i.trackIndex,d),this.animState.onEvent&&this.deprecateStuff()&&this.animState.onEvent(i.trackIndex,d);}}this.clear(),this.drainDisabled=!1}},t.prototype.clear=function(){this.objects.length=0},t.deprecatedWarning1=!1,t}();e.EventQueue=n;var o;(function(e){e[e.start=0]='start',e[e.interrupt=1]='interrupt',e[e.end=2]='end',e[e.dispose=3]='dispose',e[e.complete=4]='complete',e[e.event=5]='event'})(o=e.EventType||(e.EventType={}));var l=function(){function e(){}return e.prototype.start=function(){},e.prototype.interrupt=function(){},e.prototype.end=function(){},e.prototype.dispose=function(){},e.prototype.complete=function(){},e.prototype.event=function(){},e}();e.AnimationStateAdapter2=l})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t=function(){function e(e){if(this.animationToMixTime={},this.defaultMix=0,null==e)throw new Error('skeletonData cannot be null.');this.skeletonData=e}return e.prototype.setMix=function(e,t,r){var a=this.skeletonData.findAnimation(e);if(null==a)throw new Error('Animation not found: '+e);var n=this.skeletonData.findAnimation(t);if(null==n)throw new Error('Animation not found: '+t);this.setMixWith(a,n,r)},e.prototype.setMixByName=function(t,r,a){e.deprecatedWarning1||(e.deprecatedWarning1=!0,console.warn('Deprecation Warning: AnimationStateData.setMixByName is deprecated, please use setMix from now on.')),this.setMix(t,r,a)},e.prototype.setMixWith=function(e,t,r){if(null==e)throw new Error('from cannot be null.');if(null==t)throw new Error('to cannot be null.');var a=e.name+t.name;this.animationToMixTime[a]=r},e.prototype.getMix=function(e,t){var r=e.name+t.name,a=this.animationToMixTime[r];return void 0===a?this.defaultMix:a},e.deprecatedWarning1=!1,e}();e.AnimationStateData=t})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t=function(){function t(e){this.atlas=e}return t.prototype.newRegionAttachment=function(t,r,a){var n=this.atlas.findRegion(a);if(null==n)throw new Error('Region not found in atlas: '+a+' (region attachment: '+r+')');var o=new e.RegionAttachment(r);return o.region=n,o},t.prototype.newMeshAttachment=function(t,r,a){var n=this.atlas.findRegion(a);if(null==n)throw new Error('Region not found in atlas: '+a+' (mesh attachment: '+r+')');var o=new e.MeshAttachment(r);return o.region=n,o},t.prototype.newBoundingBoxAttachment=function(t,r){return new e.BoundingBoxAttachment(r)},t.prototype.newPathAttachment=function(t,r){return new e.PathAttachment(r)},t.prototype.newPointAttachment=function(t,r){return new e.PointAttachment(r)},t.prototype.newClippingAttachment=function(t,r){return new e.ClippingAttachment(r)},t}();e.AtlasAttachmentLoader=t})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t;(function(e){e[e.Normal=0]='Normal',e[e.Additive=1]='Additive',e[e.Multiply=2]='Multiply',e[e.Screen=3]='Screen'})(t=e.BlendMode||(e.BlendMode={}))})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t=function(){function t(e,t,r){if(this.matrix=new PIXI.Matrix,this.children=[],this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.appliedValid=!1,this.sorted=!1,null==e)throw new Error('data cannot be null.');if(null==t)throw new Error('skeleton cannot be null.');this.data=e,this.skeleton=t,this.parent=r,this.setToSetupPose()}return Object.defineProperty(t.prototype,'worldX',{get:function(){return this.matrix.tx},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,'worldY',{get:function(){return this.matrix.ty},enumerable:!0,configurable:!0}),t.prototype.update=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},t.prototype.updateWorldTransform=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},t.prototype.updateWorldTransformWith=function(a,n,i,c,g,f,_){this.ax=a,this.ay=n,this.arotation=i,this.ascaleX=c,this.ascaleY=g,this.ashearX=f,this.ashearY=_,this.appliedValid=!0;var b=this.parent,T=this.matrix;if(null==b){var m=i+90+_,v=e.MathUtils.cosDeg(i+f)*c,E=e.MathUtils.cosDeg(m)*g,S=e.MathUtils.sinDeg(i+f)*c,C=e.MathUtils.sinDeg(m)*g,P=this.skeleton;return P.flipX&&(a=-a,v=-v,E=-E),P.flipY!==t.yDown&&(n=-n,S=-S,C=-C),T.a=v,T.c=E,T.b=S,T.d=C,T.tx=a+P.x,void(T.ty=n+P.y)}var w=b.matrix.a,M=b.matrix.c,A=b.matrix.b,I=b.matrix.d;switch(T.tx=w*a+M*n+b.matrix.tx,T.ty=A*a+I*n+b.matrix.ty,this.data.transformMode){case e.TransformMode.Normal:{var m=i+90+_,v=e.MathUtils.cosDeg(i+f)*c,E=e.MathUtils.cosDeg(m)*g,S=e.MathUtils.sinDeg(i+f)*c,C=e.MathUtils.sinDeg(m)*g;return T.a=w*v+M*S,T.c=w*E+M*C,T.b=A*v+I*S,void(T.d=A*E+I*C)}case e.TransformMode.OnlyTranslation:{var m=i+90+_;T.a=e.MathUtils.cosDeg(i+f)*c,T.c=e.MathUtils.cosDeg(m)*g,T.b=e.MathUtils.sinDeg(i+f)*c,T.d=e.MathUtils.sinDeg(m)*g;break}case e.TransformMode.NoRotationOrReflection:{var R=w*w+A*A,s=0;1e-4<R?(R=p(w*I-M*A)/R,M=A*R,I=w*R,s=h(A,w)*e.MathUtils.radDeg):(w=0,A=0,s=90-h(I,M)*e.MathUtils.radDeg);var D=i+f-s,O=i+_-s+90,v=e.MathUtils.cosDeg(D)*c,E=e.MathUtils.cosDeg(O)*g,S=e.MathUtils.sinDeg(D)*c,C=e.MathUtils.sinDeg(O)*g;T.a=w*v-M*S,T.c=w*E-M*C,T.b=A*v+I*S,T.d=A*E+I*C;break}case e.TransformMode.NoScale:case e.TransformMode.NoScaleOrReflection:{var k=e.MathUtils.cosDeg(i),L=e.MathUtils.sinDeg(i),N=w*k+M*L,F=A*k+I*L,R=o(N*N+F*F);1e-5<R&&(R=1/R),N*=R,F*=R,R=o(N*N+F*F);var B=d/2+h(F,N),r=u(B)*R,U=l(B)*R,v=e.MathUtils.cosDeg(f)*c,E=e.MathUtils.cosDeg(90+_)*g,S=e.MathUtils.sinDeg(f)*c,C=e.MathUtils.sinDeg(90+_)*g;return T.a=N*v+r*S,T.c=N*E+r*C,T.b=F*v+U*S,T.d=F*E+U*C,void((this.data.transformMode==e.TransformMode.NoScaleOrReflection?this.skeleton.flipX!=this.skeleton.flipY!=t.yDown:0>w*I-M*A)&&(T.c=-T.c,T.d=-T.d))}}this.skeleton.flipX&&(T.a=-T.a,T.c=-T.c),this.skeleton.flipY!=t.yDown&&(T.b=-T.b,T.d=-T.d)},t.prototype.setToSetupPose=function(){var e=this.data;this.x=e.x,this.y=e.y,this.rotation=e.rotation,this.scaleX=e.scaleX,this.scaleY=e.scaleY,this.shearX=e.shearX,this.shearY=e.shearY},t.prototype.getWorldRotationX=function(){return h(this.matrix.b,this.matrix.a)*e.MathUtils.radDeg},t.prototype.getWorldRotationY=function(){return h(this.matrix.d,this.matrix.c)*e.MathUtils.radDeg},t.prototype.getWorldScaleX=function(){var e=this.matrix;return o(e.a*e.a+e.c*e.c)},t.prototype.getWorldScaleY=function(){var e=this.matrix;return o(e.b*e.b+e.d*e.d)},t.prototype.updateAppliedTransform=function(){this.appliedValid=!0;var t=this.parent,r=this.matrix;if(null==t)return this.ax=r.tx,this.ay=r.ty,this.arotation=h(r.b,r.a)*e.MathUtils.radDeg,this.ascaleX=o(r.a*r.a+r.b*r.b),this.ascaleY=o(r.c*r.c+r.d*r.d),this.ashearX=0,void(this.ashearY=h(r.a*r.c+r.b*r.d,r.a*r.d-r.b*r.c)*e.MathUtils.radDeg);var a=t.matrix,n=1/(a.a*a.d-a.b*a.c),i=r.tx-a.tx,s=r.ty-a.ty;this.ax=i*a.d*n-s*a.c*n,this.ay=s*a.a*n-i*a.b*n;var l=n*a.d,d=n*a.a,u=n*a.c,p=n*a.b,c=l*r.a-u*r.b,g=l*r.c-u*r.d,f=d*r.b-p*r.a,m=d*r.d-p*r.c;if(this.ashearX=0,this.ascaleX=o(c*c+f*f),1e-4<this.ascaleX){var y=c*m-g*f;this.ascaleY=y/this.ascaleX,this.ashearY=h(c*g+f*m,y)*e.MathUtils.radDeg,this.arotation=h(f,c)*e.MathUtils.radDeg}else this.ascaleX=0,this.ascaleY=o(g*g+m*m),this.ashearY=0,this.arotation=90-h(m,g)*e.MathUtils.radDeg},t.prototype.worldToLocal=function(e){var t=this.matrix,r=t.a,a=t.c,n=t.b,o=t.d,i=1/(r*o-a*n),s=e.x-t.tx,l=e.y-t.ty;return e.x=s*o*i-l*a*i,e.y=l*r*i-s*n*i,e},t.prototype.localToWorld=function(e){var t=this.matrix,r=e.x,a=e.y;return e.x=r*t.a+a*t.c+t.tx,e.y=r*t.b+a*t.d+t.ty,e},t.prototype.worldToLocalRotation=function(t){var r=e.MathUtils.sinDeg(t),a=e.MathUtils.cosDeg(t),n=this.matrix;return h(n.a*r-n.b*a,n.d*a-n.c*r)*e.MathUtils.radDeg},t.prototype.localToWorldRotation=function(t){var r=e.MathUtils.sinDeg(t),a=e.MathUtils.cosDeg(t),n=this.matrix;return h(a*n.b+r*n.d,a*n.a+r*n.c)*e.MathUtils.radDeg},t.prototype.rotateWorld=function(t){var r=this.matrix,n=r.a,a=r.c,o=r.b,i=r.d,s=e.MathUtils.cosDeg(t),l=e.MathUtils.sinDeg(t);r.a=s*n-l*o,r.c=s*a-l*i,r.b=l*n+s*o,r.d=l*a+s*i,this.appliedValid=!1},t.yDown=!1,t}();e.Bone=t})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t=function(){function e(e,t,a){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=r.Normal,0>e)throw new Error('index must be >= 0.');if(null==t)throw new Error('name cannot be null.');this.index=e,this.name=t,this.parent=a}return e}();e.BoneData=t;var r;(function(e){e[e.Normal=0]='Normal',e[e.OnlyTranslation=1]='OnlyTranslation',e[e.NoRotationOrReflection=2]='NoRotationOrReflection',e[e.NoScale=3]='NoScale',e[e.NoScaleOrReflection=4]='NoScaleOrReflection'})(r=e.TransformMode||(e.TransformMode={}))})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t=function(){return function(e,t){if(null==t)throw new Error('data cannot be null.');this.time=e,this.data=t}}();e.Event=t})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t=function(){return function(e){this.name=e}}();e.EventData=t})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t=function(){function t(e,t){if(this.mix=1,this.bendDirection=0,null==e)throw new Error('data cannot be null.');if(null==t)throw new Error('skeleton cannot be null.');this.data=e,this.mix=e.mix,this.bendDirection=e.bendDirection,this.bones=[];for(var r=0;r<e.bones.length;r++)this.bones.push(t.findBone(e.bones[r].name));this.target=t.findBone(e.target.name)}return t.prototype.getOrder=function(){return this.data.order},t.prototype.apply=function(){this.update()},t.prototype.update=function(){var e=this.target,t=this.bones;switch(t.length){case 1:this.apply1(t[0],e.worldX,e.worldY,this.mix);break;case 2:this.apply2(t[0],t[1],e.worldX,e.worldY,this.bendDirection,this.mix);}},t.prototype.apply1=function(t,r,a,n){t.appliedValid||t.updateAppliedTransform();var o=t.parent.matrix,i=1/(o.a*o.d-o.b*o.c),s=r-o.tx,l=a-o.ty,d=(s*o.d-l*o.c)*i-t.ax,u=(l*o.a-s*o.b)*i-t.ay,p=h(u,d)*e.MathUtils.radDeg-t.ashearX-t.arotation;0>t.ascaleX&&(p+=180),180<p?p-=360:-180>p&&(p+=360),t.updateWorldTransformWith(t.ax,t.ay,t.arotation+p*n,t.ascaleX,t.ascaleY,t.ashearX,t.ashearY)},t.prototype.apply2=function(t,i,s,g,f,m){if(0==m)return void i.updateWorldTransform();t.appliedValid||t.updateAppliedTransform(),i.appliedValid||i.updateAppliedTransform();var _=t.ax,T=t.ay,v=t.ascaleX,E=t.ascaleY,S=i.ascaleX,C=t.matrix,P=0,w=0,M=0;0>v?(v=-v,P=180,M=-1):(P=0,M=1),0>E&&(E=-E,M=-M),0>S?(S=-S,w=180):w=0;var A=i.ax,I=0,R=0,D=0,O=C.a,k=C.c,b=C.b,c=C.d,d=1e-4>=p(v-E);d?(I=i.ay,R=O*A+k*I+C.tx,D=b*A+c*I+C.ty):(I=0,R=O*A+C.tx,D=b*A+C.ty);var L=t.parent.matrix;O=L.a,k=L.c,b=L.b,c=L.d;var N=1/(O*c-k*b),F=s-L.tx,x=g-L.ty,y=(F*c-x*k)*N-_,B=(x*O-F*b)*N-T;F=R-L.tx,x=D-L.ty;var U=(F*c-x*k)*N-_,G=(x*O-F*b)*N-T,V=o(U*U+G*G),W=i.data.length*S,X=0,H=0;outer:if(d){W*=v;var Y=(y*y+B*B-V*V-W*W)/(2*V*W);-1>Y?Y=-1:1<Y&&(Y=1),H=n(Y)*f,O=V+W*Y,k=W*l(H),X=h(B*O-y*k,y*O+B*k)}else{O=v*W,k=E*W;var z=O*O,j=k*k,Z=y*y+B*B,K=h(B,y);b=j*V*V+z*Z-z*j;var J=-2*j*V,Q=j-z;if(c=J*J-4*Q*b,0<=c){var $=o(c);0>J&&($=-$),$=-(J+$)/2;var ee=$/Q,te=b/$,re=p(ee)<p(te)?ee:te;if(re*re<=Z){x=o(Z-re*re)*f,X=K-h(x,re),H=h(x/E,(re-V)/v);break outer}}var r=e.MathUtils.PI,ae=V-O,ne=ae*ae,oe=0,ie=0,se=V+O,le=se*se,de=0;b=-O*V/(z-j),-1<=b&&1>=b&&(b=n(b),F=O*u(b)+V,x=k*l(b),c=F*F+x*x,c<ne&&(r=b,ne=c,ae=F,oe=x),c>le&&(ie=b,le=c,se=F,de=x)),Z<=(ne+le)/2?(X=K-h(oe*f,ae),H=r*f):(X=K-h(de*f,se),H=ie*f)}var ue=h(I,A)*M,pe=t.arotation;X=(X-ue)*e.MathUtils.radDeg+P-pe,180<X?X-=360:-180>X&&(X+=360),t.updateWorldTransformWith(_,T,pe+X*m,t.ascaleX,t.ascaleY,0,0),pe=i.arotation,H=((H+ue)*e.MathUtils.radDeg-i.ashearX)*M+w-pe,180<H?H-=360:-180>H&&(H+=360),i.updateWorldTransformWith(A,I,pe+H*m,i.ascaleX,i.ascaleY,i.ashearX,i.ashearY)},t}();e.IkConstraint=t})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t=function(){return function(e){this.order=0,this.bones=[],this.bendDirection=1,this.mix=1,this.name=e}}();e.IkConstraintData=t})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t=function(){function t(e,t){if(this.position=0,this.spacing=0,this.rotateMix=0,this.translateMix=0,this.spaces=[],this.positions=[],this.world=[],this.curves=[],this.lengths=[],this.segments=[],null==e)throw new Error('data cannot be null.');if(null==t)throw new Error('skeleton cannot be null.');this.data=e,this.bones=[];for(var r=0,a=e.bones.length;r<a;r++)this.bones.push(t.findBone(e.bones[r].name));this.target=t.findSlot(e.target.name),this.position=e.position,this.spacing=e.spacing,this.rotateMix=e.rotateMix,this.translateMix=e.translateMix}return t.prototype.apply=function(){this.update()},t.prototype.update=function(){var t=this.target.getAttachment();if(t instanceof e.PathAttachment){var n=this.rotateMix,g=this.translateMix,f=0<n;if(0<g||f){var m=this.data,_=m.spacingMode,T=_==e.SpacingMode.Length,v=m.rotateMode,E=v==e.RotateMode.Tangent,S=v==e.RotateMode.ChainScale,C=this.bones.length,P=E?C:C+1,w=this.bones,M=e.Utils.setArraySize(this.spaces,P),A=null,I=this.spacing;if(S||T){S&&(A=e.Utils.setArraySize(this.lengths,C));for(var R=0;R<P-1;){var i=w[R],D=i.data.length,O=D*i.matrix.a,x=D*i.matrix.b,y=o(O*O+x*x);S&&(A[R]=y),M[++R]=(T?D+I:I)*y/D}}else for(var R=1;R<P;R++)M[R]=I;var k=this.computeWorldPositions(t,P,E,m.positionMode==e.PositionMode.Percent,_==e.SpacingMode.Percent),L=k[0],N=k[1],F=m.offsetRotation,B=!1;if(0==F)B=v==e.RotateMode.Chain;else{B=!1;var U=this.target.bone.matrix;F*=0<U.a*U.d-U.b*U.c?e.MathUtils.degRad:-e.MathUtils.degRad}for(var R=0,U=3;R<C;R++,U+=3){var i=w[R],p=i.matrix;p.tx+=(L-p.tx)*g,p.ty+=(N-p.ty)*g;var O=k[U],x=k[U+1],G=O-L,V=x-N;if(S){var W=A[R];if(0!=W){var X=(o(G*G+V*V)/W-1)*n+1;p.a*=X,p.b*=X}}if(L=O,N=x,f){var s=p.a,a=p.c,b=p.b,c=p.d,d=0,r=0,H=0;if(d=E?k[U-1]:0==M[R+1]?k[U+2]:h(V,G),d-=h(b,s),B){r=u(d),H=l(d);var Y=i.data.length;L+=(Y*(r*s-H*b)-G)*n,N+=(Y*(H*s+r*b)-V)*n}else d+=F;d>e.MathUtils.PI?d-=e.MathUtils.PI2:d<-e.MathUtils.PI&&(d+=e.MathUtils.PI2),d*=n,r=u(d),H=l(d),p.a=r*s-H*b,p.c=r*a-H*c,p.b=H*s+r*b,p.d=H*a+r*c}i.appliedValid=!1}}}},t.prototype.computeWorldPositions=function(r,a,n,s,l){var d=this.target,u=this.position,c=this.spaces,h=e.Utils.setArraySize(this.positions,3*a+2),g=null,f=r.closed,m=r.worldVerticesLength,y=m/6,x=t.NONE;if(!r.constantSpeed){var _=r.lengths;y-=f?1:2;var b=_[y];if(s&&(u*=b),l)for(var T=0;T<a;T++)c[T]*=b;g=e.Utils.setArraySize(this.world,8);for(var T=0,i=0,v=0,E;T<a;T++,i+=3){E=c[T],u+=E;var S=u;if(f)S%=b,0>S&&(S+=b),v=0;else if(0>S){x!=t.BEFORE&&(x=t.BEFORE,r.computeWorldVertices(d,2,4,g,0,2)),this.addBeforePosition(S,g,0,h,i);continue}else if(S>b){x!=t.AFTER&&(x=t.AFTER,r.computeWorldVertices(d,m-6,4,g,0,2)),this.addAfterPosition(S-b,g,0,h,i);continue}for(;;v++){var p=_[v];if(!(S>p)){if(0==v)S/=p;else{var C=_[v-1];S=(S-C)/(p-C)}break}}v!=x&&(x=v,f&&v==y?(r.computeWorldVertices(d,m-4,4,g,0,2),r.computeWorldVertices(d,0,4,g,4,2)):r.computeWorldVertices(d,6*v+2,8,g,0,2)),this.addCurvePosition(S,g[0],g[1],g[2],g[3],g[4],g[5],g[6],g[7],h,i,n||0<T&&0==E)}return h}f?(m+=2,g=e.Utils.setArraySize(this.world,m),r.computeWorldVertices(d,2,m-4,g,0,2),r.computeWorldVertices(d,0,2,g,m-4,2),g[m-2]=g[0],g[m-1]=g[1]):(y--,m-=4,g=e.Utils.setArraySize(this.world,m),r.computeWorldVertices(d,2,m,g,0,2));for(var P=e.Utils.setArraySize(this.curves,y),M=0,A=g[0],I=g[1],R=0,D=0,O=0,k=0,L=0,N=0,F=0,B=0,U=0,G=0,V=0,W=0,X=0,H=0,T=0,Y=2;T<y;T++,Y+=6)R=g[Y],D=g[Y+1],O=g[Y+2],k=g[Y+3],L=g[Y+4],N=g[Y+5],F=.1875*(A-2*R+O),B=.1875*(I-2*D+k),U=.09375*(3*(R-O)-A+L),G=.09375*(3*(D-k)-I+N),V=2*F+U,W=2*B+G,X=.75*(R-A)+F+.16666667*U,H=.75*(D-I)+B+.16666667*G,M+=o(X*X+H*H),X+=V,H+=W,V+=U,W+=G,M+=o(X*X+H*H),X+=V,H+=W,M+=o(X*X+H*H),X+=V+U,H+=W+G,M+=o(X*X+H*H),P[T]=M,A=L,I=N;if(s&&(u*=M),l)for(var T=0;T<a;T++)c[T]*=M;for(var w=this.segments,z=0,T=0,i=0,v=0,j=0,E;T<a;T++,i+=3){E=c[T],u+=E;var S=u;if(f)S%=M,0>S&&(S+=M),v=0;else if(0>S){this.addBeforePosition(S,g,0,h,i);continue}else if(S>M){this.addAfterPosition(S-M,g,m-4,h,i);continue}for(;;v++){var q=P[v];if(!(S>q)){if(0==v)S/=q;else{var C=P[v-1];S=(S-C)/(q-C)}break}}if(v!=x){x=v;var Z=6*v;for(A=g[Z],I=g[Z+1],R=g[Z+2],D=g[Z+3],O=g[Z+4],k=g[Z+5],L=g[Z+6],N=g[Z+7],F=.03*(A-2*R+O),B=.03*(I-2*D+k),U=.006*(3*(R-O)-A+L),G=.006*(3*(D-k)-I+N),V=2*F+U,W=2*B+G,X=.3*(R-A)+F+.16666667*U,H=.3*(D-I)+B+.16666667*G,z=o(X*X+H*H),w[0]=z,Z=1;8>Z;Z++)X+=V,H+=W,V+=U,W+=G,z+=o(X*X+H*H),w[Z]=z;X+=V,H+=W,z+=o(X*X+H*H),w[8]=z,X+=V+U,H+=W+G,z+=o(X*X+H*H),w[9]=z,j=0}for(S*=z;;j++){var K=w[j];if(!(S>K)){if(0==j)S/=K;else{var C=w[j-1];S=j+(S-C)/(K-C)}break}}this.addCurvePosition(.1*S,A,I,R,D,O,k,L,N,h,i,n||0<T&&0==E)}return h},t.prototype.addBeforePosition=function(e,t,a,n,i){var o=t[a],s=t[a+1],d=t[a+2]-o,p=t[a+3]-s,c=h(p,d);n[i]=o+e*u(c),n[i+1]=s+e*l(c),n[i+2]=c},t.prototype.addAfterPosition=function(e,t,a,n,i){var o=t[a+2],s=t[a+3],d=o-t[a],p=s-t[a+1],c=h(p,d);n[i]=o+e*u(c),n[i+1]=s+e*l(c),n[i+2]=c},t.prototype.addCurvePosition=function(e,t,r,a,n,i,s,l,d,p,c,o){(0==e||isNaN(e))&&(e=1e-4);var g=e*e,f=g*e,m=1-e,u=m*m,_=u*m,b=m*e,T=3*b,v=m*T,E=T*e,S=t*_+a*v+i*E+l*f,x=r*_+n*v+s*E+d*f;p[c]=S,p[c+1]=x,o&&(p[c+2]=h(x-(r*u+2*(n*b)+s*g),S-(t*u+2*(a*b)+i*g)))},t.prototype.getOrder=function(){return this.data.order},t.NONE=-1,t.BEFORE=-2,t.AFTER=-3,t}();e.PathConstraint=t})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t=function(){return function(e){this.order=0,this.bones=[],this.name=e}}();e.PathConstraintData=t;var r;(function(e){e[e.Fixed=0]='Fixed',e[e.Percent=1]='Percent'})(r=e.PositionMode||(e.PositionMode={}));var a;(function(e){e[e.Length=0]='Length',e[e.Fixed=1]='Fixed',e[e.Percent=2]='Percent'})(a=e.SpacingMode||(e.SpacingMode={}));var n;(function(e){e[e.Tangent=0]='Tangent',e[e.Chain=1]='Chain',e[e.ChainScale=2]='ChainScale'})(n=e.RotateMode||(e.RotateMode={}))})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var a;(function(e){var a=function(){function a(t){if(this._updateCache=[],this.updateCacheReset=[],this.time=0,this.flipX=!1,this.flipY=!1,this.x=0,this.y=0,null==t)throw new Error('data cannot be null.');this.data=t,this.bones=[];for(var r=0;r<t.bones.length;r++){var a=t.bones[r],n=void 0;if(null==a.parent)n=new e.Bone(a,this,null);else{var o=this.bones[a.parent.index];n=new e.Bone(a,this,o),o.children.push(n)}this.bones.push(n)}this.slots=[],this.drawOrder=[];for(var r=0;r<t.slots.length;r++){var i=t.slots[r],n=this.bones[i.boneData.index],s=new e.Slot(i,n);this.slots.push(s),this.drawOrder.push(s)}this.ikConstraints=[];for(var r=0,l;r<t.ikConstraints.length;r++)l=t.ikConstraints[r],this.ikConstraints.push(new e.IkConstraint(l,this));this.transformConstraints=[];for(var r=0,d;r<t.transformConstraints.length;r++)d=t.transformConstraints[r],this.transformConstraints.push(new e.TransformConstraint(d,this));this.pathConstraints=[];for(var r=0,u;r<t.pathConstraints.length;r++)u=t.pathConstraints[r],this.pathConstraints.push(new e.PathConstraint(u,this));this.color=new e.Color(1,1,1,1),this.updateCache()}return a.prototype.updateCache=function(){var e=this._updateCache;e.length=0,this.updateCacheReset.length=0;for(var t=this.bones,r=0,a=t.length;r<a;r++)t[r].sorted=!1;var n=this.ikConstraints,o=this.transformConstraints,i=this.pathConstraints,s=n.length,l=o.length,d=i.length;outer:for(var r=0;r<s+l+d;r++){for(var u=0,p;u<s;u++)if(p=n[u],p.data.order==r){this.sortIkConstraint(p);continue outer}for(var u=0,p;u<l;u++)if(p=o[u],p.data.order==r){this.sortTransformConstraint(p);continue outer}for(var u=0,p;u<d;u++)if(p=i[u],p.data.order==r){this.sortPathConstraint(p);continue outer}}for(var r=0,a=t.length;r<a;r++)this.sortBone(t[r])},a.prototype.sortIkConstraint=function(e){var t=e.target;this.sortBone(t);var r=e.bones,a=r[0];if(this.sortBone(a),1<r.length){var n=r[r.length-1];-1<this._updateCache.indexOf(n)||this.updateCacheReset.push(n)}this._updateCache.push(e),this.sortReset(a.children),r[r.length-1].sorted=!0},a.prototype.sortPathConstraint=function(t){var r=t.target,a=r.data.index,o=r.bone;null!=this.skin&&this.sortPathConstraintAttachment(this.skin,a,o),null!=this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,a,o);for(var s=0,i=this.data.skins.length;s<i;s++)this.sortPathConstraintAttachment(this.data.skins[s],a,o);var n=r.getAttachment();n instanceof e.PathAttachment&&this.sortPathConstraintAttachmentWith(n,o);for(var l=t.bones,d=l.length,s=0;s<d;s++)this.sortBone(l[s]);this._updateCache.push(t);for(var s=0;s<d;s++)this.sortReset(l[s].children);for(var s=0;s<d;s++)l[s].sorted=!0},a.prototype.sortTransformConstraint=function(e){this.sortBone(e.target);var t=e.bones,r=t.length;if(e.data.local)for(var a=0,n;a<r;a++)n=t[a],this.sortBone(n.parent),-1<this._updateCache.indexOf(n)||this.updateCacheReset.push(n);else for(var a=0;a<r;a++)this.sortBone(t[a]);this._updateCache.push(e);for(var o=0;o<r;o++)this.sortReset(t[o].children);for(var o=0;o<r;o++)t[o].sorted=!0},a.prototype.sortPathConstraintAttachment=function(e,t,r){var a=e.attachments[t];if(a)for(var n in a)this.sortPathConstraintAttachmentWith(a[n],r)},a.prototype.sortPathConstraintAttachmentWith=function(t,r){if(t instanceof e.PathAttachment){var a=t.bones;if(null==a)this.sortBone(r);else for(var o=this.bones,s=0;s<a.length;)for(var i=a[s++],l=s+i,n;s<l;s++)n=a[s],this.sortBone(o[n])}},a.prototype.sortBone=function(e){if(!e.sorted){var t=e.parent;null!=t&&this.sortBone(t),e.sorted=!0,this._updateCache.push(e)}},a.prototype.sortReset=function(e){for(var t=0,r=e.length,a;t<r;t++)a=e[t],a.sorted&&this.sortReset(a.children),a.sorted=!1},a.prototype.updateWorldTransform=function(){for(var e=this.updateCacheReset,t=0,r=e.length,a;t<r;t++)a=e[t],a.ax=a.x,a.ay=a.y,a.arotation=a.rotation,a.ascaleX=a.scaleX,a.ascaleY=a.scaleY,a.ashearX=a.shearX,a.ashearY=a.shearY,a.appliedValid=!0;for(var n=this._updateCache,t=0,r=n.length;t<r;t++)n[t].update()},a.prototype.setToSetupPose=function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},a.prototype.setBonesToSetupPose=function(){for(var e=this.bones,t=0,r=e.length;t<r;t++)e[t].setToSetupPose();for(var a=this.ikConstraints,t=0,r=a.length,n;t<r;t++)n=a[t],n.bendDirection=n.data.bendDirection,n.mix=n.data.mix;for(var o=this.transformConstraints,t=0,r=o.length;t<r;t++){var n=o[t],i=n.data;n.rotateMix=i.rotateMix,n.translateMix=i.translateMix,n.scaleMix=i.scaleMix,n.shearMix=i.shearMix}for(var s=this.pathConstraints,t=0,r=s.length;t<r;t++){var n=s[t],i=n.data;n.position=i.position,n.spacing=i.spacing,n.rotateMix=i.rotateMix,n.translateMix=i.translateMix}},a.prototype.setSlotsToSetupPose=function(){var t=this.slots;e.Utils.arrayCopy(t,0,this.drawOrder,0,t.length);for(var r=0,a=t.length;r<a;r++)t[r].setToSetupPose()},a.prototype.getRootBone=function(){return 0==this.bones.length?null:this.bones[0]},a.prototype.findBone=function(e){if(null==e)throw new Error('boneName cannot be null.');for(var t=this.bones,r=0,a=t.length,n;r<a;r++)if(n=t[r],n.data.name==e)return n;return null},a.prototype.findBoneIndex=function(e){if(null==e)throw new Error('boneName cannot be null.');for(var t=this.bones,r=0,a=t.length;r<a;r++)if(t[r].data.name==e)return r;return-1},a.prototype.findSlot=function(e){if(null==e)throw new Error('slotName cannot be null.');for(var t=this.slots,r=0,a=t.length,n;r<a;r++)if(n=t[r],n.data.name==e)return n;return null},a.prototype.findSlotIndex=function(e){if(null==e)throw new Error('slotName cannot be null.');for(var t=this.slots,r=0,a=t.length;r<a;r++)if(t[r].data.name==e)return r;return-1},a.prototype.setSkinByName=function(e){var t=this.data.findSkin(e);if(null==t)throw new Error('Skin not found: '+e);this.setSkin(t)},a.prototype.setSkin=function(e){if(null!=e)if(null!=this.skin)e.attachAll(this,this.skin);else for(var t=this.slots,r=0,a=t.length;r<a;r++){var n=t[r],o=n.data.attachmentName;if(null!=o){var i=e.getAttachment(r,o);null!=i&&n.setAttachment(i)}}this.skin=e},a.prototype.getAttachmentByName=function(e,t){return this.getAttachment(this.data.findSlotIndex(e),t)},a.prototype.getAttachment=function(e,t){if(null==t)throw new Error('attachmentName cannot be null.');if(null!=this.skin){var r=this.skin.getAttachment(e,t);if(null!=r)return r}return null==this.data.defaultSkin?null:this.data.defaultSkin.getAttachment(e,t)},a.prototype.setAttachment=function(e,t){if(null==e)throw new Error('slotName cannot be null.');for(var r=this.slots,a=0,o=r.length,n;a<o;a++)if(n=r[a],n.data.name==e){var i=null;if(null!=t&&(i=this.getAttachment(a,t),null==i))throw new Error('Attachment not found: '+t+', for slot: '+e);return void n.setAttachment(i)}throw new Error('Slot not found: '+e)},a.prototype.findIkConstraint=function(e){if(null==e)throw new Error('constraintName cannot be null.');for(var t=this.ikConstraints,r=0,a=t.length,n;r<a;r++)if(n=t[r],n.data.name==e)return n;return null},a.prototype.findTransformConstraint=function(e){if(null==e)throw new Error('constraintName cannot be null.');for(var t=this.transformConstraints,r=0,a=t.length,n;r<a;r++)if(n=t[r],n.data.name==e)return n;return null},a.prototype.findPathConstraint=function(e){if(null==e)throw new Error('constraintName cannot be null.');for(var t=this.pathConstraints,r=0,a=t.length,n;r<a;r++)if(n=t[r],n.data.name==e)return n;return null},a.prototype.getBounds=function(a,o,l){if(null==a)throw new Error('offset cannot be null.');if(null==o)throw new Error('size cannot be null.');for(var d=this.drawOrder,u=r,p=r,c=t,h=t,g=0,f=d.length;g<f;g++){var n=d[g],m=0,_=null,b=n.getAttachment();if(b instanceof e.RegionAttachment)m=8,_=e.Utils.setArraySize(l,m,0),b.computeWorldVertices(n.bone,_,0,2);else if(b instanceof e.MeshAttachment){var T=b;m=T.worldVerticesLength,_=e.Utils.setArraySize(l,m,0),T.computeWorldVertices(n,0,m,_,0,2)}if(null!=_)for(var v=0,E=_.length;v<E;v+=2){var S=_[v],x=_[v+1];u=i(u,S),p=i(p,x),c=s(c,S),h=s(h,x)}}a.set(u,p),o.set(c-u,h-p)},a.prototype.update=function(e){this.time+=e},a}();e.Skeleton=a})(a=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var a;(function(e){var a=function(){function a(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.boundingBoxes=[],this.polygons=[],this.polygonPool=new e.Pool(function(){return e.Utils.newFloatArray(16)})}return a.prototype.update=function(a,n){if(null==a)throw new Error('skeleton cannot be null.');var o=this.boundingBoxes,s=this.polygons,l=this.polygonPool,d=a.slots,u=d.length;o.length=0,l.freeAll(s),s.length=0;for(var p=0;p<u;p++){var i=d[p],c=i.getAttachment();if(c instanceof e.BoundingBoxAttachment){var h=c;o.push(h);var g=l.obtain();g.length!=h.worldVerticesLength&&(g=e.Utils.newFloatArray(h.worldVerticesLength)),s.push(g),h.computeWorldVertices(i,0,h.worldVerticesLength,g,0,2)}}n?this.aabbCompute():(this.minX=r,this.minY=r,this.maxX=t,this.maxY=t)},a.prototype.aabbCompute=function(){for(var e=r,a=r,o=t,l=t,d=this.polygons,u=0,p=d.length;u<p;u++)for(var n=d[u],c=n,h=0,g=n.length;h<g;h+=2){var f=c[h],m=c[h+1];e=i(e,f),a=i(a,m),o=s(o,f),l=s(l,m)}this.minX=e,this.minY=a,this.maxX=o,this.maxY=l},a.prototype.aabbContainsPoint=function(e,t){return e>=this.minX&&e<=this.maxX&&t>=this.minY&&t<=this.maxY},a.prototype.aabbIntersectsSegment=function(e,t,r,a){var n=this.minX,o=this.minY,i=this.maxX,s=this.maxY;if(e<=n&&r<=n||t<=o&&a<=o||e>=i&&r>=i||t>=s&&a>=s)return!1;var l=(a-t)/(r-e),d=l*(n-e)+t;if(d>o&&d<s)return!0;if(d=l*(i-e)+t,d>o&&d<s)return!0;var u=(o-t)/l+e;return!!(u>n&&u<i)||(u=(s-t)/l+e,!!(u>n&&u<i))},a.prototype.aabbIntersectsSkeleton=function(e){return this.minX<e.maxX&&this.maxX>e.minX&&this.minY<e.maxY&&this.maxY>e.minY},a.prototype.containsPoint=function(e,t){for(var r=this.polygons,a=0,o=r.length;a<o;a++)if(this.containsPointPolygon(r[a],e,t))return this.boundingBoxes[a];return null},a.prototype.containsPointPolygon=function(e,t,r){for(var a=e,n=e.length,o=n-2,i=!1,s=0;s<n;s+=2){var l=a[s+1],d=a[o+1];if(l<r&&d>=r||d<r&&l>=r){var u=a[s];u+(r-l)/(d-l)*(a[o]-u)<t&&(i=!i)}o=s}return i},a.prototype.intersectsSegment=function(e,t,r,a){for(var o=this.polygons,s=0,i=o.length;s<i;s++)if(this.intersectsSegmentPolygon(o[s],e,t,r,a))return this.boundingBoxes[s];return null},a.prototype.intersectsSegmentPolygon=function(e,t,r,a,n){for(var o=e,i=e.length,s=t-a,l=r-n,d=t*n-r*a,u=o[i-2],p=o[i-1],c=0;c<i;c+=2){var h=o[c],g=o[c+1],f=u*g-p*h,m=u-h,_=p-g,b=s*_-l*m,T=(d*m-s*f)/b;if((T>=u&&T<=h||T>=h&&T<=u)&&(T>=t&&T<=a||T>=a&&T<=t)){var x=(d*_-l*f)/b;if((x>=p&&x<=g||x>=g&&x<=p)&&(x>=r&&x<=n||x>=n&&x<=r))return!0}u=h,p=g}return!1},a.prototype.getPolygon=function(e){if(null==e)throw new Error('boundingBox cannot be null.');var t=this.boundingBoxes.indexOf(e);return-1==t?null:this.polygons[t]},a.prototype.getWidth=function(){return this.maxX-this.minX},a.prototype.getHeight=function(){return this.maxY-this.minY},a}();e.SkeletonBounds=a})(a=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t=function(){function t(){this.triangulator=new e.Triangulator,this.clippingPolygon=[],this.clipOutput=[],this.clippedVertices=[],this.clippedTriangles=[],this.scratch=[]}return t.prototype.clipStart=function(r,a){if(null!=this.clipAttachment)return 0;this.clipAttachment=a;var o=a.worldVerticesLength,n=e.Utils.setArraySize(this.clippingPolygon,o);a.computeWorldVertices(r,0,o,n,0,2);var s=this.clippingPolygon;t.makeClockwise(s);for(var l=this.clippingPolygons=this.triangulator.decompose(s,this.triangulator.triangulate(s)),d=0,i=l.length,u;d<i;d++)u=l[d],t.makeClockwise(u),u.push(u[0]),u.push(u[1]);return l.length},t.prototype.clipEndWithSlot=function(e){null!=this.clipAttachment&&this.clipAttachment.endSlot==e.data&&this.clipEnd()},t.prototype.clipEnd=function(){null==this.clipAttachment||(this.clipAttachment=null,this.clippingPolygons=null,this.clippedVertices.length=0,this.clippedTriangles.length=0,this.clippingPolygon.length=0)},t.prototype.isClipping=function(){return null!=this.clipAttachment},t.prototype.clipTriangles=function(t,r,n,o,l,u,h,g){var f=this.clipOutput,m=this.clippedVertices,_=this.clippedTriangles,T=this.clippingPolygons,v=this.clippingPolygons.length,E=g?12:8,S=0;m.length=0,_.length=0;outer:for(var C=0;C<o;C+=3){var i=n[C]<<1,P=t[i],w=t[i+1],M=l[i],A=l[i+1];i=n[C+1]<<1;var I=t[i],R=t[i+1],D=l[i],O=l[i+1];i=n[C+2]<<1;for(var k=t[i],L=t[i+1],N=l[i],F=l[i+1],B=0,p;B<v;B++)if(p=m.length,this.clip(P,w,I,R,k,L,T[B],f)){var s=f.length;if(0==s)continue;for(var U=R-L,G=k-I,V=P-k,W=1/(U*V+G*(w-L)),d=s>>1,X=this.clipOutput,H=e.Utils.setArraySize(m,p+d*E),Y=0;Y<s;Y+=2){var z=X[Y],x=X[Y+1];H[p]=z,H[p+1]=x,H[p+2]=u.r,H[p+3]=u.g,H[p+4]=u.b,H[p+5]=u.a;var y=z-k,j=x-L,q=(U*y+G*j)*W,a=((L-w)*y+V*j)*W,b=1-q-a;H[p+6]=M*q+D*a+N*b,H[p+7]=A*q+O*a+F*b,g&&(H[p+8]=h.r,H[p+9]=h.g,H[p+10]=h.b,H[p+11]=h.a),p+=E}p=_.length;var c=e.Utils.setArraySize(_,p+3*(d-2));d--;for(var Y=1;Y<d;Y++)c[p]=S,c[p+1]=S+Y,c[p+2]=S+Y+1,p+=3;S+=d+1}else{var H=e.Utils.setArraySize(m,p+3*E);H[p]=P,H[p+1]=w,H[p+2]=u.r,H[p+3]=u.g,H[p+4]=u.b,H[p+5]=u.a,g?(H[p+6]=M,H[p+7]=A,H[p+8]=h.r,H[p+9]=h.g,H[p+10]=h.b,H[p+11]=h.a,H[p+12]=I,H[p+13]=R,H[p+14]=u.r,H[p+15]=u.g,H[p+16]=u.b,H[p+17]=u.a,H[p+18]=D,H[p+19]=O,H[p+20]=h.r,H[p+21]=h.g,H[p+22]=h.b,H[p+23]=h.a,H[p+24]=k,H[p+25]=L,H[p+26]=u.r,H[p+27]=u.g,H[p+28]=u.b,H[p+29]=u.a,H[p+30]=N,H[p+31]=F,H[p+32]=h.r,H[p+33]=h.g,H[p+34]=h.b,H[p+35]=h.a):(H[p+6]=M,H[p+7]=A,H[p+8]=I,H[p+9]=R,H[p+10]=u.r,H[p+11]=u.g,H[p+12]=u.b,H[p+13]=u.a,H[p+14]=D,H[p+15]=O,H[p+16]=k,H[p+17]=L,H[p+18]=u.r,H[p+19]=u.g,H[p+20]=u.b,H[p+21]=u.a,H[p+22]=N,H[p+23]=F),p=_.length;var c=e.Utils.setArraySize(_,p+3);c[p]=S,c[p+1]=S+1,c[p+2]=S+2,S+=3;continue outer}}},t.prototype.clip=function(e,t,r,a,o,s,l,d){var u=d,p=!1,c=null;2<=l.length%4?(c=d,d=this.scratch):c=this.scratch,c.length=0,c.push(e),c.push(t),c.push(r),c.push(a),c.push(o),c.push(s),c.push(e),c.push(t),d.length=0;for(var h=l,g=l.length-4,f=0;;f+=2){for(var i=h[f],m=h[f+1],y=h[f+2],x=h[f+3],_=i-y,b=m-x,T=c,v=c.length-2,E=d.length,S=0;S<v;S+=2){var C=T[S],P=T[S+1],w=T[S+2],M=T[S+3],A=0<_*(M-x)-b*(w-y);if(0<_*(P-x)-b*(C-y)){if(A){d.push(w),d.push(M);continue}var I=M-P,R=w-C,D=(R*(m-P)-I*(i-C))/(I*(y-i)-R*(x-m));d.push(i+(y-i)*D),d.push(m+(x-m)*D)}else if(A){var I=M-P,R=w-C,D=(R*(m-P)-I*(i-C))/(I*(y-i)-R*(x-m));d.push(i+(y-i)*D),d.push(m+(x-m)*D),d.push(w),d.push(M)}p=!0}if(E==d.length)return u.length=0,!0;if(d.push(d[0]),d.push(d[1]),f==g)break;var O=d;d=c,d.length=0,c=O}if(u!=d){u.length=0;for(var f=0,k=d.length-2;f<k;f++)u[f]=d[f]}else u.length-=2;return p},t.makeClockwise=function(e){for(var t=e,r=e.length,a=t[r-2]*t[1]-t[0]*t[r-1],o=0,s=0,l=0,d=0,u=0,i=r-3;u<i;u+=2)o=t[u],s=t[u+1],l=t[u+2],d=t[u+3],a+=o*d-l*s;if(!(0>a))for(var u=0,i=r>>1;u<i;u+=2){var n=t[u],p=t[u+1],c=r-2-u;t[u]=t[c],t[u+1]=t[c+1],t[c]=n,t[c+1]=p}},t}();e.SkeletonClipping=t})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t=function(){function e(){this.bones=[],this.slots=[],this.skins=[],this.events=[],this.animations=[],this.ikConstraints=[],this.transformConstraints=[],this.pathConstraints=[],this.fps=0}return e.prototype.findBone=function(e){if(null==e)throw new Error('boneName cannot be null.');for(var t=this.bones,r=0,a=t.length,n;r<a;r++)if(n=t[r],n.name==e)return n;return null},e.prototype.findBoneIndex=function(e){if(null==e)throw new Error('boneName cannot be null.');for(var t=this.bones,r=0,a=t.length;r<a;r++)if(t[r].name==e)return r;return-1},e.prototype.findSlot=function(e){if(null==e)throw new Error('slotName cannot be null.');for(var t=this.slots,r=0,a=t.length,n;r<a;r++)if(n=t[r],n.name==e)return n;return null},e.prototype.findSlotIndex=function(e){if(null==e)throw new Error('slotName cannot be null.');for(var t=this.slots,r=0,a=t.length;r<a;r++)if(t[r].name==e)return r;return-1},e.prototype.findSkin=function(e){if(null==e)throw new Error('skinName cannot be null.');for(var t=this.skins,r=0,a=t.length,n;r<a;r++)if(n=t[r],n.name==e)return n;return null},e.prototype.findEvent=function(e){if(null==e)throw new Error('eventDataName cannot be null.');for(var t=this.events,r=0,a=t.length,n;r<a;r++)if(n=t[r],n.name==e)return n;return null},e.prototype.findAnimation=function(e){if(null==e)throw new Error('animationName cannot be null.');for(var t=this.animations,r=0,a=t.length,n;r<a;r++)if(n=t[r],n.name==e)return n;return null},e.prototype.findIkConstraint=function(e){if(null==e)throw new Error('constraintName cannot be null.');for(var t=this.ikConstraints,r=0,a=t.length,n;r<a;r++)if(n=t[r],n.name==e)return n;return null},e.prototype.findTransformConstraint=function(e){if(null==e)throw new Error('constraintName cannot be null.');for(var t=this.transformConstraints,r=0,a=t.length,n;r<a;r++)if(n=t[r],n.name==e)return n;return null},e.prototype.findPathConstraint=function(e){if(null==e)throw new Error('constraintName cannot be null.');for(var t=this.pathConstraints,r=0,a=t.length,n;r<a;r++)if(n=t[r],n.name==e)return n;return null},e.prototype.findPathConstraintIndex=function(e){if(null==e)throw new Error('pathConstraintName cannot be null.');for(var t=this.pathConstraints,r=0,a=t.length;r<a;r++)if(t[r].name==e)return r;return-1},e}();e.SkeletonData=t})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t=function(){function t(e){this.scale=1,this.linkedMeshes=[],this.attachmentLoader=e}return t.prototype.readSkeletonData=function(r){var a=this.scale,o=new e.SkeletonData,s='string'==typeof r?JSON.parse(r):r,l=s.skeleton;if(null!=l&&(o.hash=l.hash,o.version=l.spine,o.width=l.width,o.height=l.height,o.fps=l.fps,o.imagesPath=l.images),s.bones)for(var d=0;d<s.bones.length;d++){var i=s.bones[d],u=null,p=this.getValue(i,'parent',null);if(null!=p&&(u=o.findBone(p),null==u))throw new Error('Parent bone not found: '+p);var c=new e.BoneData(o.bones.length,i.name,u);c.length=this.getValue(i,'length',0)*a,c.x=this.getValue(i,'x',0)*a,c.y=this.getValue(i,'y',0)*a,c.rotation=this.getValue(i,'rotation',0),c.scaleX=this.getValue(i,'scaleX',1),c.scaleY=this.getValue(i,'scaleY',1),c.shearX=this.getValue(i,'shearX',0),c.shearY=this.getValue(i,'shearY',0),c.transformMode=t.transformModeFromString(this.getValue(i,'transform','normal')),o.bones.push(c)}if(s.slots)for(var d=0;d<s.slots.length;d++){var h=s.slots[d],g=h.name,f=h.bone,m=o.findBone(f);if(null==m)throw new Error('Slot bone not found: '+f);var c=new e.SlotData(o.slots.length,g,m),y=this.getValue(h,'color',null);null!=y&&c.color.setFromString(y);var x=this.getValue(h,'dark',null);null!=x&&(c.darkColor=new e.Color(1,1,1,1),c.darkColor.setFromString(x)),c.attachmentName=this.getValue(h,'attachment',null),c.blendMode=t.blendModeFromString(this.getValue(h,'blend','normal')),o.slots.push(c)}if(s.ik)for(var d=0;d<s.ik.length;d++){var _=s.ik[d],c=new e.IkConstraintData(_.name);c.order=this.getValue(_,'order',0);for(var b=0;b<_.bones.length;b++){var f=_.bones[b],T=o.findBone(f);if(null==T)throw new Error('IK bone not found: '+f);c.bones.push(T)}var v=_.target;if(c.target=o.findBone(v),null==c.target)throw new Error('IK target bone not found: '+v);c.bendDirection=this.getValue(_,'bendPositive',!0)?1:-1,c.mix=this.getValue(_,'mix',1),o.ikConstraints.push(c)}if(s.transform)for(var d=0;d<s.transform.length;d++){var _=s.transform[d],c=new e.TransformConstraintData(_.name);c.order=this.getValue(_,'order',0);for(var b=0;b<_.bones.length;b++){var f=_.bones[b],T=o.findBone(f);if(null==T)throw new Error('Transform constraint bone not found: '+f);c.bones.push(T)}var v=_.target;if(c.target=o.findBone(v),null==c.target)throw new Error('Transform constraint target bone not found: '+v);c.local=this.getValue(_,'local',!1),c.relative=this.getValue(_,'relative',!1),c.offsetRotation=this.getValue(_,'rotation',0),c.offsetX=this.getValue(_,'x',0)*a,c.offsetY=this.getValue(_,'y',0)*a,c.offsetScaleX=this.getValue(_,'scaleX',0),c.offsetScaleY=this.getValue(_,'scaleY',0),c.offsetShearY=this.getValue(_,'shearY',0),c.rotateMix=this.getValue(_,'rotateMix',1),c.translateMix=this.getValue(_,'translateMix',1),c.scaleMix=this.getValue(_,'scaleMix',1),c.shearMix=this.getValue(_,'shearMix',1),o.transformConstraints.push(c)}if(s.path)for(var d=0;d<s.path.length;d++){var _=s.path[d],c=new e.PathConstraintData(_.name);c.order=this.getValue(_,'order',0);for(var b=0;b<_.bones.length;b++){var f=_.bones[b],T=o.findBone(f);if(null==T)throw new Error('Transform constraint bone not found: '+f);c.bones.push(T)}var v=_.target;if(c.target=o.findSlot(v),null==c.target)throw new Error('Path target slot not found: '+v);c.positionMode=t.positionModeFromString(this.getValue(_,'positionMode','percent')),c.spacingMode=t.spacingModeFromString(this.getValue(_,'spacingMode','length')),c.rotateMode=t.rotateModeFromString(this.getValue(_,'rotateMode','tangent')),c.offsetRotation=this.getValue(_,'rotation',0),c.position=this.getValue(_,'position',0),c.positionMode==e.PositionMode.Fixed&&(c.position*=a),c.spacing=this.getValue(_,'spacing',0),(c.spacingMode==e.SpacingMode.Length||c.spacingMode==e.SpacingMode.Fixed)&&(c.spacing*=a),c.rotateMix=this.getValue(_,'rotateMix',1),c.translateMix=this.getValue(_,'translateMix',1),o.pathConstraints.push(c)}if(s.skins)for(var E in s.skins){var S=s.skins[E],C=new e.Skin(E);for(var g in S){var P=o.findSlotIndex(g);if(-1==P)throw new Error('Slot not found: '+g);var h=S[g];for(var w in h){var M=this.readAttachment(h[w],C,P,w,o);null!=M&&C.addAttachment(P,w,M)}}o.skins.push(C),'default'==C.name&&(o.defaultSkin=C)}for(var d=0,A=this.linkedMeshes.length;d<A;d++){var n=this.linkedMeshes[d],C=null==n.skin?o.defaultSkin:o.findSkin(n.skin);if(null==C)throw new Error('Skin not found: '+n.skin);var I=C.getAttachment(n.slotIndex,n.parent);if(null==I)throw new Error('Parent mesh not found: '+n.parent);n.mesh.setParentMesh(I)}if(this.linkedMeshes.length=0,s.events)for(var R in s.events){var D=s.events[R],c=new e.EventData(R);c.intValue=this.getValue(D,'int',0),c.floatValue=this.getValue(D,'float',0),c.stringValue=this.getValue(D,'string',''),o.events.push(c)}if(s.animations)for(var O in s.animations){var k=s.animations[O];this.readAnimation(k,O,o)}return o},t.prototype.readAttachment=function(t,a,n,o,s){var l=this.scale;o=this.getValue(t,'name',o);var d=this.getValue(t,'type','region');switch(d){case'region':{var u=this.getValue(t,'path',o),p=this.attachmentLoader.newRegionAttachment(a,o,u);if(null==p)return null;p.path=u,p.x=this.getValue(t,'x',0)*l,p.y=this.getValue(t,'y',0)*l,p.scaleX=this.getValue(t,'scaleX',1),p.scaleY=this.getValue(t,'scaleY',1),p.rotation=this.getValue(t,'rotation',0),p.width=t.width*l,p.height=t.height*l;var c=this.getValue(t,'color',null);return null!=c&&p.color.setFromString(c),p}case'boundingbox':{var h=this.attachmentLoader.newBoundingBoxAttachment(a,o);if(null==h)return null;this.readVertices(t,h,t.vertexCount<<1);var c=this.getValue(t,'color',null);return null!=c&&h.color.setFromString(c),h}case'mesh':case'linkedmesh':{var u=this.getValue(t,'path',o),g=this.attachmentLoader.newMeshAttachment(a,o,u);if(null==g)return null;g.path=u;var c=this.getValue(t,'color',null);null!=c&&g.color.setFromString(c);var f=this.getValue(t,'parent',null);if(null!=f)return g.inheritDeform=this.getValue(t,'deform',!0),this.linkedMeshes.push(new r(g,this.getValue(t,'skin',null),n,f)),g;var m=t.uvs;return this.readVertices(t,g,m.length),g.triangles=t.triangles,g.regionUVs=m,g.hullLength=2*this.getValue(t,'hull',0),g}case'path':{var u=this.attachmentLoader.newPathAttachment(a,o);if(null==u)return null;u.closed=this.getValue(t,'closed',!1),u.constantSpeed=this.getValue(t,'constantSpeed',!0);var y=t.vertexCount;this.readVertices(t,u,y<<1);for(var x=e.Utils.newArray(y/3,0),_=0;_<t.lengths.length;_++)x[_]*=l;u.lengths=x;var c=this.getValue(t,'color',null);return null!=c&&u.color.setFromString(c),u}case'point':{var i=this.attachmentLoader.newPointAttachment(a,o);if(null==i)return null;i.x=this.getValue(t,'x',0)*l,i.y=this.getValue(t,'y',0)*l,i.rotation=this.getValue(t,'rotation',0);var c=this.getValue(t,'color',null);return null!=c&&i.color.setFromString(c),i}case'clipping':{var b=this.attachmentLoader.newClippingAttachment(a,o);if(null==b)return null;var T=this.getValue(t,'end',null);if(null!=T){var v=s.findSlot(T);if(null==v)throw new Error('Clipping end slot not found: '+T);b.endSlot=v}var y=t.vertexCount;this.readVertices(t,b,y<<1);var c=this.getValue(t,'color',null);return null!=c&&b.color.setFromString(c),b}}return null},t.prototype.readVertices=function(t,r,a){var o=this.scale;r.worldVerticesLength=a;var s=t.vertices;if(a==s.length){var l=e.Utils.toFloatArray(s);if(1!=o)for(var d=0,i=s.length;d<i;d++)l[d]*=o;return void(r.vertices=l)}for(var n=[],u=[],d=0,i=s.length,p;d<i;){p=s[d++],u.push(p);for(var c=d+4*p;d<c;d+=4)u.push(s[d]),n.push(s[d+1]*o),n.push(s[d+2]*o),n.push(s[d+3])}r.bones=u,r.vertices=e.Utils.toFloatArray(n)},t.prototype.readAnimation=function(t,r,a){var o=this.scale,l=[],d=0;if(t.slots)for(var u in t.slots){var p=t.slots[u],c=a.findSlotIndex(u);if(-1==c)throw new Error('Slot not found: '+u);for(var h in p){var g=p[h];if('attachment'==h){var f=new e.AttachmentTimeline(g.length);f.slotIndex=c;for(var m=0,_=0,i;_<g.length;_++)i=g[_],f.setFrame(m++,i.time,i.name);l.push(f),d=s(d,f.frames[f.getFrameCount()-1])}else if('color'==h){var f=new e.ColorTimeline(g.length);f.slotIndex=c;for(var m=0,_=0;_<g.length;_++){var i=g[_],b=new e.Color;b.setFromString(i.color||'ffffffff'),f.setFrame(m,i.time,b.r,b.g,b.b,b.a),this.readCurve(i,f,m),m++}l.push(f),d=s(d,f.frames[(f.getFrameCount()-1)*e.ColorTimeline.ENTRIES])}else if('twoColor'==h){var f=new e.TwoColorTimeline(g.length);f.slotIndex=c;for(var m=0,_=0;_<g.length;_++){var i=g[_],T=new e.Color,v=new e.Color;T.setFromString(i.light),v.setFromString(i.dark),f.setFrame(m,i.time,T.r,T.g,T.b,T.a,v.r,v.g,v.b),this.readCurve(i,f,m),m++}l.push(f),d=s(d,f.frames[(f.getFrameCount()-1)*e.TwoColorTimeline.ENTRIES])}else throw new Error('Invalid timeline type for a slot: '+h+' ('+u+')')}}if(t.bones)for(var E in t.bones){var S=t.bones[E],C=a.findBoneIndex(E);if(-1==C)throw new Error('Bone not found: '+E);for(var h in S){var g=S[h];if('rotate'==h){var f=new e.RotateTimeline(g.length);f.boneIndex=C;for(var m=0,_=0,i;_<g.length;_++)i=g[_],f.setFrame(m,i.time,i.angle),this.readCurve(i,f,m),m++;l.push(f),d=s(d,f.frames[(f.getFrameCount()-1)*e.RotateTimeline.ENTRIES])}else if('translate'==h||'scale'==h||'shear'==h){var f=null,P=1;'scale'==h?f=new e.ScaleTimeline(g.length):'shear'==h?f=new e.ShearTimeline(g.length):(f=new e.TranslateTimeline(g.length),P=o),f.boneIndex=C;for(var m=0,_=0;_<g.length;_++){var i=g[_],w=this.getValue(i,'x',0),x=this.getValue(i,'y',0);f.setFrame(m,i.time,w*P,x*P),this.readCurve(i,f,m),m++}l.push(f),d=s(d,f.frames[(f.getFrameCount()-1)*e.TranslateTimeline.ENTRIES])}else throw new Error('Invalid timeline type for a bone: '+h+' ('+E+')')}}if(t.ik)for(var y in t.ik){var M=t.ik[y],A=a.findIkConstraint(y),f=new e.IkConstraintTimeline(M.length);f.ikConstraintIndex=a.ikConstraints.indexOf(A);for(var m=0,_=0,i;_<M.length;_++)i=M[_],f.setFrame(m,i.time,this.getValue(i,'mix',1),this.getValue(i,'bendPositive',!0)?1:-1),this.readCurve(i,f,m),m++;l.push(f),d=s(d,f.frames[(f.getFrameCount()-1)*e.IkConstraintTimeline.ENTRIES])}if(t.transform)for(var y in t.transform){var M=t.transform[y],A=a.findTransformConstraint(y),f=new e.TransformConstraintTimeline(M.length);f.transformConstraintIndex=a.transformConstraints.indexOf(A);for(var m=0,_=0,i;_<M.length;_++)i=M[_],f.setFrame(m,i.time,this.getValue(i,'rotateMix',1),this.getValue(i,'translateMix',1),this.getValue(i,'scaleMix',1),this.getValue(i,'shearMix',1)),this.readCurve(i,f,m),m++;l.push(f),d=s(d,f.frames[(f.getFrameCount()-1)*e.TransformConstraintTimeline.ENTRIES])}if(t.paths)for(var y in t.paths){var M=t.paths[y],I=a.findPathConstraintIndex(y);if(-1==I)throw new Error('Path constraint not found: '+y);var R=a.pathConstraints[I];for(var h in M){var g=M[h];if('position'==h||'spacing'==h){var f=null,P=1;'spacing'==h?(f=new e.PathConstraintSpacingTimeline(g.length),(R.spacingMode==e.SpacingMode.Length||R.spacingMode==e.SpacingMode.Fixed)&&(P=o)):(f=new e.PathConstraintPositionTimeline(g.length),R.positionMode==e.PositionMode.Fixed&&(P=o)),f.pathConstraintIndex=I;for(var m=0,_=0,i;_<g.length;_++)i=g[_],f.setFrame(m,i.time,this.getValue(i,h,0)*P),this.readCurve(i,f,m),m++;l.push(f),d=s(d,f.frames[(f.getFrameCount()-1)*e.PathConstraintPositionTimeline.ENTRIES])}else if('mix'==h){var f=new e.PathConstraintMixTimeline(g.length);f.pathConstraintIndex=I;for(var m=0,_=0,i;_<g.length;_++)i=g[_],f.setFrame(m,i.time,this.getValue(i,'rotateMix',1),this.getValue(i,'translateMix',1)),this.readCurve(i,f,m),m++;l.push(f),d=s(d,f.frames[(f.getFrameCount()-1)*e.PathConstraintMixTimeline.ENTRIES])}}}if(t.deform)for(var D in t.deform){var O=t.deform[D],k=a.findSkin(D);if(null==k)throw new Error('Skin not found: '+D);for(var u in O){var p=O[u],c=a.findSlotIndex(u);if(-1==c)throw new Error('Slot not found: '+p.name);for(var h in p){var g=p[h],L=k.getAttachment(c,h);if(null==L)throw new Error('Deform attachment not found: '+g.name);var N=null!=L.bones,F=L.vertices,B=N?2*(F.length/3):F.length,f=new e.DeformTimeline(g.length);f.slotIndex=c,f.attachment=L;for(var m=0,U=0;U<g.length;U++){var i=g[U],G=void 0,V=this.getValue(i,'vertices',null);if(null==V)G=N?e.Utils.newFloatArray(B):F;else{G=e.Utils.newFloatArray(B);var W=this.getValue(i,'offset',0);if(e.Utils.arrayCopy(V,0,G,W,V.length),1!=o)for(var _=W,X=_+V.length;_<X;_++)G[_]*=o;if(!N)for(var _=0;_<B;_++)G[_]+=F[_]}f.setFrame(m,i.time,G),this.readCurve(i,f,m),m++}l.push(f),d=s(d,f.frames[f.getFrameCount()-1])}}}var n=t.drawOrder;if(null==n&&(n=t.draworder),null!=n){for(var f=new e.DrawOrderTimeline(n.length),H=a.slots.length,m=0,U=0;U<n.length;U++){var Y=n[U],z=null,j=this.getValue(Y,'offsets',null);if(null!=j){z=e.Utils.newArray(H,-1);for(var q=e.Utils.newArray(H-j.length,0),Z=0,K=0,_=0;_<j.length;_++){var J=j[_],c=a.findSlotIndex(J.slot);if(-1==c)throw new Error('Slot not found: '+J.slot);for(;Z!=c;)q[K++]=Z++;z[Z+J.offset]=Z++}for(;Z<H;)q[K++]=Z++;for(var _=H-1;0<=_;_--)-1==z[_]&&(z[_]=q[--K])}f.setFrame(m++,Y.time,z)}l.push(f),d=s(d,f.frames[f.getFrameCount()-1])}if(t.events){for(var f=new e.EventTimeline(t.events.length),m=0,_=0;_<t.events.length;_++){var Q=t.events[_],$=a.findEvent(Q.name);if(null==$)throw new Error('Event not found: '+Q.name);var ee=new e.Event(e.Utils.toSinglePrecision(Q.time),$);ee.intValue=this.getValue(Q,'int',$.intValue),ee.floatValue=this.getValue(Q,'float',$.floatValue),ee.stringValue=this.getValue(Q,'string',$.stringValue),f.setFrame(m++,ee)}l.push(f),d=s(d,f.frames[f.getFrameCount()-1])}if(isNaN(d))throw new Error('Error while parsing animation, duration is NaN');a.animations.push(new e.Animation(r,l,d))},t.prototype.readCurve=function(e,t,r){if(e.curve)if('stepped'===e.curve)t.setStepped(r);else if('[object Array]'===Object.prototype.toString.call(e.curve)){var a=e.curve;t.setCurve(r,a[0],a[1],a[2],a[3])}},t.prototype.getValue=function(e,t,r){return void 0===e[t]?r:e[t]},t.blendModeFromString=function(t){if(t=t.toLowerCase(),'normal'==t)return e.BlendMode.Normal;if('additive'==t)return e.BlendMode.Additive;if('multiply'==t)return e.BlendMode.Multiply;if('screen'==t)return e.BlendMode.Screen;throw new Error('Unknown blend mode: '+t)},t.positionModeFromString=function(t){if(t=t.toLowerCase(),'fixed'==t)return e.PositionMode.Fixed;if('percent'==t)return e.PositionMode.Percent;throw new Error('Unknown position mode: '+t)},t.spacingModeFromString=function(t){if(t=t.toLowerCase(),'length'==t)return e.SpacingMode.Length;if('fixed'==t)return e.SpacingMode.Fixed;if('percent'==t)return e.SpacingMode.Percent;throw new Error('Unknown position mode: '+t)},t.rotateModeFromString=function(t){if(t=t.toLowerCase(),'tangent'==t)return e.RotateMode.Tangent;if('chain'==t)return e.RotateMode.Chain;if('chainscale'==t)return e.RotateMode.ChainScale;throw new Error('Unknown rotate mode: '+t)},t.transformModeFromString=function(t){if(t=t.toLowerCase(),'normal'==t)return e.TransformMode.Normal;if('onlytranslation'==t)return e.TransformMode.OnlyTranslation;if('norotationorreflection'==t)return e.TransformMode.NoRotationOrReflection;if('noscale'==t)return e.TransformMode.NoScale;if('noscaleorreflection'==t)return e.TransformMode.NoScaleOrReflection;throw new Error('Unknown transform mode: '+t)},t}();e.SkeletonJson=t;var r=function(){return function(e,t,r,a){this.mesh=e,this.skin=t,this.slotIndex=r,this.parent=a}}()})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t=function(){function e(e){if(this.attachments=[],null==e)throw new Error('name cannot be null.');this.name=e}return e.prototype.addAttachment=function(e,t,r){if(null==r)throw new Error('attachment cannot be null.');var a=this.attachments;e>=a.length&&(a.length=e+1),a[e]||(a[e]={}),a[e][t]=r},e.prototype.getAttachment=function(e,t){var r=this.attachments[e];return r?r[t]:null},e.prototype.attachAll=function(e,t){for(var r=0,a=0;a<e.slots.length;a++){var n=e.slots[a],o=n.getAttachment();if(o&&r<t.attachments.length){var i=t.attachments[r];for(var s in i){var l=i[s];if(o==l){var d=this.getAttachment(r,name);null!=d&&n.setAttachment(d);break}}}r++}},e}();e.Skin=t})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t=function(){function t(t,r){if(this.attachmentVertices=[],null==t)throw new Error('data cannot be null.');if(null==r)throw new Error('bone cannot be null.');this.data=t,this.bone=r,this.color=new e.Color,this.darkColor=null==t.darkColor?null:new e.Color,this.setToSetupPose(),this.blendMode=this.data.blendMode}return t.prototype.getAttachment=function(){return this.attachment},t.prototype.setAttachment=function(e){this.attachment==e||(this.attachment=e,this.attachmentTime=this.bone.skeleton.time,this.attachmentVertices.length=0)},t.prototype.setAttachmentTime=function(e){this.attachmentTime=this.bone.skeleton.time-e},t.prototype.getAttachmentTime=function(){return this.bone.skeleton.time-this.attachmentTime},t.prototype.setToSetupPose=function(){this.color.setFromColor(this.data.color),null!=this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),null==this.data.attachmentName?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))},t}();e.Slot=t})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t=function(){return function(t,r,a){if(this.color=new e.Color(1,1,1,1),0>t)throw new Error('index must be >= 0.');if(null==r)throw new Error('name cannot be null.');if(null==a)throw new Error('boneData cannot be null.');this.index=t,this.name=r,this.boneData=a}}();e.SlotData=t})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t=function(){function e(e){this._image=e}return e.prototype.getImage=function(){return this._image},e.filterFromString=function(e){switch(e.toLowerCase()){case'nearest':return r.Nearest;case'linear':return r.Linear;case'mipmap':return r.MipMap;case'mipmapnearestnearest':return r.MipMapNearestNearest;case'mipmaplinearnearest':return r.MipMapLinearNearest;case'mipmapnearestlinear':return r.MipMapNearestLinear;case'mipmaplinearlinear':return r.MipMapLinearLinear;default:throw new Error('Unknown texture filter '+e);}},e.wrapFromString=function(e){switch(e.toLowerCase()){case'mirroredtepeat':return a.MirroredRepeat;case'clamptoedge':return a.ClampToEdge;case'repeat':return a.Repeat;default:throw new Error('Unknown texture wrap '+e);}},e}();e.Texture=t;var r;(function(e){e[e.Nearest=9728]='Nearest',e[e.Linear=9729]='Linear',e[e.MipMap=9987]='MipMap',e[e.MipMapNearestNearest=9984]='MipMapNearestNearest',e[e.MipMapLinearNearest=9985]='MipMapLinearNearest',e[e.MipMapNearestLinear=9986]='MipMapNearestLinear',e[e.MipMapLinearLinear=9987]='MipMapLinearLinear'})(r=e.TextureFilter||(e.TextureFilter={}));var a;(function(e){e[e.MirroredRepeat=33648]='MirroredRepeat',e[e.ClampToEdge=33071]='ClampToEdge',e[e.Repeat=10497]='Repeat'})(a=e.TextureWrap||(e.TextureWrap={}));var n=function(){function e(){this.size=null}return Object.defineProperty(e.prototype,'width',{get:function(){var e=this.texture;return'3'==PIXI.VERSION[0]?e.crop.width:e.trim?e.trim.width:e.orig.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,'height',{get:function(){var e=this.texture;return'3'==PIXI.VERSION[0]?e.crop.height:e.trim?e.trim.height:e.orig.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,'u',{get:function(){return this.texture._uvs.x0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,'v',{get:function(){return this.texture._uvs.y0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,'u2',{get:function(){return this.texture._uvs.x2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,'v2',{get:function(){return this.texture._uvs.y2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,'offsetX',{get:function(){var e=this.texture;return e.trim?e.trim.x:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,'offsetY',{get:function(){return console.warn('Deprecation Warning: @Hackerham: I guess, if you are using PIXI-SPINE ATLAS region.offsetY, you want a texture, right? Use region.texture from now on.'),this.spineOffsetY},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,'pixiOffsetY',{get:function(){var e=this.texture;return e.trim?e.trim.y:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,'spineOffsetY',{get:function(){var e=this.texture;return this.originalHeight-this.height-(e.trim?e.trim.y:0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,'originalWidth',{get:function(){var e=this.texture;return'3'==PIXI.VERSION[0]?e.trim?e.trim.width:e.crop.width:e.orig.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,'originalHeight',{get:function(){var e=this.texture;return'3'==PIXI.VERSION[0]?e.trim?e.trim.height:e.crop.height:e.orig.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,'x',{get:function(){return this.texture.frame.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,'y',{get:function(){return this.texture.frame.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,'rotate',{get:function(){return 0!==this.texture.rotate},enumerable:!0,configurable:!0}),e}();e.TextureRegion=n})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t=function(){function t(e,t,r){this.pages=[],this.regions=[],e&&this.addSpineAtlas(e,t,r)}return t.prototype.addTexture=function(t,r){for(var o=this.pages,s=null,l=0;l<o.length;l++)if(o[l].baseTexture===r.baseTexture){s=o[l];break}if(null===s){s=new a,s.name='texturePage';var i=r.baseTexture;s.width=i.realWidth,s.height=i.realHeight,s.baseTexture=i,s.minFilter=s.magFilter=e.TextureFilter.Nearest,s.uWrap=e.TextureWrap.ClampToEdge,s.vWrap=e.TextureWrap.ClampToEdge,o.push(s)}var d=new n;return d.name=t,d.page=s,d.texture=r,d.index=-1,this.regions.push(d),d},t.prototype.addTextureHash=function(e,t){for(var r in e)e.hasOwnProperty(r)&&this.addTexture(t&&-1!==r.indexOf('.')?r.substr(0,r.lastIndexOf('.')):r,e[r])},t.prototype.addSpineAtlas=function(e,t,r){return this.load(e,t,r)},t.prototype.load=function(t,o,i){var s=this;if(null==o)throw new Error('textureLoader cannot be null.');var l=new r(t),d=[,,,,],u=null,p=function(){for(;;){var t=l.readLine();if(null==t)return i&&i(s);if(t=t.trim(),0==t.length)u=null;else if(!u){u=new a,u.name=t,2==l.readTuple(d)&&(u.width=parseInt(d[0]),u.height=parseInt(d[1]),l.readTuple(d)),l.readTuple(d),u.minFilter=e.Texture.filterFromString(d[0]),u.magFilter=e.Texture.filterFromString(d[1]);var r=l.readValue();u.uWrap=e.TextureWrap.ClampToEdge,u.vWrap=e.TextureWrap.ClampToEdge,'x'==r?u.uWrap=e.TextureWrap.Repeat:'y'==r?u.vWrap=e.TextureWrap.Repeat:'xy'==r&&(u.uWrap=u.vWrap=e.TextureWrap.Repeat),o(t,function(e){u.baseTexture=e,e.hasLoaded||(e.width=u.width,e.height=u.height),s.pages.push(u),u.setFilters(),u.width&&u.height||(u.width=e.realWidth,u.height=e.realHeight,(!u.width||!u.height)&&console.log('ERROR spine atlas page '+u.name+': meshes wont work if you dont specify size in atlas (http://www.html5gamedevs.com/topic/18888-pixi-spines-and-meshes/?p=107121)')),p()}),s.pages.push(u);break}else{var c=new n;c.name=t,c.page=u;var h='true'==l.readValue()?6:0;l.readTuple(d);var g=parseInt(d[0]),f=parseInt(d[1]);l.readTuple(d);var m=parseInt(d[0]),y=parseInt(d[1]),x=u.baseTexture.resolution;g/=x,f/=x,m/=x,y/=x;var _=new PIXI.Rectangle(g,f,h?y:m,h?m:y);4==l.readTuple(d)&&4==l.readTuple(d)&&l.readTuple(d);var b=parseInt(d[0])/x,T=parseInt(d[1])/x;l.readTuple(d);var v=parseInt(d[0])/x,E=parseInt(d[1])/x,S=new PIXI.Rectangle(0,0,b,T),C=new PIXI.Rectangle(v,T-y-E,m,y);if('3'!=PIXI.VERSION[0])c.texture=new PIXI.Texture(c.page.baseTexture,_,S,C,h);else{var P=new PIXI.Rectangle(g,f,m,y),w=P.clone();C.width=b,C.height=T,c.texture=new PIXI.Texture(c.page.baseTexture,P,w,C,h)}c.index=parseInt(l.readValue()),c.texture._updateUvs(),s.regions.push(c)}}};p()},t.prototype.findRegion=function(e){for(var t=0;t<this.regions.length;t++)if(this.regions[t].name==e)return this.regions[t];return null},t.prototype.dispose=function(){for(var e=0;e<this.pages.length;e++)this.pages[e].baseTexture.dispose()},t}();e.TextureAtlas=t;var r=function(){function e(e){this.index=0,this.lines=e.split(/\r\n|\r|\n/)}return e.prototype.readLine=function(){return this.index>=this.lines.length?null:this.lines[this.index++]},e.prototype.readValue=function(){var e=this.readLine(),t=e.indexOf(':');if(-1==t)throw new Error('Invalid line: '+e);return e.substring(t+1).trim()},e.prototype.readTuple=function(e){var t=this.readLine(),r=t.indexOf(':');if(-1==r)throw new Error('Invalid line: '+t);for(var a=0,n=r+1,o;3>a&&(o=t.indexOf(',',n),-1!=o);a++)e[a]=t.substr(n,o-n).trim(),n=o+1;return e[a]=t.substring(n).trim(),a+1},e}(),a=function(){function t(){}return t.prototype.setFilters=function(){var t=this.baseTexture,r=this.minFilter;r==e.TextureFilter.Linear?t.scaleMode=PIXI.SCALE_MODES.LINEAR:this.minFilter==e.TextureFilter.Nearest?t.scaleMode=PIXI.SCALE_MODES.NEAREST:(t.mipmap=!0,t.scaleMode=r==e.TextureFilter.MipMapNearestNearest?PIXI.SCALE_MODES.NEAREST:PIXI.SCALE_MODES.LINEAR)},t}();e.TextureAtlasPage=a;var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t}(e.TextureRegion);e.TextureAtlasRegion=n})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t=function(){function t(t,r){if(this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.temp=new e.Vector2,null==t)throw new Error('data cannot be null.');if(null==r)throw new Error('skeleton cannot be null.');this.data=t,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix,this.scaleMix=t.scaleMix,this.shearMix=t.shearMix,this.bones=[];for(var a=0;a<t.bones.length;a++)this.bones.push(r.findBone(t.bones[a].name));this.target=r.findBone(t.target.name)}return t.prototype.apply=function(){this.update()},t.prototype.update=function(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()},t.prototype.applyAbsoluteWorld=function(){for(var t=this.rotateMix,p=this.translateMix,g=this.scaleMix,f=this.shearMix,m=this.target,y=m.matrix,x=y.a,_=y.c,T=y.b,v=y.d,E=0<x*v-_*T?e.MathUtils.degRad:-e.MathUtils.degRad,S=this.data.offsetRotation*E,C=this.data.offsetShearY*E,P=this.bones,w=0,i=P.length;w<i;w++){var n=P[w],M=!1,A=n.matrix;if(0!=t){var I=A.a,a=A.c,b=A.b,c=A.d,d=h(T,x)-h(b,I)+S;d>e.MathUtils.PI?d-=e.MathUtils.PI2:d<-e.MathUtils.PI&&(d+=e.MathUtils.PI2),d*=t;var r=u(d),R=l(d);A.a=r*I-R*b,A.c=r*a-R*c,A.b=R*I+r*b,A.d=R*a+r*c,M=!0}if(0!=p){var D=this.temp;m.localToWorld(D.set(this.data.offsetX,this.data.offsetY)),A.tx+=(D.x-A.tx)*p,A.ty+=(D.y-A.ty)*p,M=!0}if(0<g){var O=o(A.a*A.a+A.b*A.b),s=o(x*x+T*T);1e-5<O&&(O=(O+(s-O+this.data.offsetScaleX)*g)/O),A.a*=O,A.b*=O,O=o(A.c*A.c+A.d*A.d),s=o(_*_+v*v),1e-5<O&&(O=(O+(s-O+this.data.offsetScaleY)*g)/O),A.c*=O,A.d*=O,M=!0}if(0<f){var a=A.c,c=A.d,k=h(c,a),d=h(v,_)-h(T,x)-(k-h(A.b,A.a));d>e.MathUtils.PI?d-=e.MathUtils.PI2:d<-e.MathUtils.PI&&(d+=e.MathUtils.PI2),d=k+(d+C)*f;var O=o(a*a+c*c);A.c=u(d)*O,A.d=l(d)*O,M=!0}M&&(n.appliedValid=!1)}},t.prototype.applyRelativeWorld=function(){for(var t=this.rotateMix,p=this.translateMix,g=this.scaleMix,f=this.shearMix,m=this.target,y=m.matrix,x=y.a,_=y.c,T=y.b,v=y.d,E=0<x*v-_*T?e.MathUtils.degRad:-e.MathUtils.degRad,S=this.data.offsetRotation*E,C=this.data.offsetShearY*E,P=this.bones,w=0,i=P.length;w<i;w++){var n=P[w],M=!1,A=n.matrix;if(0!=t){var I=A.a,a=A.c,b=A.b,c=A.d,d=h(T,x)+S;d>e.MathUtils.PI?d-=e.MathUtils.PI2:d<-e.MathUtils.PI&&(d+=e.MathUtils.PI2),d*=t;var r=u(d),R=l(d);A.a=r*I-R*b,A.c=r*a-R*c,A.b=R*I+r*b,A.d=R*a+r*c,M=!0}if(0!=p){var D=this.temp;m.localToWorld(D.set(this.data.offsetX,this.data.offsetY)),A.tx+=D.x*p,A.ty+=D.y*p,M=!0}if(0<g){var O=(o(x*x+T*T)-1+this.data.offsetScaleX)*g+1;A.a*=O,A.b*=O,O=(o(_*_+v*v)-1+this.data.offsetScaleY)*g+1,A.c*=O,A.d*=O,M=!0}if(0<f){var d=h(v,_)-h(T,x);d>e.MathUtils.PI?d-=e.MathUtils.PI2:d<-e.MathUtils.PI&&(d+=e.MathUtils.PI2);var a=A.c,c=A.d;d=h(c,a)+(d-e.MathUtils.PI/2+C)*f;var O=o(a*a+c*c);A.c=u(d)*O,A.d=l(d)*O,M=!0}M&&(n.appliedValid=!1)}},t.prototype.applyAbsoluteLocal=function(){var e=this.rotateMix,t=this.translateMix,a=this.scaleMix,o=this.shearMix,s=this.target;s.appliedValid||s.updateAppliedTransform();for(var l=this.bones,d=0,i=l.length,n;d<i;d++){n=l[d],n.appliedValid||n.updateAppliedTransform();var u=n.arotation;if(0!=e){var p=s.arotation-u+this.data.offsetRotation;p-=360*(16384-(0|16384.499999999996-p/360)),u+=p*e}var r=n.ax,c=n.ay;0!=t&&(r+=(s.ax-r+this.data.offsetX)*t,c+=(s.ay-c+this.data.offsetY)*t);var h=n.ascaleX,g=n.ascaleY;0<a&&(1e-5<h&&(h=(h+(s.ascaleX-h+this.data.offsetScaleX)*a)/h),1e-5<g&&(g=(g+(s.ascaleY-g+this.data.offsetScaleY)*a)/g));var f=n.ashearY;if(0<o){var p=s.ashearY-f+this.data.offsetShearY;p-=360*(16384-(0|16384.499999999996-p/360)),n.shearY+=p*o}n.updateWorldTransformWith(r,c,u,h,g,n.ashearX,f)}},t.prototype.applyRelativeLocal=function(){var e=this.rotateMix,t=this.translateMix,r=this.scaleMix,a=this.shearMix,o=this.target;o.appliedValid||o.updateAppliedTransform();for(var s=this.bones,l=0,i=s.length,n;l<i;l++){n=s[l],n.appliedValid||n.updateAppliedTransform();var d=n.arotation;0!=e&&(d+=(o.arotation+this.data.offsetRotation)*e);var u=n.ax,p=n.ay;0!=t&&(u+=(o.ax+this.data.offsetX)*t,p+=(o.ay+this.data.offsetY)*t);var c=n.ascaleX,h=n.ascaleY;0<r&&(1e-5<c&&(c*=(o.ascaleX-1+this.data.offsetScaleX)*r+1),1e-5<h&&(h*=(o.ascaleY-1+this.data.offsetScaleY)*r+1));var g=n.ashearY;0<a&&(g+=(o.ashearY+this.data.offsetShearY)*a),n.updateWorldTransformWith(u,p,d,c,h,n.ashearX,g)}},t.prototype.getOrder=function(){return this.data.order},t}();e.TransformConstraint=t})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t=function(){return function(e){if(this.order=0,this.bones=[],this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1,null==e)throw new Error('name cannot be null.');this.name=e}}();e.TransformConstraintData=t})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t=function(){function t(){this.convexPolygons=[],this.convexPolygonsIndices=[],this.indicesArray=[],this.isConcaveArray=[],this.triangles=[],this.polygonPool=new e.Pool(function(){return[]}),this.polygonIndicesPool=new e.Pool(function(){return[]})}return t.prototype.triangulate=function(e){var r=e,a=e.length>>1,o=this.indicesArray;o.length=0;for(var s=0;s<a;s++)o[s]=s;var i=this.isConcaveArray;i.length=0;for(var s=0,l=a;s<l;++s)i[s]=t.isConcave(s,a,r,o);var n=this.triangles;for(n.length=0;3<a;){for(var d=a-1,s=0,u=1;;){outer:if(!i[s]){for(var p=o[d]<<1,c=o[s]<<1,h=o[u]<<1,g=r[p],f=r[p+1],m=r[c],y=r[c+1],x=r[h],_=r[h+1],b=(u+1)%a;b!=d;b=(b+1)%a)if(i[b]){var T=o[b]<<1,v=r[T],E=r[T+1];if(t.positiveArea(x,_,g,f,v,E)&&t.positiveArea(g,f,m,y,v,E)&&t.positiveArea(m,y,x,_,v,E))break outer}break}if(0==u){do{if(!i[s])break;s--}while(0<s);break}d=s,s=u,u=(u+1)%a}n.push(o[(a+s-1)%a]),n.push(o[s]),n.push(o[(s+1)%a]),o.splice(s,1),i.splice(s,1),a--;var S=(a+s-1)%a,C=s==a?0:s;i[S]=t.isConcave(S,a,r,o),i[C]=t.isConcave(C,a,r,o)}return 3==a&&(n.push(o[2]),n.push(o[0]),n.push(o[1])),n},t.prototype.decompose=function(e,r){var a=e,s=this.convexPolygons;this.polygonPool.freeAll(s),s.length=0;var l=this.convexPolygonsIndices;this.polygonIndicesPool.freeAll(l),l.length=0;var d=this.polygonIndicesPool.obtain();d.length=0;var u=this.polygonPool.obtain();u.length=0;for(var p=-1,c=0,h=0,i=r.length;h<i;h+=3){var n=r[h]<<1,g=r[h+1]<<1,f=r[h+2]<<1,m=a[n],y=a[n+1],x=a[g],_=a[g+1],b=a[f],T=a[f+1],v=!1;if(p==n){var E=u.length-4,o=t.winding(u[E],u[E+1],u[E+2],u[E+3],b,T),S=t.winding(b,T,u[0],u[1],u[2],u[3]);o==c&&S==c&&(u.push(b),u.push(T),d.push(f),v=!0)}v||(0<u.length?(s.push(u),l.push(d)):(this.polygonPool.free(u),this.polygonIndicesPool.free(d)),u=this.polygonPool.obtain(),u.length=0,u.push(m),u.push(y),u.push(x),u.push(_),u.push(b),u.push(T),d=this.polygonIndicesPool.obtain(),d.length=0,d.push(n),d.push(g),d.push(f),c=t.winding(m,y,x,_,b,T),p=n)}0<u.length&&(s.push(u),l.push(d));for(var h=0,i=s.length;h<i;h++)if(d=l[h],0!=d.length){var C=d[0],P=d[d.length-1];u=s[h];for(var E=u.length-4,w=u[E],M=u[E+1],A=u[E+2],I=u[E+3],R=u[0],D=u[1],O=u[2],k=u[3],L=t.winding(w,M,A,I,R,D),N=0;N<i;N++)if(N!=h){var F=l[N];if(3==F.length){var B=F[0],U=F[1],G=F[2],V=s[N],b=V[V.length-2],T=V[V.length-1];if(B==C&&U==P){var o=t.winding(w,M,A,I,b,T),S=t.winding(b,T,R,D,O,k);o==L&&S==L&&(V.length=0,F.length=0,u.push(b),u.push(T),d.push(G),w=A,M=I,A=b,I=T,N=0)}}}}for(var h=s.length-1;0<=h;h--)u=s[h],0==u.length&&(s.splice(h,1),this.polygonPool.free(u),d=l[h],l.splice(h,1),this.polygonIndicesPool.free(d));return s},t.isConcave=function(e,t,r,a){var n=a[(t+e-1)%t]<<1,o=a[e]<<1,i=a[(e+1)%t]<<1;return!this.positiveArea(r[n],r[n+1],r[o],r[o+1],r[i],r[i+1])},t.positiveArea=function(e,t,r,a,n,o){return 0<=e*(o-a)+r*(t-o)+n*(a-t)},t.winding=function(e,t,r,a,n,o){var i=r-e,s=a-t;return 0<=n*s-o*i+i*t-e*s?1:-1},t}();e.Triangulator=t})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(t){var r;(function(t){var r=Math.pow,n=function(){function e(){this.array=[]}return e.prototype.add=function(e){var t=this.contains(e);return this.array[0|e]=0|e,!t},e.prototype.contains=function(e){return void 0!=this.array[0|e]},e.prototype.remove=function(e){this.array[0|e]=void 0},e.prototype.clear=function(){this.array.length=0},e}();t.IntSet=n;var i=function(){function e(e,t,r,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),void 0===n&&(n=0),this.r=e,this.g=t,this.b=r,this.a=n}return e.prototype.set=function(e,t,r,n){return this.r=e,this.g=t,this.b=r,this.a=n,this.clamp(),this},e.prototype.setFromColor=function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this},e.prototype.setFromString=function(e){return e='#'==e.charAt(0)?e.substr(1):e,this.r=parseInt(e.substr(0,2),16)/255,this.g=parseInt(e.substr(2,2),16)/255,this.b=parseInt(e.substr(4,2),16)/255,this.a=(8==e.length?parseInt(e.substr(6,2),16):255)/255,this},e.prototype.add=function(e,t,r,n){return this.r+=e,this.g+=t,this.b+=r,this.a+=n,this.clamp(),this},e.prototype.clamp=function(){return 0>this.r?this.r=0:1<this.r&&(this.r=1),0>this.g?this.g=0:1<this.g&&(this.g=1),0>this.b?this.b=0:1<this.b&&(this.b=1),0>this.a?this.a=0:1<this.a&&(this.a=1),this},e.WHITE=new e(1,1,1,1),e.RED=new e(1,0,0,1),e.GREEN=new e(0,1,0,1),e.BLUE=new e(0,0,1,1),e.MAGENTA=new e(1,0,1,1),e}();t.Color=i;var s=function(){function e(){}return e.clamp=function(e,t,r){return e<t?t:e>r?r:e},e.cosDeg=function(t){return u(t*e.degRad)},e.sinDeg=function(t){return l(t*e.degRad)},e.signum=function(e){return 0<e?1:0>e?-1:0},e.toInt=function(e){return 0<e?a(e):Math.ceil(e)},e.cbrt=function(e){var t=r(p(e),1/3);return 0>e?-t:t},e.randomTriangular=function(t,r){return e.randomTriangularWith(t,r,.5*(t+r))},e.randomTriangularWith=function(e,t,r){var a=Math.random(),n=t-e;return a<=(r-e)/n?e+o(a*n*(r-e)):t-o((1-a)*n*(t-r))},e.PI=3.1415927,e.PI2=2*e.PI,e.radiansToDegrees=180/e.PI,e.radDeg=e.radiansToDegrees,e.degreesToRadians=e.PI/180,e.degRad=e.degreesToRadians,e}();t.MathUtils=s;var d=function(){function e(){}return e.prototype.apply=function(e,t,r){return e+(t-e)*this.applyInternal(r)},e}();t.Interpolation=d;var h=function(e){function t(t){var r=e.call(this)||this;return r.power=2,r.power=t,r}return c(t,e),t.prototype.applyInternal=function(e){return .5>=e?r(2*e,this.power)/2:r(2*(e-1),this.power)/(0==this.power%2?-2:2)+1},t}(d);t.Pow=h;var g=function(e){function t(t){return e.call(this,t)||this}return c(t,e),t.prototype.applyInternal=function(e){return r(e-1,this.power)*(0==this.power%2?-1:1)+1},t}(h);t.PowOut=g;var f=function(){function t(){}return t.arrayCopy=function(e,t,r,a,n){for(var o=t,i=a;o<t+n;o++,i++)r[i]=e[o]},t.setArraySize=function(e,t,r){void 0===r&&(r=0);var a=e.length;if(a==t)return e;if(e.length=t,a<t)for(var n=a;n<t;n++)e[n]=r;return e},t.ensureArrayCapacity=function(e,r,a){return void 0===a&&(a=0),e.length>=r?e:t.setArraySize(e,r,a)},t.newArray=function(e,t){for(var r=Array(e),a=0;a<e;a++)r[a]=t;return r},t.newFloatArray=function(e){if(t.SUPPORTS_TYPED_ARRAYS)return new Float32Array(e);for(var r=Array(e),a=0;a<r.length;a++)r[a]=0;return r},t.newShortArray=function(e){if(t.SUPPORTS_TYPED_ARRAYS)return new Int16Array(e);for(var r=Array(e),a=0;a<r.length;a++)r[a]=0;return r},t.toFloatArray=function(e){return t.SUPPORTS_TYPED_ARRAYS?new Float32Array(e):e},t.toSinglePrecision=function(r){return t.SUPPORTS_TYPED_ARRAYS?e(r):r},t.SUPPORTS_TYPED_ARRAYS='undefined'!=typeof Float32Array,t}();t.Utils=f;var m=function(){function e(){}return e.logBones=function(e){for(var t=0;t<e.bones.length;t++){var r=e.bones[t],a=r.matrix;console.log(r.data.name+', '+a.a+', '+a.b+', '+a.c+', '+a.d+', '+a.tx+', '+a.ty)}},e}();t.DebugUtils=m;var y=function(){function e(e){this.items=[],this.instantiator=e}return e.prototype.obtain=function(){return 0<this.items.length?this.items.pop():this.instantiator()},e.prototype.free=function(e){e.reset&&e.reset(),this.items.push(e)},e.prototype.freeAll=function(e){for(var t=0;t<e.length;t++)e[t].reset&&e[t].reset(),this.items[t]=e[t]},e.prototype.clear=function(){this.items.length=0},e}();t.Pool=y;var x=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.x=e,this.y=t}return e.prototype.set=function(e,t){return this.x=e,this.y=t,this},e.prototype.length=function(){var e=this.x,t=this.y;return o(e*e+t*t)},e.prototype.normalize=function(){var e=this.length();return 0!=e&&(this.x/=e,this.y/=e),this},e}();t.Vector2=x;var _=function(){function e(){this.maxDelta=.064,this.framesPerSecond=0,this.delta=0,this.totalTime=0,this.lastTime=Date.now()/1e3,this.frameCount=0,this.frameTime=0}return e.prototype.update=function(){var e=Date.now()/1e3;this.delta=e-this.lastTime,this.frameTime+=this.delta,this.totalTime+=this.delta,this.delta>this.maxDelta&&(this.delta=this.maxDelta),this.lastTime=e,this.frameCount++,1<this.frameTime&&(this.framesPerSecond=this.frameCount/this.frameTime,this.frameTime=0,this.frameCount=0)},e}();t.TimeKeeper=_;var b=function(){function e(e){void 0===e&&(e=32),this.addedValues=0,this.lastValue=0,this.mean=0,this.dirty=!0,this.values=Array(e)}return e.prototype.hasEnoughData=function(){return this.addedValues>=this.values.length},e.prototype.addValue=function(e){this.addedValues<this.values.length&&this.addedValues++,this.values[this.lastValue++]=e,this.lastValue>this.values.length-1&&(this.lastValue=0),this.dirty=!0},e.prototype.getMean=function(){if(this.hasEnoughData()){if(this.dirty){for(var e=0,t=0;t<this.values.length;t++)e+=this.values[t];this.mean=e/this.values.length,this.dirty=!1}return this.mean}return 0},e}();t.WindowedMean=b})(r=t.core||(t.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t=function(){return function(e){if(null==e)throw new Error('name cannot be null.');this.name=e}}();e.Attachment=t;var r=function(e){function t(r){var a=e.call(this,r)||this;return a.id=(65535&t.nextID++)<<11,a.worldVerticesLength=0,a}return c(t,e),t.prototype.computeWorldVerticesOld=function(e,t){this.computeWorldVertices(e,0,this.worldVerticesLength,t,0,2)},t.prototype.computeWorldVertices=function(e,t,r,o,s,l){r=s+(r>>1)*l;var u=e.bone.skeleton,p=e.attachmentVertices,h=this.vertices,g=this.bones;if(null==g){0<p.length&&(h=p);for(var m=e.bone.matrix,_=m.tx,x=m.ty,y=m.a,a=m.c,b=m.b,c=m.d,d=t,T=s;T<r;d+=2,T+=l){var E=h[d],S=h[d+1];o[T]=E*y+S*a+_,o[T+1]=E*b+S*c+x}return}for(var C=0,v=0,P=0,i;P<t;P+=2)i=g[C],C+=i+1,v+=i;var n=u.bones;if(0==p.length)for(var T=s,a=3*v;T<r;T+=l){var w=0,M=0,i=g[C++];for(i+=C;C<i;C++,a+=3){var m=n[g[C]].matrix,E=h[a],S=h[a+1],A=h[a+2];w+=(E*m.a+S*m.c+m.tx)*A,M+=(E*m.b+S*m.d+m.ty)*A}o[T]=w,o[T+1]=M}else for(var I=p,T=s,a=3*v,R=v<<1;T<r;T+=l){var w=0,M=0,i=g[C++];for(i+=C;C<i;C++,a+=3,R+=2){var m=n[g[C]].matrix,E=h[a]+I[R],S=h[a+1]+I[R+1],A=h[a+2];w+=(E*m.a+S*m.c+m.tx)*A,M+=(E*m.b+S*m.d+m.ty)*A}o[T]=w,o[T+1]=M}},t.prototype.applyDeform=function(e){return this==e},t.nextID=0,t}(t);e.VertexAttachment=r})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t;(function(e){e[e.Region=0]='Region',e[e.BoundingBox=1]='BoundingBox',e[e.Mesh=2]='Mesh',e[e.LinkedMesh=3]='LinkedMesh',e[e.Path=4]='Path',e[e.Point=5]='Point'})(t=e.AttachmentType||(e.AttachmentType={}))})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t=function(t){function r(r){var a=t.call(this,r)||this;return a.color=new e.Color(1,1,1,1),a}return c(r,t),r}(e.VertexAttachment);e.BoundingBoxAttachment=t})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t=function(t){function r(r){var a=t.call(this,r)||this;return a.color=new e.Color(.2275,.2275,.8078,1),a}return c(r,t),r}(e.VertexAttachment);e.ClippingAttachment=t})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t=function(t){function r(r){var a=t.call(this,r)||this;return a.color=new e.Color(1,1,1,1),a.inheritDeform=!1,a.tempColor=new e.Color(0,0,0,0),a}return c(r,t),r.prototype.updateUVs=function(t,a){var o=this.regionUVs,s=o.length;if(a&&a.length==s||(a=e.Utils.newFloatArray(s)),null!=t){for(var n=t.texture,l=n._uvs,r=t.width,d=t.height,p=t.originalWidth,c=t.originalHeight,h=t.offsetX,g=t.pixiOffsetY,f=0;f<s;f+=2){var i=this.regionUVs[f],u=this.regionUVs[f+1];i=(i*p-h)/r,u=(u*c-g)/d,a[f]=(l.x0*(1-i)+l.x1*i)*(1-u)+(l.x3*(1-i)+l.x2*i)*u,a[f+1]=(l.y0*(1-i)+l.y1*i)*(1-u)+(l.y3*(1-i)+l.y2*i)*u}return a}},r.prototype.applyDeform=function(e){return this==e||this.inheritDeform&&this.parentMesh==e},r.prototype.getParentMesh=function(){return this.parentMesh},r.prototype.setParentMesh=function(e){this.parentMesh=e,null!=e&&(this.bones=e.bones,this.vertices=e.vertices,this.worldVerticesLength=e.worldVerticesLength,this.regionUVs=e.regionUVs,this.triangles=e.triangles,this.hullLength=e.hullLength,this.worldVerticesLength=e.worldVerticesLength)},r}(e.VertexAttachment);e.MeshAttachment=t})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t=function(t){function r(r){var a=t.call(this,r)||this;return a.closed=!1,a.constantSpeed=!1,a.color=new e.Color(1,1,1,1),a}return c(r,t),r}(e.VertexAttachment);e.PathAttachment=t})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t=function(t){function r(r){var a=t.call(this,r)||this;return a.color=new e.Color(.38,.94,0,1),a}return c(r,t),r.prototype.computeWorldPosition=function(e,t){var r=e.matrix;return t.x=this.x*r.a+this.y*r.c+e.worldX,t.y=this.x*r.b+this.y*r.d+e.worldY,t},r.prototype.computeWorldRotation=function(t){var r=t.matrix,a=e.MathUtils.cosDeg(this.rotation),n=e.MathUtils.sinDeg(this.rotation),o=a*r.a+n*r.c,i=a*r.b+n*r.d;return h(i,o)*e.MathUtils.radDeg},r}(e.VertexAttachment);e.PointAttachment=t})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t=function(t){function r(r){var a=t.call(this,r)||this;return a.x=0,a.y=0,a.scaleX=1,a.scaleY=1,a.rotation=0,a.width=0,a.height=0,a.color=new e.Color(1,1,1,1),a.offset=e.Utils.newFloatArray(8),a.uvs=e.Utils.newFloatArray(8),a.tempColor=new e.Color(1,1,1,1),a}return c(r,t),r.prototype.updateOffset=function(){var e=this.width/this.region.originalWidth*this.scaleX,t=this.height/this.region.originalHeight*this.scaleY,a=-this.width/2*this.scaleX+this.region.offsetX*e,n=-this.height/2*this.scaleY+this.region.offsetY*t,o=a+this.region.width*e,i=n+this.region.height*t,s=this.rotation*d/180,p=u(s),c=l(s),h=a*p+this.x,g=a*c,f=n*p+this.y,m=n*c,y=o*p+this.x,x=o*c,_=i*p+this.y,b=i*c,T=this.offset;T[r.OX1]=h-m,T[r.OY1]=f+g,T[r.OX2]=h-b,T[r.OY2]=_+g,T[r.OX3]=y-b,T[r.OY3]=_+x,T[r.OX4]=y-m,T[r.OY4]=f+x},r.prototype.setRegion=function(e){this.region=e;var t=this.uvs;e.rotate?(t[2]=e.u,t[3]=e.v2,t[4]=e.u,t[5]=e.v,t[6]=e.u2,t[7]=e.v,t[0]=e.u2,t[1]=e.v2):(t[0]=e.u,t[1]=e.v2,t[2]=e.u,t[3]=e.v,t[4]=e.u2,t[5]=e.v,t[6]=e.u2,t[7]=e.v2)},r.prototype.computeWorldVertices=function(e,t,n,o){var i=this.offset,s=e.matrix,l=s.tx,u=s.ty,p=s.a,a=s.c,h=s.b,c=s.d,d=0,g=0;d=i[r.OX1],g=i[r.OY1],t[n]=d*p+g*a+l,t[n+1]=d*h+g*c+u,n+=o,d=i[r.OX2],g=i[r.OY2],t[n]=d*p+g*a+l,t[n+1]=d*h+g*c+u,n+=o,d=i[r.OX3],g=i[r.OY3],t[n]=d*p+g*a+l,t[n+1]=d*h+g*c+u,n+=o,d=i[r.OX4],g=i[r.OY4],t[n]=d*p+g*a+l,t[n+1]=d*h+g*c+u},r.OX1=0,r.OY1=1,r.OX2=2,r.OY2=3,r.OX3=4,r.OY3=5,r.OX4=6,r.OY4=7,r.X1=0,r.Y1=1,r.C1R=2,r.C1G=3,r.C1B=4,r.C1A=5,r.U1=6,r.V1=7,r.X2=8,r.Y2=9,r.C2R=10,r.C2G=11,r.C2B=12,r.C2A=13,r.U2=14,r.V2=15,r.X3=16,r.Y3=17,r.C3R=18,r.C3G=19,r.C3B=20,r.C3A=21,r.U3=22,r.V3=23,r.X4=24,r.Y4=25,r.C4R=26,r.C4G=27,r.C4B=28,r.C4A=29,r.U4=30,r.V4=31,r}(e.Attachment);e.RegionAttachment=t})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t=function(){function t(e,t){this.jitterX=0,this.jitterY=0,this.jitterX=e,this.jitterY=t}return t.prototype.begin=function(){},t.prototype.transform=function(t){t.x+=e.MathUtils.randomTriangular(-this.jitterX,this.jitterY),t.y+=e.MathUtils.randomTriangular(-this.jitterX,this.jitterY)},t.prototype.end=function(){},t}();e.JitterEffect=t})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){var t;(function(e){var t=function(){function t(e){this.centerX=0,this.centerY=0,this.radius=0,this.angle=0,this.worldX=0,this.worldY=0,this.radius=e}return t.prototype.begin=function(e){this.worldX=e.x+this.centerX,this.worldY=e.y+this.centerY},t.prototype.transform=function(r){var a=this.angle*e.MathUtils.degreesToRadians,n=r.x-this.worldX,i=r.y-this.worldY,s=o(n*n+i*i);if(s<this.radius){var d=t.interpolation.apply(0,a,(this.radius-s)/this.radius),p=u(d),c=l(d);r.x=p*n-c*i+this.worldX,r.y=c*n+p*i+this.worldY}},t.prototype.end=function(){},t.interpolation=new e.PowOut(2),t}();e.SwirlEffect=t})(t=e.core||(e.core={}))})(g||(g={}));var g;(function(e){function t(e){return e.type===PIXI.loaders.Resource.TYPE.JSON}function r(){return function(r,o){if(!r.data||!t(r)||!r.data.bones)return o();var i=r.metadata||{},s=i?r.metadata.spineSkeletonScale:null,l=i?r.metadata.spineAtlas:null;if(!1===l)return o();if(l&&l.pages){var d=new e.core.SkeletonJson(new e.core.AtlasAttachmentLoader(l)),u=d.readSkeletonData(r.data);return r.spineData=u,r.spineAtlas=l,o()}var p=i.spineAtlasSuffix||'.atlas',c=r.url.substr(0,r.url.lastIndexOf('.'))+p;c=c.replace(this.baseUrl,'');var h={crossOrigin:r.crossOrigin,xhrType:PIXI.loaders.Resource.XHR_RESPONSE_TYPE.TEXT,metadata:i.spineMetadata||null,parentResource:r},g={crossOrigin:r.crossOrigin,metadata:i.imageMetadata||null,parentResource:r},f=r.url.substr(0,r.url.lastIndexOf('/')+1);f=f.replace(this.baseUrl,'');var m=i.images?n(i.images):i.image?n({default:i.image}):i.imageLoader?i.imageLoader(this,r.name+'_atlas_page_',f,g):a(this,r.name+'_atlas_page_',f,g);this.add(r.name+'_atlas',c,h,function(t){new e.core.TextureAtlas(t.xhr.responseText,m,function(t){var a=new e.core.SkeletonJson(new e.core.AtlasAttachmentLoader(t));s&&(a.scale=s),r.spineData=a.readSkeletonData(r.data),r.spineAtlas=t,o()})})}}function a(e,t,r,a){return r&&r.lastIndexOf('/')!==r.length-1&&(r+='/'),function(n,o){var i=r+n;e.add(t+n,i,a,function(e){o(e.texture.baseTexture)})}}function n(e){return function(t,r){var a=e[t]||e['default'];a&&a.baseTexture?r(a.baseTexture):r(a)}}e.atlasParser=r,e.imageLoaderAdapter=a,e.syncImageLoaderAdapter=function(e,t){return e&&e.lastIndexOf('/')!==e.length-1&&(e+='/'),function(e,r){r(PIXI.BaseTexture.fromImage(e,t))}},e.staticImageLoader=n,PIXI.loaders.Loader.addPixiMiddleware(r),PIXI.loader.use(r())})(g||(g={})),function(){e||(e=e=function(e){return function(t){return e[0]=t,e[0]}}(new Float32Array(1)))}();var g;(function(e){function t(){var e=this.parent.worldTransform,t=this.worldTransform,r=this.localTransform;t.a=r.a*e.a+r.b*e.c,t.b=r.a*e.b+r.b*e.d,t.c=r.c*e.a+r.d*e.c,t.d=r.c*e.b+r.d*e.d,t.tx=r.tx*e.a+r.ty*e.c+e.tx,t.ty=r.tx*e.b+r.ty*e.d+e.ty,this.worldAlpha=this.alpha*this.parent.worldAlpha,this._currentBounds=null}e.core.Bone.yDown=!0;var r=[0,0,0],a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.region=null,t}return c(t,e),t}(PIXI.Sprite);e.SpineSprite=a;var n=function(e){function t(t,r,a,n,o){return e.call(this,t,r,a,n,o)||this}return c(t,e),t}(PIXI.mesh.Mesh);e.SpineMesh=n;var o=function(o){function i(t){var r=o.call(this)||this;if(!t)throw new Error('The spineData param is required.');if('string'==typeof t)throw new Error('spineData param cant be string. Please use spine.Spine.fromAtlas("YOUR_RESOURCE_NAME") from now on.');r.spineData=t,r.skeleton=new e.core.Skeleton(t),r.skeleton.updateWorldTransform(),r.stateData=new e.core.AnimationStateData(t),r.state=new e.core.AnimationState(r.stateData),r.slotContainers=[],r.tempClipContainers=[];for(var a=0,i=r.skeleton.slots.length;a<i;a++){var n=r.skeleton.slots[a],s=n.attachment,l=r.newContainer();if(r.slotContainers.push(l),r.addChild(l),r.tempClipContainers.push(null),s instanceof e.core.RegionAttachment){var d=s.region.name,u=r.createSprite(n,s,d);n.currentSprite=u,n.currentSpriteName=d,l.addChild(u)}else if(s instanceof e.core.MeshAttachment){var p=r.createMesh(n,s);n.currentMesh=p,n.currentMeshName=s.name,l.addChild(p)}else if(s instanceof e.core.ClippingAttachment)r.createGraphics(n,s),l.addChild(n.clippingContainer),l.addChild(n.currentGraphics);else continue}return r.autoUpdate=!0,r.tintRgb=new Float32Array([1,1,1]),r}return c(i,o),Object.defineProperty(i.prototype,'autoUpdate',{get:function(){return this.updateTransform===i.prototype.autoUpdateTransform},set:function(e){this.updateTransform=e?i.prototype.autoUpdateTransform:PIXI.Container.prototype.updateTransform},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,'tint',{get:function(){return PIXI.utils.rgb2hex(this.tintRgb)},set:function(e){this.tintRgb=PIXI.utils.hex2rgb(e,this.tintRgb)},enumerable:!0,configurable:!0}),i.prototype.update=function(a){this.state.update(a),this.state.apply(this.skeleton),this.skeleton.updateWorldTransform();var o=this.skeleton.slots,s=this.color,l=null,d=null;s?(l=s.light,d=s.dark):l=this.tintRgb;for(var u=PIXI.TransformBase&&1==this.transformHack(),p=0,i=o.length;p<i;p++){var n=o[p],h=n.attachment,g=this.slotContainers[p];if(!h){g.visible=!1;continue}var f=null,m=h.color;if(h instanceof e.core.RegionAttachment){var y=h.region;if(y){n.currentMesh&&(n.currentMesh.visible=!1,n.currentMesh=null,n.currentMeshName=void 0);var x=y;if(!n.currentSpriteName||n.currentSpriteName!==x.name){var _=x.name;if(n.currentSprite&&(n.currentSprite.visible=!1),n.sprites=n.sprites||{},void 0!==n.sprites[_])n.sprites[_].visible=!0;else{var b=this.createSprite(n,h,_);g.addChild(b)}n.currentSprite=n.sprites[_],n.currentSpriteName=_}}if(g.transform){var T=g.transform,v=T,E=null;v.matrix2d?(E=v.matrix2d,v._dirtyVersion++,v.version=v._dirtyVersion,v.isStatic=!0,v.operMode=0):u?(v.position&&(T=new PIXI.TransformBase,g.transform=T),E=T.localTransform):v.setFromMatrix(n.bone.matrix),E&&n.bone.matrix.copy(E)}else{var E=g.localTransform||new PIXI.Matrix;n.bone.matrix.copy(E),g.localTransform=E,g.displayObjectUpdateTransform=t}n.currentSprite.color?f=n.currentSprite.color:(r[0]=l[0]*n.color.r*m.r,r[1]=l[1]*n.color.g*m.g,r[2]=l[2]*n.color.b*m.b,n.currentSprite.tint=PIXI.utils.rgb2hex(r)),n.currentSprite.blendMode=n.blendMode}else if(h instanceof e.core.MeshAttachment){if(n.currentSprite&&(n.currentSprite.visible=!1,n.currentSprite=null,n.currentSpriteName=void 0,g.transform?g.transform=new PIXI.TransformStatic:(g.localTransform=new PIXI.Matrix,g.displayObjectUpdateTransform=PIXI.DisplayObject.prototype.updateTransform)),!n.currentMeshName||n.currentMeshName!==h.name){var S=h.name;if(n.currentMesh&&(n.currentMesh.visible=!1),n.meshes=n.meshes||{},void 0!==n.meshes[S])n.meshes[S].visible=!0;else{var C=this.createMesh(n,h);g.addChild(C)}n.currentMesh=n.meshes[S],n.currentMeshName=S}if(h.computeWorldVerticesOld(n,n.currentMesh.vertices),n.currentMesh.color)f=n.currentMesh.color;else if('3'!==PIXI.VERSION[0]){var P=n.currentMesh.tintRgb;P[0]=l[0]*n.color.r*m.r,P[1]=l[1]*n.color.g*m.g,P[2]=l[2]*n.color.b*m.b}n.currentMesh.blendMode=n.blendMode}else if(h instanceof e.core.ClippingAttachment)n.currentGraphics||(this.createGraphics(n,h),g.addChild(n.clippingContainer),g.addChild(n.currentGraphics)),this.updateGraphics(n,h);else{g.visible=!1;continue}if(g.visible=!0,f){var w=n.color.r*m.r,M=n.color.g*m.g,A=n.color.b*m.b;f.setLight(l[0]*w+d[0]*(1-w),l[1]*M+d[1]*(1-M),l[2]*A+d[2]*(1-A)),n.darkColor?(w=n.darkColor.r,M=n.darkColor.g,A=n.darkColor.b):(w=0,M=0,A=0),f.setDark(l[0]*w+d[0]*(1-w),l[1]*M+d[1]*(1-M),l[2]*A+d[2]*(1-A))}g.alpha=n.color.a}for(var I=this.skeleton.drawOrder,R=null,D=null,p=0,i=I.length;p<i;p++){var n=o[I[p].data.index],g=this.slotContainers[I[p].data.index];if(D||g.parent===this||(g.parent.removeChild(g),g.parent=this),n.currentGraphics&&n.attachment)D=n.clippingContainer,R=n.attachment,D.children.length=0,this.children[p]=g,R.endSlot==n.data&&(R.endSlot=null);else if(D){var O=this.tempClipContainers[p];O||(O=this.tempClipContainers[p]=this.newContainer(),O.visible=!1),this.children[p]=O,g.parent=null,D.addChild(g),R.endSlot==n.data&&(D.renderable=!0,D=null,R=null)}else this.children[p]=g}},i.prototype.setSpriteRegion=function(e,t,r){t.region=r,t.texture=r.texture,r.size?(t.scale.x=r.size.width/r.originalWidth,t.scale.y=-r.size.height/r.originalHeight):(t.scale.x=e.scaleX*e.width/r.originalWidth,t.scale.y=-e.scaleY*e.height/r.originalHeight)},i.prototype.setMeshRegion=function(e,t,r){t.region=r,t.texture=r.texture,r.texture._updateUvs(),e.updateUVs(r,t.uvs),t.dirty++},i.prototype.autoUpdateTransform=function(){if(i.globalAutoUpdate){this.lastTime=this.lastTime||Date.now();var e=.001*(Date.now()-this.lastTime);this.lastTime=Date.now(),this.update(e)}else this.lastTime=0;PIXI.Container.prototype.updateTransform.call(this)},i.prototype.createSprite=function(t,r,a){var n=r.region;t.tempAttachment===r&&(n=t.tempRegion,t.tempAttachment=null,t.tempRegion=null);var o=n.texture,i=this.newSprite(o);return i.rotation=r.rotation*e.core.MathUtils.degRad,i.anchor.x=.5,i.anchor.y=.5,i.position.x=r.x,i.position.y=r.y,i.alpha=r.color.a,i.region=r.region,this.setSpriteRegion(r,i,r.region),t.sprites=t.sprites||{},t.sprites[a]=i,i},i.prototype.createMesh=function(e,t){var r=t.region;e.tempAttachment===t&&(r=e.tempRegion,e.tempAttachment=null,e.tempRegion=null);var a=this.newMesh(r.texture,new Float32Array(t.regionUVs.length),new Float32Array(t.regionUVs.length),new Uint16Array(t.triangles),PIXI.mesh.Mesh.DRAW_MODES.TRIANGLES);return a.canvasPadding=1.5,a.alpha=t.color.a,a.region=t.region,this.setMeshRegion(t,a,r),e.meshes=e.meshes||{},e.meshes[t.name]=a,a},(i.prototype.createGraphics=function(e){var t=this.newGraphics(),r=new PIXI.Polygon([]);return t.clear(),t.beginFill(16777215,1),t.drawPolygon(r),t.renderable=!1,e.currentGraphics=t,e.clippingContainer=this.newContainer(),e.clippingContainer.mask=e.currentGraphics,t},i.prototype.updateGraphics=function(e,t){var r=e.currentGraphics.graphicsData[0].shape.points,a=t.worldVerticesLength;r.length=a,t.computeWorldVertices(e,0,a,r,0,2),e.currentGraphics.dirty++,e.currentGraphics.clearDirty++},i.prototype.hackTextureBySlotIndex=function(t,r,a){void 0===r&&(r=null),void 0===a&&(a=null);var n=this.skeleton.slots[t];if(!n)return!1;var o=n.attachment,i=o.region;return r&&(i=new e.core.TextureRegion,i.texture=r,i.size=a),n.currentSprite&&n.currentSprite.region!=i?(this.setSpriteRegion(o,n.currentSprite,i),n.currentSprite.region=i):n.currentMesh&&n.currentMesh.region!=i?this.setMeshRegion(o,n.currentMesh,i):(n.tempRegion=i,n.tempAttachment=o),!0},i.prototype.hackTextureBySlotName=function(e,t,r){void 0===t&&(t=null),void 0===r&&(r=null);var a=this.skeleton.findSlotIndex(e);return-1!=a&&this.hackTextureBySlotIndex(a,t,r)},i.prototype.newContainer=function(){return new PIXI.Container},i.prototype.newSprite=function(e){return new a(e)},i.prototype.newGraphics=function(){return new PIXI.Graphics},i.prototype.newMesh=function(e,t,r,a,o){return new n(e,t,r,a,o)},i.prototype.transformHack=function(){return 1},i.globalAutoUpdate=!0,i.clippingPolygon=[],i)}(PIXI.Container);e.Spine=o})(g||(g={})),PIXI.spine=g},function(e,t,r){'use strict';var a=Math.ceil,n=Math.abs,o=Math.round;Object.defineProperty(t,'__esModule',{value:!0});const i=r(30),s=r(10),l=255,d=65535;class u{constructor(e){if(this.nrows=0,this.ncols=0,this.width=0,this.height=0,this.invalidCellIdx=l,this.cellsize=e.cellsize,e.nrows&&e.ncols)this.nrows=e.nrows,this.ncols=e.ncols,this.deriveTerraDimensions();else if(e.width&&e.height)this.width=e.width,this.height=e.height,this.deriveGridSize();else throw new Error('Incomplete TerraGridSpec');e.walls?this.walls=new i.GridBit(this.nrows,this.ncols,e.walls):(this.walls=new i.GridBit(this.nrows,this.ncols),this.walls.fill(0));let t;256>this.nrows*this.ncols?(t='uint8',this.invalidCellIdx=l):65536>this.nrows*this.ncols?(t='uint16',this.invalidCellIdx=d):s.Log.assert(!1,'Too big grid size'),this.fwdPointers=new i.Grid(this.nrows,this.ncols,{type:t}),this.fwdPointers.fill(this.invalidCellIdx),this.rvsPointers=new i.Grid(this.nrows,this.ncols,{type:t}),this.rvsPointers.fill(this.invalidCellIdx),this.fwdDistance=new i.Grid(this.nrows,this.ncols,{type:'uint8'}),this.fwdDistance.fill(0),this.rvsDistance=new i.Grid(this.nrows,this.ncols,{type:'uint8'}),this.rvsDistance.fill(0)}setPathEndPoints(e,t){this.source=e,this.target=t}updatePointers(){!this.target||!this.source?console.assert(!1):(this.doBFSAnalysis(this.target,this.fwdPointers,this.fwdDistance),this.doBFSAnalysis(this.source,this.rvsPointers,this.rvsDistance))}findNeighborClosestToTarget(e,t){let r=t?this.fwdDistance:this.rvsDistance,a=null,n=Infinity;for(let o of this.getNeighbors(e)){let e=r.get(o[0],o[1]);e<n&&!this.isWallAt(o)&&(a=o,n=e)}if(a)return a;throw new Error('No free neighbor for wall')}getDistanceAt(e,t){let r=t?this.fwdDistance:this.rvsDistance;return r.get(e[0],e[1])}nextCell(e,t){if(this.isWallAt(e))return this.findNeighborClosestToTarget(e,t);if(t){let t=this.fwdPointers.get(e[0],e[1]);if(t===this.invalidCellIdx)throw new Error('No fwd pointer');else return this.indexToCoord(t)}else{let t=this.rvsPointers.get(e[0],e[1]);if(t===this.invalidCellIdx)throw new Error('No rvs pointer');else return this.indexToCoord(t)}}coordToIndex(e,t){let[r,a]=this.coord(e,t);return r*this.ncols+a}indexToCoord(e){return[Math.floor(e/this.ncols),e%this.ncols]}doBFSAnalysis(e,t,r){let a=[],n=this.coordToIndex(e);for(t.fill(this.invalidCellIdx),r.fill(0),a.push(e),t.set(e[0],e[1],n);a.length;){let e=a.shift(),n=this.coordToIndex(e);for(let o of this.getNeighbors(e[0],e[1]))t.get(o[0],o[1])===this.invalidCellIdx&&(this.isWallAt(o[0],o[1])||(a.push(o),t.set(o[0],o[1],n),r.set(o[0],o[1],r.get(e[0],e[1])+1)))}}searchForwardPath(){if(this.target){let e=[this.target],t=this.target,r=this.coordToIndex(t);for(;this.rvsPointers.get(t[0],t[1])!==r;)r=this.rvsPointers.get(t[0],t[1]),t=this.indexToCoord(r),e.unshift(t);return e}throw new Error('Target unspecified')}pathExists(e,t){let r=this.searchOneToOnePath(e,t);return 0<r.length}reconstructPath(e,t){let r=[e],a=e;for(;t.get(a[0],a[1]);)a=t.get(a[0],a[1]),r.unshift(a);return r}searchOneToOnePath(e,t,r='a*'){let a=[],n=[],o;256>this.nrows*this.ncols?(o='uint8',this.invalidCellIdx=l):65536>this.nrows*this.ncols?(o='uint16',this.invalidCellIdx=d):s.Log.assert(!1,'Too big grid size');let u=new i.Grid(this.nrows,this.ncols,{type:o}),p=new i.Grid(this.nrows,this.ncols,{type:o}),c=new i.GridAny(this.nrows,this.ncols);if('a*'===r)a=[e];else if('dijkstra'===r)for(let e=0;e<this.nrows;e++)for(let t=0;t<this.ncols;t++)a.push([e,t]);let h=()=>{let e=-1,t=Infinity;for(let r=0;r<a.length;r++){let[n,o]=a[r],i=u.get(n,o)+p.get(n,o);i<t&&(t=i,e=r)}return 0>e&&(e=0),a.splice(e,1)[0]},f=(e)=>{let[t,r]=e;for(let n=0;n<a.length;n++)if(a[n][0]===t&&a[n][1]===r)return!0;return!1},m=(e)=>{let[t,r]=e;for(let a=0;a<n.length;a++)if(n[a][0]===t&&n[a][1]===r)return!0;return!1};for(u.set(e[0],e[1],0),p.set(e[0],e[1],this.heuristic(e,t));0<a.length;){let e=h();if(e[0]===t[0]&&e[1]===t[1])return this.reconstructPath(t,c);n.push(e);let o=this.getNeighbors(e[0],e[1]);for(let n of o){let[o,i]=n;if(this.isWallAt(o,i))continue;if(m(n))continue;f(n)||a.push(n);let s=u.get(e[0],e[1])+this.distanceManhattan(e,n);s>u.get(n[0],n[1])||(c.set(n[0],n[1],e),u.set(n[0],n[1],s),'dijkstra'===r?p.set(n[0],n[1],0):'a*'===r?p.set(n[0],n[1],this.heuristic(n,t)):console.assert(!1))}}return[]}heuristic(e,t){return this.distanceManhattan(e,t)}distanceManhattan(e,t){return n(e[0]-t[0])+n(e[1]-t[1])}clone(){return new u({nrows:this.nrows,ncols:this.ncols,cellsize:this.cellsize,walls:this.walls.data,resolvable:!1})}deriveGridSize(){this.ncols=a(this.width/this.cellsize),this.nrows=a(this.height/this.cellsize)}deriveTerraDimensions(){this.width=this.ncols*this.cellsize,this.height=this.nrows*this.cellsize}getCellCenter(e,t){let[r,a]=this.coord(e,t);return[this.cellsize/2+a*this.cellsize,this.cellsize/2+r*this.cellsize]}getCellCorners(e,t){let[r,a]=this.coord(e,t),[n,o]=this.getCellCenter(r,a);return[[n-this.cellsize/2,o-this.cellsize/2],[n-this.cellsize/2,o+this.cellsize/2],[n+this.cellsize/2,o+this.cellsize/2],[n+this.cellsize/2,o-this.cellsize/2]]}coord(e,t){return Array.isArray(e)?e:[e,t||0]}resolveCell(e,t){let[r,a]=this.coord(e,t),n=this.cellsize;return[o((a-n/2)/n),o((r-n/2)/n)]}isValidCell(e,t){let[r,a]=this.coord(e,t);return 0<=r&&r<this.nrows&&0<=a&&a<this.ncols}isWallAt(e,t){let[r,a]=this.coord(e,t);return 1===this.walls.get(r,a)}setWallAt(e,t){let[r,a]=this.coord(e,t);this.walls.set(r,a,1)}removeWallAt(e,t){let[r,a]=this.coord(e,t);this.walls.set(r,a,0)}getNeighbors(e,t){let[r,a]=this.coord(e,t),n=[];return this.isValidCell(r,a-1)&&n.push([r,a-1]),this.isValidCell(r,a+1)&&n.push([r,a+1]),this.isValidCell(r+1,a)&&n.push([r+1,a]),this.isValidCell(r-1,a)&&n.push([r-1,a]),!this.isValidCell(r-1,a-1)||this.isWallAt(r,a-1)||this.isWallAt(r-1,a)||n.push([r-1,a-1]),!this.isValidCell(r+1,a+1)||this.isWallAt(r,a+1)||this.isWallAt(r+1,a)||n.push([r+1,a+1]),!this.isValidCell(r+1,a-1)||this.isWallAt(r,a-1)||this.isWallAt(r+1,a)||n.push([r+1,a-1]),!this.isValidCell(r-1,a+1)||this.isWallAt(r-1,a)||this.isWallAt(r,a+1)||n.push([r-1,a+1]),n}forEachCell(e){for(let t=0;t<this.nrows;t++)for(let r=0;r<this.ncols;r++)this.isValidCell([t,r])&&e(t,r)}numFreeCells(){let e=0;for(let t=0;t<this.nrows;t++)for(let r=0;r<this.ncols;r++)this.isWallAt(t,r)||e++;return e}cornersForEachCell(e){for(let t=0;t<this.nrows;t++)for(let r=0;r<this.ncols;r++)this.isValidCell([t,r])&&e(this.getCellCorners(t,r),t,r)}}t.RectTerraLean=u;class p{constructor(e){if(this.nrows=0,this.ncols=0,this.width=0,this.height=0,this._cellsize=e.cellsize,this.areWeightsDirty=!0,e.nrows&&e.ncols)this.nrows=e.nrows,this.ncols=e.ncols,this.deriveTerraDimensions();else if(e.width&&e.height)this.width=e.width,this.height=e.height,this.deriveGridSize();else throw new Error('Incomplete TerraGridSpec');this.weightGrid=new i.Grid(this.nrows,this.ncols,{data:e.walls}),e.walls||this.weightGrid.fill(1),e.resolvable&&this.indexForCellResolution(),this.bfsData={}}indexForCellResolution(){console.warn('Not supported')}get cellsize(){return this._cellsize}forEachCell(e){for(let t=0;t<this.nrows;t++)for(let r=0;r<this.ncols;r++)this.isValidCell([t,r])&&e(t,r)}getCellDebugInfo(e,t){let[r,a]=this.coord(e,t),n={weight:this.weightGrid.get(r,a),bfsData:{}};for(let o in this.bfsData)n.bfsData[o]='from '+this.bfsData[o].camefromGrid.get(r,a)+' d '+this.bfsData[o].distanceGrid.get(r,a);return JSON.stringify(n)}cornersForEachCell(e){for(let t=0;t<this.nrows;t++)for(let r=0;r<this.ncols;r++)this.isValidCell([t,r])&&e(this.getCellCorners(t,r),t,r)}setWeight(e,t,r){this.weightGrid.set(e,t,r)}getWeight(e,t){let[r,a]=this.coord(e,t);return this.weightGrid.get(r,a)}numFreeCells(){let e=0;for(let t=0;t<this.nrows;t++)for(let r=0;r<this.ncols;r++)this.isWallAt(t,r)||e++;return e}coord(e,t){return Array.isArray(e)?e:[e,t||0]}allocateGrids(e='a*',t){'a*'===e||'dijkstra'===e?(!this.gCostGrid&&(this.gCostGrid=new i.Grid(this.nrows,this.ncols)),!this.hCostGrid&&(this.hCostGrid=new i.Grid(this.nrows,this.ncols)),!this.camefromGrid&&(this.camefromGrid=new i.GridAny(this.nrows,this.ncols))):'bfs'===e?(console.assert(t!==void 0),!this.bfsData[t]&&(this.bfsData[t]={camefromGrid:new i.GridAny(this.nrows,this.ncols),distanceGrid:new i.Grid(this.nrows,this.ncols)})):console.assert(!1)}hasBFSDataForTarget(e){let[t,r]=e,a=this.generateCellKey(t,r);return this.bfsData[a]!==void 0}doBFSAnalysis(e){let[t,r]=e,a=this.generateCellKey(t,r);this.allocateGrids('bfs',a);let n=[],{camefromGrid:o,distanceGrid:i}=this.bfsData[a];for(o.fill(0),i.fill(0),o.set(t,r,null),n.push(e);n.length;){let e=n.shift();for(let t of this.getNeighbors(e[0],e[1]))0===o.get(t[0],t[1])&&(this.isWallAt(t[0],t[1])||(n.push(t),o.set(t[0],t[1],e),i.set(t[0],t[1],i.get(e[0],e[1])+1)))}this.areWeightsDirty=!1}reconstructPath(e,t){let r=[e],a=e;for(;t.get(a[0],a[1]);)a=t.get(a[0],a[1]),r.unshift(a);return r}searchOneToOnePath(e,t,r='a*'){let a=[],n=[];if('a*'===r)a=[e];else if('dijkstra'===r)for(let e=0;e<this.nrows;e++)for(let t=0;t<this.ncols;t++)a.push([e,t]);let o=()=>{let e=-1,t=Infinity;for(let r=0;r<a.length;r++){let[n,o]=a[r],i=this.gCostGrid.get(n,o)+this.hCostGrid.get(n,o);i<t&&(t=i,e=r)}return 0>e&&(e=0),a.splice(e,1)[0]},i=(e)=>{let[t,r]=e;for(let n=0;n<a.length;n++)if(a[n][0]===t&&a[n][1]===r)return!0;return!1},s=(e)=>{let[t,r]=e;for(let a=0;a<n.length;a++)if(n[a][0]===t&&n[a][1]===r)return!0;return!1};for(this.gCostGrid.set(e[0],e[1],0),this.hCostGrid.set(e[0],e[1],this.heuristic(e,t));0<a.length;){let e=o();if(e[0]===t[0]&&e[1]===t[1])return this.reconstructPath(t,this.camefromGrid);n.push(e);let l=this.getNeighbors(e[0],e[1]);for(let n of l){let[o,l]=n;if(this.isWallAt(o,l))continue;if(s(n))continue;i(n)||a.push(n);let d=this.gCostGrid.get(e[0],e[1])+this.distanceManhattan(e,n);d>this.gCostGrid.get(n[0],n[1])||(this.camefromGrid.set(n[0],n[1],e),this.gCostGrid.set(n[0],n[1],d),'dijkstra'===r?this.hCostGrid.set(n[0],n[1],0):'a*'===r?this.hCostGrid.set(n[0],n[1],this.heuristic(n,t)):console.assert(!1))}}return[]}isValidCell(e,t){let[r,a]=this.coord(e,t);return 0<=r&&r<this.nrows&&0<=a&&a<this.ncols}isWallAt(e,t){let[r,a]=this.coord(e,t);return 0===this.weightGrid.get(r,a)}setWallAt(e,t){let[r,a]=this.coord(e,t);this.weightGrid.set(r,a,0),this.areWeightsDirty=!0}removeWallAt(e,t){let[r,a]=this.coord(e,t);this.weightGrid.set(r,a,1),this.areWeightsDirty=!0}generateCellKey(e,t){let[r,a]=this.coord(e,t);return r*this.ncols+a}searchAllToOnePath(e,t){this.areWeightsDirty&&(this.bfsData={}),this.hasBFSDataForTarget(e)||this.doBFSAnalysis(e);let r=this.generateCellKey(e[0],e[1]);return this.reconstructPath(t,this.bfsData[r].camefromGrid)}searchPath(e,t,r='bfs'){if('dijkstra'===r)return this.allocateGrids(r),this.gCostGrid.fill(Infinity),this.hCostGrid.fill(0),this.camefromGrid.fill(null),this.searchOneToOnePath(e,t,r);if('a*'===r)return this.allocateGrids(r),this.gCostGrid.fill(Infinity),this.hCostGrid.fill(0),this.camefromGrid.fill(null),this.searchOneToOnePath(e,t,r);if('bfs'===r)return this.searchAllToOnePath(e,t);throw new Error('Unknown algo:'+r)}toSVG(e=1){let t='';for(let r=0;r<this.nrows;r++)for(let a=0;a<this.ncols;a++){let n=this.getCellCorners(r,a),o=n.map((e)=>`${e[0]},${e[1]}`).join(' '),i;i=this.weightGrid.get(r,a)?'#ffffff':'#000000',t+=`<polygon points="${o}" stroke="#aaaaaa"`+` fill="${i}" fill-opacity="${e}" class="cell"`+` id="cell${r}-${a}"></polygon>`}return`<svg
      xmlns:dc="http://purl.org/dc/elements/1.1/"
      xmlns:cc="http://creativecommons.org/ns#"
      xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
      xmlns:svg="http://www.w3.org/2000/svg"
      xmlns="http://www.w3.org/2000/svg"
      xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
      xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
      version="1.1"
      width="${this.width}" height="${this.height}">
      <g id="weights" data="${this.nrows},${this.ncols}" `+`inkscape:label="Weights" inkscape:groupmode="layer">
      ${t}
      </g>
      <g id="terrain" inkscape:label="Terrain Art" inkscape:groupmode="layer">
      </g>
      <g id="structures" inkscape:label="Structures Art"
       inkscape:groupmode="layer">
      </g>
      <g id="actors" inkscape:label="Actors Art" inkscape:groupmode="layer">
      </g>
    </svg>`}}t.Terra=p},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function n(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function o(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var i=r(17),s=function(e){return e&&e.__esModule?e:{default:e}}(i),l=function(e){function t(){return a(this,t),n(this,e.apply(this,arguments))}return o(t,e),t.prototype.start=function(){},t.prototype.stop=function(){this.flush()},t.prototype.flush=function(){},t.prototype.render=function(){},t}(s.default);t.default=l},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=r(65),l=a(s),d=r(137),u=a(d),p=r(140),c=a(p),h=r(141),g=a(h),f=r(27),m=a(f),y=r(25),x=a(y),_=r(143),b=a(_),T=r(14),v=a(T),E=r(144),S=a(E),C=r(145),P=a(C),w=r(147),M=a(w),A=r(148),I=a(A),R=r(2),D=r(7),O=a(D),k=r(1),L=0,N=function(e){function t(r,a,i){n(this,t);var s=o(this,e.call(this,'WebGL',r,a,i));return s.legacy=s.options.legacy,s.legacy&&(O.default.VertexArrayObject.FORCE_NATIVE=!0),s.type=k.RENDERER_TYPE.WEBGL,s.handleContextLost=s.handleContextLost.bind(s),s.handleContextRestored=s.handleContextRestored.bind(s),s.view.addEventListener('webglcontextlost',s.handleContextLost,!1),s.view.addEventListener('webglcontextrestored',s.handleContextRestored,!1),s._contextOptions={alpha:s.transparent,antialias:s.options.antialias,premultipliedAlpha:s.transparent&&'notMultiplied'!==s.transparent,stencil:!0,preserveDrawingBuffer:s.options.preserveDrawingBuffer,powerPreference:s.options.powerPreference},s._backgroundColorRgba[3]=s.transparent?0:1,s.maskManager=new u.default(s),s.stencilManager=new c.default(s),s.emptyRenderer=new x.default(s),s.currentRenderer=s.emptyRenderer,s.textureManager=null,s.filterManager=null,s.initPlugins(),s.options.context&&(0,I.default)(s.options.context),s.gl=s.options.context||O.default.createContext(s.view,s._contextOptions),s.CONTEXT_UID=L++,s.state=new P.default(s.gl),s.renderingToScreen=!0,s.boundTextures=null,s._activeShader=null,s._activeVao=null,s._activeRenderTarget=null,s._initContext(),s.drawModes=(0,M.default)(s.gl),s._nextTextureLocation=0,s.setBlendMode(0),s}return i(t,e),t.prototype._initContext=function(){var e=this.gl;e.isContextLost()&&e.getExtension('WEBGL_lose_context')&&e.getExtension('WEBGL_lose_context').restoreContext();var t=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this._activeShader=null,this._activeVao=null,this.boundTextures=Array(t),this.emptyTextures=Array(t),this.textureManager=new b.default(this),this.filterManager=new g.default(this),this.textureGC=new S.default(this),this.state.resetToDefault(),this.rootRenderTarget=new m.default(e,this.width,this.height,null,this.resolution,!0),this.rootRenderTarget.clearColor=this._backgroundColorRgba,this.bindRenderTarget(this.rootRenderTarget);var r=new O.default.GLTexture.fromData(e,null,1,1),a={_glTextures:{}};a._glTextures[this.CONTEXT_UID]={};for(var n=0,o;n<t;n++)o=new v.default,o._glTextures[this.CONTEXT_UID]=r,this.boundTextures[n]=a,this.emptyTextures[n]=o,this.bindTexture(null,n);this.emit('context',e),this.resize(this.screen.width,this.screen.height)},t.prototype.render=function(e,t,r,a,n){if(this.renderingToScreen=!t,this.emit('prerender'),this.gl&&!this.gl.isContextLost()){if(this._nextTextureLocation=0,t||(this._lastObjectRendered=e),!n){var o=e.parent;e.parent=this._tempDisplayObjectParent,e.updateTransform(),e.parent=o}this.bindRenderTexture(t,a),this.currentRenderer.start(),(void 0===r?this.clearBeforeRender:r)&&this._activeRenderTarget.clear(),e.renderWebGL(this),this.currentRenderer.flush(),this.textureGC.update(),this.emit('postrender')}},t.prototype.setObjectRenderer=function(e){this.currentRenderer===e||(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.resize=function(e,t){l.default.prototype.resize.call(this,e,t),this.rootRenderTarget.resize(e,t),this._activeRenderTarget===this.rootRenderTarget&&(this.rootRenderTarget.activate(),this._activeShader&&(this._activeShader.uniforms.projectionMatrix=this.rootRenderTarget.projectionMatrix.toArray(!0)))},t.prototype.setBlendMode=function(e){this.state.setBlendMode(e)},t.prototype.clear=function(e){this._activeRenderTarget.clear(e)},t.prototype.setTransform=function(e){this._activeRenderTarget.transform=e},t.prototype.clearRenderTexture=function(e,t){var r=e.baseTexture,a=r._glRenderTargets[this.CONTEXT_UID];return a&&a.clear(t),this},t.prototype.bindRenderTexture=function(e,t){var r;if(e){var a=e.baseTexture;a._glRenderTargets[this.CONTEXT_UID]||this.textureManager.updateTexture(a,0),this.unbindTexture(a),r=a._glRenderTargets[this.CONTEXT_UID],r.setFrame(e.frame)}else r=this.rootRenderTarget;return r.transform=t,this.bindRenderTarget(r),this},t.prototype.bindRenderTarget=function(e){return e!==this._activeRenderTarget&&(this._activeRenderTarget=e,e.activate(),this._activeShader&&(this._activeShader.uniforms.projectionMatrix=e.projectionMatrix.toArray(!0)),this.stencilManager.setMaskStack(e.stencilMaskStack)),this},t.prototype.bindShader=function(e,t){return this._activeShader!==e&&(this._activeShader=e,e.bind(),!1!==t&&(e.uniforms.projectionMatrix=this._activeRenderTarget.projectionMatrix.toArray(!0))),this},t.prototype.bindTexture=function(e,t,r){if(e=e||this.emptyTextures[t],e=e.baseTexture||e,e.touched=this.textureGC.count,!r){for(var a=0;a<this.boundTextures.length;a++)if(this.boundTextures[a]===e)return a;void 0===t&&(this._nextTextureLocation++,this._nextTextureLocation%=this.boundTextures.length,t=this.boundTextures.length-this._nextTextureLocation-1)}else t=t||0;var n=this.gl,o=e._glTextures[this.CONTEXT_UID];return o?(this.boundTextures[t]=e,n.activeTexture(n.TEXTURE0+t),n.bindTexture(n.TEXTURE_2D,o.texture)):this.textureManager.updateTexture(e,t),t},t.prototype.unbindTexture=function(e){var t=this.gl;e=e.baseTexture||e;for(var r=0;r<this.boundTextures.length;r++)this.boundTextures[r]===e&&(this.boundTextures[r]=this.emptyTextures[r],t.activeTexture(t.TEXTURE0+r),t.bindTexture(t.TEXTURE_2D,this.emptyTextures[r]._glTextures[this.CONTEXT_UID].texture));return this},t.prototype.createVao=function(){return new O.default.VertexArrayObject(this.gl,this.state.attribState)},t.prototype.bindVao=function(e){return this._activeVao===e?this:(e?e.bind():this._activeVao&&this._activeVao.unbind(),this._activeVao=e,this)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer),this.bindVao(null),this._activeShader=null,this._activeRenderTarget=this.rootRenderTarget;for(var e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.emptyTextures[e];return this.rootRenderTarget.activate(),this.state.resetToDefault(),this},t.prototype.handleContextLost=function(e){e.preventDefault()},t.prototype.handleContextRestored=function(){this.textureManager.removeAll(),this.filterManager.destroy(!0),this._initContext()},t.prototype.destroy=function(t){this.destroyPlugins(),this.view.removeEventListener('webglcontextlost',this.handleContextLost),this.view.removeEventListener('webglcontextrestored',this.handleContextRestored),this.textureManager.destroy(),e.prototype.destroy.call(this,t),this.uid=0,this.maskManager.destroy(),this.stencilManager.destroy(),this.filterManager.destroy(),this.maskManager=null,this.filterManager=null,this.textureManager=null,this.currentRenderer=null,this.handleContextLost=null,this.handleContextRestored=null,this._contextOptions=null,this.gl.useProgram(null),this.gl.getExtension('WEBGL_lose_context')&&this.gl.getExtension('WEBGL_lose_context').loseContext(),this.gl=null},t}(l.default);t.default=N,R.pluginTarget.mixin(N)},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var n=r(4),o=r(1),i=r(3),s=function(e){return e&&e.__esModule?e:{default:e}}(i),l=r(7),d=function(){function e(t,r,i,d,u,p){a(this,e),this.gl=t,this.frameBuffer=null,this.texture=null,this.clearColor=[0,0,0,0],this.size=new n.Rectangle(0,0,1,1),this.resolution=u||s.default.RESOLUTION,this.projectionMatrix=new n.Matrix,this.transform=null,this.frame=null,this.defaultFrame=new n.Rectangle,this.destinationFrame=null,this.sourceFrame=null,this.stencilBuffer=null,this.stencilMaskStack=[],this.filterData=null,this.scaleMode=void 0===d?s.default.SCALE_MODE:d,this.root=p,this.root?(this.frameBuffer=new l.GLFramebuffer(t,100,100),this.frameBuffer.framebuffer=null):(this.frameBuffer=l.GLFramebuffer.createRGBA(t,100,100),this.scaleMode===o.SCALE_MODES.NEAREST?this.frameBuffer.texture.enableNearestScaling():this.frameBuffer.texture.enableLinearScaling(),this.texture=this.frameBuffer.texture),this.setFrame(),this.resize(r,i)}return e.prototype.clear=function(e){var t=e||this.clearColor;this.frameBuffer.clear(t[0],t[1],t[2],t[3])},e.prototype.attachStencilBuffer=function(){this.root||this.frameBuffer.enableStencil()},e.prototype.setFrame=function(e,t){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=t||this.sourceFrame||this.destinationFrame},e.prototype.activate=function(){var e=this.gl;this.frameBuffer.bind(),this.calculateProjection(this.destinationFrame,this.sourceFrame),this.transform&&this.projectionMatrix.append(this.transform),this.destinationFrame===this.sourceFrame?e.disable(e.SCISSOR_TEST):(e.enable(e.SCISSOR_TEST),e.scissor(0|this.destinationFrame.x,0|this.destinationFrame.y,0|this.destinationFrame.width*this.resolution,0|this.destinationFrame.height*this.resolution)),e.viewport(0|this.destinationFrame.x,0|this.destinationFrame.y,0|this.destinationFrame.width*this.resolution,0|this.destinationFrame.height*this.resolution)},e.prototype.calculateProjection=function(e,t){var r=this.projectionMatrix;t=t||e,r.identity(),this.root?(r.a=2*(1/e.width),r.d=2*(-1/e.height),r.tx=-1-t.x*r.a,r.ty=1-t.y*r.d):(r.a=2*(1/e.width),r.d=2*(1/e.height),r.tx=-1-t.x*r.a,r.ty=-1-t.y*r.d)},e.prototype.resize=function(e,t){if(e|=0,t|=0,this.size.width!==e||this.size.height!==t){this.size.width=e,this.size.height=t,this.defaultFrame.width=e,this.defaultFrame.height=t,this.frameBuffer.resize(e*this.resolution,t*this.resolution);var r=this.frame||this.size;this.calculateProjection(r)}},e.prototype.destroy=function(){this.frameBuffer.destroy(),this.frameBuffer=null,this.texture=null},e}();t.default=d},function(e,t,r){'use strict';function a(e,t){var a=e.points;if(0!==a.length){var n=new s.Point(a[0],a[1]),d=new s.Point(a[a.length-2],a[a.length-1]);if(n.x===d.x&&n.y===d.y){a=a.slice(),a.pop(),a.pop(),d=new s.Point(a[a.length-2],a[a.length-1]);var u=d.x+.5*(n.x-d.x),p=d.y+.5*(n.y-d.y);a.unshift(u,p),a.push(u,p)}var c=t.points,h=t.indices,f=a.length/2,m=a.length,y=c.length/6,x=e.lineWidth/2,_=(0,l.hex2rgb)(e.lineColor),T=e.lineAlpha,v=_[0]*T,r=_[1]*T,g=_[2]*T,b=a[0],E=a[1],S=a[2],C=a[3],P=0,w=0,M=-(E-C),A=b-S,I=0,R=0,D=0,O=0,k=o(M*M+A*A);M/=k,A/=k,M*=x,A*=x,c.push(b-M,E-A,v,r,g,T),c.push(b+M,E+A,v,r,g,T);for(var L=1;L<f-1;++L){b=a[2*(L-1)],E=a[2*(L-1)+1],S=a[2*L],C=a[2*L+1],P=a[2*(L+1)],w=a[2*(L+1)+1],M=-(E-C),A=b-S,k=o(M*M+A*A),M/=k,A/=k,M*=x,A*=x,I=-(C-w),R=S-P,k=o(I*I+R*R),I/=k,R/=k,I*=x,R*=x;var i=-A+E-(-A+C),N=-M+S-(-M+b),F=(-M+b)*(-A+C)-(-M+S)*(-A+E),B=-R+w-(-R+C),U=-I+S-(-I+P),G=(-I+P)*(-R+C)-(-I+S)*(-R+w),V=i*U-B*N;if(.1>Math.abs(V)){V+=10.1,c.push(S-M,C-A,v,r,g,T),c.push(S+M,C+A,v,r,g,T);continue}var W=(N*G-U*F)/V,X=(B*F-i*G)/V,H=(W-S)*(W-S)+(X-C)*(X-C);H>196*x*x?(D=M-I,O=A-R,k=o(D*D+O*O),D/=k,O/=k,D*=x,O*=x,c.push(S-D,C-O),c.push(v,r,g,T),c.push(S+D,C+O),c.push(v,r,g,T),c.push(S-D,C-O),c.push(v,r,g,T),m++):(c.push(W,X),c.push(v,r,g,T),c.push(S-(W-S),C-(X-C)),c.push(v,r,g,T))}b=a[2*(f-2)],E=a[2*(f-2)+1],S=a[2*(f-1)],C=a[2*(f-1)+1],M=-(E-C),A=b-S,k=o(M*M+A*A),M/=k,A/=k,M*=x,A*=x,c.push(S-M,C-A),c.push(v,r,g,T),c.push(S+M,C+A),c.push(v,r,g,T),h.push(y);for(var Y=0;Y<m;++Y)h.push(y++);h.push(y-1)}}function n(e,t){var a=0,n=e.points;if(0!==n.length){var o=t.points,i=n.length/2,s=(0,l.hex2rgb)(e.lineColor),d=e.lineAlpha,u=s[0]*d,r=s[1]*d,p=s[2]*d;for(a=1;a<i;a++){var c=n[2*(a-1)],h=n[2*(a-1)+1],g=n[2*a],f=n[2*a+1];o.push(c,h),o.push(u,r,p,d),o.push(g,f),o.push(u,r,p,d)}}}var o=Math.sqrt;t.__esModule=!0,t.default=function(e,t,r){e.nativeLines?n(e,r):a(e,t)};var s=r(4),l=r(2)},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});const a=r(8);class n{constructor(e,t,r,a){this.duration=e,this.type=t,this.onEval=r,this.onEnd=a,this.tstart=NaN}start(e){this.tstart=e;let t=e,r=e+this.duration;switch(this.type){case n.LINEAR:this._curve=void 0;break;case n.EASEIN:this._curve=new a.CubicBezier([[t,0],[t+(r-t)/2,0],[r,1],[r,1]]);break;case n.EASEOUT:this._curve=new a.CubicBezier([[t,0],[t,0],[t+(r-t)/2,1],[r,1]]);break;case n.EASEINOUT:this._curve=new a.CubicBezier([[t,0],[t+(r-t)/2,0],[t+(r-t)/2,1],[r,1]]);break;default:throw new Error('Not implemented');}}end(){this.onEnd&&this.onEnd()}_calcParameter(e){let t=(e-this.tstart)/this.duration;switch(this.type){case n.LINEAR:return t;case n.EASEIN:return this._curve.evaluate(t)[1];case n.EASEOUT:return this._curve.evaluate(t)[1];case n.EASEINOUT:return this._curve.evaluate(t)[1];default:throw new Error('Not implemented');}}eval(e){let t=Math.min(1,Math.max(0,this._calcParameter(e)));this.onEval&&this.onEval(t)}isStarted(){return!isNaN(this.tstart)}isPastEnd(e){return e-this.tstart>this.duration}}n.LINEAR=1,n.EASEIN=2,n.EASEOUT=3,n.EASEINOUT=4,n.EASECUBIC=5,t.Animation=n},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});const a=r(10);t.GridBit=class{constructor(e,t,r){if(this.nrows=e,this.ncols=t,r)console.assert(8*r.length>=e*t),this.data=r.slice();else{let e=Math.ceil(this.nrows*this.ncols/8);this.data=new Uint8Array(e)}}get(e,t){if(0>e||e>=this.nrows||0>t||t>=this.ncols)throw new Error('Invalid index');let r=e*this.ncols+t,a=7&r,n=this.data[r>>3];return(n&1<<a)>>a}set(e,t,r){if(0>e||e>=this.nrows||0>t||t>=this.ncols)throw new Error('Invalid index');let a=e*this.ncols+t,n=a>>3,o=7&a,i=this.data[n];r?i|=1<<o:i&=~(1<<o),this.data[n]=i}fill(e){e?this.data.fill(255):this.data.fill(0)}toString(){let e=[];for(let t=0,r;t<this.nrows;t++){r='';for(let e=0;e<this.ncols;e++)r=r.concat(`${this.get(t,e)}`);e.push(r)}return e.join('\n')}};t.Grid=class{constructor(e,t,r={}){this.nrows=e,this.ncols=t,r.data?(a.Log.assert(r.data.length===e*t,'Mismatched grid size'),this.data=r.data.slice()):'uint8'===r.type?this.data=new Uint8Array(this.nrows*this.ncols):'uint16'===r.type?this.data=new Uint16Array(this.nrows*this.ncols):(this.data=new Uint8Array(0),a.Log.assert(!1,'Unknown type'))}get(e,t){return this.data[e*this.ncols+t]}set(e,t,r){this.data[e*this.ncols+t]=r}fill(e){this.data.fill(e)}forEach(e){for(let t=0;t<this.nrows;t++)for(let r=0;r<this.ncols;r++)e(t,r,this.get(t,r))}};t.GridAny=class{constructor(e,t,r){this.nrows=e,this.ncols=t,r?(console.assert(r.length===e*t),this.data=r.slice()):this.data=Array(this.nrows*this.ncols)}get(e,t){return this.data[e*this.ncols+t]}set(e,t,r){this.data[e*this.ncols+t]=r}fill(e){this.data.fill(e)}forEach(e){for(let t=0;t<this.nrows;t++)for(let r=0;r<this.ncols;r++)e(t,r,this.get(t,r))}}},function(e){var t=function(){return this}();try{t=t||Function('return this')()||(1,eval)('this')}catch(r){'object'==typeof window&&(t=window)}e.exports=t},function(e,t){'use strict';function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var a=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;r(this,e),this.x=t,this.y=a}return e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.copy=function(e){this.set(e.x,e.y)},e.prototype.equals=function(e){return e.x===this.x&&e.y===this.y},e.prototype.set=function(e,t){this.x=e||0,this.y=t||(0===t?0:this.x)},e}();t.default=a},function(e,t,r){'use strict';function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var o=Math.sin,i=Math.cos,s=Math.atan2,l=Math.sqrt,u=Math.PI;t.__esModule=!0;var a=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),d=r(32),p=function(e){return e&&e.__esModule?e:{default:e}}(d),c=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0;n(this,e),this.a=t,this.b=r,this.c=a,this.d=o,this.tx=i,this.ty=s,this.array=null}return e.prototype.fromArray=function(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]},e.prototype.set=function(e,t,r,a,n,o){return this.a=e,this.b=t,this.c=r,this.d=a,this.tx=n,this.ty=o,this},e.prototype.toArray=function(e,t){this.array||(this.array=new Float32Array(9));var r=t||this.array;return e?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r},e.prototype.apply=function(e,t){t=t||new p.default;var r=e.x,a=e.y;return t.x=this.a*r+this.c*a+this.tx,t.y=this.b*r+this.d*a+this.ty,t},e.prototype.applyInverse=function(e,t){t=t||new p.default;var r=1/(this.a*this.d+this.c*-this.b),a=e.x,n=e.y;return t.x=this.d*r*a+-this.c*r*n+(this.ty*this.c-this.tx*this.d)*r,t.y=this.a*r*n+-this.b*r*a+(-this.ty*this.a+this.tx*this.b)*r,t},e.prototype.translate=function(e,t){return this.tx+=e,this.ty+=t,this},e.prototype.scale=function(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this},e.prototype.rotate=function(e){var t=i(e),r=o(e),a=this.a,n=this.c,s=this.tx;return this.a=a*t-this.b*r,this.b=a*r+this.b*t,this.c=n*t-this.d*r,this.d=n*r+this.d*t,this.tx=s*t-this.ty*r,this.ty=s*r+this.ty*t,this},e.prototype.append=function(e){var t=this.a,r=this.b,a=this.c,n=this.d;return this.a=e.a*t+e.b*a,this.b=e.a*r+e.b*n,this.c=e.c*t+e.d*a,this.d=e.c*r+e.d*n,this.tx=e.tx*t+e.ty*a+this.tx,this.ty=e.tx*r+e.ty*n+this.ty,this},e.prototype.setTransform=function(e,t,r,n,s,l,u,p,h){var g=o(u),f=i(u),m=i(h),y=o(h),x=-o(p),_=i(p),T=f*s,a=g*s,b=-g*l,c=f*l;return this.a=m*T+y*b,this.b=m*a+y*c,this.c=x*T+_*b,this.d=x*a+_*c,this.tx=e+(r*T+n*b),this.ty=t+(r*a+n*c),this},e.prototype.prepend=function(e){var t=this.tx;if(1!==e.a||0!==e.b||0!==e.c||1!==e.d){var r=this.a,a=this.c;this.a=r*e.a+this.b*e.c,this.b=r*e.b+this.b*e.d,this.c=a*e.a+this.d*e.c,this.d=a*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this},e.prototype.decompose=function(e){var t=this.a,r=this.b,a=this.c,n=this.d,o=-s(-a,n),i=s(r,t),d=Math.abs(o+i);return 1e-5>d?(e.rotation=i,0>t&&0<=n&&(e.rotation+=0>=e.rotation?u:-u),e.skew.x=e.skew.y=0):(e.skew.x=o,e.skew.y=i),e.scale.x=l(t*t+r*r),e.scale.y=l(a*a+n*n),e.position.x=this.tx,e.position.y=this.ty,e},e.prototype.invert=function(){var e=this.a,t=this.b,r=this.c,a=this.d,o=this.tx,i=e*a-t*r;return this.a=a/i,this.b=-t/i,this.c=-r/i,this.d=e/i,this.tx=(r*this.ty-a*o)/i,this.ty=-(e*this.ty-t*o)/i,this},e.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},e.prototype.clone=function(){var t=new e;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},e.prototype.copy=function(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},a(e,null,[{key:'IDENTITY',get:function(){return new e}},{key:'TEMP_MATRIX',get:function(){return new e}}]),e}();t.default=c},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var n=Math.max,o=Math.min;t.__esModule=!0;var i=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),s=r(1),l=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;a(this,e),this.x=+t,this.y=+r,this.width=+n,this.height=+o,this.type=s.SHAPES.RECT}return e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e.prototype.copy=function(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this},e.prototype.contains=function(e,t){return!(0>=this.width||0>=this.height)&&!!(e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height)},e.prototype.pad=function(e,t){e=e||0,t=t||(0===t?0:e),this.x-=e,this.y-=t,this.width+=2*e,this.height+=2*t},e.prototype.fit=function(e){this.x<e.x&&(this.width+=this.x,0>this.width&&(this.width=0),this.x=e.x),this.y<e.y&&(this.height+=this.y,0>this.height&&(this.height=0),this.y=e.y),this.x+this.width>e.x+e.width&&(this.width=e.width-this.x,0>this.width&&(this.width=0)),this.y+this.height>e.y+e.height&&(this.height=e.height-this.y,0>this.height&&(this.height=0))},e.prototype.enlarge=function(e){var t=o(this.x,e.x),r=n(this.x+this.width,e.x+e.width),a=o(this.y,e.y),i=n(this.y+this.height,e.y+e.height);this.x=t,this.width=r-t,this.y=a,this.height=i-a},i(e,[{key:'left',get:function(){return this.x}},{key:'right',get:function(){return this.x+this.width}},{key:'top',get:function(){return this.y}},{key:'bottom',get:function(){return this.y+this.height}}],[{key:'EMPTY',get:function(){return new e(0,0,0,0)}}]),e}();t.default=l},function(e){var t=function(e,t){if(!r){var n=Object.keys(a);r={};for(var o=0,i;o<n.length;++o)i=n[o],r[e[i]]=a[i]}return r[t]},r=null,a={FLOAT:'float',FLOAT_VEC2:'vec2',FLOAT_VEC3:'vec3',FLOAT_VEC4:'vec4',INT:'int',INT_VEC2:'ivec2',INT_VEC3:'ivec3',INT_VEC4:'ivec4',BOOL:'bool',BOOL_VEC2:'bvec2',BOOL_VEC3:'bvec3',BOOL_VEC4:'bvec4',FLOAT_MAT2:'mat2',FLOAT_MAT3:'mat3',FLOAT_MAT4:'mat4',SAMPLER_2D:'sampler2D'};e.exports=t},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var n=Math.max,o=Math.min;t.__esModule=!0;var i=r(4),s=function(){function e(){a(this,e),this.minX=Infinity,this.minY=Infinity,this.maxX=-Infinity,this.maxY=-Infinity,this.rect=null}return e.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},e.prototype.clear=function(){this.updateID++,this.minX=Infinity,this.minY=Infinity,this.maxX=-Infinity,this.maxY=-Infinity},e.prototype.getRectangle=function(e){return this.minX>this.maxX||this.minY>this.maxY?i.Rectangle.EMPTY:(e=e||new i.Rectangle(0,0,1,1),e.x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)},e.prototype.addPoint=function(e){this.minX=o(this.minX,e.x),this.maxX=n(this.maxX,e.x),this.minY=o(this.minY,e.y),this.maxY=n(this.maxY,e.y)},e.prototype.addQuad=function(e){var t=this.minX,r=this.minY,a=this.maxX,n=this.maxY,o=e[0],i=e[1];t=o<t?o:t,r=i<r?i:r,a=o>a?o:a,n=i>n?i:n,o=e[2],i=e[3],t=o<t?o:t,r=i<r?i:r,a=o>a?o:a,n=i>n?i:n,o=e[4],i=e[5],t=o<t?o:t,r=i<r?i:r,a=o>a?o:a,n=i>n?i:n,o=e[6],i=e[7],t=o<t?o:t,r=i<r?i:r,a=o>a?o:a,n=i>n?i:n,this.minX=t,this.minY=r,this.maxX=a,this.maxY=n},e.prototype.addFrame=function(e,t,r,n,o){var i=e.worldTransform,s=i.a,a=i.b,l=i.c,u=i.d,d=i.tx,p=i.ty,c=this.minX,h=this.minY,g=this.maxX,f=this.maxY,m=s*t+l*r+d,x=a*t+u*r+p;c=m<c?m:c,h=x<h?x:h,g=m>g?m:g,f=x>f?x:f,m=s*n+l*r+d,x=a*n+u*r+p,c=m<c?m:c,h=x<h?x:h,g=m>g?m:g,f=x>f?x:f,m=s*t+l*o+d,x=a*t+u*o+p,c=m<c?m:c,h=x<h?x:h,g=m>g?m:g,f=x>f?x:f,m=s*n+l*o+d,x=a*n+u*o+p,c=m<c?m:c,h=x<h?x:h,g=m>g?m:g,f=x>f?x:f,this.minX=c,this.minY=h,this.maxX=g,this.maxY=f},e.prototype.addVertices=function(e,t,r,n){for(var o=e.worldTransform,s=o.a,a=o.b,l=o.c,u=o.d,d=o.tx,p=o.ty,c=this.minX,h=this.minY,g=this.maxX,f=this.maxY,m=r;m<n;m+=2){var i=t[m],_=t[m+1],b=s*i+l*_+d,x=u*_+a*i+p;c=b<c?b:c,h=x<h?x:h,g=b>g?b:g,f=x>f?x:f}this.minX=c,this.minY=h,this.maxX=g,this.maxY=f},e.prototype.addBounds=function(e){var t=this.minX,r=this.minY,a=this.maxX,n=this.maxY;this.minX=e.minX<t?e.minX:t,this.minY=e.minY<r?e.minY:r,this.maxX=e.maxX>a?e.maxX:a,this.maxY=e.maxY>n?e.maxY:n},e.prototype.addBoundsMask=function(e,t){var r=e.minX>t.minX?e.minX:t.minX,a=e.minY>t.minY?e.minY:t.minY,n=e.maxX<t.maxX?e.maxX:t.maxX,o=e.maxY<t.maxY?e.maxY:t.maxY;if(r<=n&&a<=o){var i=this.minX,s=this.minY,l=this.maxX,d=this.maxY;this.minX=r<i?r:i,this.minY=a<s?a:s,this.maxX=n>l?n:l,this.maxY=o>d?o:d}},e.prototype.addBoundsArea=function(e,t){var r=e.minX>t.x?e.minX:t.x,a=e.minY>t.y?e.minY:t.y,n=e.maxX<t.x+t.width?e.maxX:t.x+t.width,o=e.maxY<t.y+t.height?e.maxY:t.y+t.height;if(r<=n&&a<=o){var i=this.minX,s=this.minY,l=this.maxX,d=this.maxY;this.minX=r<i?r:i,this.minY=a<s?a:s,this.maxX=n>l?n:l,this.maxY=o>d?o:d}},e}();t.default=s},function(e,t){var r,a,n;/**
 * isMobile.js v0.4.1
 *
 * A simple library to detect Apple phones and tablets,
 * Android phones and tablets, other mobile devices (like blackberry, mini-opera and windows phone),
 * and any kind of seven inch device, via user agent sniffing.
 *
 * @author: Kai Mallea (kmallea@gmail.com)
 *
 * @license: http://creativecommons.org/publicdomain/zero/1.0/
 */(function(o){var i=/iPhone/i,s=/iPod/i,l=/iPad/i,d=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,u=/Android/i,p=/(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,c=/(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,h=/Windows Phone/i,g=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,f=/BlackBerry/i,m=/BB10/i,y=/Opera Mini/i,x=/(CriOS|Chrome)(?=.*\bMobile\b)/i,_=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,b=/(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)/i,T=function(e,t){return e.test(t)},v=function(e){var t=e||navigator.userAgent,r=t.split('[FBAN');if('undefined'!=typeof r[1]&&(t=r[0]),r=t.split('Twitter'),'undefined'!=typeof r[1]&&(t=r[0]),this.apple={phone:T(i,t),ipod:T(s,t),tablet:!T(i,t)&&T(l,t),device:T(i,t)||T(s,t)||T(l,t)},this.amazon={phone:T(p,t),tablet:!T(p,t)&&T(c,t),device:T(p,t)||T(c,t)},this.android={phone:T(p,t)||T(d,t),tablet:!T(p,t)&&!T(d,t)&&(T(c,t)||T(u,t)),device:T(p,t)||T(c,t)||T(d,t)||T(u,t)},this.windows={phone:T(h,t),tablet:T(g,t),device:T(h,t)||T(g,t)},this.other={blackberry:T(f,t),blackberry10:T(m,t),opera:T(y,t),firefox:T(_,t),chrome:T(x,t),device:T(f,t)||T(m,t)||T(y,t)||T(_,t)||T(x,t)},this.seven_inch=T(b,t),this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch,this.phone=this.apple.phone||this.android.phone||this.windows.phone,this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet,'undefined'==typeof window)return this},E=function(){var e=new v;return e.Class=v,e};'undefined'!=typeof e&&e.exports&&'undefined'==typeof window?e.exports=v:'undefined'!=typeof e&&e.exports&&'undefined'!=typeof window?e.exports=E():(a=[],r=o.isMobile=E(),n='function'==typeof r?r.apply(t,a):r,!(n!==void 0&&(e.exports=n)))})(this)},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var n=r(4),o=function(){function e(){a(this,e),this.worldTransform=new n.Matrix,this.localTransform=new n.Matrix,this._worldID=0,this._parentID=0}return e.prototype.updateLocalTransform=function(){},e.prototype.updateTransform=function(e){var t=e.worldTransform,r=this.worldTransform,a=this.localTransform;r.a=a.a*t.a+a.b*t.c,r.b=a.a*t.b+a.b*t.d,r.c=a.c*t.a+a.d*t.c,r.d=a.c*t.b+a.d*t.d,r.tx=a.tx*t.a+a.ty*t.c+t.tx,r.ty=a.tx*t.b+a.ty*t.d+t.ty,this._worldID++},e}();t.default=o,o.prototype.updateWorldTransform=o.prototype.updateTransform,o.IDENTITY=new o},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=Math.abs;t.__esModule=!0;var l=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),d=r(4),u=r(2),p=r(1),c=r(11),h=a(c),g=r(15),f=a(g),m=new d.Point,y=function(e){function t(r){n(this,t);var a=o(this,e.call(this));return a._anchor=new d.ObservablePoint(a._onAnchorUpdate,a),a._texture=null,a._width=0,a._height=0,a._tint=null,a._tintRGB=null,a.tint=16777215,a.blendMode=p.BLEND_MODES.NORMAL,a.shader=null,a.cachedTint=16777215,a.texture=r||h.default.EMPTY,a.vertexData=new Float32Array(8),a.vertexTrimmedData=null,a._transformID=-1,a._textureID=-1,a._transformTrimmedID=-1,a._textureTrimmedID=-1,a.pluginName='sprite',a}return i(t,e),t.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this.cachedTint=16777215,this._width&&(this.scale.x=(0,u.sign)(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=(0,u.sign)(this.scale.y)*this._height/this._texture.orig.height)},t.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},t.prototype.calculateVertices=function(){if(this._transformID!==this.transform._worldID||this._textureID!==this._texture._updateID){this._transformID=this.transform._worldID,this._textureID=this._texture._updateID;var e=this._texture,t=this.transform.worldTransform,r=t.a,a=t.b,n=t.c,o=t.d,i=t.tx,s=t.ty,l=this.vertexData,d=e.trim,u=e.orig,p=this._anchor,c=0,h=0,g=0,f=0;d?(h=d.x-p._x*u.width,c=h+d.width,f=d.y-p._y*u.height,g=f+d.height):(h=-p._x*u.width,c=h+u.width,f=-p._y*u.height,g=f+u.height),l[0]=r*h+n*f+i,l[1]=o*f+a*h+s,l[2]=r*c+n*f+i,l[3]=o*f+a*c+s,l[4]=r*c+n*g+i,l[5]=o*g+a*c+s,l[6]=r*h+n*g+i,l[7]=o*g+a*h+s}},t.prototype.calculateTrimmedVertices=function(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var e=this._texture,t=this.vertexTrimmedData,r=e.orig,n=this._anchor,o=this.transform.worldTransform,i=o.a,a=o.b,s=o.c,l=o.d,d=o.tx,u=o.ty,p=-n._x*r.width,c=p+r.width,h=-n._y*r.height,g=h+r.height;t[0]=i*p+s*h+d,t[1]=l*h+a*p+u,t[2]=i*c+s*h+d,t[3]=l*h+a*c+u,t[4]=i*c+s*g+d,t[5]=l*g+a*c+u,t[6]=i*p+s*g+d,t[7]=l*g+a*p+u},t.prototype._renderWebGL=function(e){this.calculateVertices(),e.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)},t.prototype._renderCanvas=function(e){e.plugins[this.pluginName].render(this)},t.prototype._calculateBounds=function(){var e=this._texture.trim,t=this._texture.orig;e&&(e.width!==t.width||e.height!==t.height)?(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData)):(this.calculateVertices(),this._bounds.addQuad(this.vertexData))},t.prototype.getLocalBounds=function(t){return 0===this.children.length?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(!this._localBoundsRect&&(this._localBoundsRect=new d.Rectangle),t=this._localBoundsRect),this._bounds.getRectangle(t)):e.prototype.getLocalBounds.call(this,t)},t.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,m);var t=this._texture.orig.width,r=this._texture.orig.height,a=-t*this.anchor.x,n=0;return!!(m.x>=a&&m.x<a+t&&(n=-r*this.anchor.y,m.y>=n&&m.y<n+r))},t.prototype.destroy=function(t){e.prototype.destroy.call(this,t),this._anchor=null;var r='boolean'==typeof t?t:t&&t.texture;if(r){var a='boolean'==typeof t?t:t&&t.baseTexture;this._texture.destroy(!!a)}this._texture=null,this.shader=null},t.from=function(e){return new t(h.default.from(e))},t.fromFrame=function(e){var r=u.TextureCache[e];if(!r)throw new Error('The frameId "'+e+'" does not exist in the texture cache');return new t(r)},t.fromImage=function(e,r,a){return new t(h.default.fromImage(e,r,a))},l(t,[{key:'width',get:function(){return s(this.scale.x)*this._texture.orig.width},set:function(e){var t=(0,u.sign)(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}},{key:'height',get:function(){return s(this.scale.y)*this._texture.orig.height},set:function(e){var t=(0,u.sign)(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}},{key:'anchor',get:function(){return this._anchor},set:function(e){this._anchor.copy(e)}},{key:'tint',get:function(){return this._tint},set:function(e){this._tint=e,this._tintRGB=(e>>16)+(65280&e)+((255&e)<<16)}},{key:'texture',get:function(){return this._texture},set:function(e){this._texture===e||(this._texture=e,this.cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.hasLoaded?this._onTextureUpdate():e.once('update',this._onTextureUpdate,this)))}}]),t}(f.default);t.default=y},function(e,t){'use strict';'use restrict';function r(e){var t=32;return e&=-e,e&&t--,65535&e&&(t-=16),16711935&e&&(t-=8),252645135&e&&(t-=4),858993459&e&&(t-=2),1431655765&e&&(t-=1),t}var a=32;t.INT_BITS=a,t.INT_MAX=2147483647,t.INT_MIN=-1<<a-1,t.sign=function(e){return(0<e)-(0>e)},t.abs=function(e){var t=e>>a-1;return(e^t)-t},t.min=function(e,t){return t^(e^t)&-(e<t)},t.max=function(e,t){return e^(e^t)&-(e<t)},t.isPow2=function(e){return!(e&e-1)&&!!e},t.log2=function(e){var t,r;return t=(65535<e)<<4,e>>>=t,r=(255<e)<<3,e>>>=r,t|=r,r=(15<e)<<2,e>>>=r,t|=r,r=(3<e)<<1,e>>>=r,t|=r,t|e>>1},t.log10=function(e){return 1e9<=e?9:1e8<=e?8:1e7<=e?7:1e6<=e?6:1e5<=e?5:1e4<=e?4:1e3<=e?3:100<=e?2:10<=e?1:0},t.popCount=function(e){return e-=1431655765&e>>>1,e=(858993459&e)+(858993459&e>>>2),16843009*(252645135&e+(e>>>4))>>>24},t.countTrailingZeros=r,t.nextPow2=function(e){return e+=0===e,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e+1},t.prevPow2=function(e){return e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e-(e>>>1)},t.parity=function(e){return e^=e>>>16,e^=e>>>8,e^=e>>>4,e&=15,1&27030>>>e};var n=Array(256);(function(e){for(var t=0;256>t;++t){var a=t,n=t,r=7;for(a>>>=1;a;a>>>=1)n<<=1,n|=1&a,--r;e[t]=255&n<<r}})(n),t.reverse=function(e){return n[255&e]<<24|n[255&e>>>8]<<16|n[255&e>>>16]<<8|n[255&e>>>24]},t.interleave2=function(e,t){return e&=65535,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t&=65535,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e|t<<1},t.deinterleave2=function(e,t){return e=1431655765&e>>>t,e=858993459&(e|e>>>1),e=252645135&(e|e>>>2),e=16711935&(e|e>>>4),e=65535&(e|e>>>16),e<<16>>16},t.interleave3=function(e,t,r){return e&=1023,e=4278190335&(e|e<<16),e=251719695&(e|e<<8),e=3272356035&(e|e<<4),e=1227133513&(e|e<<2),t&=1023,t=4278190335&(t|t<<16),t=251719695&(t|t<<8),t=3272356035&(t|t<<4),t=1227133513&(t|t<<2),e|=t<<1,r&=1023,r=4278190335&(r|r<<16),r=251719695&(r|r<<8),r=3272356035&(r|r<<4),r=1227133513&(r|r<<2),e|r<<2},t.deinterleave3=function(e,t){return e=1227133513&e>>>t,e=3272356035&(e|e>>>2),e=251719695&(e|e>>>4),e=4278190335&(e|e>>>8),e=1023&(e|e>>>16),e<<22>>22},t.nextCombination=function(e){var a=e|e-1;return a+1|(~a&-~a)-1>>>r(e)+1}},function(e,t,r){'use strict';t.__esModule=!0,t.Ticker=t.shared=void 0;var a=r(131),n=function(e){return e&&e.__esModule?e:{default:e}}(a),o=new n.default;o.autoStart=!0,o.destroy=function(){},t.shared=o,t.Ticker=n.default},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=Math.ceil;t.__esModule=!0;var l=r(66),d=a(l),u=r(11),p=a(u),c=function(e){function t(r,a){n(this,t);var i=null;if(!(r instanceof d.default)){var s=arguments[1],l=arguments[2],u=arguments[3],p=arguments[4];console.warn('Please use RenderTexture.create('+s+', '+l+') instead of the ctor directly.'),i=arguments[0],a=null,r=new d.default(s,l,u,p)}var c=o(this,e.call(this,r,a));return c.legacyRenderer=i,c.valid=!0,c._updateUvs(),c}return i(t,e),t.prototype.resize=function(e,t,r){e=s(e),t=s(t),this.valid=0<e&&0<t,this._frame.width=this.orig.width=e,this._frame.height=this.orig.height=t,r||this.baseTexture.resize(e,t),this._updateUvs()},t.create=function(e,r,a,n){return new t(new d.default(e,r,a,n))},t}(p.default);t.default=c},function(e,t,r){'use strict';var a=Math.ceil,n=Math.min;t.__esModule=!0;var o=r(2),i=r(68),s=function(e){return e&&e.__esModule?e:{default:e}}(i),l={getTintedTexture:function(e,t){var r=e._texture;t=l.roundColor(t);var a='#'+('00000'+(0|t).toString(16)).substr(-6);r.tintCache=r.tintCache||{};var n=r.tintCache[a],o;if(n){if(n.tintId===r._updateID)return r.tintCache[a];o=r.tintCache[a]}else o=l.canvas||document.createElement('canvas');if(l.tintMethod(r,t,o),o.tintId=r._updateID,l.convertTintToImage){var i=new Image;i.src=o.toDataURL(),r.tintCache[a]=i}else r.tintCache[a]=o,l.canvas=null;return o},tintWithMultiply:function(e,t,r){var n=r.getContext('2d'),o=e._frame.clone(),i=e.baseTexture.resolution;o.x*=i,o.y*=i,o.width*=i,o.height*=i,r.width=a(o.width),r.height=a(o.height),n.save(),n.fillStyle='#'+('00000'+(0|t).toString(16)).substr(-6),n.fillRect(0,0,o.width,o.height),n.globalCompositeOperation='multiply',n.drawImage(e.baseTexture.source,o.x,o.y,o.width,o.height,0,0,o.width,o.height),n.globalCompositeOperation='destination-atop',n.drawImage(e.baseTexture.source,o.x,o.y,o.width,o.height,0,0,o.width,o.height),n.restore()},tintWithOverlay:function(e,t,r){var n=r.getContext('2d'),o=e._frame.clone(),i=e.baseTexture.resolution;o.x*=i,o.y*=i,o.width*=i,o.height*=i,r.width=a(o.width),r.height=a(o.height),n.save(),n.globalCompositeOperation='copy',n.fillStyle='#'+('00000'+(0|t).toString(16)).substr(-6),n.fillRect(0,0,o.width,o.height),n.globalCompositeOperation='destination-atop',n.drawImage(e.baseTexture.source,o.x,o.y,o.width,o.height,0,0,o.width,o.height),n.restore()},tintWithPerPixel:function(e,t,n){var s=n.getContext('2d'),l=e._frame.clone(),d=e.baseTexture.resolution;l.x*=d,l.y*=d,l.width*=d,l.height*=d,n.width=a(l.width),n.height=a(l.height),s.save(),s.globalCompositeOperation='copy',s.drawImage(e.baseTexture.source,l.x,l.y,l.width,l.height,0,0,l.width,l.height),s.restore();for(var u=(0,o.hex2rgb)(t),p=u[0],r=u[1],c=u[2],h=s.getImageData(0,0,l.width,l.height),g=h.data,f=0;f<g.length;f+=4)g[f+0]*=p,g[f+1]*=r,g[f+2]*=c;s.putImageData(h,0,0)},roundColor:function(e){var t=l.cacheStepsPerColorChannel,r=(0,o.hex2rgb)(e);return r[0]=n(255,r[0]/t*t),r[1]=n(255,r[1]/t*t),r[2]=n(255,r[2]/t*t),(0,o.rgb2hex)(r)},cacheStepsPerColorChannel:8,convertTintToImage:!1,canUseMultiply:(0,s.default)(),tintMethod:0};l.tintMethod=l.canUseMultiply?l.tintWithMultiply:l.tintWithPerPixel,t.default=l},function(e,t){'use strict';t.__esModule=!0,t.default=function(e){for(var t=6*e,r=new Uint16Array(t),a=0,n=0;a<t;a+=6,n+=4)r[a+0]=n+0,r[a+1]=n+1,r[a+2]=n+2,r[a+3]=n+0,r[a+4]=n+2,r[a+5]=n+3;return r}},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(){}function i(e,t,r){t&&0===t.indexOf('.')&&(t=t.substring(1));t&&(e[t]=r)}function s(e){return e.toString().replace('object ','')}t.__esModule=!0;var l=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),d=r(92),u=a(d),p=r(91),c=a(p),h=!(!window.XDomainRequest||'withCredentials'in new XMLHttpRequest),g=null,f=200,m=function(){function e(t,r,a){if(n(this,e),'string'!=typeof t||'string'!=typeof r)throw new Error('Both name and url are required for constructing a resource.');a=a||{},this._flags=0,this._setFlag(e.STATUS_FLAGS.DATA_URL,0===r.indexOf('data:')),this.name=t,this.url=r,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===a.crossOrigin?'anonymous':a.crossOrigin,this.loadType=a.loadType||this._determineLoadType(),this.xhrType=a.xhrType,this.metadata=a.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=e.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=o,this._onLoadBinding=null,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this._boundXdrOnTimeout=this._xdrOnTimeout.bind(this),this.onStart=new c.default,this.onProgress=new c.default,this.onComplete=new c.default,this.onAfterMiddleware=new c.default}return e.setExtensionLoadType=function(t,r){i(e._loadTypeMap,t,r)},e.setExtensionXhrType=function(t,r){i(e._xhrTypeMap,t,r)},e.prototype.complete=function(){if(this.data&&this.data.removeEventListener&&(this.data.removeEventListener('error',this._boundOnError,!1),this.data.removeEventListener('load',this._boundComplete,!1),this.data.removeEventListener('progress',this._boundOnProgress,!1),this.data.removeEventListener('canplaythrough',this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener('error',this._boundXhrOnError,!1),this.xhr.removeEventListener('abort',this._boundXhrOnAbort,!1),this.xhr.removeEventListener('progress',this._boundOnProgress,!1),this.xhr.removeEventListener('load',this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null)),this.isComplete)throw new Error('Complete called again for an already completed resource.');this._setFlag(e.STATUS_FLAGS.COMPLETE,!0),this._setFlag(e.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},e.prototype.abort=function(t){if(!this.error){if(this.error=new Error(t),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=e.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this.complete()}},e.prototype.load=function(t){var r=this;if(!this.isLoading){if(this.isComplete)return void(t&&setTimeout(function(){return t(r)},1));switch(t&&this.onComplete.once(t),this._setFlag(e.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),(!1===this.crossOrigin||'string'!=typeof this.crossOrigin)&&(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case e.LOAD_TYPE.IMAGE:this.type=e.TYPE.IMAGE,this._loadElement('image');break;case e.LOAD_TYPE.AUDIO:this.type=e.TYPE.AUDIO,this._loadSourceElement('audio');break;case e.LOAD_TYPE.VIDEO:this.type=e.TYPE.VIDEO,this._loadSourceElement('video');break;case e.LOAD_TYPE.XHR:default:h&&this.crossOrigin?this._loadXdr():this._loadXhr();}}},e.prototype._hasFlag=function(e){return!!(this._flags&e)},e.prototype._setFlag=function(e,t){this._flags=t?this._flags|e:this._flags&~e},e.prototype._loadElement=function(e){this.data=this.metadata.loadElement?this.metadata.loadElement:'image'===e&&'undefined'!=typeof window.Image?new Image:document.createElement(e),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener('error',this._boundOnError,!1),this.data.addEventListener('load',this._boundComplete,!1),this.data.addEventListener('progress',this._boundOnProgress,!1)},e.prototype._loadSourceElement=function(e){if(this.data=this.metadata.loadElement?this.metadata.loadElement:'audio'===e&&'undefined'!=typeof window.Audio?new Audio:document.createElement(e),null===this.data)return void this.abort('Unsupported element: '+e);if(!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var t=this.metadata.mimeType,r=0;r<this.url.length;++r)this.data.appendChild(this._createSource(e,this.url[r],Array.isArray(t)?t[r]:t));else{var a=this.metadata.mimeType;this.data.appendChild(this._createSource(e,this.url,Array.isArray(a)?a[0]:a))}this.data.addEventListener('error',this._boundOnError,!1),this.data.addEventListener('load',this._boundComplete,!1),this.data.addEventListener('progress',this._boundOnProgress,!1),this.data.addEventListener('canplaythrough',this._boundComplete,!1),this.data.load()},e.prototype._loadXhr=function(){'string'!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XMLHttpRequest;t.open('GET',this.url,!0),t.responseType=this.xhrType===e.XHR_RESPONSE_TYPE.JSON||this.xhrType===e.XHR_RESPONSE_TYPE.DOCUMENT?e.XHR_RESPONSE_TYPE.TEXT:this.xhrType,t.addEventListener('error',this._boundXhrOnError,!1),t.addEventListener('abort',this._boundXhrOnAbort,!1),t.addEventListener('progress',this._boundOnProgress,!1),t.addEventListener('load',this._boundXhrOnLoad,!1),t.send()},e.prototype._loadXdr=function(){'string'!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XDomainRequest;e.timeout=5e3,e.onerror=this._boundXhrOnError,e.ontimeout=this._boundXdrOnTimeout,e.onprogress=this._boundOnProgress,e.onload=this._boundXhrOnLoad,e.open('GET',this.url,!0),setTimeout(function(){return e.send()},1)},e.prototype._createSource=function(e,t,r){r||(r=e+'/'+this._getExtension(t));var a=document.createElement('source');return a.src=t,a.type=r,a},e.prototype._onError=function(e){this.abort('Failed to load element using: '+e.target.nodeName)},e.prototype._onProgress=function(e){e&&e.lengthComputable&&this.onProgress.dispatch(this,e.loaded/e.total)},e.prototype._xhrOnError=function(){var e=this.xhr;this.abort(s(e)+' Request failed. Status: '+e.status+', text: "'+e.statusText+'"')},e.prototype._xhrOnAbort=function(){this.abort(s(this.xhr)+' Request was aborted by the user.')},e.prototype._xdrOnTimeout=function(){this.abort(s(this.xhr)+' Request timed out.')},e.prototype._xhrOnLoad=function(){var t=this.xhr,r='',a='undefined'==typeof t.status?f:t.status;(''===t.responseType||'text'===t.responseType||'undefined'==typeof t.responseType)&&(r=t.responseText),a===0&&(0<r.length||t.responseType===e.XHR_RESPONSE_TYPE.BUFFER)?a=f:a===1223&&(a=204);var n=0|a/100;if(n!==2)return void this.abort('['+t.status+'] '+t.statusText+': '+t.responseURL);if(this.xhrType===e.XHR_RESPONSE_TYPE.TEXT)this.data=r,this.type=e.TYPE.TEXT;else if(this.xhrType===e.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(r),this.type=e.TYPE.JSON}catch(t){return void this.abort('Error trying to parse loaded json: '+t)}else if(this.xhrType===e.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var o=new DOMParser;this.data=o.parseFromString(r,'text/xml')}else{var i=document.createElement('div');i.innerHTML=r,this.data=i}this.type=e.TYPE.XML}catch(t){return void this.abort('Error trying to parse loaded xml: '+t)}else this.data=t.response||r;this.complete()},e.prototype._determineCrossOrigin=function(e,t){if(0===e.indexOf('data:'))return'';t=t||window.location,g||(g=document.createElement('a')),g.href=e,e=(0,u.default)(g.href,{strictMode:!0});var r=!e.port&&''===t.port||e.port===t.port,a=e.protocol?e.protocol+':':'';return e.host===t.hostname&&r&&a===t.protocol?'':'anonymous'},e.prototype._determineXhrType=function(){return e._xhrTypeMap[this.extension]||e.XHR_RESPONSE_TYPE.TEXT},e.prototype._determineLoadType=function(){return e._loadTypeMap[this.extension]||e.LOAD_TYPE.XHR},e.prototype._getExtension=function(){var e=this.url,t='';if(this.isDataUrl){var r=e.indexOf('/');t=e.substring(r+1,e.indexOf(';',r))}else{var a=e.indexOf('?'),n=e.indexOf('#'),o=Math.min(-1<a?a:e.length,-1<n?n:e.length);e=e.substring(0,o),t=e.substring(e.lastIndexOf('.')+1)}return t.toLowerCase()},e.prototype._getMimeFromXhrType=function(t){switch(t){case e.XHR_RESPONSE_TYPE.BUFFER:return'application/octet-binary';case e.XHR_RESPONSE_TYPE.BLOB:return'application/blob';case e.XHR_RESPONSE_TYPE.DOCUMENT:return'application/xml';case e.XHR_RESPONSE_TYPE.JSON:return'application/json';case e.XHR_RESPONSE_TYPE.DEFAULT:case e.XHR_RESPONSE_TYPE.TEXT:default:return'text/plain';}},l(e,[{key:'isDataUrl',get:function(){return this._hasFlag(e.STATUS_FLAGS.DATA_URL)}},{key:'isComplete',get:function(){return this._hasFlag(e.STATUS_FLAGS.COMPLETE)}},{key:'isLoading',get:function(){return this._hasFlag(e.STATUS_FLAGS.LOADING)}}]),e}();t.default=m,m.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4},m.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6},m.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},m.XHR_RESPONSE_TYPE={DEFAULT:'text',BUFFER:'arraybuffer',BLOB:'blob',DOCUMENT:'document',JSON:'json',TEXT:'text'},m._loadTypeMap={gif:m.LOAD_TYPE.IMAGE,png:m.LOAD_TYPE.IMAGE,bmp:m.LOAD_TYPE.IMAGE,jpg:m.LOAD_TYPE.IMAGE,jpeg:m.LOAD_TYPE.IMAGE,tif:m.LOAD_TYPE.IMAGE,tiff:m.LOAD_TYPE.IMAGE,webp:m.LOAD_TYPE.IMAGE,tga:m.LOAD_TYPE.IMAGE,svg:m.LOAD_TYPE.IMAGE,"svg+xml":m.LOAD_TYPE.IMAGE,mp3:m.LOAD_TYPE.AUDIO,ogg:m.LOAD_TYPE.AUDIO,wav:m.LOAD_TYPE.AUDIO,mp4:m.LOAD_TYPE.VIDEO,webm:m.LOAD_TYPE.VIDEO},m._xhrTypeMap={xhtml:m.XHR_RESPONSE_TYPE.DOCUMENT,html:m.XHR_RESPONSE_TYPE.DOCUMENT,htm:m.XHR_RESPONSE_TYPE.DOCUMENT,xml:m.XHR_RESPONSE_TYPE.DOCUMENT,tmx:m.XHR_RESPONSE_TYPE.DOCUMENT,svg:m.XHR_RESPONSE_TYPE.DOCUMENT,tsx:m.XHR_RESPONSE_TYPE.DOCUMENT,gif:m.XHR_RESPONSE_TYPE.BLOB,png:m.XHR_RESPONSE_TYPE.BLOB,bmp:m.XHR_RESPONSE_TYPE.BLOB,jpg:m.XHR_RESPONSE_TYPE.BLOB,jpeg:m.XHR_RESPONSE_TYPE.BLOB,tif:m.XHR_RESPONSE_TYPE.BLOB,tiff:m.XHR_RESPONSE_TYPE.BLOB,webp:m.XHR_RESPONSE_TYPE.BLOB,tga:m.XHR_RESPONSE_TYPE.BLOB,json:m.XHR_RESPONSE_TYPE.JSON,text:m.XHR_RESPONSE_TYPE.TEXT,txt:m.XHR_RESPONSE_TYPE.TEXT,ttf:m.XHR_RESPONSE_TYPE.BUFFER,otf:m.XHR_RESPONSE_TYPE.BUFFER},m.EMPTY_GIF='data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=='},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function n(e,t){var r=!1;if(e&&e._textures&&e._textures.length)for(var a=0;a<e._textures.length;a++)if(e._textures[a]instanceof c.Texture){var n=e._textures[a].baseTexture;-1===t.indexOf(n)&&(t.push(n),r=!0)}return r}function o(e,t){return!!(e instanceof c.BaseTexture)&&(-1===t.indexOf(e)&&t.push(e),!0)}function i(e,t){if(e._texture&&e._texture instanceof c.Texture){var r=e._texture.baseTexture;return-1===t.indexOf(r)&&t.push(r),!0}return!1}function s(e,t){return!!(t instanceof c.Text)&&(t.updateText(!0),!0)}function l(e,t){if(t instanceof c.TextStyle){var r=t.toFontString();return c.TextMetrics.measureFont(r),!0}return!1}function d(e,t){if(e instanceof c.Text){-1===t.indexOf(e.style)&&t.push(e.style),-1===t.indexOf(e)&&t.push(e);var r=e._texture.baseTexture;return-1===t.indexOf(r)&&t.push(r),!0}return!1}function u(e,t){return!!(e instanceof c.TextStyle)&&(-1===t.indexOf(e)&&t.push(e),!0)}t.__esModule=!0;var p=r(0),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(p),h=r(98),g=function(e){return e&&e.__esModule?e:{default:e}}(h),f=c.ticker.shared;c.settings.UPLOADS_PER_FRAME=4;var m=function(){function e(t){var r=this;a(this,e),this.limiter=new g.default(c.settings.UPLOADS_PER_FRAME),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){r.queue&&r.prepareItems()},this.registerFindHook(d),this.registerFindHook(u),this.registerFindHook(n),this.registerFindHook(o),this.registerFindHook(i),this.registerUploadHook(s),this.registerUploadHook(l)}return e.prototype.upload=function(e,t){'function'==typeof e&&(t=e,e=null),e&&this.add(e),this.queue.length?(t&&this.completes.push(t),!this.ticking&&(this.ticking=!0,f.addOnce(this.tick,this,c.UPDATE_PRIORITY.UTILITY))):t&&t()},e.prototype.tick=function(){setTimeout(this.delayedTick,0)},e.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var e=this.queue[0],t=!1;if(e&&!e._destroyed)for(var r=0,a=this.uploadHooks.length;r<a;r++)if(this.uploadHooks[r](this.uploadHookHelper,e)){this.queue.shift(),t=!0;break}t||this.queue.shift()}if(!this.queue.length){this.ticking=!1;var n=this.completes.slice(0);this.completes.length=0;for(var o=0,i=n.length;o<i;o++)n[o]()}else f.addOnce(this.tick,this,c.UPDATE_PRIORITY.UTILITY)},e.prototype.registerFindHook=function(e){return e&&this.addHooks.push(e),this},e.prototype.registerUploadHook=function(e){return e&&this.uploadHooks.push(e),this},e.prototype.add=function(e){for(var t=0,r=this.addHooks.length;t<r&&!this.addHooks[t](e,this.queue);t++);if(e instanceof c.Container)for(var a=e.children.length-1;0<=a;a--)this.add(e.children[a]);return this},e.prototype.destroy=function(){this.ticking&&f.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},e}();t.default=m},function(e,t){'use strict';function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var a=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(t,a){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;r(this,e),this._x=n,this._y=o,this.cb=t,this.scope=a}return e.prototype.set=function(e,t){var r=e||0,a=t||(0===t?0:r);(this._x!==r||this._y!==a)&&(this._x=r,this._y=a,this.cb.call(this.scope))},e.prototype.copy=function(e){(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope))},a(e,[{key:'x',get:function(){return this._x},set:function(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))}},{key:'y',get:function(){return this._y},set:function(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))}}]),e}();t.default=n},function(e,t,r){'use strict';function a(e){return 0>e?-1:0<e?1:0}var n=Math.abs;t.__esModule=!0;var o=r(33),i=function(e){return e&&e.__esModule?e:{default:e}}(o),s=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],l=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],d=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],u=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],p=[],c=[];(function(){for(var e=0,t;16>e;e++){t=[],c.push(t);for(var r=0;16>r;r++)for(var n=a(s[e]*s[r]+d[e]*l[r]),o=a(l[e]*s[r]+u[e]*l[r]),h=a(s[e]*d[r]+d[e]*u[r]),g=a(l[e]*d[r]+u[e]*u[r]),f=0;16>f;f++)if(s[f]===n&&l[f]===o&&d[f]===h&&u[f]===g){t.push(f);break}}for(var m=0,y;16>m;m++)y=new i.default,y.set(s[m],l[m],d[m],u[m],0,0),p.push(y)})();var h={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MIRROR_HORIZONTAL:12,uX:function(e){return s[e]},uY:function(e){return l[e]},vX:function(e){return d[e]},vY:function(e){return u[e]},inv:function(e){return 8&e?15&e:7&-e},add:function(e,t){return c[e][t]},sub:function(e,t){return c[e][h.inv(t)]},rotate180:function(e){return 4^e},isVertical:function(e){return 2==(3&e)},byDirection:function(e,t){if(2*n(e)<=n(t))return 0<=t?h.S:h.N;return 2*n(t)<=n(e)?0<e?h.E:h.W:0<t?0<e?h.SE:h.SW:0<e?h.NE:h.NW},matrixAppendRotationInv:function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0,a=3<arguments.length&&arguments[3]!==void 0?arguments[3]:0,n=p[h.inv(t)];n.tx=r,n.ty=a,e.append(n)}};t.default=h},function(e){e.exports=function(e,t,r){var a;if(r){var n=r.tempAttribState,o=r.attribState;for(a=0;a<n.length;a++)n[a]=!1;for(a=0;a<t.length;a++)n[t[a].attribute.location]=!0;for(a=0;a<o.length;a++)o[a]!==n[a]&&(o[a]=n[a],r.attribState[a]?e.enableVertexAttribArray(a):e.disableVertexAttribArray(a))}else for(a=0;a<t.length;a++){var i=t[a];e.enableVertexAttribArray(i.attribute.location)}}},function(e){var t=function(e,t,r,a,n){this.gl=e,this.texture=e.createTexture(),this.mipmap=!1,this.premultiplyAlpha=!1,this.width=t||-1,this.height=r||-1,this.format=a||e.RGBA,this.type=n||e.UNSIGNED_BYTE};t.prototype.upload=function(e){this.bind();var t=this.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha);var r=e.videoWidth||e.width,a=e.videoHeight||e.height;a!==this.height||r!==this.width?t.texImage2D(t.TEXTURE_2D,0,this.format,this.format,this.type,e):t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.format,this.type,e),this.width=r,this.height=a};var r=!1;t.prototype.uploadData=function(e,t,a){this.bind();var n=this.gl;if(e instanceof Float32Array){if(!r){var o=n.getExtension('OES_texture_float');if(o)r=!0;else throw new Error('floating point textures not available')}this.type=n.FLOAT}else this.type=this.type||n.UNSIGNED_BYTE;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),t!==this.width||a!==this.height?n.texImage2D(n.TEXTURE_2D,0,this.format,t,a,0,this.format,this.type,e||null):n.texSubImage2D(n.TEXTURE_2D,0,0,0,t,a,this.format,this.type,e||null),this.width=t,this.height=a},t.prototype.bind=function(e){var t=this.gl;e!==void 0&&t.activeTexture(t.TEXTURE0+e),t.bindTexture(t.TEXTURE_2D,this.texture)},t.prototype.unbind=function(){var e=this.gl;e.bindTexture(e.TEXTURE_2D,null)},t.prototype.minFilter=function(e){var t=this.gl;this.bind(),this.mipmap?t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,e?t.LINEAR_MIPMAP_LINEAR:t.NEAREST_MIPMAP_NEAREST):t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,e?t.LINEAR:t.NEAREST)},t.prototype.magFilter=function(e){var t=this.gl;this.bind(),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,e?t.LINEAR:t.NEAREST)},t.prototype.enableMipmap=function(){var e=this.gl;this.bind(),this.mipmap=!0,e.generateMipmap(e.TEXTURE_2D)},t.prototype.enableLinearScaling=function(){this.minFilter(!0),this.magFilter(!0)},t.prototype.enableNearestScaling=function(){this.minFilter(!1),this.magFilter(!1)},t.prototype.enableWrapClamp=function(){var e=this.gl;this.bind(),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)},t.prototype.enableWrapRepeat=function(){var e=this.gl;this.bind(),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT)},t.prototype.enableWrapMirrorRepeat=function(){var e=this.gl;this.bind(),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.MIRRORED_REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.MIRRORED_REPEAT)},t.prototype.destroy=function(){var e=this.gl;e.deleteTexture(this.texture)},t.fromSource=function(e,r,a){var n=new t(e);return n.premultiplyAlpha=a||!1,n.upload(r),n},t.fromData=function(e,r,a,n){var o=new t(e);return o.uploadData(r,a,n),o},e.exports=t},function(e){var t=function(e,t,r){var a=e.createShader(t);return e.shaderSource(a,r),e.compileShader(a),e.getShaderParameter(a,e.COMPILE_STATUS)?a:(console.log(e.getShaderInfoLog(a)),null)};e.exports=function(e,r,a,n){var o=t(e,e.VERTEX_SHADER,r),s=t(e,e.FRAGMENT_SHADER,a),l=e.createProgram();if(e.attachShader(l,o),e.attachShader(l,s),n)for(var d in n)e.bindAttribLocation(l,n[d],d);return e.linkProgram(l),e.getProgramParameter(l,e.LINK_STATUS)||(console.error('Pixi.js Error: Could not initialize shader.'),console.error('gl.VALIDATE_STATUS',e.getProgramParameter(l,e.VALIDATE_STATUS)),console.error('gl.getError()',e.getError()),''!==e.getProgramInfoLog(l)&&console.warn('Pixi.js Warning: gl.getProgramInfoLog()',e.getProgramInfoLog(l)),e.deleteProgram(l),l=null),e.deleteShader(o),e.deleteShader(s),l}},function(e,t,r){var a=r(35),n=r(53),o=function(e,t,r,a){gl.vertexAttribPointer(this.location,this.size,e||gl.FLOAT,t||!1,r||0,a||0)};e.exports=function(e,t){for(var r={},s=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),l=0;l<s;l++){var i=e.getActiveAttrib(t,l),d=a(e,i.type);r[i.name]={type:d,size:n(d),location:e.getAttribLocation(t,i.name),pointer:o}}return r}},function(e){var t={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};e.exports=function(e){return t[e]}},function(e,t,r){var a=r(35),n=r(55);e.exports=function(e,t){for(var r={},o=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),s=0;s<o;s++){var i=e.getActiveUniform(t,s),l=i.name.replace(/\[.*?\]/,''),d=a(e,i.type);r[l]={type:d,size:i.size,location:e.getUniformLocation(t,l),value:n(d,i.size)}}return r}},function(e){var t=function(e){for(var t=Array(e),r=0;r<t.length;r++)t[r]=!1;return t};e.exports=function(e,r){return'float'===e?0:'vec2'===e?new Float32Array(2*r):'vec3'===e?new Float32Array(3*r):'vec4'===e?new Float32Array(4*r):'int'===e||'sampler2D'===e?0:'ivec2'===e?new Int32Array(2*r):'ivec3'===e?new Int32Array(3*r):'ivec4'===e?new Int32Array(4*r):'bool'!=e&&('bvec2'===e?t(2*r):'bvec3'===e?t(3*r):'bvec4'===e?t(4*r):'mat2'===e?new Float32Array([1,0,0,1]):'mat3'===e?new Float32Array([1,0,0,0,1,0,0,0,1]):'mat4'===e?new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]):void 0)}},function(e){e.exports=function(e,t){return'precision'===e.substring(0,9)?e:'precision '+t+' float;\n'+e}},function(e){function t(e,t){return function(r){this.data[e].value=r;var a=this.data[e].location;1===t.size?n[t.type](this.gl,a,r):o[t.type](this.gl,a,r)}}function r(e,t){for(var r=t,a=0,n;a<e.length-1;a++)n=r[e[a]]||{data:{}},r[e[a]]=n,r=n;return r}var a=function(e){return function(){return this.data[e].value}},n={float:function(e,t,r){e.uniform1f(t,r)},vec2:function(e,t,r){e.uniform2f(t,r[0],r[1])},vec3:function(e,t,r){e.uniform3f(t,r[0],r[1],r[2])},vec4:function(e,t,r){e.uniform4f(t,r[0],r[1],r[2],r[3])},int:function(e,t,r){e.uniform1i(t,r)},ivec2:function(e,t,r){e.uniform2i(t,r[0],r[1])},ivec3:function(e,t,r){e.uniform3i(t,r[0],r[1],r[2])},ivec4:function(e,t,r){e.uniform4i(t,r[0],r[1],r[2],r[3])},bool:function(e,t,r){e.uniform1i(t,r)},bvec2:function(e,t,r){e.uniform2i(t,r[0],r[1])},bvec3:function(e,t,r){e.uniform3i(t,r[0],r[1],r[2])},bvec4:function(e,t,r){e.uniform4i(t,r[0],r[1],r[2],r[3])},mat2:function(e,t,r){e.uniformMatrix2fv(t,!1,r)},mat3:function(e,t,r){e.uniformMatrix3fv(t,!1,r)},mat4:function(e,t,r){e.uniformMatrix4fv(t,!1,r)},sampler2D:function(e,t,r){e.uniform1i(t,r)}},o={float:function(e,t,r){e.uniform1fv(t,r)},vec2:function(e,t,r){e.uniform2fv(t,r)},vec3:function(e,t,r){e.uniform3fv(t,r)},vec4:function(e,t,r){e.uniform4fv(t,r)},int:function(e,t,r){e.uniform1iv(t,r)},ivec2:function(e,t,r){e.uniform2iv(t,r)},ivec3:function(e,t,r){e.uniform3iv(t,r)},ivec4:function(e,t,r){e.uniform4iv(t,r)},bool:function(e,t,r){e.uniform1iv(t,r)},bvec2:function(e,t,r){e.uniform2iv(t,r)},bvec3:function(e,t,r){e.uniform3iv(t,r)},bvec4:function(e,t,r){e.uniform4iv(t,r)},sampler2D:function(e,t,r){e.uniform1iv(t,r)}};e.exports=function(e,n){for(var o={data:{},gl:e},s=Object.keys(n),l=0;l<s.length;l++){var i=s[l],d=i.split('.'),u=d[d.length-1],p=r(d,o),c=n[i];p.data[u]=c,p.gl=e,Object.defineProperty(p,u,{get:a(u),set:t(u,c)})}return o}},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),l=r(12),d=a(l),u=r(1),p=r(3),c=a(p),h=r(59),g=a(h),f=r(60),m=a(f),y=r(36),x=a(y),_=r(4),b=function(e){function t(){n(this,t);var r=o(this,e.call(this)),a=c.default.TRANSFORM_MODE===u.TRANSFORM_MODE.STATIC?g.default:m.default;return r.tempDisplayObjectParent=null,r.transform=new a,r.alpha=1,r.visible=!0,r.renderable=!0,r.parent=null,r.worldAlpha=1,r.filterArea=null,r._filters=null,r._enabledFilters=null,r._bounds=new x.default,r._boundsID=0,r._lastBoundsID=-1,r._boundsRect=null,r._localBoundsRect=null,r._mask=null,r._destroyed=!1,r}return i(t,e),t.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,this._bounds.updateID++},t.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},t.prototype.getBounds=function(e,t){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&this.calculateBounds(),t||(!this._boundsRect&&(this._boundsRect=new _.Rectangle),t=this._boundsRect),this._bounds.getRectangle(t)},t.prototype.getLocalBounds=function(e){var t=this.transform,r=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,e||(!this._localBoundsRect&&(this._localBoundsRect=new _.Rectangle),e=this._localBoundsRect);var a=this.getBounds(!1,e);return this.parent=r,this.transform=t,a},t.prototype.toGlobal=function(e,t){var r=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2];return r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,t)},t.prototype.toLocal=function(e,t,r,a){return t&&(e=t.toGlobal(e,r,a)),a||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,r)},t.prototype.renderWebGL=function(){},t.prototype.renderCanvas=function(){},t.prototype.setParent=function(e){if(!e||!e.addChild)throw new Error('setParent: Argument must be a Container');return e.addChild(this),e},t.prototype.setTransform=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,n=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,i=6<arguments.length&&void 0!==arguments[6]?arguments[6]:0,s=7<arguments.length&&void 0!==arguments[7]?arguments[7]:0,l=8<arguments.length&&void 0!==arguments[8]?arguments[8]:0;return this.position.x=e,this.position.y=t,this.scale.x=r?r:1,this.scale.y=a?a:1,this.rotation=n,this.skew.x=o,this.skew.y=i,this.pivot.x=s,this.pivot.y=l,this},t.prototype.destroy=function(){this.removeAllListeners(),this.parent&&this.parent.removeChild(this),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filterArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},s(t,[{key:'_tempDisplayObjectParent',get:function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new t),this.tempDisplayObjectParent}},{key:'x',get:function(){return this.position.x},set:function(e){this.transform.position.x=e}},{key:'y',get:function(){return this.position.y},set:function(e){this.transform.position.y=e}},{key:'worldTransform',get:function(){return this.transform.worldTransform}},{key:'localTransform',get:function(){return this.transform.localTransform}},{key:'position',get:function(){return this.transform.position},set:function(e){this.transform.position.copy(e)}},{key:'scale',get:function(){return this.transform.scale},set:function(e){this.transform.scale.copy(e)}},{key:'pivot',get:function(){return this.transform.pivot},set:function(e){this.transform.pivot.copy(e)}},{key:'skew',get:function(){return this.transform.skew},set:function(e){this.transform.skew.copy(e)}},{key:'rotation',get:function(){return this.transform.rotation},set:function(e){this.transform.rotation=e}},{key:'worldVisible',get:function(){var e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0}},{key:'mask',get:function(){return this._mask},set:function(e){this._mask&&(this._mask.renderable=!0,this._mask.isMask=!1),this._mask=e,this._mask&&(this._mask.renderable=!1,this._mask.isMask=!0)}},{key:'filters',get:function(){return this._filters&&this._filters.slice()},set:function(e){this._filters=e&&e.slice()}}]),t}(d.default);t.default=b,b.prototype.displayObjectUpdateTransform=b.prototype.updateTransform},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function n(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function o(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=Math.sin,s=Math.cos;t.__esModule=!0;var l=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),d=r(4),u=r(38),p=function(e){return e&&e.__esModule?e:{default:e}}(u),c=function(e){function t(){a(this,t);var r=n(this,e.call(this));return r.position=new d.ObservablePoint(r.onChange,r,0,0),r.scale=new d.ObservablePoint(r.onChange,r,1,1),r.pivot=new d.ObservablePoint(r.onChange,r,0,0),r.skew=new d.ObservablePoint(r.updateSkew,r,0,0),r._rotation=0,r._cx=1,r._sx=0,r._cy=0,r._sy=1,r._localID=0,r._currentLocalID=0,r}return o(t,e),t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){this._cx=s(this._rotation+this.skew._y),this._sx=i(this._rotation+this.skew._y),this._cy=-i(this._rotation-this.skew._x),this._sy=s(this._rotation-this.skew._x),this._localID++},t.prototype.updateLocalTransform=function(){var e=this.localTransform;this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale._x,e.b=this._sx*this.scale._x,e.c=this._cy*this.scale._y,e.d=this._sy*this.scale._y,e.tx=this.position._x-(this.pivot._x*e.a+this.pivot._y*e.c),e.ty=this.position._y-(this.pivot._x*e.b+this.pivot._y*e.d),this._currentLocalID=this._localID,this._parentID=-1)},t.prototype.updateTransform=function(e){var t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale._x,t.b=this._sx*this.scale._x,t.c=this._cy*this.scale._y,t.d=this._sy*this.scale._y,t.tx=this.position._x-(this.pivot._x*t.a+this.pivot._y*t.c),t.ty=this.position._y-(this.pivot._x*t.b+this.pivot._y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==e._worldID){var r=e.worldTransform,a=this.worldTransform;a.a=t.a*r.a+t.b*r.c,a.b=t.a*r.b+t.b*r.d,a.c=t.c*r.a+t.d*r.c,a.d=t.c*r.b+t.d*r.d,a.tx=t.tx*r.a+t.ty*r.c+r.tx,a.ty=t.tx*r.b+t.ty*r.d+r.ty,this._parentID=e._worldID,this._worldID++}},t.prototype.setFromMatrix=function(e){e.decompose(this),this._localID++},l(t,[{key:'rotation',get:function(){return this._rotation},set:function(e){this._rotation=e,this.updateSkew()}}]),t}(p.default);t.default=c},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function n(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function o(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=Math.sin,s=Math.cos;t.__esModule=!0;var l=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),d=r(4),u=r(38),p=function(e){return e&&e.__esModule?e:{default:e}}(u),c=function(e){function t(){a(this,t);var r=n(this,e.call(this));return r.position=new d.Point(0,0),r.scale=new d.Point(1,1),r.skew=new d.ObservablePoint(r.updateSkew,r,0,0),r.pivot=new d.Point(0,0),r._rotation=0,r._cx=1,r._sx=0,r._cy=0,r._sy=1,r}return o(t,e),t.prototype.updateSkew=function(){this._cx=s(this._rotation+this.skew._y),this._sx=i(this._rotation+this.skew._y),this._cy=-i(this._rotation-this.skew._x),this._sy=s(this._rotation-this.skew._x)},t.prototype.updateLocalTransform=function(){var e=this.localTransform;e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d)},t.prototype.updateTransform=function(e){var t=this.localTransform;t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d);var r=e.worldTransform,a=this.worldTransform;a.a=t.a*r.a+t.b*r.c,a.b=t.a*r.b+t.b*r.d,a.c=t.c*r.a+t.d*r.c,a.d=t.c*r.b+t.d*r.d,a.tx=t.tx*r.a+t.ty*r.c+r.tx,a.ty=t.tx*r.b+t.ty*r.d+r.ty,this._worldID++},t.prototype.setFromMatrix=function(e){e.decompose(this)},l(t,[{key:'rotation',get:function(){return this._rotation},set:function(e){this._rotation=e,this.updateSkew()}}]),t}(p.default);t.default=c},function(e,t,r){'use strict';function a(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:window.location;if(0===e.indexOf('data:'))return'';t=t||window.location,i||(i=document.createElement('a')),i.href=e,e=o.default.parse(i.href);var r=!e.port&&''===t.port||e.port===t.port;return e.hostname===t.hostname&&r&&e.protocol===t.protocol?'':'anonymous'}t.__esModule=!0,t.default=a;var n=r(62),o=function(e){return e&&e.__esModule?e:{default:e}}(n),i=void 0},function(e,t,r){'use strict';function a(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function n(e,t,r){if(e&&d.isObject(e)&&e instanceof a)return e;var n=new a;return n.parse(e,t,r),n}var o=r(125),d=r(127);t.parse=n,t.resolve=function(e,t){return n(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?n(e,!1,!0).resolveObject(t):t},t.format=function(e){return d.isString(e)&&(e=n(e)),e instanceof a?e.format():a.prototype.format.call(e)},t.Url=a;var u=/^([a-z0-9.+-]+:)/i,i=/:[0-9]*$/,s=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,l=['{','}','|','\\','^','`'].concat(['<','>','"','`',' ','\r','\n','\t']),p=['\''].concat(l),c=['%','/','?',';','#'].concat(p),h=['/','?','#'],g=/^[+a-z0-9A-Z_-]{0,63}$/,f=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,m={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},x={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},_=r(128);a.prototype.parse=function(e,t,r){if(!d.isString(e))throw new TypeError('Parameter \'url\' must be a string, not '+typeof e);var a=e.indexOf('?'),n=-1!==a&&a<e.indexOf('#')?'?':'#',b=e.split(n),T=/\\/g;b[0]=b[0].replace(T,'/'),e=b.join(n);var v=e;if(v=v.trim(),!r&&1===e.split('#').length){var E=s.exec(v);if(E)return this.path=v,this.href=v,this.pathname=E[1],E[2]?(this.search=E[2],this.query=t?_.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search='',this.query={}),this}var S=u.exec(v);if(S){S=S[0];var C=S.toLowerCase();this.protocol=C,v=v.substr(S.length)}if(r||S||v.match(/^\/\/[^@\/]+@[^@\/]+/)){var P='//'===v.substr(0,2);P&&!(S&&y[S])&&(v=v.substr(2),this.slashes=!0)}if(!y[S]&&(P||S&&!x[S])){for(var w=-1,M=0,i;M<h.length;M++)i=v.indexOf(h[M]),-1!==i&&(-1===w||i<w)&&(w=i);var A,I;I=-1===w?v.lastIndexOf('@'):v.lastIndexOf('@',w),-1!==I&&(A=v.slice(0,I),v=v.slice(I+1),this.auth=decodeURIComponent(A)),w=-1;for(var M=0,i;M<c.length;M++)i=v.indexOf(c[M]),-1!==i&&(-1===w||i<w)&&(w=i);-1===w&&(w=v.length),this.host=v.slice(0,w),v=v.slice(w),this.parseHost(),this.hostname=this.hostname||'';var R='['===this.hostname[0]&&']'===this.hostname[this.hostname.length-1];if(!R)for(var D=this.hostname.split(/\./),M=0,O=D.length,l;M<O;M++)if(l=D[M],l&&!l.match(g)){for(var L='',N=0,F=l.length;N<F;N++)L+=127<l.charCodeAt(N)?'x':l[N];if(!L.match(g)){var k=D.slice(0,M),B=D.slice(M+1),U=l.match(f);U&&(k.push(U[1]),B.unshift(U[2])),B.length&&(v='/'+B.join('.')+v),this.hostname=k.join('.');break}}this.hostname=this.hostname.length>255?'':this.hostname.toLowerCase(),R||(this.hostname=o.toASCII(this.hostname));var G=this.port?':'+this.port:'',V=this.hostname||'';this.host=V+G,this.href+=this.host,R&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),'/'!==v[0]&&(v='/'+v))}if(!m[C])for(var M=0,O=p.length,W;M<O;M++)if(W=p[M],-1!==v.indexOf(W)){var X=encodeURIComponent(W);X===W&&(X=escape(W)),v=v.split(W).join(X)}var H=v.indexOf('#');-1!==H&&(this.hash=v.substr(H),v=v.slice(0,H));var Y=v.indexOf('?');if(-1===Y?t&&(this.search='',this.query={}):(this.search=v.substr(Y),this.query=v.substr(Y+1),t&&(this.query=_.parse(this.query)),v=v.slice(0,Y)),v&&(this.pathname=v),x[C]&&this.hostname&&!this.pathname&&(this.pathname='/'),this.pathname||this.search){var G=this.pathname||'',z=this.search||'';this.path=G+z}return this.href=this.format(),this},a.prototype.format=function(){var e=this.auth||'';e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,':'),e+='@');var t=this.protocol||'',r=this.pathname||'',a=this.hash||'',n=!1,o='';this.host?n=e+this.host:this.hostname&&(n=e+(-1===this.hostname.indexOf(':')?this.hostname:'['+this.hostname+']'),this.port&&(n+=':'+this.port)),this.query&&d.isObject(this.query)&&Object.keys(this.query).length&&(o=_.stringify(this.query));var i=this.search||o&&'?'+o||'';return t&&':'!==t.substr(-1)&&(t+=':'),this.slashes||(!t||x[t])&&!1!=n?(n='//'+(n||''),r&&'/'!==r.charAt(0)&&(r='/'+r)):!n&&(n=''),a&&'#'!==a.charAt(0)&&(a='#'+a),i&&'?'!==i.charAt(0)&&(i='?'+i),r=r.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),i=i.replace('#','%23'),t+n+r+i+a},a.prototype.resolve=function(e){return this.resolveObject(n(e,!1,!0)).format()},a.prototype.resolveObject=function(e){if(d.isString(e)){var t=new a;t.parse(e,!1,!0),e=t}for(var r=new a,n=Object.keys(this),o=0,l;o<n.length;o++)l=n[o],r[l]=this[l];if(r.hash=e.hash,''===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var u=Object.keys(e),c=0,h;c<u.length;c++)h=u[c],'protocol'!==h&&(r[h]=e[h]);return x[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname='/'),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!x[e.protocol]){for(var g=Object.keys(e),f=0,m;f<g.length;f++)m=g[f],r[m]=e[m];return r.href=r.format(),r}if(r.protocol=e.protocol,!e.host&&!y[e.protocol]){for(var _=(e.pathname||'').split('/');_.length&&!(e.host=_.shift()););e.host||(e.host=''),e.hostname||(e.hostname=''),''!==_[0]&&_.unshift(''),2>_.length&&_.unshift(''),r.pathname=_.join('/')}else r.pathname=e.pathname;if(r.search=e.search,r.query=e.query,r.host=e.host||'',r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var b=r.pathname||'',p=r.search||'';r.path=b+p}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var s=r.pathname&&'/'===r.pathname.charAt(0),T=e.host||e.pathname&&'/'===e.pathname.charAt(0),v=T||s||r.host&&e.pathname,E=v,S=r.pathname&&r.pathname.split('/')||[],_=e.pathname&&e.pathname.split('/')||[],C=r.protocol&&!x[r.protocol];if(C&&(r.hostname='',r.port=null,r.host&&(''===S[0]?S[0]=r.host:S.unshift(r.host)),r.host='',e.protocol&&(e.hostname=null,e.port=null,e.host&&(''===_[0]?_[0]=e.host:_.unshift(e.host)),e.host=null),v=v&&(''===_[0]||''===S[0])),T)r.host=e.host||''===e.host?e.host:r.host,r.hostname=e.hostname||''===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,S=_;else if(_.length)S||(S=[]),S.pop(),S=S.concat(_),r.search=e.search,r.query=e.query;else if(!d.isNullOrUndefined(e.search)){if(C){r.hostname=r.host=S.shift();var P=!!(r.host&&0<r.host.indexOf('@'))&&r.host.split('@');P&&(r.auth=P.shift(),r.host=r.hostname=P.shift())}return r.search=e.search,r.query=e.query,d.isNull(r.pathname)&&d.isNull(r.search)||(r.path=(r.pathname?r.pathname:'')+(r.search?r.search:'')),r.href=r.format(),r}if(!S.length)return r.pathname=null,r.path=r.search?'/'+r.search:null,r.href=r.format(),r;for(var w=S.slice(-1)[0],M=(r.host||e.host||1<S.length)&&('.'===w||'..'===w)||''===w,A=0,I=S.length;0<=I;I--)w=S[I],'.'===w?S.splice(I,1):'..'===w?(S.splice(I,1),A++):A&&(S.splice(I,1),A--);if(!v&&!E)for(;A--;A)S.unshift('..');v&&''!==S[0]&&(!S[0]||'/'!==S[0].charAt(0))&&S.unshift(''),M&&'/'!==S.join('/').substr(-1)&&S.push('');var i=''===S[0]||S[0]&&'/'===S[0].charAt(0);if(C){r.hostname=r.host=i?'':S.length?S.shift():'';var P=!!(r.host&&0<r.host.indexOf('@'))&&r.host.split('@');P&&(r.auth=P.shift(),r.host=r.hostname=P.shift())}return v=v||r.host&&S.length,v&&!i&&S.unshift(''),S.length?r.pathname=S.join('/'):(r.pathname=null,r.path=null),d.isNull(r.pathname)&&d.isNull(r.search)||(r.path=(r.pathname?r.pathname:'')+(r.search?r.search:'')),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},a.prototype.parseHost=function(){var e=this.host,t=i.exec(e);t&&(t=t[0],':'!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){t||(t='video/'+e.substr(e.lastIndexOf('.')+1));var r=document.createElement('source');return r.src=e,r.type=t,r}t.__esModule=!0;var l=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),d=r(14),u=a(d),p=r(2),c=r(41),h=r(1),g=r(61),f=a(g),m=function(e){function t(r,a){if(n(this,t),!r)throw new Error('No video source element specified.');(r.readyState===r.HAVE_ENOUGH_DATA||r.readyState===r.HAVE_FUTURE_DATA)&&r.width&&r.height&&(r.complete=!0);var i=o(this,e.call(this,r,a));return i.width=r.videoWidth,i.height=r.videoHeight,i._autoUpdate=!0,i._isAutoUpdating=!1,i.autoPlay=!0,i.update=i.update.bind(i),i._onCanPlay=i._onCanPlay.bind(i),r.addEventListener('play',i._onPlayStart.bind(i)),r.addEventListener('pause',i._onPlayStop.bind(i)),i.hasLoaded=!1,i.__loaded=!1,i._isSourceReady()?i._onCanPlay():(r.addEventListener('canplay',i._onCanPlay),r.addEventListener('canplaythrough',i._onCanPlay)),i}return i(t,e),t.prototype._isSourcePlaying=function(){var e=this.source;return 0<e.currentTime&&!1===e.paused&&!1===e.ended&&2<e.readyState},t.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},t.prototype._onPlayStart=function(){this.hasLoaded||this._onCanPlay(),!this._isAutoUpdating&&this.autoUpdate&&(c.shared.add(this.update,this,h.UPDATE_PRIORITY.HIGH),this._isAutoUpdating=!0)},t.prototype._onPlayStop=function(){this._isAutoUpdating&&(c.shared.remove(this.update,this),this._isAutoUpdating=!1)},t.prototype._onCanPlay=function(){this.hasLoaded=!0,this.source&&(this.source.removeEventListener('canplay',this._onCanPlay),this.source.removeEventListener('canplaythrough',this._onCanPlay),this.width=this.source.videoWidth,this.height=this.source.videoHeight,!this.__loaded&&(this.__loaded=!0,this.emit('loaded',this)),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.source.play())},t.prototype.destroy=function(){this._isAutoUpdating&&c.shared.remove(this.update,this),this.source&&this.source._pixiId&&(u.default.removeFromCache(this.source._pixiId),delete this.source._pixiId,this.source.pause(),this.source.src='',this.source.load()),e.prototype.destroy.call(this)},t.fromVideo=function(e,r){e._pixiId||(e._pixiId='video_'+(0,p.uid)());var a=p.BaseTextureCache[e._pixiId];return a||(a=new t(e,r),u.default.addToCache(a,e._pixiId)),a},t.fromUrl=function(e,r,a){var n=document.createElement('video');n.setAttribute('webkit-playsinline',''),n.setAttribute('playsinline','');var o=Array.isArray(e)?e[0].src||e[0]:e.src||e;if(void 0===a&&0!==o.indexOf('data:')?n.crossOrigin=(0,f.default)(o):a&&(n.crossOrigin='string'==typeof a?a:'anonymous'),Array.isArray(e))for(var l=0;l<e.length;++l)n.appendChild(s(e[l].src||e[l],e[l].mime));else n.appendChild(s(o,e.mime));return n.load(),t.fromVideo(n,r)},l(t,[{key:'autoUpdate',get:function(){return this._autoUpdate},set:function(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isAutoUpdating?(c.shared.remove(this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(c.shared.add(this.update,this,h.UPDATE_PRIORITY.HIGH),this._isAutoUpdating=!0))}}]),t}(u.default);t.default=m,m.fromUrls=m.fromUrl},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var n=r(48),o=function(e){return e&&e.__esModule?e:{default:e}}(n),i=function(){function e(){a(this,e),this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsUint32=new Uint32Array(4)}return e.prototype.set=function(e,t,r){var a=t.width,n=t.height;if(r){var i=e.width/2/a,s=e.height/2/n,l=e.x/a+i,d=e.y/n+s;r=o.default.add(r,o.default.NW),this.x0=l+i*o.default.uX(r),this.y0=d+s*o.default.uY(r),r=o.default.add(r,2),this.x1=l+i*o.default.uX(r),this.y1=d+s*o.default.uY(r),r=o.default.add(r,2),this.x2=l+i*o.default.uX(r),this.y2=d+s*o.default.uY(r),r=o.default.add(r,2),this.x3=l+i*o.default.uX(r),this.y3=d+s*o.default.uY(r)}else this.x0=e.x/a,this.y0=e.y/n,this.x1=(e.x+e.width)/a,this.y1=e.y/n,this.x2=(e.x+e.width)/a,this.y2=(e.y+e.height)/n,this.x3=e.x/a,this.y3=(e.y+e.height)/n;this.uvsUint32[0]=(65535&65535*this.y0)<<16|65535&65535*this.x0,this.uvsUint32[1]=(65535&65535*this.y1)<<16|65535&65535*this.x1,this.uvsUint32[2]=(65535&65535*this.y2)<<16|65535&65535*this.x2,this.uvsUint32[3]=(65535&65535*this.y3)<<16|65535&65535*this.x3},e}();t.default=i},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),l=r(2),d=r(4),u=r(1),p=r(3),c=a(p),h=r(15),g=a(h),f=r(42),m=a(f),y=r(12),x=a(y),_=new d.Matrix,b=function(e){function t(r,a,i,s){n(this,t);var p=o(this,e.call(this));return(0,l.sayHello)(r),'number'==typeof a&&(a=Object.assign({width:a,height:i||c.default.RENDER_OPTIONS.height},s)),a=Object.assign({},c.default.RENDER_OPTIONS,a),p.options=a,p.type=u.RENDERER_TYPE.UNKNOWN,p.screen=new d.Rectangle(0,0,a.width,a.height),p.view=a.view||document.createElement('canvas'),p.resolution=a.resolution||c.default.RESOLUTION,p.transparent=a.transparent,p.autoResize=a.autoResize||!1,p.blendModes=null,p.preserveDrawingBuffer=a.preserveDrawingBuffer,p.clearBeforeRender=a.clearBeforeRender,p.roundPixels=a.roundPixels,p._backgroundColor=0,p._backgroundColorRgba=[0,0,0,0],p._backgroundColorString='#000000',p.backgroundColor=a.backgroundColor||p._backgroundColor,p._tempDisplayObjectParent=new g.default,p._lastObjectRendered=p._tempDisplayObjectParent,p}return i(t,e),t.prototype.resize=function(e,t){this.screen.width=e,this.screen.height=t,this.view.width=e*this.resolution,this.view.height=t*this.resolution,this.autoResize&&(this.view.style.width=e+'px',this.view.style.height=t+'px')},t.prototype.generateTexture=function(e,t,r,a){a=a||e.getLocalBounds();var n=m.default.create(0|a.width,0|a.height,t,r);return _.tx=-a.x,_.ty=-a.y,this.render(e,n,!1,_,!0),n},t.prototype.destroy=function(e){e&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.type=u.RENDERER_TYPE.UNKNOWN,this.view=null,this.screen=null,this.resolution=0,this.transparent=!1,this.autoResize=!1,this.blendModes=null,this.options=null,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!1,this.roundPixels=!1,this._backgroundColor=0,this._backgroundColorRgba=null,this._backgroundColorString=null,this._tempDisplayObjectParent=null,this._lastObjectRendered=null},s(t,[{key:'width',get:function(){return this.view.width}},{key:'height',get:function(){return this.view.height}},{key:'backgroundColor',get:function(){return this._backgroundColor},set:function(e){this._backgroundColor=e,this._backgroundColorString=(0,l.hex2string)(e),(0,l.hex2rgb)(e,this._backgroundColorRgba)}}]),t}(x.default);t.default=b},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=Math.ceil;t.__esModule=!0;var l=r(14),d=a(l),u=r(3),p=a(u),c=function(e){function t(){var r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:100,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:100,i=arguments[2],l=arguments[3];n(this,t);var d=o(this,e.call(this,null,i));return d.resolution=l||p.default.RESOLUTION,d.width=s(r),d.height=s(a),d.realWidth=d.width*d.resolution,d.realHeight=d.height*d.resolution,d.scaleMode=void 0===i?p.default.SCALE_MODE:i,d.hasLoaded=!0,d._glRenderTargets={},d._canvasRenderTarget=null,d.valid=!1,d}return i(t,e),t.prototype.resize=function(e,t){(e=s(e),t=s(t),e!==this.width||t!==this.height)&&(this.valid=0<e&&0<t,this.width=e,this.height=t,this.realWidth=this.width*this.resolution,this.realHeight=this.height*this.resolution,this.valid&&this.emit('update',this))},t.prototype.destroy=function(){e.prototype.destroy.call(this,!0),this.renderer=null},t}(d.default);t.default=c},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var n=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),o=r(3),i=function(e){return e&&e.__esModule?e:{default:e}}(o),s=function(){function e(t,r,n){a(this,e),this.canvas=document.createElement('canvas'),this.context=this.canvas.getContext('2d'),this.resolution=n||i.default.RESOLUTION,this.resize(t,r)}return e.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},e.prototype.resize=function(e,t){this.canvas.width=e*this.resolution,this.canvas.height=t*this.resolution},e.prototype.destroy=function(){this.context=null,this.canvas=null},n(e,[{key:'width',get:function(){return this.canvas.width},set:function(e){this.canvas.width=e}},{key:'height',get:function(){return this.canvas.height},set:function(e){this.canvas.height=e}}]),e}();t.default=s},function(e,t){'use strict';function r(e){var t=document.createElement('canvas');t.width=6,t.height=1;var r=t.getContext('2d');return r.fillStyle=e,r.fillRect(0,0,6,1),t}t.__esModule=!0,t.default=function(){if('undefined'==typeof document)return!1;var e=r('#ff00ff'),t=r('#ffff00'),a=document.createElement('canvas');a.width=6,a.height=1;var n=a.getContext('2d');n.globalCompositeOperation='multiply',n.drawImage(e,0,0),n.drawImage(t,2,0);var o=n.getImageData(2,0,1,1);if(!o)return!1;var i=o.data;return 255===i[0]&&0===i[1]&&0===i[2]}},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=r(70),l=a(s),d=r(4),u=r(9),p=r(71),c=a(p),h=function(e){function t(r){n(this,t);var a=new d.Matrix,i=o(this,e.call(this,'attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n','varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n\n    original *= (masky.r * masky.a * alpha * clip);\n\n    gl_FragColor = original;\n}\n'));return r.renderable=!1,i.maskSprite=r,i.maskMatrix=a,i}return i(t,e),t.prototype.apply=function(e,t,r){var a=this.maskSprite,n=this.maskSprite.texture;n.valid&&(!n.transform&&(n.transform=new c.default(n,0)),n.transform.update(),this.uniforms.mask=n,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,a).prepend(n.transform.mapCoord),this.uniforms.alpha=a.worldAlpha,this.uniforms.maskClamp=n.transform.uClampFrame,e.applyFilter(this,t,r))},t}(l.default);t.default=h},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var o=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),i=r(138),s=a(i),l=r(2),d=r(1),u=r(3),p=a(u),c={},h=function(){function e(t,r,a){for(var o in n(this,e),this.vertexSrc=t||e.defaultVertexSrc,this.fragmentSrc=r||e.defaultFragmentSrc,this._blendMode=d.BLEND_MODES.NORMAL,this.uniformData=a||(0,s.default)(this.vertexSrc,this.fragmentSrc,'projectionMatrix|uSampler'),this.uniforms={},this.uniformData)this.uniforms[o]=this.uniformData[o].value,this.uniformData[o].type&&(this.uniformData[o].type=this.uniformData[o].type.toLowerCase());this.glShaders={},c[this.vertexSrc+this.fragmentSrc]||(c[this.vertexSrc+this.fragmentSrc]=(0,l.uid)()),this.glShaderKey=c[this.vertexSrc+this.fragmentSrc],this.padding=4,this.resolution=p.default.RESOLUTION,this.enabled=!0,this.autoFit=!0}return e.prototype.apply=function(e,t,r,a){e.applyFilter(this,t,r,a)},o(e,[{key:'blendMode',get:function(){return this._blendMode},set:function(e){this._blendMode=e}}],[{key:'defaultVertexSrc',get:function(){return'attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n   vTextureCoord = aTextureCoord ;\n}'}},{key:'defaultFragmentSrc',get:function(){return'varying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\nuniform sampler2D uSampler;\nuniform sampler2D filterSampler;\nvoid main(void){\n   vec4 masky = texture2D(filterSampler, vFilterCoord);\n   vec4 sample = texture2D(uSampler, vTextureCoord);\n   vec4 color;\n   if(mod(vFilterCoord.x, 1.0) > 0.5)\n   {\n     color = vec4(1.0, 0.0, 0.0, 1.0);\n   }\n   else\n   {\n     color = vec4(0.0, 1.0, 0.0, 1.0);\n   }\n   gl_FragColor = mix(sample, masky, 0.5);\n   gl_FragColor *= sample.a;\n}'}}]),e}();t.default=h},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var n=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),o=r(33),i=function(e){return e&&e.__esModule?e:{default:e}}(o),s=new i.default,l=function(){function e(t,r){a(this,e),this._texture=t,this.mapCoord=new i.default,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._lastTextureID=-1,this.clampOffset=0,this.clampMargin='undefined'==typeof r?.5:r}return e.prototype.multiplyUvs=function(e,t){void 0===t&&(t=e);for(var r=this.mapCoord,a=0;a<e.length;a+=2){var n=e[a],o=e[a+1];t[a]=n*r.a+o*r.c+r.tx,t[a+1]=n*r.b+o*r.d+r.ty}return t},e.prototype.update=function(e){var t=this._texture;if(!t||!t.valid)return!1;if(!e&&this._lastTextureID===t._updateID)return!1;this._lastTextureID=t._updateID;var r=t._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);var a=t.orig,n=t.trim;n&&(s.set(a.width/n.width,0,0,a.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(s));var o=t.baseTexture,i=this.uClampFrame,l=this.clampMargin/o.resolution,d=this.clampOffset;return i[0]=(t._frame.x+l+d)/o.width,i[1]=(t._frame.y+l+d)/o.height,i[2]=(t._frame.x+t._frame.width-l+d)/o.width,i[3]=(t._frame.y+t._frame.height-l+d)/o.height,this.uClampOffset[0]=d/o.realWidth,this.uClampOffset[1]=d/o.realHeight,!0},n(e,[{key:'texture',get:function(){return this._texture},set:function(e){this._texture=e,this._lastTextureID=-1}}]),e}();t.default=l},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var o=r(7),s=a(o),i=r(44),l=a(i),d=function(){function e(t,r){n(this,e),this.gl=t,this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.interleaved=new Float32Array(16);for(var a=0;4>a;a++)this.interleaved[4*a]=this.vertices[2*a],this.interleaved[4*a+1]=this.vertices[2*a+1],this.interleaved[4*a+2]=this.uvs[2*a],this.interleaved[4*a+3]=this.uvs[2*a+1];this.indices=(0,l.default)(1),this.vertexBuffer=s.default.GLBuffer.createVertexBuffer(t,this.interleaved,t.STATIC_DRAW),this.indexBuffer=s.default.GLBuffer.createIndexBuffer(t,this.indices,t.STATIC_DRAW),this.vao=new s.default.VertexArrayObject(t,r)}return e.prototype.initVao=function(e){this.vao.clear().addIndex(this.indexBuffer).addAttribute(this.vertexBuffer,e.attributes.aVertexPosition,this.gl.FLOAT,!1,16,0).addAttribute(this.vertexBuffer,e.attributes.aTextureCoord,this.gl.FLOAT,!1,16,8)},e.prototype.map=function(e,t){var r=0,a=0;return this.uvs[0]=r,this.uvs[1]=a,this.uvs[2]=r+t.width/e.width,this.uvs[3]=a,this.uvs[4]=r+t.width/e.width,this.uvs[5]=a+t.height/e.height,this.uvs[6]=r,this.uvs[7]=a+t.height/e.height,r=t.x,a=t.y,this.vertices[0]=r,this.vertices[1]=a,this.vertices[2]=r+t.width,this.vertices[3]=a,this.vertices[4]=r+t.width,this.vertices[5]=a+t.height,this.vertices[6]=r,this.vertices[7]=a+t.height,this},e.prototype.upload=function(){for(var e=0;4>e;e++)this.interleaved[4*e]=this.vertices[2*e],this.interleaved[4*e+1]=this.vertices[2*e+1],this.interleaved[4*e+2]=this.uvs[2*e],this.interleaved[4*e+3]=this.uvs[2*e+1];return this.vertexBuffer.upload(this.interleaved),this},e.prototype.destroy=function(){var e=this.gl;e.deleteBuffer(this.vertexBuffer),e.deleteBuffer(this.indexBuffer)},e}();t.default=d},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function n(e){return'number'==typeof e?(0,u.hex2string)(e):('string'==typeof e&&0===e.indexOf('0x')&&(e=e.replace('0x','#')),e)}function o(e){if(!Array.isArray(e))return n(e);for(var t=0;t<e.length;++t)e[t]=n(e[t]);return e}function i(e,t){if(!Array.isArray(e)||!Array.isArray(t))return!1;if(e.length!==t.length)return!1;for(var r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}function s(e,t,r){for(var a in r)e[a]=Array.isArray(t[a])?t[a].slice():t[a]}t.__esModule=!0;var l=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),d=r(1),u=r(2),p={align:'left',breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:'black',dropShadowDistance:5,fill:'black',fillGradientType:d.TEXT_GRADIENT.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:'Arial',fontSize:26,fontStyle:'normal',fontVariant:'normal',fontWeight:'normal',letterSpacing:0,lineHeight:0,lineJoin:'miter',miterLimit:10,padding:0,stroke:'black',strokeThickness:0,textBaseline:'alphabetic',trim:!1,wordWrap:!1,wordWrapWidth:100,leading:0},c=function(){function e(t){a(this,e),this.styleID=0,this.reset(),s(this,t,t)}return e.prototype.clone=function(){var t={};return s(t,this,p),new e(t)},e.prototype.reset=function(){s(this,p,p)},e.prototype.toFontString=function(){var e='number'==typeof this.fontSize?this.fontSize+'px':this.fontSize,t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(','));for(var r=t.length-1,a;0<=r;r--)a=t[r].trim(),/([\"\'])[^\'\"]+\1/.test(a)||(a='"'+a+'"'),t[r]=a;return this.fontStyle+' '+this.fontVariant+' '+this.fontWeight+' '+e+' '+t.join(',')},l(e,[{key:'align',get:function(){return this._align},set:function(e){this._align!==e&&(this._align=e,this.styleID++)}},{key:'breakWords',get:function(){return this._breakWords},set:function(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)}},{key:'dropShadow',get:function(){return this._dropShadow},set:function(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)}},{key:'dropShadowAlpha',get:function(){return this._dropShadowAlpha},set:function(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)}},{key:'dropShadowAngle',get:function(){return this._dropShadowAngle},set:function(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)}},{key:'dropShadowBlur',get:function(){return this._dropShadowBlur},set:function(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)}},{key:'dropShadowColor',get:function(){return this._dropShadowColor},set:function(e){var t=o(e);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)}},{key:'dropShadowDistance',get:function(){return this._dropShadowDistance},set:function(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)}},{key:'fill',get:function(){return this._fill},set:function(e){var t=o(e);this._fill!==t&&(this._fill=t,this.styleID++)}},{key:'fillGradientType',get:function(){return this._fillGradientType},set:function(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)}},{key:'fillGradientStops',get:function(){return this._fillGradientStops},set:function(e){i(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)}},{key:'fontFamily',get:function(){return this._fontFamily},set:function(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)}},{key:'fontSize',get:function(){return this._fontSize},set:function(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)}},{key:'fontStyle',get:function(){return this._fontStyle},set:function(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)}},{key:'fontVariant',get:function(){return this._fontVariant},set:function(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)}},{key:'fontWeight',get:function(){return this._fontWeight},set:function(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)}},{key:'letterSpacing',get:function(){return this._letterSpacing},set:function(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)}},{key:'lineHeight',get:function(){return this._lineHeight},set:function(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)}},{key:'leading',get:function(){return this._leading},set:function(e){this._leading!==e&&(this._leading=e,this.styleID++)}},{key:'lineJoin',get:function(){return this._lineJoin},set:function(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)}},{key:'miterLimit',get:function(){return this._miterLimit},set:function(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)}},{key:'padding',get:function(){return this._padding},set:function(e){this._padding!==e&&(this._padding=e,this.styleID++)}},{key:'stroke',get:function(){return this._stroke},set:function(e){var t=o(e);this._stroke!==t&&(this._stroke=t,this.styleID++)}},{key:'strokeThickness',get:function(){return this._strokeThickness},set:function(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)}},{key:'textBaseline',get:function(){return this._textBaseline},set:function(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)}},{key:'trim',get:function(){return this._trim},set:function(e){this._trim!==e&&(this._trim=e,this.styleID++)}},{key:'wordWrap',get:function(){return this._wordWrap},set:function(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)}},{key:'wordWrapWidth',get:function(){return this._wordWrapWidth},set:function(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)}}]),e}();t.default=c},function(e,t){'use strict';function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var a=Math.ceil,n=Math.max;t.__esModule=!0;var o=function(){function e(t,a,n,o,i,s,l,d,u){r(this,e),this.text=t,this.style=a,this.width=n,this.height=o,this.lines=i,this.lineWidths=s,this.lineHeight=l,this.maxLineWidth=d,this.fontProperties=u}return e.measureText=function(t,r,a){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:e._canvas;a=a||r.wordWrap;var s=r.toFontString(),l=e.measureFont(s),d=o.getContext('2d');d.font=s;for(var u=a?e.wordWrap(t,r,o):t,p=u.split(/(?:\r\n|\r|\n)/),c=Array(p.length),h=0,g=0,i;g<p.length;g++)i=d.measureText(p[g]).width+(p[g].length-1)*r.letterSpacing,c[g]=i,h=n(h,i);var f=h+r.strokeThickness;r.dropShadow&&(f+=r.dropShadowDistance);var m=r.lineHeight||l.fontSize+r.strokeThickness,y=n(m,l.fontSize+r.strokeThickness)+(p.length-1)*(m+r.leading);return r.dropShadow&&(y+=r.dropShadowDistance),new e(t,r,f,y,p,c,m+r.leading,h,l)},e.wordWrap=function(t,r){for(var a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:e._canvas,n=a.getContext('2d'),o='',s=t.charAt(0),l=t.split('\n'),d=r.wordWrapWidth,u={},p=0;p<l.length;p++){for(var i=d,h=l[p].split(' '),g=0,f;g<h.length;g++)if(f=n.measureText(h[g]).width,r.breakWords&&f>d)for(var m=h[g].split(''),y=0;y<m.length;y++){var c=m[y],x=u[c];void 0===x&&(x=n.measureText(c).width,u[c]=x),x>i?(o+='\n'+c,i=d-x):(0===y&&(0<g||' '===s)&&(o+=' '),o+=c,i-=x)}else{var _=f+n.measureText(' ').width;0===g||_>i?(0<g&&(o+='\n'),o+=h[g],i=d-f):(i-=_,o+=' '+h[g])}p<l.length-1&&(o+='\n')}return o},e.measureFont=function(t){if(e._fonts[t])return e._fonts[t];var r={},n=e._canvas,o=e._context;o.font=t;var s=a(o.measureText('|M\xC9q').width),l=a(o.measureText('M').width),d=2*l;l=0|1.4*l,n.width=s,n.height=d,o.fillStyle='#f00',o.fillRect(0,0,s,d),o.font=t,o.textBaseline='alphabetic',o.fillStyle='#000',o.fillText('|M\xC9q',0,l);var u=o.getImageData(0,0,s,d).data,p=u.length,c=4*s,h=0,i=0,g=!1;for(h=0;h<l;++h){for(var f=0;f<c;f+=4)if(255!==u[i+f]){g=!0;break}if(!g)i+=c;else break}for(r.ascent=l-h,i=p-c,g=!1,h=d;h>l;--h){for(var m=0;m<c;m+=4)if(255!==u[i+m]){g=!0;break}if(!g)i-=c;else break}return r.descent=h-l,r.fontSize=r.ascent+r.descent,e._fonts[t]=r,r},e}();t.default=o;var i=document.createElement('canvas');i.width=i.height=10,o._canvas=i,o._context=i.getContext('2d'),o._fonts={}},function(e,t){'use strict';function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var a=function(){function e(t,a,n,o,i,s,l,d){r(this,e),this.lineWidth=t,this.nativeLines=l,this.lineColor=a,this.lineAlpha=n,this._lineTint=a,this.fillColor=o,this.fillAlpha=i,this._fillTint=o,this.fill=s,this.holes=[],this.shape=d,this.type=d.type}return e.prototype.clone=function(){return new e(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.nativeLines,this.shape)},e.prototype.addHole=function(e){this.holes.push(e)},e.prototype.destroy=function(){this.shape=null,this.holes=null},e}();t.default=a},function(e){'use strict';function t(e,t,a){a=a||2;var n=t&&t.length,s=n?t[0]*a:e.length,l=r(e,0,s,a,!0),u=[];if(!l)return u;var p,c,h,g,f,m,y;if(n&&(l=d(e,t,l,a)),e.length>80*a){p=h=e[0],c=g=e[1];for(var x=a;x<s;x+=a)f=e[x],m=e[x+1],f<p&&(p=f),m<c&&(c=m),f>h&&(h=f),m>g&&(g=m);y=Math.max(h-p,g-c),y=0===y?0:1/y}return o(l,u,a,p,c,y),u}function r(e,t,r,a,n){var o,i;if(n===0<A(e,t,r,a))for(o=t;o<r;o+=a)i=b(o,e[o],e[o+1],i);else for(o=r-a;o>=t;o-=a)i=b(o,e[o],e[o+1],i);return i&&T(i,i.next)&&(w(i),i=i.next),i}function n(e,t){if(!e)return e;t||(t=e);var r=e,a;do if(a=!1,!r.steiner&&(T(r,r.next)||0===_(r.prev,r,r.next))){if(w(r),r=t=r.prev,r===r.next)break;a=!0}else r=r.next;while(a||r!==t);return t}function o(e,t,r,d,u,p,c){if(e){!c&&p&&h(e,d,u,p);for(var g=e,f,m;e.prev!==e.next;){if(f=e.prev,m=e.next,p?i(e,d,u,p):a(e)){t.push(f.i/r),t.push(e.i/r),t.push(m.i/r),w(e),e=m.next,g=m.next;continue}if(e=m,e===g){c?1===c?(e=s(e,t,r),o(e,t,r,d,u,p,2)):2==c&&l(e,t,r,d,u,p):o(n(e),t,r,d,u,p,1);break}}}}function a(e){var t=e.prev,r=e,a=e.next;if(0<=_(t,r,a))return!1;for(var n=e.next.next;n!==e.prev;){if(y(t.x,t.y,r.x,r.y,a.x,a.y,n.x,n.y)&&0<=_(n.prev,n,n.next))return!1;n=n.next}return!0}function i(e,t,r,o){var i=e.prev,a=e,s=e.next;if(0<=_(i,a,s))return!1;for(var l=i.x<a.x?i.x<s.x?i.x:s.x:a.x<s.x?a.x:s.x,d=i.y<a.y?i.y<s.y?i.y:s.y:a.y<s.y?a.y:s.y,u=i.x>a.x?i.x>s.x?i.x:s.x:a.x>s.x?a.x:s.x,c=i.y>a.y?i.y>s.y?i.y:s.y:a.y>s.y?a.y:s.y,h=f(l,d,t,r,o),g=f(u,c,t,r,o),m=e.prevZ,p=e.nextZ;m&&m.z>=h&&p&&p.z<=g;){if(m!==e.prev&&m!==e.next&&y(i.x,i.y,a.x,a.y,s.x,s.y,m.x,m.y)&&0<=_(m.prev,m,m.next))return!1;if(m=m.prevZ,p!==e.prev&&p!==e.next&&y(i.x,i.y,a.x,a.y,s.x,s.y,p.x,p.y)&&0<=_(p.prev,p,p.next))return!1;p=p.nextZ}for(;m&&m.z>=h;){if(m!==e.prev&&m!==e.next&&y(i.x,i.y,a.x,a.y,s.x,s.y,m.x,m.y)&&0<=_(m.prev,m,m.next))return!1;m=m.prevZ}for(;p&&p.z<=g;){if(p!==e.prev&&p!==e.next&&y(i.x,i.y,a.x,a.y,s.x,s.y,p.x,p.y)&&0<=_(p.prev,p,p.next))return!1;p=p.nextZ}return!0}function s(e,t,r){var n=e;do{var o=n.prev,a=n.next.next;!T(o,a)&&v(o,n,n.next,a)&&S(o,a)&&S(a,o)&&(t.push(o.i/r),t.push(n.i/r),t.push(a.i/r),w(n),w(n.next),n=e=a),n=n.next}while(n!==e);return n}function l(e,t,r,i,s,l){var d=e;do{for(var a=d.next.next;a!==d.prev;){if(d.i!==a.i&&x(d,a)){var u=P(d,a);return d=n(d,d.next),u=n(u,u.next),o(d,t,r,i,s,l),void o(u,t,r,i,s,l)}a=a.next}d=d.next}while(d!==e)}function d(e,t,a,o){var s=[],l,i,d,c,h;for(l=0,i=t.length;l<i;l++)d=t[l]*o,c=l<i-1?t[l+1]*o:e.length,h=r(e,d,c,o,!1),h===h.next&&(h.steiner=!0),s.push(m(h));for(s.sort(u),l=0;l<s.length;l++)p(s[l],a),a=n(a,a.next);return a}function u(e,t){return e.x-t.x}function p(e,t){if(t=c(e,t),t){var r=P(t,e);n(r,r.next)}}function c(e,t){var r=t,a=e.x,n=e.y,o=-Infinity,i;do{if(n<=r.y&&n>=r.next.y&&r.next.y!==r.y){var s=r.x+(n-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=a&&s>o){if(o=s,s===a){if(n===r.y)return r;if(n===r.next.y)return r.next}i=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!i)return null;if(a===o)return i.prev;var l=i,d=i.x,u=i.y,p=Infinity,c;for(r=i.next;r!==l;)a>=r.x&&r.x>=d&&a!==r.x&&y(n<u?a:o,n,d,u,n<u?o:a,n,r.x,r.y)&&(c=I(n-r.y)/(a-r.x),(c<p||c===p&&r.x>i.x)&&S(r,e)&&(i=r,p=c)),r=r.next;return i}function h(e,t,r,a){var n=e;do null===n.z&&(n.z=f(n.x,n.y,t,r,a)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,g(n)}function g(t){var r=1,a,n,o,i,e,s,l,d;do{for(n=t,t=null,e=null,s=0;n;){for(s++,o=n,l=0,a=0;a<r&&(l++,o=o.nextZ,!!o);a++);for(d=r;0<l||0<d&&o;)0!==l&&(0===d||!o||n.z<=o.z)?(i=n,n=n.nextZ,l--):(i=o,o=o.nextZ,d--),e?e.nextZ=i:t=i,i.prevZ=e,e=i;n=o}e.nextZ=null,r*=2}while(1<s);return t}function f(e,t,r,a,n){return e=32767*(e-r)*n,t=32767*(t-a)*n,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e|t<<1}function m(e){var t=e,r=e;do t.x<r.x&&(r=t),t=t.next;while(t!==e);return r}function y(e,t,r,a,n,o,i,s){return 0<=(n-i)*(t-s)-(e-i)*(o-s)&&0<=(e-i)*(a-s)-(r-i)*(t-s)&&0<=(r-i)*(o-s)-(n-i)*(a-s)}function x(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!E(e,t)&&S(e,t)&&S(t,e)&&C(e,t)}function _(e,t,a){return(t.y-e.y)*(a.x-t.x)-(t.x-e.x)*(a.y-t.y)}function T(e,t){return e.x===t.x&&e.y===t.y}function v(e,t,r,a){return!!(T(e,t)&&T(r,a)||T(e,a)&&T(r,t))||0<_(e,t,r)!=0<_(e,t,a)&&0<_(r,a,e)!=0<_(r,a,t)}function E(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&v(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function S(e,t){return 0>_(e.prev,e,e.next)?0<=_(e,t,e.next)&&0<=_(e,e.prev,t):0>_(e,t,e.prev)||0>_(e,e.next,t)}function C(e,t){var r=e,a=!1,n=(e.x+t.x)/2,o=(e.y+t.y)/2;do r.y>o!=r.next.y>o&&r.next.y!==r.y&&n<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(a=!a),r=r.next;while(r!==e);return a}function P(e,t){var r=new M(e.i,e.x,e.y),a=new M(t.i,t.x,t.y),n=e.next,o=t.prev;return e.next=t,t.prev=e,r.next=n,n.prev=r,a.next=r,r.prev=a,o.next=a,a.prev=o,a}function b(e,t,r,a){var n=new M(e,t,r);return a?(n.next=a.next,n.prev=a,a.next.prev=n,a.next=n):(n.prev=n,n.next=n),n}function w(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function M(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function A(e,t,r,a){for(var n=0,o=t,i=r-a;o<r;o+=a)n+=(e[i]-e[o])*(e[o+1]+e[i+1]),i=o;return n}var I=Math.abs;e.exports=t,e.exports.default=t,t.deviation=function(e,t,r,n){var o=t&&t.length,s=o?t[0]*r:e.length,l=I(A(e,0,s,r));if(o)for(var d=0,i=t.length;d<i;d++){var u=t[d]*r,p=d<i-1?t[d+1]*r:e.length;l-=I(A(e,u,p,r))}var h=0;for(d=0;d<n.length;d+=3){var g=n[d]*r,a=n[d+1]*r,f=n[d+2]*r;h+=I((e[g]-e[f])*(e[a+1]-e[g+1])-(e[g]-e[a])*(e[f+1]-e[g+1]))}return 0===l&&0===h?0:I((h-l)/l)},t.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},a=0,n=0;n<e.length;n++){for(var o=0;o<e[n].length;o++)for(var i=0;i<t;i++)r.vertices.push(e[n][o][i]);0<n&&(a+=e[n-1].length,r.holes.push(a))}return r}},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var o=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),i=r(78),s=r(15),l=a(s),d=r(41),u=r(3),p=a(u),c=r(1),h=function(){function e(t,r,a,o,s){n(this,e),'number'==typeof t&&(t=Object.assign({width:t,height:r||p.default.RENDER_OPTIONS.height,forceCanvas:!!o,sharedTicker:!!s},a)),this._options=t=Object.assign({autoStart:!0,sharedTicker:!1,forceCanvas:!1,sharedLoader:!1},t),this.renderer=(0,i.autoDetectRenderer)(t),this.stage=new l.default,this._ticker=null,this.ticker=t.sharedTicker?d.shared:new d.Ticker,t.autoStart&&this.start()}return e.prototype.render=function(){this.renderer.render(this.stage)},e.prototype.stop=function(){this._ticker.stop()},e.prototype.start=function(){this._ticker.start()},e.prototype.destroy=function(e){var t=this._ticker;this.ticker=null,t.destroy(),this.stage.destroy(),this.stage=null,this.renderer.destroy(e),this.renderer=null,this._options=null},o(e,[{key:'ticker',set:function(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,c.UPDATE_PRIORITY.LOW)},get:function(){return this._ticker}},{key:'view',get:function(){return this.renderer.view}},{key:'screen',get:function(){return this.renderer.screen}}]),e}();t.default=h},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0,t.autoDetectRenderer=function(e,t,r,a){var n=e&&e.forceCanvas;return void 0!==a&&(n=a),!n&&o.isWebGLSupported()?new d.default(e,t,r):new s.default(e,t,r)};var n=r(2),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=r(16),s=a(i),l=r(26),d=a(l)},function(e,t){'use strict';t.__esModule=!0,t.default={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:!1}},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0,t.BitmapText=t.TilingSpriteRenderer=t.TilingSprite=t.AnimatedSprite=void 0;var n=r(171);Object.defineProperty(t,'AnimatedSprite',{enumerable:!0,get:function(){return a(n).default}});var o=r(172);Object.defineProperty(t,'TilingSprite',{enumerable:!0,get:function(){return a(o).default}});var i=r(173);Object.defineProperty(t,'TilingSpriteRenderer',{enumerable:!0,get:function(){return a(i).default}});var s=r(174);Object.defineProperty(t,'BitmapText',{enumerable:!0,get:function(){return a(s).default}}),r(175),r(176),r(177)},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),l=r(0),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(l),u=r(82),p=a(u),c=r(83),h=a(c),g=r(84),f=a(g),m=function(e){function t(r,a,i,s){n(this,t),s=s||5;var l=(0,p.default)(s,!0),u=(0,h.default)(s),c=o(this,e.call(this,l,u));return c.resolution=i||d.settings.RESOLUTION,c._quality=0,c.quality=a||4,c.strength=r||8,c.firstRun=!0,c}return i(t,e),t.prototype.apply=function(e,t,r,a){if(this.firstRun){var n=e.renderer.gl,o=(0,f.default)(n);this.vertexSrc=(0,p.default)(o,!0),this.fragmentSrc=(0,h.default)(o),this.firstRun=!1}if(this.uniforms.strength=1/r.size.width*(r.size.width/t.size.width),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)e.applyFilter(this,t,r,a);else{for(var s=e.getRenderTarget(!0),l=t,d=s,u=0;u<this.passes-1;u++){e.applyFilter(this,l,d,!0);var i=d;d=l,l=i}e.applyFilter(this,l,r,a),e.returnRenderTarget(s)}},s(t,[{key:'blur',get:function(){return this.strength},set:function(e){this.padding=2*Math.abs(e),this.strength=e}},{key:'quality',get:function(){return this._quality},set:function(e){this._quality=e,this.passes=e}}]),t}(d.Filter);t.default=m},function(e,t){'use strict';t.__esModule=!0,t.default=function(e,t){var a=Math.ceil(e/2),n=r,o='',s;s=t?'vBlurTexCoords[%index%] = aTextureCoord + vec2(%sampleIndex% * strength, 0.0);':'vBlurTexCoords[%index%] = aTextureCoord + vec2(0.0, %sampleIndex% * strength);';for(var l=0,i;l<e;l++)i=s.replace('%index%',l),i=i.replace('%sampleIndex%',l-(a-1)+'.0'),o+=i,o+='\n';return n=n.replace('%blur%',o),n=n.replace('%size%',e),n};var r='attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nuniform float strength;\nuniform mat3 projectionMatrix;\nvarying vec2 vBlurTexCoords[%size%];\nvoid main(void)\n{\ngl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);\n%blur%\n}'},function(e,t){'use strict';t.__esModule=!0,t.default=function(e){for(var t=r[e],n=t.length,o=a,s='',l=void 0,d=0,i;d<e;d++)i='gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;'.replace('%index%',d),l=d,d>=n&&(l=e-d-1),i=i.replace('%value%',t[l]),s+=i,s+='\n';return o=o.replace('%blur%',s),o=o.replace('%size%',e),o};var r={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},a='varying vec2 vBlurTexCoords[%size%];\nuniform sampler2D uSampler;\nvoid main(void)\n{\n    gl_FragColor = vec4(0.0);\n    %blur%\n}'},function(e,t){'use strict';t.__esModule=!0,t.default=function(e){for(var t=e.getParameter(e.MAX_VARYING_VECTORS),r=15;r>t;)r-=2;return r}},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),l=r(0),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(l),u=r(82),p=a(u),c=r(83),h=a(c),g=r(84),f=a(g),m=function(e){function t(r,a,i,s){n(this,t),s=s||5;var l=(0,p.default)(s,!1),u=(0,h.default)(s),c=o(this,e.call(this,l,u));return c.resolution=i||d.settings.RESOLUTION,c._quality=0,c.quality=a||4,c.strength=r||8,c.firstRun=!0,c}return i(t,e),t.prototype.apply=function(e,t,r,a){if(this.firstRun){var n=e.renderer.gl,o=(0,f.default)(n);this.vertexSrc=(0,p.default)(o,!1),this.fragmentSrc=(0,h.default)(o),this.firstRun=!1}if(this.uniforms.strength=1/r.size.height*(r.size.height/t.size.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)e.applyFilter(this,t,r,a);else{for(var s=e.getRenderTarget(!0),l=t,d=s,u=0;u<this.passes-1;u++){e.applyFilter(this,l,d,!0);var i=d;d=l,l=i}e.applyFilter(this,l,r,a),e.returnRenderTarget(s)}},s(t,[{key:'blur',get:function(){return this.strength},set:function(e){this.padding=2*Math.abs(e),this.strength=e}},{key:'quality',get:function(){return this._quality},set:function(e){this._quality=e,this.passes=e}}]),t}(d.Filter);t.default=m},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var n=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),o=r(0),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(o),s=function(){function e(){a(this,e),this.global=new i.Point,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return e.prototype.getLocalPosition=function(e,t,r){return e.worldTransform.applyInverse(r||this.global,t)},e.prototype._copyEvent=function(e){e.isPrimary&&(this.isPrimary=!0),this.button=e.button,this.buttons=e.buttons,this.width=e.width,this.height=e.height,this.tiltX=e.tiltX,this.tiltY=e.tiltY,this.pointerType=e.pointerType,this.pressure=e.pressure,this.rotationAngle=e.rotationAngle,this.twist=e.twist||0,this.tangentialPressure=e.tangentialPressure||0},e.prototype._reset=function(){this.isPrimary=!1},n(e,[{key:'pointerId',get:function(){return this.identifier}}]),e}();t.default=s},function(e,t){'use strict';function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var a=function(){function e(){r(this,e),this.stopped=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return e.prototype.stopPropagation=function(){this.stopped=!0},e.prototype._reset=function(){this.stopped=!1,this.currentTarget=null,this.target=null},e}();t.default=a},function(e,t){'use strict';function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var a=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(t){r(this,e),this._pointerId=t,this._flags=e.FLAGS.NONE}return e.prototype._doSet=function(e,t){t?this._flags|=e:this._flags&=~e},a(e,[{key:'pointerId',get:function(){return this._pointerId}},{key:'flags',get:function(){return this._flags},set:function(e){this._flags=e}},{key:'none',get:function(){return this._flags===this.constructor.FLAGS.NONE}},{key:'over',get:function(){return 0!=(this._flags&this.constructor.FLAGS.OVER)},set:function(e){this._doSet(this.constructor.FLAGS.OVER,e)}},{key:'rightDown',get:function(){return 0!=(this._flags&this.constructor.FLAGS.RIGHT_DOWN)},set:function(e){this._doSet(this.constructor.FLAGS.RIGHT_DOWN,e)}},{key:'leftDown',get:function(){return 0!=(this._flags&this.constructor.FLAGS.LEFT_DOWN)},set:function(e){this._doSet(this.constructor.FLAGS.LEFT_DOWN,e)}}]),e}();t.default=n,n.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4})},function(e,t){'use strict';t.__esModule=!0,t.default={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return'pointer'===this.cursor},set buttonMode(e){e?this.cursor='pointer':'pointer'===this.cursor&&(this.cursor=null)},cursor:null,get trackedPointers(){return void 0===this._trackedPointers&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0}},function(e,t,r){'use strict';function a(e,t){e.bitmapFont=l.BitmapText.registerFont(e.data,t)}t.__esModule=!0,t.parse=a,t.default=function(){return function(e,t){if(!e.data||e.type!==s.Resource.TYPE.XML)return void t();if(0===e.data.getElementsByTagName('page').length||0===e.data.getElementsByTagName('info').length||null===e.data.getElementsByTagName('info')[0].getAttribute('face'))return void t();var r=e.isDataUrl?'':o.dirname(e.url);e.isDataUrl&&('.'===r&&(r=''),this.baseUrl&&r&&'/'===this.baseUrl.charAt(this.baseUrl.length-1)&&(r+='/')),r=r.replace(this.baseUrl,''),r&&'/'!==r.charAt(r.length-1)&&(r+='/');var n=r+e.data.getElementsByTagName('page')[0].getAttribute('file');if(i.utils.TextureCache[n])a(e,i.utils.TextureCache[n]),t();else{var l={crossOrigin:e.crossOrigin,loadType:s.Resource.LOAD_TYPE.IMAGE,metadata:e.metadata.imageMetadata,parentResource:e};this.add(e.name+'_image',n,l,function(r){a(e,r.texture),t()})}}};var n=r(9),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=r(0),s=r(19),l=r(80)},function(e,t){'use strict';function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function a(e,t){return e._head?(e._tail._next=t,t._prev=e._tail,e._tail=t):(e._head=t,e._tail=t),t._owner=e,t}Object.defineProperty(t,'__esModule',{value:!0});var n=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),o=function(){function e(t,a,n){void 0===a&&(a=!1),r(this,e),this._fn=t,this._once=a,this._thisArg=n,this._next=this._prev=this._owner=null}return n(e,[{key:'detach',value:function(){return null!==this._owner&&(this._owner.detach(this),!0)}}]),e}(),i=function(){function e(){r(this,e),this._head=this._tail=void 0}return n(e,[{key:'handlers',value:function(){var e=!(0>=arguments.length||void 0===arguments[0])&&arguments[0],t=this._head;if(e)return!!t;for(var r=[];t;)r.push(t),t=t._next;return r}},{key:'has',value:function(e){if(!(e instanceof o))throw new Error('MiniSignal#has(): First arg must be a MiniSignalBinding object.');return e._owner===this}},{key:'dispatch',value:function(){var e=this._head;if(!e)return!1;for(;e;)e._once&&this.detach(e),e._fn.apply(e._thisArg,arguments),e=e._next;return!0}},{key:'add',value:function(e){var t=1>=arguments.length||void 0===arguments[1]?null:arguments[1];if('function'!=typeof e)throw new Error('MiniSignal#add(): First arg must be a Function.');return a(this,new o(e,!1,t))}},{key:'once',value:function(e){var t=1>=arguments.length||void 0===arguments[1]?null:arguments[1];if('function'!=typeof e)throw new Error('MiniSignal#once(): First arg must be a Function.');return a(this,new o(e,!0,t))}},{key:'detach',value:function(e){if(!(e instanceof o))throw new Error('MiniSignal#detach(): First arg must be a MiniSignalBinding object.');return e._owner===this?(e._prev&&(e._prev._next=e._next),e._next&&(e._next._prev=e._prev),e===this._head?(this._head=e._next,null===e._next&&(this._tail=null)):e===this._tail&&(this._tail=e._prev,this._tail._next=null),e._owner=null,this):this}},{key:'detachAll',value:function(){var e=this._head;if(!e)return this;for(this._head=this._tail=null;e;)e._owner=null,e=e._next;return this}}]),e}();i.MiniSignalBinding=o,t['default']=i,e.exports=t['default']},function(e){'use strict';e.exports=function(e,t){t=t||{};for(var r={key:['source','protocol','authority','userInfo','user','password','host','port','relative','path','directory','file','query','anchor'],q:{name:'queryKey',parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},a=r.parser[t.strictMode?'strict':'loose'].exec(e),n={},o=14;o--;)n[r.key[o]]=a[o]||'';return n[r.q.name]={},n[r.key[12]].replace(r.q.parser,function(e,t,a){t&&(n[r.q.name][t]=a)}),n}},function(e,t){'use strict';function r(){}function a(e){return function(){if(null===e)throw new Error('Callback was already called.');var t=e;e=null,t.apply(this,arguments)}}t.__esModule=!0,t.eachSeries=function(e,t,r,a){var n=0,o=e.length;(function i(s){return s||n===o?void(r&&r(s)):void(a?setTimeout(function(){t(e[n++],i)},1):t(e[n++],i))})()},t.queue=function(e,t){function n(e,t,a){if(null!=a&&'function'!=typeof a)throw new Error('task callback must be a function');if(s.started=!0,null==e&&s.idle())return void setTimeout(function(){return s.drain()},1);var n={data:e,callback:'function'==typeof a?a:r};t?s._tasks.unshift(n):s._tasks.push(n),setTimeout(function(){return s.process()},1)}function o(e){return function(){i-=1,e.callback.apply(e,arguments),null!=arguments[0]&&s.error(arguments[0],e.data),i<=s.concurrency-s.buffer&&s.unsaturated(),s.idle()&&s.drain(),s.process()}}if(null==t)t=1;else if(0===t)throw new Error('Concurrency must not be zero');var i=0,s={_tasks:[],concurrency:t,saturated:r,unsaturated:r,buffer:t/4,empty:r,drain:r,error:r,started:!1,paused:!1,push:function(e,t){n(e,!1,t)},kill:function(){i=0,s.drain=r,s.started=!1,s._tasks=[]},unshift:function(e,t){n(e,!0,t)},process:function(){for(;!s.paused&&i<s.concurrency&&s._tasks.length;){var t=s._tasks.shift();0===s._tasks.length&&s.empty(),i+=1,i===s.concurrency&&s.saturated(),e(t.data,a(o(t)))}},length:function(){return s._tasks.length},running:function(){return i},idle:function(){return 0===s._tasks.length+i},pause:function(){!0===s.paused||(s.paused=!0)},resume:function(){if(!1!==s.paused){s.paused=!1;for(var e=1;e<=s.concurrency;e++)s.process()}}};return s}},function(e,t){'use strict';t.__esModule=!0,t.encodeBinary=function(e){for(var t='',a=0;a<e.length;){for(var n=[0,0,0],o=[0,0,0,0],i=0;i<n.length;++i)n[i]=a<e.length?255&e.charCodeAt(a++):0;o[0]=n[0]>>2,o[1]=(3&n[0])<<4|n[1]>>4,o[2]=(15&n[1])<<2|n[2]>>6,o[3]=63&n[2];var s=a-(e.length-1);switch(s){case 2:o[3]=64,o[2]=64;break;case 1:o[3]=64;break;default:}for(var l=0;l<o.length;++l)t+=r.charAt(o[l])}return t};var r='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='},function(e,t,r){'use strict';function a(e,t){return e.isDataUrl?e.data.meta.image:i.default.resolve(e.url.replace(t,''),e.data.meta.image)}t.__esModule=!0,t.default=function(){return function(e,t){var r=e.name+'_image';if(!e.data||e.type!==n.Resource.TYPE.JSON||!e.data.frames||this.resources[r])return void t();var o={crossOrigin:e.crossOrigin,metadata:e.metadata.imageMetadata,parentResource:e},i=a(e,this.baseUrl);this.add(r,i,o,function(r){if(r.error)return void t(r.error);var a=new s.Spritesheet(r.texture.baseTexture,e.data,e.url);a.parse(function(){e.spritesheet=a,e.textures=a.textures,t()})})}},t.getResourcePath=a;var n=r(19),o=r(62),i=function(e){return e&&e.__esModule?e:{default:e}}(o),s=r(0)},function(e,t,r){'use strict';t.__esModule=!0,t.default=function(){return function(e,t){e.data&&e.type===a.Resource.TYPE.IMAGE&&(e.texture=o.default.fromLoader(e.data,e.url,e.name)),t()}};var a=r(19),n=r(11),o=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function n(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function o(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var i=r(20),s=function(e){return e&&e.__esModule?e:{default:e}}(i),l=function(e){function t(r,o,i){a(this,t);var l=n(this,e.call(this,r));return l._ready=!0,l.verticesX=o||10,l.verticesY=i||10,l.drawMode=s.default.DRAW_MODES.TRIANGLES,l.refresh(),l}return o(t,e),t.prototype._refresh=function(){for(var e=this._texture,t=this.verticesX*this.verticesY,r=[],a=[],n=[],o=[],s=this.verticesX-1,l=this.verticesY-1,d=e.width/s,u=e.height/l,p=0;p<t;p++){var i=p%this.verticesX,c=0|p/this.verticesX;r.push(i*d,c*u),n.push(i/s,c/l)}for(var h=0;h<s*l;h++){var g=h%s,f=0|h/s,m=f*this.verticesX+g,y=f*this.verticesX+g+1,x=(f+1)*this.verticesX+g,_=(f+1)*this.verticesX+g+1;o.push(m,y,x),o.push(y,_,x)}this.vertices=new Float32Array(r),this.uvs=new Float32Array(n),this.colors=new Float32Array(a),this.indices=new Uint16Array(o),this.dirty++,this.indexDirty++,this.multiplyUvs()},t.prototype._onTextureUpdate=function(){s.default.prototype._onTextureUpdate.call(this),this._ready&&this.refresh()},t}(s.default);t.default=l},function(e,t){'use strict';function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var a=function(){function e(t){r(this,e),this.maxItemsPerFrame=t,this.itemsLeft=0}return e.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},e.prototype.allowedToUpload=function(){return 0<this.itemsLeft--},e}();t.default=a},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});const a=r(206),n=r(207),o=r(223),i=r(224),s=r(225),l=r(5),d=r(21),u=r(226);var p;(function(e){e[e.ESCAPE=1]='ESCAPE',e[e.RESULTS=2]='RESULTS',e[e.END=3]='END',e[e.LEVELS=4]='LEVELS',e[e.TITLE=5]='TITLE',e[e.DIFFICULTY=6]='DIFFICULTY'})(p=t.ScreenType||(t.ScreenType={}));class c{constructor(e,t,r){this.screens={},this.current=void 0,this.lidx=0,document.body.innerHTML=e;let n=document.body.querySelector('svg');this.svg=n,n.setAttribute('width',`${t}`),n.setAttribute('height',`${r}`),n.style.position='absolute',n.style.left='50%',n.style.top='50%',n.style.marginLeft=`-${t/2}px`,n.style.marginTop=`-${r/2}px`,document.body.style.overflow='hidden',this.screens[p.ESCAPE]=new a.Screen(n.querySelector('#escape-screen')),this.screens[p.END]=new a.Screen(n.querySelector('#end-screen')),this.screens[p.TITLE]=new a.Screen(n.querySelector('#title-screen')),this.screens[p.DIFFICULTY]=new a.Screen(n.querySelector('#difficulty-screen')),this.screens[p.RESULTS]=new a.ResultScreen(n.querySelector('#results-screen')),this.lvlscreens=[new a.Screen(n.querySelector('#level1-screen')),new a.Screen(n.querySelector('#level2-screen')),new a.Screen(n.querySelector('#level3-screen')),new a.Screen(n.querySelector('#level4-screen'))],this.lvlselscr=new a.LevelSelectionScreen(n.querySelector('#levelsel-screen'),4,4),this.screens[p.TITLE].on('ok',()=>{this.loadLevel()}),d.ISDEV&&this.showPerfStats()}showPerfStats(){this.pstats=u.PerfStats(),this.pstats.showPanel(0),document.body.appendChild(this.pstats.dom)}show(e){this.clear(),this.current=this.screens[e],this.current.show()}clear(){this.current&&this.current.clear(),this.current=void 0}handleKeyPress(e){this.current?this.current.handleKeyPress(e):this.level&&this.level.handleKeyPress(e)}handleKeyUp(e){this.current?this.current.handleKeyUp(e):this.level&&this.level.handleKeyUp(e)}handleKeyDown(e){this.current?this.current.handleKeyDown(e):this.level&&this.level.handleKeyDown(e)}loadLevelScreen(e){return new Promise((t)=>{this.clear(),this.current=this.lvlscreens[e],this.current.show(),this.current.on('ok',t)})}loadDifficultyScreen(){return new Promise((e)=>{this.show(p.DIFFICULTY),this.current.on('easy-click',()=>{this.clear(),e('easy')}),this.current.on('normal-click',()=>{this.clear(),e('normal')}),this.current.on('hard-click',()=>{this.clear(),e('hard')})})}playLevel(e){this.level=new c.levelClasses[this.lidx],this.level.load(e),document.body.appendChild(this.level.app.view),this.level.play(),this.level.on('pause',()=>{this.show(p.ESCAPE),this.level.app.view.style.display='none',this.current.on('resume-click',()=>{this.clear(),this.level.app.view.style.display='inherit',this.level.resume()}),this.current.on('reload-click',()=>{this.clear(),this.level.finish(),this.loadLevel()}),this.current.on('levels-click',()=>{this.clear(),this.current=this.lvlselscr,this.current.show()}),this.current.on('settings-click',()=>{this.show(p.END)}),this.current.on('exit-click',()=>{this.show(p.END)})})}loadLevel(e,t){e!==void 0&&(this.lidx=e),t?this.playLevel(t):this.loadLevelScreen(this.lidx).then(()=>this.loadDifficultyScreen()).then((e)=>{this.playLevel(e)})}unloadLevel(e,t){this.clear(),this.level=void 0,this.current=this.screens[p.RESULTS],this.current.populateValues(e,t),this.current.show(),this.current.on('replay',()=>{this.loadLevel()}),this.current.on('ok',()=>{this.lidx++,this.loadLevel()})}resize(){this.svg.setAttribute('width',`${l.Game.vpWidth}`),this.svg.setAttribute('height',`${l.Game.vpHeight}`),this.svg.style.marginLeft=-l.Game.vpWidth/2+'px',this.svg.style.marginTop=-l.Game.vpHeight/2+'px',this.svg.style.marginLeft=`-${l.Game.vpWidth/2}px`,this.svg.style.marginTop=`-${l.Game.vpHeight/2}px`,this.level&&this.level.resize()}}c.levelClasses=[n.Level1,o.Level2,i.Level3,s.Level4],t.ScreenManager=c},function(e,t,r){'use strict';var a=Math.max;Object.defineProperty(t,'__esModule',{value:!0});const n=r(6);r(23);const o=r(101),i=r(8),s=r(10),l=r(13),d=r(29);var u;(function(e){e[e.goingToPavilion=1]='goingToPavilion',e[e.inPavilion=2]='inPavilion',e[e.goingToShip=3]='goingToShip'})(u=t.GhostState||(t.GhostState={}));class p extends o.Actor{constructor(e,t,r){super(r),this.type=e,this.ship=t,this.level=r,this.state=u.goingToPavilion,this.isdead=!1,this.hasfactoid=!1,this.lane=0,this.pathlength=0,this.pathidx=0;if((this.sprBody=new n.Sprite(n.Texture.fromFrame(`${e}-body`)),this.sprShield=new n.Sprite(n.Texture.fromFrame(`${e}-shield`))),this.sprGold=new n.Sprite(n.Texture.from('gold')),this.uid=r.genGhostId(),this.normalScale=r.terra.cellsize/100,this.setScale(this.normalScale),this.sprBody.position.set(-this.sprBody.width/2,-this.sprBody.height/2),this.container.addChild(this.sprBody),this.sprShield.position.set(-this.sprShield.width/2,-this.sprShield.height/2),this.container.addChild(this.sprShield),this.sprGold.position.set(-this.sprGold.width/2,-this.sprGold.height/2),this.container.addChild(this.sprGold),this.sprGold.visible=!1,'walker'===this.type){this.spec=l.spec.ghosts.walker;let{x:e,x:t}=this.sprGold.position;this.sprGold.position.set(e,t-16*this.normalScale);let{x:r,y:a}=this.sprShield.position;this.sprShield.position.set(r,a-1*this.normalScale)}else if('bouncer'===this.type){this.spec=l.spec.ghosts.bouncer;let{x:e,x:t}=this.sprGold.position;this.sprGold.position.set(e,t-16*this.normalScale);let{x:r,y:a}=this.sprShield.position;this.sprShield.position.set(r,a-1*this.normalScale)}else if('sprinter'===this.type){this.spec=l.spec.ghosts.sprinter;let{x:e,y:t}=this.sprShield.position;this.sprShield.position.set(e,t-7.8*this.normalScale);let{x:r,x:a}=this.sprGold.position;this.sprGold.position.set(r,a-20*this.normalScale)}else this.spec=l.spec.ghosts.walker,s.Log.assert(!1,'Unknown ghost type');this.speed=this.spec.maxspeed,this.health=this.spec.maxhealth,this.shield=this.spec.maxshield;let o=a(this.container.width,this.container.height);this.radius=o/2,this.updateShieldTint(),this.creationTime=this.level.getGameTime()}setScale(e){this.sprBody.scale.set(e),this.sprShield.scale.set(e),this.sprGold.scale.set(e)}initState(e){this.position=this.level.terra.getCellCenter(e),this.state=u.goingToPavilion,this.gridcell=e,this.cellpath=this.getCellPath()}toString(){let e=this.isdead?'Dead':'Alive',t;return t=this.state===u.goingToPavilion?'toPav':this.state===u.goingToShip?'toShip':this.state===u.inPavilion?'inPav':'UNK',`G(${this.type}-${super.toString()}) `+`${e} ${t} ${this.gridcell}`}updateShieldTint(){let e=a(0,this.shield)/this.spec.maxshield;this.sprShield.alpha=e}die(){this.isdead=!0,this.level.score.countGhostKill(),this.level.expireGhost(this)}animateHit(){this.level.animator.add(new d.Animation(100,d.Animation.LINEAR,(e)=>{this.container.scale.set(.7+.3*e)},()=>{this.container.scale.set(1)}))}dive(){let e=.7*this.normalScale;this.level.animator.add(new d.Animation(1e3,d.Animation.LINEAR,(t)=>{this.setScale(this.normalScale+(e-this.normalScale)*t)},()=>{}))}undive(){let e=.7*this.normalScale;this.level.animator.add(new d.Animation(1e3,d.Animation.LINEAR,(t)=>{this.setScale(e+(this.normalScale-e)*t)},()=>{}))}jump(){let e=1.2*this.normalScale;this.level.animator.add(new d.Animation(1e3,d.Animation.LINEAR,(t)=>{this.setScale(this.normalScale+(e-this.normalScale)*t)},()=>{}))}unjump(){let e=1.2*this.normalScale;this.level.animator.add(new d.Animation(1e3,d.Animation.LINEAR,(t)=>{this.setScale(e+(this.normalScale-e)*t)},()=>{}))}sufferAttack(e){if(0>=this.shield?(this.health-=e.damage.health,this.animateHit()):this.shield-=e.damage.shield,this.updateShieldTint(),0>=this.health&&!this.isdead)this.die();else{let e=this.health/this.spec.maxhealth;this.sprBody.alpha=e}}static speedPixels(e){return 20*e}getCellPath(){console.assert(!!this.gridcell);let e=this.gridcell,t;if(this.cellpath&&1<this.cellpath.length&&!this.level.terra.isWallAt(this.cellpath[1])&&(t=this.cellpath[1]),this.state===u.goingToPavilion){let[r,a]=t||this.level.terra.nextCell(e,!0),[n,o]=this.level.pavilion.getEntranceCell(),i;return i=r===n&&a===o?this.level.pavilion.nextCell([r,a]):this.level.terra.nextCell([r,a],!0),[[r,a],i]}if(this.state===u.goingToShip){let[a,r]=e,[n,o]=t||this.level.terra.nextCell(e,!1),[i,s]=this.level.ship.source;if(a===i&&r===s)return[[a,r]];let l;return n===i&&o===s?[[n,o]]:(l=this.level.terra.nextCell([n,o],!1),[[n,o],l])}if(this.state===u.inPavilion){let[t,r]=this.level.pavilion.nextCell(e),[a,n]=this.level.pavilion.getEntranceCell(),o;return o=t===a&&r===n?this.level.terra.nextCell([t,r],!1):this.level.pavilion.nextCell([t,r]),[[t,r],o]}throw new Error('Invalid ghost state')}updateState(){console.assert(!!this.gridcell);let[e,t]=this.gridcell,[r,a]=this.level.ship.source,[n,o]=this.level.pavilion.entryCell;if(e===n&&t===o)if(this.state===u.goingToPavilion)this.state=u.inPavilion;else if(this.state===u.inPavilion){this.state=u.goingToShip;let e=this.level.pavilion.stealFactoid();e&&(this.level.score.countGoldSteal(this.level.getGameTime()),this.level.promoteGhost(this),this.carryFactoid())}else if(this.state===u.goingToShip);else s.Log.assert(!1,'Invalid state');e===r&&t===a&&this.state===u.goingToShip&&(this.level.score.countGhostEscape(this.level.getGameTime(),this),this.level.expireGhost(this)),this.cellpath=this.getCellPath()}slidePoint(e,t,r){return i.vec2.add(e,i.vec2.mul(t,r))}getPathCurve(){let t=this.level.terra,e=t.cellsize/4,r=[-e,0,e][this.lane];console.assert(!!this.gridcell),console.assert(!!this.cellpath);let[n,a]=this.gridcell,[o,s]=this.cellpath[0],[l,d]=t.getCellCenter(n,a),[u,p]=t.getCellCenter(o,s);if(1===this.cellpath.length){let e=i.vec2.mul(i.vec2.add([l,d],[u,p]),.5),t=[u,p],a=i.vec2.dir(e,t);return r&&(e=this.slidePoint(e,i.vec2.orthogonal(a),r),t=this.slidePoint(t,i.vec2.orthogonal(a),r)),[e,t]}if(2===this.cellpath.length){let[a,e]=this.cellpath[1],[n,o]=t.getCellCenter(a,e),s=i.vec2.mul(i.vec2.add([l,d],[u,p]),.5),c=[u,p],h=i.vec2.mul(i.vec2.add([u,p],[n,o]),.5);if(r){let e=i.vec2.dir(s,c),t=i.vec2.dir(s,h),a=i.vec2.dir(c,h);s=this.slidePoint(s,i.vec2.orthogonal(e),r),c=this.slidePoint(c,i.vec2.orthogonal(t),r),h=this.slidePoint(h,i.vec2.orthogonal(a),r)}let g=new i.QuadraticBezier([s,c,h]);return[0,.2,.4,.6,.8,1].map((e)=>g.evaluate(e))}throw new Error('Invalid cellpath length')}moveGridCell(){this.gridcell=this.cellpath[0]}getGhostRotation(e){let t=0<=i.vec2.cross(e,[0,-1])?-1:1,r=Math.acos(i.vec2.dot(e,[0,-1]));return t*r}nextPathStep(){if(this.pathidx<this.pathcrv.length-1){let e=i.vec2.dir(this.pathcrv[this.pathidx],this.pathcrv[this.pathidx+1]);this.rotation=this.getGhostRotation(e),this.pathidx++}else{this.moveGridCell(),this.updateState();let e=this.getPathCurve();this.pathcrv=e,this.pathidx=0,this.pathlength++}}getRelativeCellPath(){return[i.vec2.sub(this.cellpath[0],this.gridcell),i.vec2.sub(this.cellpath[1],this.gridcell)]}tick(e,t){e,this.pathcrv||(this.pathcrv=this.getPathCurve(),this.pathidx=0,s.Log.assert(!!this.pathcrv,'cellpath not found'));let r=this.pathcrv[this.pathidx],a=i.vec2.sub(r,this.position),n=i.vec2.len(a),o=p.speedPixels(this.speed)*t/1e3;if(n<=o)this.position=r,this.nextPathStep();else{let e=i.vec2.mul(a,1/n);this.rotation=this.getGhostRotation(e),this.position=i.vec2.add(i.vec2.mul(e,o),this.position)}this.isVisible()||this.show()}onVisibilityStart(e){}onVisibilityEnd(e){}carryFactoid(){this.hasfactoid=!0,this.sprGold.visible=!0}}t.Ghost=p},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});const a=r(6);r(23);class n{constructor(e){this.level=e,this.uid=-1,this.radius=-1,this.container=new a.Container,this.underContainer=new a.Container,this.container.addChild(this.underContainer)}get position(){return[this.container.position.x,this.container.position.y]}set position(e){this.container.position.set(e[0],e[1])}get rotation(){return this.container.rotation}set rotation(e){this.container.rotation=e}toString(){return`${this.uid}`}show(){this.container.visible=!0}hide(){this.container.visible=!1}isVisible(){return this.container.visible}}t.Actor=n},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});const a=r(6),n=r(8);class o extends a.Graphics{makeRectangle(e,t,r=16777215,a=1){return this.lineStyle(0),this.beginFill(r,a),this.drawRectangle(e,t),this.endFill(),this.cacheAsBitmap=!0,this}drawRectangle(e,t){this.drawRect(0,0,e,t)}drawVectorShape(e,t){for(let r=0;r<e.length;r++){let[t,a]=e[r];0===r?this.moveTo(t,a):this.lineTo(t,a)}this.closePath();for(let r of t){for(let e=0;e<r.length;e++){let[t,a]=r[e];0===e?this.moveTo(t,a):this.lineTo(t,a)}this.closePath(),this.addHole()}}drawPathData(e,t=[]){let r=o.parsePathData(e),a=t.map((e)=>o.parsePathData(e));this.drawVectorShape(r,a)}static parsePathData(e){let t=[],r=e.trim().replace(/,/g,' ').split(/\s+/),a=()=>r.shift(),o=()=>(console.assert(2<=r.length),[parseFloat(r.shift()),parseFloat(r.shift())]),i=()=>(console.assert(1<=r.length),parseFloat(r.shift())),s=(e)=>/^[MmLlHhVvzZ]+$/.test(e);console.assert('M'===r[0]);for(let l=[0,0],d='';r.length;)switch(s(r[0])&&(d=a()),d){case'M':l=o(),t.push(l.slice());break;case'm':l=n.vec2.add(l,o()),t.push(l.slice());break;case'L':l=o(),t.push(l.slice());break;case'l':l=n.vec2.add(l,o()),t.push(l.slice());break;case'H':l[0]=i(),t.push(l.slice());break;case'h':l[0]+=i(),t.push(l.slice());break;case'V':l[1]=i(),t.push(l.slice());break;case'v':l[1]+=i(),t.push(l.slice());break;case'Z':case'z':}return t}}t.VectorGraphics=o},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});const a=r(5),n=r(227),o=r(8);window.onload=()=>{a.Game.start(),window.game=a.Game,window.vec2=o.vec2,window.config=n.Config}},function(e,t,r){'use strict';r(105),r(107),r(108),window.ArrayBuffer||(window.ArrayBuffer=Array),window.Float32Array||(window.Float32Array=Array),window.Uint32Array||(window.Uint32Array=Array),window.Uint16Array||(window.Uint16Array=Array)},function(e,t,r){'use strict';var a=r(106),n=function(e){return e&&e.__esModule?e:{default:e}}(a);Object.assign||(Object.assign=n.default)},function(e){'use strict';/*
object-assign
(c) Sindre Sorhus
@license MIT
*/function t(e){if(null===e||e===void 0)throw new TypeError('Object.assign cannot be called with null or undefined');return Object(e)}var r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String('abc');if(e[5]='de','5'===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;10>r;r++)t['_'+String.fromCharCode(r)]=r;var a=Object.getOwnPropertyNames(t).map(function(e){return t[e]});if('0123456789'!==a.join(''))return!1;var n={};return['a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t'].forEach(function(e){n[e]=e}),'abcdefghijklmnopqrst'===Object.keys(Object.assign({},n)).join('')}catch(e){return!1}}()?Object.assign:function(e){for(var o=t(e),l=1,s,d;l<arguments.length;l++){for(var u in s=Object(arguments[l]),s)a.call(s,u)&&(o[u]=s[u]);if(r){d=r(s);for(var p=0;p<d.length;p++)n.call(s,d[p])&&(o[d[p]]=s[d[p]])}}return o}},function(e,t,r){'use strict';(function(e){if(Date.now&&Date.prototype.getTime||(Date.now=function(){return new Date().getTime()}),!(e.performance&&e.performance.now)){var t=Date.now();e.performance||(e.performance={}),e.performance.now=function(){return Date.now()-t}}for(var r=Date.now(),a=['ms','moz','webkit','o'],n=0,o;n<a.length&&!e.requestAnimationFrame;++n)o=a[n],e.requestAnimationFrame=e[o+'RequestAnimationFrame'],e.cancelAnimationFrame=e[o+'CancelAnimationFrame']||e[o+'CancelRequestAnimationFrame'];e.requestAnimationFrame||(e.requestAnimationFrame=function(e){if('function'!=typeof e)throw new TypeError(e+'is not a function');var t=Date.now(),a=16+r-t;return 0>a&&(a=0),r=t,setTimeout(function(){r=Date.now(),e(performance.now())},a)}),e.cancelAnimationFrame||(e.cancelAnimationFrame=function(e){return clearTimeout(e)})}).call(t,r(31))},function(){'use strict';var e=Math.sign;e||(e=function(e){return e=+e,0===e||isNaN(e)?e:0<e?1:-1})},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var n=r(34),o=function(e){return e&&e.__esModule?e:{default:e}}(n),i=r(1),s=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;a(this,e),this.x=t,this.y=r,this.radius=n,this.type=i.SHAPES.CIRC}return e.prototype.clone=function(){return new e(this.x,this.y,this.radius)},e.prototype.contains=function(e,t){if(0>=this.radius)return!1;var r=this.radius*this.radius,a=this.x-e,n=this.y-t;return a*=a,n*=n,a+n<=r},e.prototype.getBounds=function(){return new o.default(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},e}();t.default=s},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var n=r(34),o=function(e){return e&&e.__esModule?e:{default:e}}(n),i=r(1),s=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;a(this,e),this.x=t,this.y=r,this.width=n,this.height=o,this.type=i.SHAPES.ELIP}return e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e.prototype.contains=function(e,t){if(0>=this.width||0>=this.height)return!1;var r=(e-this.x)/this.width,a=(t-this.y)/this.height;return r*=r,a*=a,1>=r+a},e.prototype.getBounds=function(){return new o.default(this.x-this.width,this.y-this.height,this.width,this.height)},e}();t.default=s},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var n=r(32),o=function(e){return e&&e.__esModule?e:{default:e}}(n),s=r(1),i=function(){function e(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];if(a(this,e),Array.isArray(r[0])&&(r=r[0]),r[0]instanceof o.default){for(var l=[],d=0,i=r.length;d<i;d++)l.push(r[d].x,r[d].y);r=l}this.closed=!0,this.points=r,this.type=s.SHAPES.POLY}return e.prototype.clone=function(){return new e(this.points.slice())},e.prototype.close=function(){var e=this.points;(e[0]!==e[e.length-2]||e[1]!==e[e.length-1])&&e.push(e[0],e[1])},e.prototype.contains=function(e,t){for(var r=!1,a=this.points.length/2,n=0,o=a-1;n<a;o=n++){var i=this.points[2*n],s=this.points[2*n+1],l=this.points[2*o],d=this.points[2*o+1];s>t!=d>t&&e<(l-i)*((t-s)/(d-s))+i&&(r=!r)}return r},e}();t.default=i},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var n=r(1),o=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:20;a(this,e),this.x=t,this.y=r,this.width=o,this.height=i,this.radius=s,this.type=n.SHAPES.RREC}return e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height,this.radius)},e.prototype.contains=function(e,t){if(0>=this.width||0>=this.height)return!1;if(e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height){if(t>=this.y+this.radius&&t<=this.y+this.height-this.radius||e>=this.x+this.radius&&e<=this.x+this.width-this.radius)return!0;var r=e-(this.x+this.radius),a=t-(this.y+this.radius),n=this.radius*this.radius;if(r*r+a*a<=n)return!0;if(r=e-(this.x+this.width-this.radius),r*r+a*a<=n)return!0;if(a=t-(this.y+this.height-this.radius),r*r+a*a<=n)return!0;if(r=e-(this.x+this.radius),r*r+a*a<=n)return!0}return!1},e}();t.default=o},function(e){e.exports=function(e,t){var r=e.getContext('webgl',t)||e.getContext('experimental-webgl',t);if(!r)throw new Error('This browser does not support webGL. Try using the canvas renderer');return r}},function(e){var t=new ArrayBuffer(0),r=function(e,r,a,n){this.gl=e,this.buffer=e.createBuffer(),this.type=r||e.ARRAY_BUFFER,this.drawType=n||e.STATIC_DRAW,this.data=t,a&&this.upload(a),this._updateID=0};r.prototype.upload=function(e,t,r){r||this.bind();var a=this.gl;e=e||this.data,t=t||0,this.data.byteLength>=e.byteLength?a.bufferSubData(this.type,t,e):a.bufferData(this.type,e,this.drawType),this.data=e},r.prototype.bind=function(){var e=this.gl;e.bindBuffer(this.type,this.buffer)},r.createVertexBuffer=function(e,t,a){return new r(e,e.ARRAY_BUFFER,t,a)},r.createIndexBuffer=function(e,t,a){return new r(e,e.ELEMENT_ARRAY_BUFFER,t,a)},r.create=function(e,t,a,n){return new r(e,t,a,n)},r.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)},e.exports=r},function(e,t,r){var a=r(50),n=function(e,t,r){this.gl=e,this.framebuffer=e.createFramebuffer(),this.stencil=null,this.texture=null,this.width=t||100,this.height=r||100};n.prototype.enableTexture=function(e){var t=this.gl;this.texture=e||new a(t),this.texture.bind(),this.bind(),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture.texture,0)},n.prototype.enableStencil=function(){if(!this.stencil){var e=this.gl;this.stencil=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,this.stencil),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,this.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,this.width,this.height)}},n.prototype.clear=function(e,t,r,n){this.bind();var a=this.gl;a.clearColor(e,t,r,n),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT)},n.prototype.bind=function(){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer)},n.prototype.unbind=function(){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,null)},n.prototype.resize=function(e,t){var r=this.gl;this.width=e,this.height=t,this.texture&&this.texture.uploadData(null,e,t),this.stencil&&(r.bindRenderbuffer(r.RENDERBUFFER,this.stencil),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,e,t))},n.prototype.destroy=function(){var e=this.gl;this.texture&&this.texture.destroy(),e.deleteFramebuffer(this.framebuffer),this.gl=null,this.stencil=null,this.texture=null},n.createRGBA=function(e,t,r){var o=a.fromData(e,null,t,r);o.enableNearestScaling(),o.enableWrapClamp();var i=new n(e,t,r);return i.enableTexture(o),i.unbind(),i},n.createFloat32=function(e,t,r,o){var i=new a.fromData(e,o,t,r);i.enableNearestScaling(),i.enableWrapClamp();var s=new n(e,t,r);return s.enableTexture(i),s.unbind(),s},e.exports=n},function(e,t,r){var a=r(51),n=r(52),o=r(54),i=r(56),s=r(57),l=function(e,t,r,l,d){this.gl=e,l&&(t=i(t,l),r=i(r,l)),this.program=a(e,t,r,d),this.attributes=n(e,this.program),this.uniformData=o(e,this.program),this.uniforms=s(e,this.uniformData)};l.prototype.bind=function(){return this.gl.useProgram(this.program),this},l.prototype.destroy=function(){this.attributes=null,this.uniformData=null,this.uniforms=null;var e=this.gl;e.deleteProgram(this.program)},e.exports=l},function(e,t,r){function a(e,t){if(this.nativeVaoExtension=null,a.FORCE_NATIVE||(this.nativeVaoExtension=e.getExtension('OES_vertex_array_object')||e.getExtension('MOZ_OES_vertex_array_object')||e.getExtension('WEBKIT_OES_vertex_array_object')),this.nativeState=t,this.nativeVaoExtension){this.nativeVao=this.nativeVaoExtension.createVertexArrayOES();var r=e.getParameter(e.MAX_VERTEX_ATTRIBS);this.nativeState={tempAttribState:Array(r),attribState:Array(r)}}this.gl=e,this.attributes=[],this.indexBuffer=null,this.dirty=!1}var n=r(49);a.prototype.constructor=a,e.exports=a,a.FORCE_NATIVE=!1,a.prototype.bind=function(){if(this.nativeVao){if(this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao),this.dirty)return this.dirty=!1,this.activate(),this;this.indexBuffer&&this.indexBuffer.bind()}else this.activate();return this},a.prototype.unbind=function(){return this.nativeVao&&this.nativeVaoExtension.bindVertexArrayOES(null),this},a.prototype.activate=function(){for(var e=this.gl,t=null,r=0,a;r<this.attributes.length;r++)a=this.attributes[r],t!==a.buffer&&(a.buffer.bind(),t=a.buffer),e.vertexAttribPointer(a.attribute.location,a.attribute.size,a.type||e.FLOAT,a.normalized||!1,a.stride||0,a.start||0);return n(e,this.attributes,this.nativeState),this.indexBuffer&&this.indexBuffer.bind(),this},a.prototype.addAttribute=function(e,t,r,a,n,o){return this.attributes.push({buffer:e,attribute:t,location:t.location,type:r||this.gl.FLOAT,normalized:a||!1,stride:n||0,start:o||0}),this.dirty=!0,this},a.prototype.addIndex=function(e){return this.indexBuffer=e,this.dirty=!0,this},a.prototype.clear=function(){return this.nativeVao&&this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao),this.attributes.length=0,this.indexBuffer=null,this},a.prototype.draw=function(e,t,r){var a=this.gl;return this.indexBuffer?a.drawElements(e,t||this.indexBuffer.data.length,a.UNSIGNED_SHORT,2*(r||0)):a.drawArrays(e,r,t||this.getSize()),this},a.prototype.destroy=function(){this.gl=null,this.indexBuffer=null,this.attributes=null,this.nativeState=null,this.nativeVao&&this.nativeVaoExtension.deleteVertexArrayOES(this.nativeVao),this.nativeVaoExtension=null,this.nativeVao=null},a.prototype.getSize=function(){var e=this.attributes[0];return e.buffer.data.length/(e.stride/4||e.attribute.size)}},function(e,t,r){e.exports={compileProgram:r(51),defaultValue:r(55),extractAttributes:r(52),extractUniforms:r(54),generateUniformAccessObject:r(57),setPrecision:r(56),mapSize:r(53),mapType:r(35)}},function(e,t,r){'use strict';t.__esModule=!0,t.default=function(e){return n.default.tablet||n.default.phone?4:e};var a=r(37),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t){'use strict';t.__esModule=!0,t.default=function(){var e=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);return!e}},function(e,t){'use strict';function r(e){e.__plugins={},e.registerPlugin=function(t,r){e.__plugins[t]=r},e.prototype.initPlugins=function(){for(var t in this.plugins=this.plugins||{},e.__plugins)this.plugins[t]=new e.__plugins[t](this)},e.prototype.destroyPlugins=function(){for(var e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null;this.plugins=null}}t.__esModule=!0,t.default={mixin:function(e){r(e)}}},function(e,t){'use strict';function r(e,t){if(e&&t)for(var r=Object.keys(t),a=0,n;a<r.length;++a)n=r[a],Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}t.__esModule=!0,t.mixin=r,t.delayMixin=function(e,t){a.push(e,t)},t.performMixins=function(){for(var e=0;e<a.length;e+=2)r(a[e],a[e+1]);a.length=0};var a=[]},function(e){'use strict';e.exports=function(e,t,r){var a=e.length,n;if(!(t>=a||0===r)){r=t+r>a?a-t:r;var o=a-r;for(n=t;n<o;++n)e[n]=e[n+r];e.length=o}}},function(e,t,r){'use strict';t.__esModule=!0,t.default=function(){for(var e=[],t=[],r=0;32>r;r++)e[r]=r,t[r]=r;e[a.BLEND_MODES.NORMAL_NPM]=a.BLEND_MODES.NORMAL,e[a.BLEND_MODES.ADD_NPM]=a.BLEND_MODES.ADD,e[a.BLEND_MODES.SCREEN_NPM]=a.BLEND_MODES.SCREEN,t[a.BLEND_MODES.NORMAL]=a.BLEND_MODES.NORMAL_NPM,t[a.BLEND_MODES.ADD]=a.BLEND_MODES.ADD_NPM,t[a.BLEND_MODES.SCREEN]=a.BLEND_MODES.SCREEN_NPM;return[t,e]};var a=r(1)},function(e,t,r){(function(e,a){var n;/*! https://mths.be/punycode v1.4.1 by @mathias */(function(o){function s(e){throw new RangeError(R[e])}function i(e,t){for(var r=e.length,a=[];r--;)a[r]=t(e[r]);return a}function l(e,t){var r=e.split('@'),a='';1<r.length&&(a=r[0]+'@',e=r[1]),e=e.replace(I,'.');var n=e.split('.'),o=i(n,t).join('.');return a+o}function d(e){for(var t=[],r=0,a=e.length,n,o;r<a;)n=e.charCodeAt(r++),55296<=n&&56319>=n&&r<a?(o=e.charCodeAt(r++),56320==(64512&o)?t.push(((1023&n)<<10)+(1023&o)+65536):(t.push(n),r--)):t.push(n);return t}function u(e){return i(e,function(e){var t='';return 65535<e&&(e-=65536,t+=L(55296|1023&e>>>10),e=56320|1023&e),t+=L(e),t}).join('')}function p(e){return 10>e-48?e-22:26>e-65?e-65:26>e-97?e-97:b}function c(e,t){return e+22+75*(26>e)-((0!=t)<<5)}function h(e,t,r){var a=0;for(e=r?O(e/S):e>>1,e+=O(e/t);e>D*v>>1;a+=b)e=O(e/D);return O(a+(D+1)*e/(e+E))}function g(e){var r=[],a=e.length,o=0,i=P,n=C,l,d,c,g,f,m,y,x,E,t;for(d=e.lastIndexOf(w),0>d&&(d=0),c=0;c<d;++c)128<=e.charCodeAt(c)&&s('not-basic'),r.push(e.charCodeAt(c));for(g=0<d?d+1:0;g<a;){for(f=o,m=1,y=b;;y+=b){if(g>=a&&s('invalid-input'),x=p(e.charCodeAt(g++)),(x>=b||x>O((_-o)/m))&&s('overflow'),o+=x*m,E=y<=n?T:y>=n+v?v:y-n,x<E)break;t=b-E,m>O(_/t)&&s('overflow'),m*=t}l=r.length+1,n=h(o-f,l,0==f),O(o/l)>_-i&&s('overflow'),i+=O(o/l),o%=l,r.splice(o++,0,i)}return u(r)}function f(e){var r=[],a,n,o,i,l,u,p,g,f,m,t,y,x,E,S;for(e=d(e),y=e.length,a=P,n=0,l=C,u=0;u<y;++u)t=e[u],128>t&&r.push(L(t));for(o=i=r.length,i&&r.push(w);o<y;){for(p=_,u=0;u<y;++u)t=e[u],t>=a&&t<p&&(p=t);for(x=o+1,p-a>O((_-n)/x)&&s('overflow'),n+=(p-a)*x,a=p,u=0;u<y;++u)if(t=e[u],t<a&&++n>_&&s('overflow'),t==a){for(g=n,f=b;;f+=b){if(m=f<=l?T:f>=l+v?v:f-l,g<m)break;S=g-m,E=b-m,r.push(L(c(m+S%E,0))),g=O(S/E)}r.push(L(c(g,0))),l=h(n,x,o==i),n=0,++o}++n,++a}return r.join('')}var m='object'==typeof t&&t&&!t.nodeType&&t,y='object'==typeof e&&e&&!e.nodeType&&e,x='object'==typeof a&&a;(x.global===x||x.window===x||x.self===x)&&(o=x);var _=2147483647,b=36,T=1,v=26,E=38,S=700,C=72,P=128,w='-',M=/^xn--/,A=/[^\x20-\x7E]/,I=/[\x2E\u3002\uFF0E\uFF61]/g,R={overflow:'Overflow: input needs wider integers to process',"not-basic":'Illegal input >= 0x80 (not a basic code point)',"invalid-input":'Invalid input'},D=b-T,O=Math.floor,L=String.fromCharCode,k;k={version:'1.4.1',ucs2:{decode:d,encode:u},decode:g,encode:f,toASCII:function(e){return l(e,function(e){return A.test(e)?'xn--'+f(e):e})},toUnicode:function(e){return l(e,function(e){return M.test(e)?g(e.slice(4).toLowerCase()):e})}};n=function(){return k}.call(t,r,t,e),!(void 0!==n&&(e.exports=n))})(this)}).call(t,r(126)(e),r(31))},function(e){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],!e.children&&(e.children=[]),Object.defineProperty(e,'loaded',{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,'id',{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e){'use strict';e.exports={isString:function(e){return'string'==typeof e},isObject:function(e){return'object'==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,r){'use strict';t.decode=t.parse=r(129),t.encode=t.stringify=r(130)},function(e){'use strict';function t(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,a,n,o){a=a||'&',n=n||'=';var s={};if('string'!=typeof e||0===e.length)return s;var l=/\+/g;e=e.split(a);var d=1e3;o&&'number'==typeof o.maxKeys&&(d=o.maxKeys);var u=e.length;0<d&&u>d&&(u=d);for(var p=0;p<u;++p){var i=e[p].replace(l,'%20'),c=i.indexOf(n),h,g,f,m;0<=c?(h=i.substr(0,c),g=i.substr(c+1)):(h=i,g=''),f=decodeURIComponent(h),m=decodeURIComponent(g),t(s,f)?r(s[f])?s[f].push(m):s[f]=[s[f],m]:s[f]=m}return s};var r=Array.isArray||function(e){return'[object Array]'===Object.prototype.toString.call(e)}},function(e){'use strict';function t(e,t){if(e.map)return e.map(t);for(var r=[],a=0;a<e.length;a++)r.push(t(e[a],a));return r}var r=function(e){switch(typeof e){case'string':return e;case'boolean':return e?'true':'false';case'number':return isFinite(e)?e:'';default:return'';}};e.exports=function(e,o,i,s){return o=o||'&',i=i||'=',null===e&&(e=void 0),'object'==typeof e?t(n(e),function(n){var s=encodeURIComponent(r(n))+i;return a(e[n])?t(e[n],function(e){return s+encodeURIComponent(r(e))}).join(o):s+encodeURIComponent(r(e[n]))}).join(o):s?encodeURIComponent(r(s))+i+encodeURIComponent(r(e)):''};var a=Array.isArray||function(e){return'[object Array]'===Object.prototype.toString.call(e)},n=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t}},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var o=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),i=r(3),s=a(i),l=r(1),d=r(132),u=a(d),p=function(){function e(){var t=this;n(this,e),this._head=new u.default(null,null,Infinity),this._requestId=null,this._maxElapsedMS=100,this.autoStart=!1,this.deltaTime=1,this.elapsedMS=1/s.default.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return e.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._requestId=requestAnimationFrame(this._tick))},e.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},e.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},e.prototype.add=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:l.UPDATE_PRIORITY.NORMAL;return this._addListener(new u.default(e,t,r))},e.prototype.addOnce=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:l.UPDATE_PRIORITY.NORMAL;return this._addListener(new u.default(e,t,r,!0))},e.prototype._addListener=function(e){var t=this._head.next,r=this._head;if(!t)e.connect(r);else{for(;t;){if(e.priority>t.priority){e.connect(r);break}r=t,t=t.next}e.previous||e.connect(r)}return this._startIfPossible(),this},e.prototype.remove=function(e,t){for(var r=this._head.next;r;)r=r.match(e,t)?r.destroy():r.next;return this._head.next||this._cancelIfNeeded(),this},e.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},e.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},e.prototype.destroy=function(){this.stop();for(var e=this._head.next;e;)e=e.destroy(!0);this._head.destroy(),this._head=null},e.prototype.update=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:performance.now(),t;if(e>this.lastTime){t=this.elapsedMS=e-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),this.deltaTime=t*s.default.TARGET_FPMS*this.speed;for(var r=this._head,a=r.next;a;)a=a.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.elapsedMS=0;this.lastTime=e},o(e,[{key:'FPS',get:function(){return 1e3/this.elapsedMS}},{key:'minFPS',get:function(){return 1e3/this._maxElapsedMS},set:function(e){var t=Math.min(Math.max(0,e)/1e3,s.default.TARGET_FPMS);this._maxElapsedMS=1/t}}]),e}();t.default=p},function(e,t){'use strict';function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var a=function(){function e(t){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,o=!!(3<arguments.length&&void 0!==arguments[3])&&arguments[3];r(this,e),this.fn=t,this.context=a,this.priority=n,this.once=o,this.next=null,this.previous=null,this._destroyed=!1}return e.prototype.match=function(e,t){return t=t||null,this.fn===e&&this.context===t},e.prototype.emit=function(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));var t=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),t},e.prototype.connect=function(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this},e.prototype.destroy=function(){var e=!!(0<arguments.length&&void 0!==arguments[0])&&arguments[0];this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var t=this.previous;return this.next=e?null:t,this.previous=null,t},e}();t.default=a},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var o=r(16),i=a(o),s=r(1),l=r(4),d=r(43),u=a(d),p=new l.Matrix,c=function(){function e(t){n(this,e),this.renderer=t}return e.prototype.render=function(e){var t=e._texture,r=this.renderer,a=t._frame.width,n=t._frame.height,o=e.transform.worldTransform,i=0,d=0;if(!(0>=t.orig.width||0>=t.orig.height||!t.baseTexture.source)&&(r.setBlendMode(e.blendMode),t.valid)){r.context.globalAlpha=e.worldAlpha;var c=t.baseTexture.scaleMode===s.SCALE_MODES.LINEAR;r.smoothProperty&&r.context[r.smoothProperty]!==c&&(r.context[r.smoothProperty]=c),t.trim?(i=t.trim.width/2+t.trim.x-e.anchor.x*t.orig.width,d=t.trim.height/2+t.trim.y-e.anchor.y*t.orig.height):(i=(.5-e.anchor.x)*t.orig.width,d=(.5-e.anchor.y)*t.orig.height),t.rotate&&(o.copy(p),o=p,l.GroupD8.matrixAppendRotationInv(o,t.rotate,i,d),i=0,d=0),i-=a/2,d-=n/2,r.roundPixels?(r.context.setTransform(o.a,o.b,o.c,o.d,0|o.tx*r.resolution,0|o.ty*r.resolution),i|=0,d|=0):r.context.setTransform(o.a,o.b,o.c,o.d,o.tx*r.resolution,o.ty*r.resolution);var h=t.baseTexture.resolution;16777215===e.tint?r.context.drawImage(t.baseTexture.source,t._frame.x*h,t._frame.y*h,a*h,n*h,i*r.resolution,d*r.resolution,a*r.resolution,n*r.resolution):((e.cachedTint!==e.tint||e.tintedTexture.tintId!==e._texture._updateID)&&(e.cachedTint=e.tint,e.tintedTexture=u.default.getTintedTexture(e,e.tint)),r.context.drawImage(e.tintedTexture,0,0,a*h,n*h,i*r.resolution,d*r.resolution,a*r.resolution,n*r.resolution))}},e.prototype.destroy=function(){this.renderer=null},e}();t.default=c,i.default.registerPlugin('sprite',c)},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var n=r(1),o=function(){function e(t){a(this,e),this.renderer=t}return e.prototype.pushMask=function(e){var t=this.renderer;t.context.save();var r=e.alpha,a=e.transform.worldTransform,n=t.resolution;t.context.setTransform(a.a*n,a.b*n,a.c*n,a.d*n,a.tx*n,a.ty*n),e._texture||(this.renderGraphicsShape(e),t.context.clip()),e.worldAlpha=r},e.prototype.renderGraphicsShape=function(e){var t=this.renderer.context,r=e.graphicsData.length;if(0!==r){t.beginPath();for(var a=0;a<r;a++){var o=e.graphicsData[a],i=o.shape;if(o.type===n.SHAPES.POLY){var s=i.points;t.moveTo(s[0],s[1]);for(var l=1;l<s.length/2;l++)t.lineTo(s[2*l],s[2*l+1]);s[0]===s[s.length-2]&&s[1]===s[s.length-1]&&t.closePath()}else if(o.type===n.SHAPES.RECT)t.rect(i.x,i.y,i.width,i.height),t.closePath();else if(o.type===n.SHAPES.CIRC)t.arc(i.x,i.y,i.radius,0,2*Math.PI),t.closePath();else if(o.type===n.SHAPES.ELIP){var d=2*i.width,u=2*i.height,p=i.x-d/2,c=i.y-u/2,h=.5522848,g=d/2*h,f=u/2*h,m=p+d,y=c+u,x=p+d/2,_=c+u/2;t.moveTo(p,_),t.bezierCurveTo(p,_-f,x-g,c,x,c),t.bezierCurveTo(x+g,c,m,_-f,m,_),t.bezierCurveTo(m,_+f,x+g,y,x,y),t.bezierCurveTo(x-g,y,p,_+f,p,_),t.closePath()}else if(o.type===n.SHAPES.RREC){var b=i.x,T=i.y,v=i.width,E=i.height,S=i.radius,C=0|Math.min(v,E)/2;S=S>C?C:S,t.moveTo(b,T+S),t.lineTo(b,T+E-S),t.quadraticCurveTo(b,T+E,b+S,T+E),t.lineTo(b+v-S,T+E),t.quadraticCurveTo(b+v,T+E,b+v,T+E-S),t.lineTo(b+v,T+S),t.quadraticCurveTo(b+v,T,b+v-S,T),t.lineTo(b+S,T),t.quadraticCurveTo(b,T,b,T+S),t.closePath()}}}},e.prototype.popMask=function(e){e.context.restore(),e.invalidateBlendMode()},e.prototype.destroy=function(){},e}();t.default=o},function(e,t,r){'use strict';t.__esModule=!0,t.default=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];return(0,o.default)()?(e[a.BLEND_MODES.NORMAL]='source-over',e[a.BLEND_MODES.ADD]='lighter',e[a.BLEND_MODES.MULTIPLY]='multiply',e[a.BLEND_MODES.SCREEN]='screen',e[a.BLEND_MODES.OVERLAY]='overlay',e[a.BLEND_MODES.DARKEN]='darken',e[a.BLEND_MODES.LIGHTEN]='lighten',e[a.BLEND_MODES.COLOR_DODGE]='color-dodge',e[a.BLEND_MODES.COLOR_BURN]='color-burn',e[a.BLEND_MODES.HARD_LIGHT]='hard-light',e[a.BLEND_MODES.SOFT_LIGHT]='soft-light',e[a.BLEND_MODES.DIFFERENCE]='difference',e[a.BLEND_MODES.EXCLUSION]='exclusion',e[a.BLEND_MODES.HUE]='hue',e[a.BLEND_MODES.SATURATION]='saturate',e[a.BLEND_MODES.COLOR]='color',e[a.BLEND_MODES.LUMINOSITY]='luminosity'):(e[a.BLEND_MODES.NORMAL]='source-over',e[a.BLEND_MODES.ADD]='lighter',e[a.BLEND_MODES.MULTIPLY]='source-over',e[a.BLEND_MODES.SCREEN]='source-over',e[a.BLEND_MODES.OVERLAY]='source-over',e[a.BLEND_MODES.DARKEN]='source-over',e[a.BLEND_MODES.LIGHTEN]='source-over',e[a.BLEND_MODES.COLOR_DODGE]='source-over',e[a.BLEND_MODES.COLOR_BURN]='source-over',e[a.BLEND_MODES.HARD_LIGHT]='source-over',e[a.BLEND_MODES.SOFT_LIGHT]='source-over',e[a.BLEND_MODES.DIFFERENCE]='source-over',e[a.BLEND_MODES.EXCLUSION]='source-over',e[a.BLEND_MODES.HUE]='source-over',e[a.BLEND_MODES.SATURATION]='source-over',e[a.BLEND_MODES.COLOR]='source-over',e[a.BLEND_MODES.LUMINOSITY]='source-over'),e[a.BLEND_MODES.NORMAL_NPM]=e[a.BLEND_MODES.NORMAL],e[a.BLEND_MODES.ADD_NPM]=e[a.BLEND_MODES.ADD],e[a.BLEND_MODES.SCREEN_NPM]=e[a.BLEND_MODES.SCREEN],e};var a=r(1),n=r(68),o=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=Math.min;t.__esModule=!0;var l=r(25),d=a(l),u=r(26),p=a(u),c=r(44),h=a(c),g=r(149),f=a(g),m=r(150),y=a(m),x=r(151),_=a(x),b=r(3),T=a(b),v=r(2),E=r(7),S=a(E),C=r(40),P=a(C),w=0,M=0,A=function(e){function t(r){n(this,t);var a=o(this,e.call(this,r));a.vertSize=5,a.vertByteSize=4*a.vertSize,a.size=T.default.SPRITE_BATCH_SIZE,a.buffers=[];for(var s=1;s<=P.default.nextPow2(a.size);s*=2)a.buffers.push(new _.default(4*s*a.vertByteSize));a.indices=(0,h.default)(a.size),a.shader=null,a.currentIndex=0,a.groups=[];for(var i=0;i<a.size;i++)a.groups[i]={textures:[],textureCount:0,ids:[],size:0,start:0,blend:0};return a.sprites=[],a.vertexBuffers=[],a.vaos=[],a.vaoMax=2,a.vertexCount=0,a.renderer.on('prerender',a.onPrerender,a),a}return i(t,e),t.prototype.onContextChange=function(){var e=this.renderer.gl;this.renderer.legacy?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=s(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),T.default.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=(0,y.default)(this.MAX_TEXTURES,e)),this.shader=(0,f.default)(e,this.MAX_TEXTURES),this.indexBuffer=S.default.GLBuffer.createIndexBuffer(e,this.indices,e.STATIC_DRAW),this.renderer.bindVao(null);for(var t=this.shader.attributes,r=0;r<this.vaoMax;r++){var a=this.vertexBuffers[r]=S.default.GLBuffer.createVertexBuffer(e,null,e.STREAM_DRAW),n=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(a,t.aVertexPosition,e.FLOAT,!1,this.vertByteSize,0).addAttribute(a,t.aTextureCoord,e.UNSIGNED_SHORT,!0,this.vertByteSize,8).addAttribute(a,t.aColor,e.UNSIGNED_BYTE,!0,this.vertByteSize,12);t.aTextureId&&n.addAttribute(a,t.aTextureId,e.FLOAT,!1,this.vertByteSize,16),this.vaos[r]=n}this.vao=this.vaos[0],this.currentBlendMode=99999,this.boundTextures=Array(this.MAX_TEXTURES)},t.prototype.onPrerender=function(){this.vertexCount=0},t.prototype.render=function(e){this.currentIndex>=this.size&&this.flush(),e._texture._uvs&&(this.sprites[this.currentIndex++]=e)},t.prototype.flush=function(){if(0!==this.currentIndex){var e=this.renderer.gl,r=this.MAX_TEXTURES,a=P.default.nextPow2(this.currentIndex),n=P.default.log2(a),o=this.buffers[n],l=this.sprites,d=this.groups,u=o.float32View,p=o.uint32View,c=this.boundTextures,h=this.renderer.boundTextures,g=this.renderer.textureGC.count,f=0,m=1,y=0,x=d[0],_=v.premultiplyBlendMode[l[0]._texture.baseTexture.premultipliedAlpha?1:0][l[0].blendMode],b,E,C,A;x.textureCount=0,x.start=0,x.blend=_,w++;var I;for(I=0;I<r;++I){var i=h[I];if(i._enabled===w){c[I]=this.renderer.emptyTextures[I];continue}c[I]=i,i._virtalBoundId=I,i._enabled=w}for(w++,I=0;I<this.currentIndex;++I){var R=l[I];b=R._texture.baseTexture;var D=v.premultiplyBlendMode[+b.premultipliedAlpha][R.blendMode];if(_!==D&&(_=D,E=null,y=r,w++),E!==b&&(E=b,b._enabled!==w)){if(y===r&&(w++,x.size=I-x.start,y=0,x=d[m++],x.blend=_,x.textureCount=0,x.start=I),b.touched=g,-1===b._virtalBoundId)for(var O=0;O<r;++O){var k=(O+M)%r,L=c[k];if(L._enabled!==w){M++,L._virtalBoundId=-1,b._virtalBoundId=k,c[k]=b;break}}b._enabled=w,x.textureCount++,x.ids[y]=b._virtalBoundId,x.textures[y++]=b}if(C=R.vertexData,A=R._texture._uvs.uvsUint32,this.renderer.roundPixels){var t=this.renderer.resolution;u[f]=(0|C[0]*t)/t,u[f+1]=(0|C[1]*t)/t,u[f+5]=(0|C[2]*t)/t,u[f+6]=(0|C[3]*t)/t,u[f+10]=(0|C[4]*t)/t,u[f+11]=(0|C[5]*t)/t,u[f+15]=(0|C[6]*t)/t,u[f+16]=(0|C[7]*t)/t}else u[f]=C[0],u[f+1]=C[1],u[f+5]=C[2],u[f+6]=C[3],u[f+10]=C[4],u[f+11]=C[5],u[f+15]=C[6],u[f+16]=C[7];p[f+2]=A[0],p[f+7]=A[1],p[f+12]=A[2],p[f+17]=A[3];var N=s(R.worldAlpha,1),F=1>N&&b.premultipliedAlpha?(0,v.premultiplyTint)(R._tintRGB,N):R._tintRGB+(255*N<<24);p[f+3]=p[f+8]=p[f+13]=p[f+18]=F,u[f+4]=u[f+9]=u[f+14]=u[f+19]=b._virtalBoundId,f+=20}if(x.size=I-x.start,!T.default.CAN_UPLOAD_SAME_BUFFER){if(this.vaoMax<=this.vertexCount){this.vaoMax++;var B=this.shader.attributes,U=this.vertexBuffers[this.vertexCount]=S.default.GLBuffer.createVertexBuffer(e,null,e.STREAM_DRAW),G=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(U,B.aVertexPosition,e.FLOAT,!1,this.vertByteSize,0).addAttribute(U,B.aTextureCoord,e.UNSIGNED_SHORT,!0,this.vertByteSize,8).addAttribute(U,B.aColor,e.UNSIGNED_BYTE,!0,this.vertByteSize,12);B.aTextureId&&G.addAttribute(U,B.aTextureId,e.FLOAT,!1,this.vertByteSize,16),this.vaos[this.vertexCount]=G}this.renderer.bindVao(this.vaos[this.vertexCount]),this.vertexBuffers[this.vertexCount].upload(o.vertices,0,!1),this.vertexCount++}else this.vertexBuffers[this.vertexCount].upload(o.vertices,0,!0);for(I=0;I<r;++I)h[I]._virtalBoundId=-1;for(I=0;I<m;++I){for(var V=d[I],W=V.textureCount,X=0;X<W;X++)E=V.textures[X],h[V.ids[X]]!==E&&this.renderer.bindTexture(E,V.ids[X],!0),E._virtalBoundId=-1;this.renderer.state.setBlendMode(V.blend),e.drawElements(e.TRIANGLES,6*V.size,e.UNSIGNED_SHORT,2*(6*V.start))}this.currentIndex=0}},t.prototype.start=function(){this.renderer.bindShader(this.shader),T.default.CAN_UPLOAD_SAME_BUFFER&&(this.renderer.bindVao(this.vaos[this.vertexCount]),this.vertexBuffers[this.vertexCount].bind())},t.prototype.stop=function(){this.flush()},t.prototype.destroy=function(){for(var t=0;t<this.vaoMax;t++)this.vertexBuffers[t]&&this.vertexBuffers[t].destroy(),this.vaos[t]&&this.vaos[t].destroy();this.indexBuffer&&this.indexBuffer.destroy(),this.renderer.off('prerender',this.onPrerender,this),e.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.vertexBuffers=null,this.vaos=null,this.indexBuffer=null,this.indices=null,this.sprites=null;for(var r=0;r<this.buffers.length;++r)this.buffers[r].destroy()},t}(d.default);t.default=A,p.default.registerPlugin('sprite',A)},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=r(17),l=a(s),d=r(69),u=a(d),p=function(e){function t(r){n(this,t);var a=o(this,e.call(this,r));return a.scissor=!1,a.scissorData=null,a.scissorRenderTarget=null,a.enableScissor=!0,a.alphaMaskPool=[],a.alphaMaskIndex=0,a}return i(t,e),t.prototype.pushMask=function(e,t){if(t.texture)this.pushSpriteMask(e,t);else if(this.enableScissor&&!this.scissor&&this.renderer._activeRenderTarget.root&&!this.renderer.stencilManager.stencilMaskStack.length&&t.isFastRect()){var r=t.worldTransform,a=Math.atan2(r.b,r.a);a=Math.round(a*(180/Math.PI)),a%90?this.pushStencilMask(t):this.pushScissorMask(e,t)}else this.pushStencilMask(t)},t.prototype.popMask=function(e,t){t.texture?this.popSpriteMask(e,t):this.enableScissor&&!this.renderer.stencilManager.stencilMaskStack.length?this.popScissorMask(e,t):this.popStencilMask(e,t)},t.prototype.pushSpriteMask=function(e,t){var r=this.alphaMaskPool[this.alphaMaskIndex];r||(r=this.alphaMaskPool[this.alphaMaskIndex]=[new u.default(t)]),r[0].resolution=this.renderer.resolution,r[0].maskSprite=t,e.filterArea=t.getBounds(!0),this.renderer.filterManager.pushFilter(e,r),this.alphaMaskIndex++},t.prototype.popSpriteMask=function(){this.renderer.filterManager.popFilter(),this.alphaMaskIndex--},t.prototype.pushStencilMask=function(e){this.renderer.currentRenderer.stop(),this.renderer.stencilManager.pushStencil(e)},t.prototype.popStencilMask=function(){this.renderer.currentRenderer.stop(),this.renderer.stencilManager.popStencil()},t.prototype.pushScissorMask=function(e,t){t.renderable=!0;var r=this.renderer._activeRenderTarget,a=t.getBounds();a.fit(r.size),t.renderable=!1,this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST);var n=this.renderer.resolution;this.renderer.gl.scissor(a.x*n,(r.root?r.size.height-a.y-a.height:a.y)*n,a.width*n,a.height*n),this.scissorRenderTarget=r,this.scissorData=t,this.scissor=!0},t.prototype.popScissorMask=function(){this.scissorRenderTarget=null,this.scissorData=null,this.scissor=!1;var e=this.renderer.gl;e.disable(e.SCISSOR_TEST)},t}(l.default);t.default=p},function(e,t,r){'use strict';function a(e){for(var t=/^(projectionMatrix|uSampler|filterArea|filterClamp)$/,r={},a=void 0,n=e.replace(/\s+/g,' ').split(/\s*;\s*/),o=0,s;o<n.length;o++)if(s=n[o].trim(),-1<s.indexOf('uniform')){var l=s.split(' '),d=l[1],u=l[2],p=1;-1<u.indexOf('[')&&(a=u.split(/\[|]/),u=a[0],p*=+a[1]),u.match(t)||(r[u]={value:i(d,p),name:u,type:d})}return r}t.__esModule=!0,t.default=function(e,t,r){var n=a(e,r),o=a(t,r);return Object.assign(n,o)};var n=r(7),o=function(e){return e&&e.__esModule?e:{default:e}}(n),i=o.default.shader.defaultValue},function(e){function t(){throw new Error('setTimeout has not been defined')}function r(){throw new Error('clearTimeout has not been defined')}function a(e){if(u===setTimeout)return setTimeout(e,0);if((u===t||!u)&&setTimeout)return u=setTimeout,setTimeout(e,0);try{return u(e,0)}catch(t){try{return u.call(null,e,0)}catch(t){return u.call(this,e,0)}}}function n(e){if(p===clearTimeout)return clearTimeout(e);if((p===r||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(e);try{return p(e)}catch(t){try{return p.call(null,e)}catch(t){return p.call(this,e)}}}function o(){h&&f&&(h=!1,f.length?c=f.concat(c):g=-1,c.length&&s())}function s(){if(!h){var e=a(o);h=!0;for(var t=c.length;t;){for(f=c,c=[];++g<t;)f&&f[g].run();g=-1,t=c.length}f=null,h=!1,n(e)}}function l(e,t){this.fun=e,this.array=t}function i(){}var d=e.exports={},u,p;(function(){try{u='function'==typeof setTimeout?setTimeout:t}catch(r){u=t}try{p='function'==typeof clearTimeout?clearTimeout:r}catch(t){p=r}})();var c=[],h=!1,g=-1,f;d.nextTick=function(e){var t=Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new l(e,t)),1!==c.length||h||a(s)},l.prototype.run=function(){this.fun.apply(null,this.array)},d.title='browser',d.browser=!0,d.env={},d.argv=[],d.version='',d.versions={},d.on=i,d.addListener=i,d.once=i,d.off=i,d.removeListener=i,d.removeAllListeners=i,d.emit=i,d.prependListener=i,d.prependOnceListener=i,d.listeners=function(){return[]},d.binding=function(){throw new Error('process.binding is not supported')},d.cwd=function(){return'/'},d.chdir=function(){throw new Error('process.chdir is not supported')},d.umask=function(){return 0}},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function n(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function o(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var i=r(17),s=function(e){return e&&e.__esModule?e:{default:e}}(i),l=function(e){function t(r){a(this,t);var o=n(this,e.call(this,r));return o.stencilMaskStack=null,o}return o(t,e),t.prototype.setMaskStack=function(e){this.stencilMaskStack=e;var t=this.renderer.gl;0===e.length?t.disable(t.STENCIL_TEST):t.enable(t.STENCIL_TEST)},t.prototype.pushStencil=function(e){this.renderer.setObjectRenderer(this.renderer.plugins.graphics),this.renderer._activeRenderTarget.attachStencilBuffer();var t=this.renderer.gl,r=this.stencilMaskStack.length;0===r&&t.enable(t.STENCIL_TEST),this.stencilMaskStack.push(e),t.colorMask(!1,!1,!1,!1),t.stencilFunc(t.EQUAL,r,this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.INCR),this.renderer.plugins.graphics.render(e),this._useCurrent()},t.prototype.popStencil=function(){this.renderer.setObjectRenderer(this.renderer.plugins.graphics);var e=this.renderer.gl,t=this.stencilMaskStack.pop();0===this.stencilMaskStack.length?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),this.renderer.plugins.graphics.render(t),this._useCurrent())},t.prototype._useCurrent=function(){var e=this.renderer.gl;e.colorMask(!0,!0,!0,!0),e.stencilFunc(e.EQUAL,this.stencilMaskStack.length,this._getBitwiseMask()),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)},t.prototype._getBitwiseMask=function(){return(1<<this.stencilMaskStack.length)-1},t.prototype.destroy=function(){s.default.prototype.destroy.call(this),this.stencilMaskStack.stencilStack=null},t}(s.default);t.default=l},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function o(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var s=r(17),l=a(s),d=r(27),u=a(d),p=r(72),c=a(p),h=r(4),g=r(18),f=a(g),m=r(142),y=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(m),x=r(40),_=a(x),b=function e(){i(this,e),this.renderTarget=null,this.sourceFrame=new h.Rectangle,this.destinationFrame=new h.Rectangle,this.filters=[],this.target=null,this.resolution=1},T=function(e){function t(r){i(this,t);var a=n(this,e.call(this,r));return a.gl=a.renderer.gl,a.quad=new c.default(a.gl,r.state.attribState),a.shaderCache={},a.pool={},a.filterData=null,a.managedFilters=[],a}return o(t,e),t.prototype.pushFilter=function(e,t){var r=this.renderer,a=this.filterData;if(!a){a=this.renderer._activeRenderTarget.filterStack;var n=new b;n.sourceFrame=n.destinationFrame=this.renderer._activeRenderTarget.size,n.renderTarget=r._activeRenderTarget,this.renderer._activeRenderTarget.filterData=a={index:0,stack:[n]},this.filterData=a}var o=a.stack[++a.index];o||(o=a.stack[a.index]=new b);var i=t[0].resolution,s=0|t[0].padding,l=e.filterArea||e.getBounds(!0),d=o.sourceFrame,u=o.destinationFrame;d.x=(0|l.x*i)/i,d.y=(0|l.y*i)/i,d.width=(0|l.width*i)/i,d.height=(0|l.height*i)/i,a.stack[0].renderTarget.transform||t[0].autoFit&&d.fit(a.stack[0].destinationFrame),d.pad(s),u.width=d.width,u.height=d.height;var p=this.getPotRenderTarget(r.gl,d.width,d.height,i);o.target=e,o.filters=t,o.resolution=i,o.renderTarget=p,p.setFrame(u,d),r.bindRenderTarget(p),p.clear()},t.prototype.popFilter=function(){var e=this.filterData,r=e.stack[e.index-1],a=e.stack[e.index];this.quad.map(a.renderTarget.size,a.sourceFrame).upload();var n=a.filters;if(1===n.length)n[0].apply(this,a.renderTarget,r.renderTarget,!1,a),this.freePotRenderTarget(a.renderTarget);else{var o=a.renderTarget,s=this.getPotRenderTarget(this.renderer.gl,a.sourceFrame.width,a.sourceFrame.height,a.resolution);s.setFrame(a.destinationFrame,a.sourceFrame),s.clear();var l=0;for(l=0;l<n.length-1;++l){n[l].apply(this,o,s,!0,a);var i=o;o=s,s=i}n[l].apply(this,o,r.renderTarget,!1,a),this.freePotRenderTarget(o),this.freePotRenderTarget(s)}e.index--,0===e.index&&(this.filterData=null)},t.prototype.applyFilter=function(e,t,r,a){var n=this.renderer,o=n.gl,i=e.glShaders[n.CONTEXT_UID];i||(e.glShaderKey?(i=this.shaderCache[e.glShaderKey],!i&&(i=new f.default(this.gl,e.vertexSrc,e.fragmentSrc),e.glShaders[n.CONTEXT_UID]=this.shaderCache[e.glShaderKey]=i,this.managedFilters.push(e))):(i=e.glShaders[n.CONTEXT_UID]=new f.default(this.gl,e.vertexSrc,e.fragmentSrc),this.managedFilters.push(e)),n.bindVao(null),this.quad.initVao(i)),n.bindVao(this.quad.vao),n.bindRenderTarget(r),a&&(o.disable(o.SCISSOR_TEST),n.clear(),o.enable(o.SCISSOR_TEST)),r===n.maskManager.scissorRenderTarget&&n.maskManager.pushScissorMask(null,n.maskManager.scissorData),n.bindShader(i);var s=this.renderer.emptyTextures[0];this.renderer.boundTextures[0]=s,this.syncUniforms(i,e),n.state.setBlendMode(e.blendMode),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,t.texture.texture),this.quad.vao.draw(this.renderer.gl.TRIANGLES,6,0),o.bindTexture(o.TEXTURE_2D,s._glTextures[this.renderer.CONTEXT_UID].texture)},t.prototype.syncUniforms=function(e,t){var r=t.uniformData,a=t.uniforms,n=1,o;if(e.uniforms.filterArea){o=this.filterData.stack[this.filterData.index];var s=e.uniforms.filterArea;s[0]=o.renderTarget.size.width,s[1]=o.renderTarget.size.height,s[2]=o.sourceFrame.x,s[3]=o.sourceFrame.y,e.uniforms.filterArea=s}if(e.uniforms.filterClamp){o=o||this.filterData.stack[this.filterData.index];var l=e.uniforms.filterClamp;l[0]=0,l[1]=0,l[2]=(o.sourceFrame.width-1)/o.renderTarget.size.width,l[3]=(o.sourceFrame.height-1)/o.renderTarget.size.height,e.uniforms.filterClamp=l}for(var d in r){var i=r[d].type;if('sampler2d'===i&&0!==a[d]){if(a[d].baseTexture)e.uniforms[d]=this.renderer.bindTexture(a[d].baseTexture,n);else{e.uniforms[d]=n;var u=this.renderer.gl;this.renderer.boundTextures[n]=this.renderer.emptyTextures[n],u.activeTexture(u.TEXTURE0+n),a[d].texture.bind()}n++}else if('mat3'===i)e.uniforms[d]=void 0===a[d].a?a[d]:a[d].toArray(!0);else if('vec2'!==i)'float'===i?e.uniforms.data[d].value!==r[d]&&(e.uniforms[d]=a[d]):e.uniforms[d]=a[d];else if(void 0!==a[d].x){var p=e.uniforms[d]||new Float32Array(2);p[0]=a[d].x,p[1]=a[d].y,e.uniforms[d]=p}else e.uniforms[d]=a[d]}},t.prototype.getRenderTarget=function(e,t){var r=this.filterData.stack[this.filterData.index],a=this.getPotRenderTarget(this.renderer.gl,r.sourceFrame.width,r.sourceFrame.height,t||r.resolution);return a.setFrame(r.destinationFrame,r.sourceFrame),a},t.prototype.returnRenderTarget=function(e){this.freePotRenderTarget(e)},t.prototype.calculateScreenSpaceMatrix=function(e){var t=this.filterData.stack[this.filterData.index];return y.calculateScreenSpaceMatrix(e,t.sourceFrame,t.renderTarget.size)},t.prototype.calculateNormalizedScreenSpaceMatrix=function(e){var t=this.filterData.stack[this.filterData.index];return y.calculateNormalizedScreenSpaceMatrix(e,t.sourceFrame,t.renderTarget.size,t.destinationFrame)},t.prototype.calculateSpriteMatrix=function(e,t){var r=this.filterData.stack[this.filterData.index];return y.calculateSpriteMatrix(e,r.sourceFrame,r.renderTarget.size,t)},t.prototype.destroy=function(){for(var e=!!(0<arguments.length&&void 0!==arguments[0])&&arguments[0],t=this.renderer,r=this.managedFilters,a=0;a<r.length;a++)e||r[a].glShaders[t.CONTEXT_UID].destroy(),delete r[a].glShaders[t.CONTEXT_UID];this.shaderCache={},e?this.pool={}:this.emptyPool()},t.prototype.getPotRenderTarget=function(e,t,r,a){t=_.default.nextPow2(t*a),r=_.default.nextPow2(r*a);var n=(65535&t)<<16|65535&r;this.pool[n]||(this.pool[n]=[]);var o=this.pool[n].pop();if(!o){var i=this.renderer.boundTextures[0];e.activeTexture(e.TEXTURE0),o=new u.default(e,t,r,null,1),e.bindTexture(e.TEXTURE_2D,i._glTextures[this.renderer.CONTEXT_UID].texture)}return o.resolution=a,o.defaultFrame.width=o.size.width=t/a,o.defaultFrame.height=o.size.height=r/a,o},t.prototype.emptyPool=function(){for(var e in this.pool){var t=this.pool[e];if(t)for(var r=0;r<t.length;r++)t[r].destroy(!0)}this.pool={}},t.prototype.freePotRenderTarget=function(e){var t=e.size.width*e.resolution,r=e.size.height*e.resolution;this.pool[(65535&t)<<16|65535&r].push(e)},t}(l.default);t.default=T},function(e,t,r){'use strict';t.__esModule=!0,t.calculateScreenSpaceMatrix=function(e,t,r){var a=e.identity();return a.translate(t.x/r.width,t.y/r.height),a.scale(r.width,r.height),a},t.calculateNormalizedScreenSpaceMatrix=function(e,t,r){var a=e.identity();a.translate(t.x/r.width,t.y/r.height);var n=r.width/t.width,o=r.height/t.height;return a.scale(n,o),a},t.calculateSpriteMatrix=function(e,t,r,n){var o=n._texture.orig,i=e.set(r.width,0,0,r.height,t.x,t.y),s=n.worldTransform.copy(a.Matrix.TEMP_MATRIX);return s.invert(),i.prepend(s),i.scale(1/o.width,1/o.height),i.translate(n.anchor.x,n.anchor.y),i};var a=r(4)},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var n=r(7),o=r(1),i=r(27),s=function(e){return e&&e.__esModule?e:{default:e}}(i),l=r(2),d=function(){function e(t){a(this,e),this.renderer=t,this.gl=t.gl,this._managedTextures=[]}return e.prototype.bindTexture=function(){},e.prototype.getTexture=function(){},e.prototype.updateTexture=function(e,t){var r=this.gl,a=!!e._glRenderTargets;if(!e.hasLoaded)return null;var l=this.renderer.boundTextures;if(void 0===t){t=0;for(var d=0;d<l.length;++d)if(l[d]===e){t=d;break}}l[t]=e,r.activeTexture(r.TEXTURE0+t);var i=e._glTextures[this.renderer.CONTEXT_UID];if(!i){if(a){var u=new s.default(this.gl,e.width,e.height,e.scaleMode,e.resolution);u.resize(e.width,e.height),e._glRenderTargets[this.renderer.CONTEXT_UID]=u,i=u.texture}else i=new n.GLTexture(this.gl,null,null,null,null),i.bind(t),i.premultiplyAlpha=!0,i.upload(e.source);e._glTextures[this.renderer.CONTEXT_UID]=i,e.on('update',this.updateTexture,this),e.on('dispose',this.destroyTexture,this),this._managedTextures.push(e),e.isPowerOfTwo?(e.mipmap&&i.enableMipmap(),e.wrapMode===o.WRAP_MODES.CLAMP?i.enableWrapClamp():e.wrapMode===o.WRAP_MODES.REPEAT?i.enableWrapRepeat():i.enableWrapMirrorRepeat()):i.enableWrapClamp(),e.scaleMode===o.SCALE_MODES.NEAREST?i.enableNearestScaling():i.enableLinearScaling()}else a?e._glRenderTargets[this.renderer.CONTEXT_UID].resize(e.width,e.height):i.upload(e.source);return i},e.prototype.destroyTexture=function(e,t){if(e=e.baseTexture||e,!!e.hasLoaded){var r=this.renderer.CONTEXT_UID,a=e._glTextures,n=e._glRenderTargets;if(a[r]&&(this.renderer.unbindTexture(e),a[r].destroy(),e.off('update',this.updateTexture,this),e.off('dispose',this.destroyTexture,this),delete a[r],!t)){var o=this._managedTextures.indexOf(e);-1!==o&&(0,l.removeItems)(this._managedTextures,o,1)}n&&n[r]&&(n[r].destroy(),delete n[r])}},e.prototype.removeAll=function(){for(var e=0,t;e<this._managedTextures.length;++e)t=this._managedTextures[e],t._glTextures[this.renderer.CONTEXT_UID]&&delete t._glTextures[this.renderer.CONTEXT_UID]},e.prototype.destroy=function(){for(var e=0,t;e<this._managedTextures.length;++e)t=this._managedTextures[e],this.destroyTexture(t,!0),t.off('update',this.updateTexture,this),t.off('dispose',this.destroyTexture,this);this._managedTextures=null},e}();t.default=d},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var n=r(1),o=r(3),i=function(e){return e&&e.__esModule?e:{default:e}}(o),s=function(){function e(t){a(this,e),this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=i.default.GC_MAX_IDLE,this.checkCountMax=i.default.GC_MAX_CHECK_COUNT,this.mode=i.default.GC_MODE}return e.prototype.update=function(){this.count++,this.mode===n.GC_MODES.MANUAL||(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run()))},e.prototype.run=function(){for(var e=this.renderer.textureManager,t=e._managedTextures,r=!1,a=0,n;a<t.length;a++)n=t[a],!n._glRenderTargets&&this.count-n.touched>this.maxIdle&&(e.destroyTexture(n,!0),t[a]=null,r=!0);if(r){for(var o=0,i=0;i<t.length;i++)null!==t[i]&&(t[o++]=t[i]);t.length=o}},e.prototype.unload=function(e){var t=this.renderer.textureManager;e._texture&&e._texture._glRenderTargets&&t.destroyTexture(e._texture,!0);for(var r=e.children.length-1;0<=r;r--)this.unload(e.children[r])},e}();t.default=s},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var n=r(146),o=function(e){return e&&e.__esModule?e:{default:e}}(n),i=0,s=1,l=2,d=3,u=4,p=function(){function e(t){a(this,e),this.activeState=new Uint8Array(16),this.defaultState=new Uint8Array(16),this.defaultState[0]=1,this.stackIndex=0,this.stack=[],this.gl=t,this.maxAttribs=t.getParameter(t.MAX_VERTEX_ATTRIBS),this.attribState={tempAttribState:Array(this.maxAttribs),attribState:Array(this.maxAttribs)},this.blendModes=(0,o.default)(t),this.nativeVaoExtension=t.getExtension('OES_vertex_array_object')||t.getExtension('MOZ_OES_vertex_array_object')||t.getExtension('WEBKIT_OES_vertex_array_object')}return e.prototype.push=function(){var e=this.stack[this.stackIndex];e||(e=this.stack[this.stackIndex]=new Uint8Array(16)),++this.stackIndex;for(var t=0;t<this.activeState.length;t++)e[t]=this.activeState[t]},e.prototype.pop=function(){var e=this.stack[--this.stackIndex];this.setState(e)},e.prototype.setState=function(e){this.setBlend(e[i]),this.setDepthTest(e[s]),this.setFrontFace(e[l]),this.setCullFace(e[d]),this.setBlendMode(e[u])},e.prototype.setBlend=function(e){e=e?1:0,this.activeState[i]===e||(this.activeState[i]=e,this.gl[e?'enable':'disable'](this.gl.BLEND))},e.prototype.setBlendMode=function(e){if(e!==this.activeState[u]){this.activeState[u]=e;var t=this.blendModes[e];2===t.length?this.gl.blendFunc(t[0],t[1]):this.gl.blendFuncSeparate(t[0],t[1],t[2],t[3])}},e.prototype.setDepthTest=function(e){e=e?1:0,this.activeState[s]===e||(this.activeState[s]=e,this.gl[e?'enable':'disable'](this.gl.DEPTH_TEST))},e.prototype.setCullFace=function(e){e=e?1:0,this.activeState[d]===e||(this.activeState[d]=e,this.gl[e?'enable':'disable'](this.gl.CULL_FACE))},e.prototype.setFrontFace=function(e){e=e?1:0,this.activeState[l]===e||(this.activeState[l]=e,this.gl.frontFace(this.gl[e?'CW':'CCW']))},e.prototype.resetAttributes=function(){for(var e=0;e<this.attribState.tempAttribState.length;e++)this.attribState.tempAttribState[e]=0;for(var t=0;t<this.attribState.attribState.length;t++)this.attribState.attribState[t]=0;for(var r=1;r<this.maxAttribs;r++)this.gl.disableVertexAttribArray(r)},e.prototype.resetToDefault=function(){this.nativeVaoExtension&&this.nativeVaoExtension.bindVertexArrayOES(null),this.resetAttributes();for(var e=0;e<this.activeState.length;++e)this.activeState[e]=32;this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.setState(this.defaultState)},e}();t.default=p},function(e,t,r){'use strict';t.__esModule=!0,t.default=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];return t[a.BLEND_MODES.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[a.BLEND_MODES.ADD]=[e.ONE,e.DST_ALPHA],t[a.BLEND_MODES.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA],t[a.BLEND_MODES.SCREEN]=[e.ONE,e.ONE_MINUS_SRC_COLOR],t[a.BLEND_MODES.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[a.BLEND_MODES.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[a.BLEND_MODES.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[a.BLEND_MODES.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[a.BLEND_MODES.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[a.BLEND_MODES.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[a.BLEND_MODES.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[a.BLEND_MODES.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[a.BLEND_MODES.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[a.BLEND_MODES.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[a.BLEND_MODES.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[a.BLEND_MODES.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[a.BLEND_MODES.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[a.BLEND_MODES.NORMAL_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[a.BLEND_MODES.ADD_NPM]=[e.SRC_ALPHA,e.DST_ALPHA,e.ONE,e.DST_ALPHA],t[a.BLEND_MODES.SCREEN_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_COLOR],t};var a=r(1)},function(e,t,r){'use strict';t.__esModule=!0,t.default=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return t[a.DRAW_MODES.POINTS]=e.POINTS,t[a.DRAW_MODES.LINES]=e.LINES,t[a.DRAW_MODES.LINE_LOOP]=e.LINE_LOOP,t[a.DRAW_MODES.LINE_STRIP]=e.LINE_STRIP,t[a.DRAW_MODES.TRIANGLES]=e.TRIANGLES,t[a.DRAW_MODES.TRIANGLE_STRIP]=e.TRIANGLE_STRIP,t[a.DRAW_MODES.TRIANGLE_FAN]=e.TRIANGLE_FAN,t};var a=r(1)},function(e,t){'use strict';t.__esModule=!0,t.default=function(e){var t=e.getContextAttributes();t.stencil||console.warn('Provided WebGL context does not have a stencil buffer, masks may not render correctly')}},function(e,t,r){'use strict';function a(e){var t='';t+='\n',t+='\n';for(var r=0;r<e;r++)0<r&&(t+='\nelse '),r<e-1&&(t+='if(textureId == '+r+'.0)'),t+='\n{',t+='\n\tcolor = texture2D(uSamplers['+r+'], vTextureCoord);',t+='\n}';return t+='\n',t+='\n',t}t.__esModule=!0,t.default=function(e,t){var r=s;r=r.replace(/%count%/gi,t),r=r.replace(/%forloop%/gi,a(t));for(var n=new o.default(e,'precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor;\n}\n',r),l=[],d=0;d<t;d++)l[d]=d;return n.bind(),n.uniforms.uSamplers=l,n};var n=r(18),o=function(e){return e&&e.__esModule?e:{default:e}}(n),i=r(9),s='varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\nvoid main(void){\nvec4 color;\nfloat textureId = floor(vTextureId+0.5);\n%forloop%\ngl_FragColor = color * vColor;\n}'},function(e,t,r){'use strict';function a(e){for(var t='',r=0;r<e;++r)0<r&&(t+='\nelse '),r<e-1&&(t+='if(test == '+r+'.0){}');return t}t.__esModule=!0,t.default=function(e,t){var r=!t;if(0===e)throw new Error('Invalid value of `0` passed to `checkMaxIfStatementsInShader`');if(r){var n=document.createElement('canvas');n.width=1,n.height=1,t=o.default.createContext(n)}for(var s=t.createShader(t.FRAGMENT_SHADER),l;l=i.replace(/%forloop%/gi,a(e)),t.shaderSource(s,l),t.compileShader(s),!t.getShaderParameter(s,t.COMPILE_STATUS);)e=0|e/2;return r&&t.getExtension('WEBGL_lose_context')&&t.getExtension('WEBGL_lose_context').loseContext(),e};var n=r(7),o=function(e){return e&&e.__esModule?e:{default:e}}(n),i='precision mediump float;\nvoid main(void){\nfloat test = 0.1;\n%forloop%\ngl_FragColor = vec4(0.0);\n}'},function(e,t){'use strict';function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var a=function(){function e(t){r(this,e),this.vertices=new ArrayBuffer(t),this.float32View=new Float32Array(this.vertices),this.uint32View=new Uint32Array(this.vertices)}return e.prototype.destroy=function(){this.vertices=null,this.positions=null,this.uvs=null,this.colors=null},e}();t.default=a},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=Math.ceil,l=Math.abs;t.__esModule=!0;var d=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),u=r(39),p=a(u),c=r(11),h=a(c),g=r(4),f=r(2),m=r(1),y=r(3),x=a(y),_=r(73),b=a(_),T=r(74),v=a(T),E=r(153),S=a(E),C={texture:!0,children:!1,baseTexture:!0},P=function(e){function t(r,a,i){n(this,t),i=i||document.createElement('canvas'),i.width=3,i.height=3;var s=h.default.fromCanvas(i,x.default.SCALE_MODE,'text');s.orig=new g.Rectangle,s.trim=new g.Rectangle;var l=o(this,e.call(this,s));return h.default.addToCache(l._texture,l._texture.baseTexture.textureCacheIds[0]),l.canvas=i,l.context=l.canvas.getContext('2d'),l.resolution=x.default.RESOLUTION,l._text=null,l._style=null,l._styleListener=null,l._font='',l.text=r,l.style=a,l.localStyleID=-1,l}return i(t,e),t.prototype.updateText=function(e){var t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),this.dirty||!e){this._font=this._style.toFontString();var r=this.context,a=v.default.measureText(this._text,this._style,this._style.wordWrap,this.canvas),n=a.width,o=a.height,l=a.lines,d=a.lineHeight,u=a.lineWidths,p=a.maxLineWidth,c=a.fontProperties;this.canvas.width=s((n+2*t.padding)*this.resolution),this.canvas.height=s((o+2*t.padding)*this.resolution),r.scale(this.resolution,this.resolution),r.clearRect(0,0,this.canvas.width,this.canvas.height),r.font=this._font,r.strokeStyle=t.stroke,r.lineWidth=t.strokeThickness,r.textBaseline=t.textBaseline,r.lineJoin=t.lineJoin,r.miterLimit=t.miterLimit;var h,g;if(t.dropShadow){r.fillStyle=t.dropShadowColor,r.globalAlpha=t.dropShadowAlpha,r.shadowBlur=t.dropShadowBlur,0<t.dropShadowBlur&&(r.shadowColor=t.dropShadowColor);for(var f=Math.cos(t.dropShadowAngle)*t.dropShadowDistance,m=Math.sin(t.dropShadowAngle)*t.dropShadowDistance,y=0;y<l.length;y++)h=t.strokeThickness/2,g=t.strokeThickness/2+y*d+c.ascent,'right'===t.align?h+=p-u[y]:'center'===t.align&&(h+=(p-u[y])/2),t.fill&&(this.drawLetterSpacing(l[y],h+f+t.padding,g+m+t.padding),t.stroke&&t.strokeThickness&&(r.strokeStyle=t.dropShadowColor,this.drawLetterSpacing(l[y],h+f+t.padding,g+m+t.padding,!0),r.strokeStyle=t.stroke))}r.shadowBlur=0,r.globalAlpha=1,r.fillStyle=this._generateFillStyle(t,l);for(var i=0;i<l.length;i++)h=t.strokeThickness/2,g=t.strokeThickness/2+i*d+c.ascent,'right'===t.align?h+=p-u[i]:'center'===t.align&&(h+=(p-u[i])/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing(l[i],h+t.padding,g+t.padding,!0),t.fill&&this.drawLetterSpacing(l[i],h+t.padding,g+t.padding);this.updateTexture()}},t.prototype.drawLetterSpacing=function(e,t,r){var a=!!(3<arguments.length&&void 0!==arguments[3])&&arguments[3],n=this._style,o=n.letterSpacing;if(0===o)return void(a?this.context.strokeText(e,t,r):this.context.fillText(e,t,r));for(var i=String.prototype.split.call(e,''),s=t,l=0,d='';l<e.length;)d=i[l++],a?this.context.strokeText(d,s,r):this.context.fillText(d,s,r),s+=this.context.measureText(d).width+o},t.prototype.updateTexture=function(){var e=this.canvas;if(this._style.trim){var t=(0,S.default)(e);e.width=t.width,e.height=t.height,this.context.putImageData(t.data,0,0)}var r=this._texture,a=this._style,n=a.trim?0:a.padding,o=r.baseTexture;o.hasLoaded=!0,o.resolution=this.resolution,o.realWidth=e.width,o.realHeight=e.height,o.width=e.width/this.resolution,o.height=e.height/this.resolution,r.trim.width=r._frame.width=e.width/this.resolution,r.trim.height=r._frame.height=e.height/this.resolution,r.trim.x=-n,r.trim.y=-n,r.orig.width=r._frame.width-2*n,r.orig.height=r._frame.height-2*n,this._onTextureUpdate(),o.emit('update',o),this.dirty=!1},t.prototype.renderWebGL=function(t){this.resolution!==t.resolution&&(this.resolution=t.resolution,this.dirty=!0),this.updateText(!0),e.prototype.renderWebGL.call(this,t)},t.prototype._renderCanvas=function(t){this.resolution!==t.resolution&&(this.resolution=t.resolution,this.dirty=!0),this.updateText(!0),e.prototype._renderCanvas.call(this,t)},t.prototype.getLocalBounds=function(t){return this.updateText(!0),e.prototype.getLocalBounds.call(this,t)},t.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},t.prototype._onStyleChange=function(){this.dirty=!0},t.prototype._generateFillStyle=function(e,t){if(!Array.isArray(e.fill))return e.fill;if(navigator.isCocoonJS)return e.fill[0];var r=this.canvas.width/this.resolution,a=this.canvas.height/this.resolution,n=e.fill.slice(),o=e.fillGradientStops.slice(),s,l,d,u;if(!o.length)for(var p=n.length+1,c=1;c<p;++c)o.push(c/p);if(n.unshift(e.fill[0]),o.unshift(0),n.push(e.fill[e.fill.length-1]),o.push(1),e.fillGradientType===m.TEXT_GRADIENT.LINEAR_VERTICAL){s=this.context.createLinearGradient(r/2,0,r/2,a),l=(n.length+1)*t.length,d=0;for(var i=0;i<t.length;i++){d+=1;for(var h=0;h<n.length;h++)u='number'==typeof o[h]?o[h]/t.length+i/t.length:d/l,s.addColorStop(u,n[h]),d++}}else{s=this.context.createLinearGradient(0,a/2,r,a/2),l=n.length+1,d=1;for(var g=0;g<n.length;g++)u='number'==typeof o[g]?o[g]:d/l,s.addColorStop(u,n[g]),d++}return s},t.prototype.destroy=function(t){'boolean'==typeof t&&(t={children:t}),t=Object.assign({},C,t),e.prototype.destroy.call(this,t),this.context=null,this.canvas=null,this._style=null},d(t,[{key:'width',get:function(){return this.updateText(!0),l(this.scale.x)*this._texture.orig.width},set:function(e){this.updateText(!0);var t=(0,f.sign)(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}},{key:'height',get:function(){return this.updateText(!0),l(this.scale.y)*this._texture.orig.height},set:function(e){this.updateText(!0);var t=(0,f.sign)(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}},{key:'style',get:function(){return this._style},set:function(e){e=e||{},this._style=e instanceof b.default?e:new b.default(e),this.localStyleID=-1,this.dirty=!0}},{key:'text',get:function(){return this._text},set:function(e){e=(''===e||null===e||void 0===e?' ':e)+'',this._text===e||(this._text=e,this.dirty=!0)}}]),t}(p.default);t.default=P},function(e,t){'use strict';t.__esModule=!0,t.default=function(e){var t=e.width,r=e.height,a=e.getContext('2d'),n=a.getImageData(0,0,t,r),o=n.data,s=o.length,l={top:null,left:null,right:null,bottom:null},d,i,u;for(d=0;d<s;d+=4)0!==o[d+3]&&(i=d/4%t,u=~~(d/4/t),null===l.top&&(l.top=u),null===l.left?l.left=i:i<l.left&&(l.left=i),null===l.right?l.right=i+1:l.right<i&&(l.right=i+1),null===l.bottom?l.bottom=u:l.bottom<u&&(l.bottom=u));t=l.right-l.left,r=l.bottom-l.top+1;var p=a.getImageData(l.left,l.top,t,r);return{height:r,width:t,data:p}}},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=Math.sin,d=Math.cos,s=Math.atan2,u=Math.sqrt,p=Math.abs;t.__esModule=!0;var c=r(15),h=a(c),g=r(42),f=a(g),m=r(11),y=a(m),x=r(75),_=a(x),b=r(39),T=a(b),v=r(4),E=r(2),S=r(1),C=r(36),P=a(C),w=r(155),M=a(w),A=r(16),I=a(A),R=new v.Matrix,D=new v.Point,O=new Float32Array(4),k=new Float32Array(4),L=function(e){function t(){var r=!!(0<arguments.length&&void 0!==arguments[0])&&arguments[0];n(this,t);var a=o(this,e.call(this));return a.fillAlpha=1,a.lineWidth=0,a.nativeLines=r,a.lineColor=0,a.graphicsData=[],a.tint=16777215,a._prevTint=16777215,a.blendMode=S.BLEND_MODES.NORMAL,a.currentPath=null,a._webGL={},a.isMask=!1,a.boundsPadding=0,a._localBounds=new P.default,a.dirty=0,a.fastRectDirty=-1,a.clearDirty=0,a.boundsDirty=-1,a.cachedSpriteDirty=!1,a._spriteRect=null,a._fastRect=!1,a}return i(t,e),t.prototype.clone=function(){var e=new t;e.renderable=this.renderable,e.fillAlpha=this.fillAlpha,e.lineWidth=this.lineWidth,e.lineColor=this.lineColor,e.tint=this.tint,e.blendMode=this.blendMode,e.isMask=this.isMask,e.boundsPadding=this.boundsPadding,e.dirty=0,e.cachedSpriteDirty=this.cachedSpriteDirty;for(var r=0;r<this.graphicsData.length;++r)e.graphicsData.push(this.graphicsData[r].clone());return e.currentPath=e.graphicsData[e.graphicsData.length-1],e.updateLocalBounds(),e},t.prototype.lineStyle=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;if(this.lineWidth=e,this.lineColor=t,this.lineAlpha=r,this.currentPath)if(this.currentPath.shape.points.length){var a=new v.Polygon(this.currentPath.shape.points.slice(-2));a.closed=!1,this.drawShape(a)}else this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha;return this},t.prototype.moveTo=function(e,t){var r=new v.Polygon([e,t]);return r.closed=!1,this.drawShape(r),this},t.prototype.lineTo=function(e,t){return this.currentPath.shape.points.push(e,t),this.dirty++,this},t.prototype.quadraticCurveTo=function(e,t,r,a){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var o=20,n=this.currentPath.shape.points,s=0,l=0;0===n.length&&this.moveTo(0,0);for(var d=n[n.length-2],u=n[n.length-1],p=1,i;p<=o;++p)i=p/o,s=d+(e-d)*i,l=u+(t-u)*i,n.push(s+(e+(r-e)*i-s)*i,l+(t+(a-t)*i-l)*i);return this.dirty++,this},t.prototype.bezierCurveTo=function(e,t,r,a,n,o){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var i=this.currentPath.shape.points,s=i[i.length-2],l=i[i.length-1];return i.length-=2,(0,M.default)(s,l,e,t,r,a,n,o,i),this.dirty++,this},t.prototype.arcTo=function(e,t,r,a,n){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(e,t):this.moveTo(e,t);var o=this.currentPath.shape.points,i=o[o.length-2],l=o[o.length-1],d=l-t,c=i-e,h=a-t,g=r-e,f=p(d*g-c*h);if(1e-8>f||0===n)(o[o.length-2]!==e||o[o.length-1]!==t)&&o.push(e,t);else{var m=d*d+c*c,y=h*h+g*g,x=d*h+c*g,_=n*u(m)/f,b=n*u(y)/f,T=_*x/m,v=b*x/y,E=_*g+b*c,S=_*h+b*d,C=s(d*(b+T)-S,c*(b+T)-E),P=s(h*(_+v)-S,g*(_+v)-E);this.arc(E+e,S+t,n,C,P,c*h>g*d)}return this.dirty++,this},t.prototype.arc=function(e,t,r,a,n){var o=!!(5<arguments.length&&void 0!==arguments[5])&&arguments[5];if(a===n)return this;!o&&n<=a?n+=S.PI_2:o&&a<=n&&(a+=S.PI_2);var u=n-a,h=40*Math.ceil(p(u)/S.PI_2);if(0==u)return this;var g=e+d(a)*r,f=t+l(a)*r,m=this.currentPath?this.currentPath.shape.points:null;m?(m[m.length-2]!==g||m[m.length-1]!==f)&&m.push(g,f):(this.moveTo(g,f),m=this.currentPath.shape.points);for(var y=u/(2*h),x=d(y),_=l(y),b=h-1,T=0;T<=b;++T){var i=T+b%1/b*T,v=y+a+2*y*i,E=d(v),c=-l(v);m.push((x*E+_*c)*r+e,(x*-c+_*E)*r+t)}return this.dirty++,this},t.prototype.beginFill=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return this.filling=!0,this.fillColor=e,this.fillAlpha=t,this.currentPath&&2>=this.currentPath.shape.points.length&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha),this},t.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},t.prototype.drawRect=function(e,t,r,a){return this.drawShape(new v.Rectangle(e,t,r,a)),this},t.prototype.drawRoundedRect=function(e,t,r,a,n){return this.drawShape(new v.RoundedRectangle(e,t,r,a,n)),this},t.prototype.drawCircle=function(e,t,r){return this.drawShape(new v.Circle(e,t,r)),this},t.prototype.drawEllipse=function(e,t,r,a){return this.drawShape(new v.Ellipse(e,t,r,a)),this},t.prototype.drawPolygon=function(e){var t=e,r=!0;if(t instanceof v.Polygon&&(r=t.closed,t=t.points),!Array.isArray(t)){t=Array(arguments.length);for(var a=0;a<t.length;++a)t[a]=arguments[a]}var n=new v.Polygon(t);return n.closed=r,this.drawShape(n),this},t.prototype.drawStar=function(e,t,a,n,o){var s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0;o=o||n/2;for(var u=-1*Math.PI/2+s,p=2*a,c=S.PI_2/p,h=[],g=0;g<p;g++){var i=g%2?o:n,r=g*c+u;h.push(e+i*d(r),t+i*l(r))}return this.drawPolygon(h)},t.prototype.clear=function(){return(this.lineWidth||this.filling||0<this.graphicsData.length)&&(this.lineWidth=0,this.filling=!1,this.boundsDirty=-1,this.dirty++,this.clearDirty++,this.graphicsData.length=0),this.currentPath=null,this._spriteRect=null,this},t.prototype.isFastRect=function(){return 1===this.graphicsData.length&&this.graphicsData[0].shape.type===S.SHAPES.RECT&&!this.graphicsData[0].lineWidth},t.prototype._renderWebGL=function(e){this.dirty!==this.fastRectDirty&&(this.fastRectDirty=this.dirty,this._fastRect=this.isFastRect()),this._fastRect?this._renderSpriteRect(e):(e.setObjectRenderer(e.plugins.graphics),e.plugins.graphics.render(this))},t.prototype._renderSpriteRect=function(e){var t=this.graphicsData[0].shape;this._spriteRect||(this._spriteRect=new T.default(new y.default(y.default.WHITE)));var r=this._spriteRect;if(16777215===this.tint)r.tint=this.graphicsData[0].fillColor;else{var a=O,n=k;(0,E.hex2rgb)(this.graphicsData[0].fillColor,a),(0,E.hex2rgb)(this.tint,n),a[0]*=n[0],a[1]*=n[1],a[2]*=n[2],r.tint=(0,E.rgb2hex)(a)}r.alpha=this.graphicsData[0].fillAlpha,r.worldAlpha=this.worldAlpha*r.alpha,r.blendMode=this.blendMode,r._texture._frame.width=t.width,r._texture._frame.height=t.height,r.transform.worldTransform=this.transform.worldTransform,r.anchor.set(-t.x/t.width,-t.y/t.height),r._onAnchorUpdate(),r._renderWebGL(e)},t.prototype._renderCanvas=function(e){!0===this.isMask||e.plugins.graphics.render(this)},t.prototype._calculateBounds=function(){this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.updateLocalBounds(),this.cachedSpriteDirty=!0);var e=this._localBounds;this._bounds.addFrame(this.transform,e.minX,e.minY,e.maxX,e.maxY)},t.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,D);for(var t=this.graphicsData,r=0,a;r<t.length;++r)if((a=t[r],!!a.fill)&&a.shape&&a.shape.contains(D.x,D.y)){if(a.holes)for(var n=0,o;n<a.holes.length;n++)if(o=a.holes[n],o.contains(D.x,D.y))return!1;return!0}return!1},t.prototype.updateLocalBounds=function(){var e=Infinity,t=-Infinity,r=Infinity,a=-Infinity;if(this.graphicsData.length)for(var n=0,o=0,s=0,l=0,d=0,c=0;c<this.graphicsData.length;c++){var i=this.graphicsData[c],h=i.type,g=i.lineWidth;if(n=i.shape,h===S.SHAPES.RECT||h===S.SHAPES.RREC)o=n.x-g/2,s=n.y-g/2,l=n.width+g,d=n.height+g,e=o<e?o:e,t=o+l>t?o+l:t,r=s<r?s:r,a=s+d>a?s+d:a;else if(h===S.SHAPES.CIRC)o=n.x,s=n.y,l=n.radius+g/2,d=n.radius+g/2,e=o-l<e?o-l:e,t=o+l>t?o+l:t,r=s-d<r?s-d:r,a=s+d>a?s+d:a;else if(h===S.SHAPES.ELIP)o=n.x,s=n.y,l=n.width+g/2,d=n.height+g/2,e=o-l<e?o-l:e,t=o+l>t?o+l:t,r=s-d<r?s-d:r,a=s+d>a?s+d:a;else for(var f=n.points,m=0,y=0,x=0,_=0,b=0,T=0,v=0,E=0,C=0;C+2<f.length;C+=2)(o=f[C],s=f[C+1],m=f[C+2],y=f[C+3],x=p(m-o),_=p(y-s),d=g,l=u(x*x+_*_),!(1e-9>l))&&(b=(d/l*_+x)/2,T=(d/l*x+_)/2,v=(m+o)/2,E=(y+s)/2,e=v-b<e?v-b:e,t=v+b>t?v+b:t,r=E-T<r?E-T:r,a=E+T>a?E+T:a)}else e=0,t=0,r=0,a=0;var P=this.boundsPadding;this._localBounds.minX=e-P,this._localBounds.maxX=t+P,this._localBounds.minY=r-P,this._localBounds.maxY=a+P},t.prototype.drawShape=function(e){this.currentPath&&2>=this.currentPath.shape.points.length&&this.graphicsData.pop(),this.currentPath=null;var t=new _.default(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,this.nativeLines,e);return this.graphicsData.push(t),t.type===S.SHAPES.POLY&&(t.shape.closed=t.shape.closed||this.filling,this.currentPath=t),this.dirty++,t},t.prototype.generateCanvasTexture=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,r=this.getLocalBounds(),a=f.default.create(r.width,r.height,e,t);N||(N=new I.default),this.transform.updateLocalTransform(),this.transform.localTransform.copy(R),R.invert(),R.tx-=r.x,R.ty-=r.y,N.render(this,a,!0,R);var n=y.default.fromCanvas(a.baseTexture._canvasRenderTarget.canvas,e,'graphics');return n.baseTexture.resolution=t,n.baseTexture.update(),n},t.prototype.closePath=function(){var e=this.currentPath;return e&&e.shape&&e.shape.close(),this},t.prototype.addHole=function(){var e=this.graphicsData.pop();return this.currentPath=this.graphicsData[this.graphicsData.length-1],this.currentPath.addHole(e.shape),this.currentPath=null,this},t.prototype.destroy=function(t){e.prototype.destroy.call(this,t);for(var r=0;r<this.graphicsData.length;++r)this.graphicsData[r].destroy();for(var a in this._webgl)for(var n=0;n<this._webgl[a].data.length;++n)this._webgl[a].data[n].destroy();this._spriteRect&&this._spriteRect.destroy(),this.graphicsData=null,this.currentPath=null,this._webgl=null,this._localBounds=null},t}(h.default),N;t.default=L,L._SPRITE_TEXTURE=null},function(e,t){'use strict';t.__esModule=!0,t.default=function(e,t,r,a,o,s,l,d){var u=8<arguments.length&&arguments[8]!==void 0?arguments[8]:[],p=20,n=0,c=0,h=0,g=0,f=0;u.push(e,t);for(var m=1,i=0;m<=p;++m)i=m/p,n=1-i,c=n*n,h=c*n,g=i*i,f=g*i,u.push(h*e+3*c*i*r+3*n*g*o+f*l,h*t+3*c*i*a+3*n*g*s+f*d);return u}},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=r(2),l=r(1),d=r(25),u=a(d),p=r(26),c=a(p),h=r(157),g=a(h),f=r(158),m=a(f),y=r(159),x=a(y),_=r(160),b=a(_),T=r(161),v=a(T),E=r(162),S=a(E),C=function(e){function t(r){n(this,t);var a=o(this,e.call(this,r));return a.graphicsDataPool=[],a.primitiveShader=null,a.gl=r.gl,a.CONTEXT_UID=0,a}return i(t,e),t.prototype.onContextChange=function(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.primitiveShader=new m.default(this.gl)},t.prototype.destroy=function(){u.default.prototype.destroy.call(this);for(var e=0;e<this.graphicsDataPool.length;++e)this.graphicsDataPool[e].destroy();this.graphicsDataPool=null},t.prototype.render=function(e){var t=this.renderer,r=t.gl,a=e._webGL[this.CONTEXT_UID],o;a&&e.dirty===a.dirty||(this.updateGraphics(e),a=e._webGL[this.CONTEXT_UID]);var l=this.primitiveShader;t.bindShader(l),t.state.setBlendMode(e.blendMode);for(var d=0,i=a.data.length;d<i;d++){o=a.data[d];var n=o.shader;t.bindShader(n),n.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),n.uniforms.tint=(0,s.hex2rgb)(e.tint),n.uniforms.alpha=e.worldAlpha,t.bindVao(o.vao),o.nativeLines?r.drawArrays(r.LINES,0,o.points.length/6):o.vao.draw(r.TRIANGLE_STRIP,o.indices.length)}},t.prototype.updateGraphics=function(e){var t=this.renderer.gl,r=e._webGL[this.CONTEXT_UID];if(r||(r=e._webGL[this.CONTEXT_UID]={lastIndex:0,data:[],gl:t,clearDirty:-1,dirty:-1}),r.dirty=e.dirty,e.clearDirty!==r.clearDirty){r.clearDirty=e.clearDirty;for(var a=0;a<r.data.length;a++)this.graphicsDataPool.push(r.data[a]);r.data.length=0,r.lastIndex=0}for(var n=void 0,o=void 0,i=r.lastIndex,s;i<e.graphicsData.length;i++)s=e.graphicsData[i],n=this.getWebGLData(r,0),s.nativeLines&&s.lineWidth&&(o=this.getWebGLData(r,0,!0),r.lastIndex++),s.type===l.SHAPES.POLY&&(0,x.default)(s,n,o),s.type===l.SHAPES.RECT?(0,b.default)(s,n,o):s.type===l.SHAPES.CIRC||s.type===l.SHAPES.ELIP?(0,S.default)(s,n,o):s.type===l.SHAPES.RREC&&(0,v.default)(s,n,o),r.lastIndex++;this.renderer.bindVao(null);for(var d=0;d<r.data.length;d++)n=r.data[d],n.dirty&&n.upload()},t.prototype.getWebGLData=function(e,t,r){var a=e.data[e.data.length-1];return(!a||a.nativeLines!==r||32e4<a.points.length)&&(a=this.graphicsDataPool.pop()||new g.default(this.renderer.gl,this.primitiveShader,this.renderer.state.attribsState),a.nativeLines=r,a.reset(t),e.data.push(a)),a.dirty=!0,a},t}(u.default);t.default=C,c.default.registerPlugin('graphics',C)},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var n=r(7),o=function(e){return e&&e.__esModule?e:{default:e}}(n),i=function(){function e(t,r,n){a(this,e),this.gl=t,this.color=[0,0,0],this.points=[],this.indices=[],this.buffer=o.default.GLBuffer.createVertexBuffer(t),this.indexBuffer=o.default.GLBuffer.createIndexBuffer(t),this.dirty=!0,this.nativeLines=!1,this.glPoints=null,this.glIndices=null,this.shader=r,this.vao=new o.default.VertexArrayObject(t,n).addIndex(this.indexBuffer).addAttribute(this.buffer,r.attributes.aVertexPosition,t.FLOAT,!1,24,0).addAttribute(this.buffer,r.attributes.aColor,t.FLOAT,!1,24,8)}return e.prototype.reset=function(){this.points.length=0,this.indices.length=0},e.prototype.upload=function(){this.glPoints=new Float32Array(this.points),this.buffer.upload(this.glPoints),this.glIndices=new Uint16Array(this.indices),this.indexBuffer.upload(this.glIndices),this.dirty=!1},e.prototype.destroy=function(){this.color=null,this.points=null,this.indices=null,this.vao.destroy(),this.buffer.destroy(),this.indexBuffer.destroy(),this.gl=null,this.buffer=null,this.indexBuffer=null,this.glPoints=null,this.glIndices=null},e}();t.default=i},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function n(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function o(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var i=r(18),s=function(e){return e&&e.__esModule?e:{default:e}}(i),l=function(e){function t(r){return a(this,t),n(this,e.call(this,r,'attribute vec2 aVertexPosition;\nattribute vec4 aColor;\nuniform mat3 translationMatrix;\nuniform mat3 projectionMatrix;\nuniform float alpha;\nuniform vec3 tint;\nvarying vec4 vColor;\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vColor = aColor * vec4(tint * alpha, alpha);\n}','varying vec4 vColor;\nvoid main(void){\n   gl_FragColor = vColor;\n}'))}return o(t,e),t}(s.default);t.default=l},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0,t.default=function(e,t,a){e.points=e.shape.points.slice();var n=e.points;if(e.fill&&6<=n.length){for(var d=[],u=e.holes,p=0,i;p<u.length;p++)i=u[p],d.push(n.length/2),n=n.concat(i.points);var c=t.points,h=t.indices,f=n.length/2,m=(0,s.hex2rgb)(e.fillColor),y=e.fillAlpha,x=m[0]*y,r=m[1]*y,g=m[2]*y,_=(0,l.default)(n,d,2);if(!_)return;for(var b=c.length/6,T=0;T<_.length;T+=3)h.push(_[T]+b),h.push(_[T]+b),h.push(_[T+1]+b),h.push(_[T+2]+b),h.push(_[T+2]+b);for(var v=0;v<f;v++)c.push(n[2*v],n[2*v+1],x,r,g,y)}0<e.lineWidth&&(0,o.default)(e,t,a)};var n=r(28),o=a(n),s=r(2),i=r(76),l=a(i)},function(e,t,r){'use strict';t.__esModule=!0,t.default=function(e,t,a){var i=e.shape,s=i.x,l=i.y,d=i.width,u=i.height;if(e.fill){var p=(0,o.hex2rgb)(e.fillColor),c=e.fillAlpha,h=p[0]*c,r=p[1]*c,g=p[2]*c,f=t.points,m=t.indices,y=f.length/6;f.push(s,l),f.push(h,r,g,c),f.push(s+d,l),f.push(h,r,g,c),f.push(s,l+u),f.push(h,r,g,c),f.push(s+d,l+u),f.push(h,r,g,c),m.push(y,y,y+1,y+2,y+3,y+3)}if(e.lineWidth){var x=e.points;e.points=[s,l,s+d,l,s+d,l+u,s,l+u,s,l],(0,n.default)(e,t,a),e.points=x}};var a=r(28),n=function(e){return e&&e.__esModule?e:{default:e}}(a),o=r(2)},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t,r){return e+(t-e)*r}function n(e,t,r,a,s,l){for(var d=6<arguments.length&&arguments[6]!==void 0?arguments[6]:[],u=20,n=d,p=0,c=0,h=0,g=0,f=0,m=0,y=0,i=0;y<=u;++y)i=y/u,p=o(e,r,i),c=o(t,a,i),h=o(r,s,i),g=o(a,l,i),f=o(p,h,i),m=o(c,g,i),n.push(f,m);return n}t.__esModule=!0,t.default=function(e,t,a){var o=e.shape,l=o.x,p=o.y,c=o.width,h=o.height,f=o.radius,m=[];if(m.push(l,p+f),n(l,p+h-f,l,p+h,l+f,p+h,m),n(l+c-f,p+h,l+c,p+h,l+c,p+h-f,m),n(l+c,p+f,l+c,p,l+c-f,p,m),n(l+f,p,l,p,l,p+f+1e-10,m),e.fill){for(var y=(0,u.hex2rgb)(e.fillColor),x=e.fillAlpha,_=y[0]*x,r=y[1]*x,g=y[2]*x,b=t.points,T=t.indices,v=b.length/6,E=(0,s.default)(m,null,2),S=0,i=E.length;S<i;S+=3)T.push(E[S]+v),T.push(E[S]+v),T.push(E[S+1]+v),T.push(E[S+2]+v),T.push(E[S+2]+v);for(var C=0,P=m.length;C<P;C++)b.push(m[C],m[++C],_,r,g,x)}if(e.lineWidth){var w=e.points;e.points=m,(0,d.default)(e,t,a),e.points=w}};var i=r(76),s=a(i),l=r(28),d=a(l),u=r(2)},function(e,t,r){'use strict';var a=Math.floor,n=Math.sin,o=Math.cos,s=Math.sqrt;t.__esModule=!0,t.default=function(e,t,p){var c=e.shape,h=c.x,f=c.y,m,y;if(e.type===d.SHAPES.CIRC?(m=c.radius,y=c.radius):(m=c.width,y=c.height),0!==m&&0!==y){var x=a(30*s(c.radius))||a(15*s(c.width+c.height)),_=2*Math.PI/x;if(e.fill){var T=(0,u.hex2rgb)(e.fillColor),v=e.fillAlpha,E=T[0]*v,r=T[1]*v,g=T[2]*v,b=t.points,S=t.indices,C=b.length/6;S.push(C);for(var P=0;P<x+1;P++)b.push(h,f,E,r,g,v),b.push(h+n(_*P)*m,f+o(_*P)*y,E,r,g,v),S.push(C++,C++);S.push(C-1)}if(e.lineWidth){var i=e.points;e.points=[];for(var w=0;w<x+1;w++)e.points.push(h+n(_*w)*m,f+o(_*w)*y);(0,l.default)(e,t,p),e.points=i}}};var i=r(28),l=function(e){return e&&e.__esModule?e:{default:e}}(i),d=r(1),u=r(2)},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var n=r(16),o=function(e){return e&&e.__esModule?e:{default:e}}(n),s=r(1),i=function(){function e(t){a(this,e),this.renderer=t}return e.prototype.render=function(e){var t=this.renderer,r=t.context,a=e.worldAlpha,n=e.transform.worldTransform,o=t.resolution;this._prevTint!==this.tint&&(this.dirty=!0),r.setTransform(n.a*o,n.b*o,n.c*o,n.d*o,n.tx*o,n.ty*o),e.dirty&&(this.updateGraphicsTint(e),e.dirty=!1),t.setBlendMode(e.blendMode);for(var l=0;l<e.graphicsData.length;l++){var i=e.graphicsData[l],d=i.shape,u=i._fillTint,p=i._lineTint;if(r.lineWidth=i.lineWidth,i.type===s.SHAPES.POLY){r.beginPath(),this.renderPolygon(d.points,d.closed,r);for(var c=0;c<i.holes.length;c++)this.renderPolygon(i.holes[c].points,!0,r);i.fill&&(r.globalAlpha=i.fillAlpha*a,r.fillStyle='#'+('00000'+(0|u).toString(16)).substr(-6),r.fill()),i.lineWidth&&(r.globalAlpha=i.lineAlpha*a,r.strokeStyle='#'+('00000'+(0|p).toString(16)).substr(-6),r.stroke())}else if(i.type===s.SHAPES.RECT)(i.fillColor||0===i.fillColor)&&(r.globalAlpha=i.fillAlpha*a,r.fillStyle='#'+('00000'+(0|u).toString(16)).substr(-6),r.fillRect(d.x,d.y,d.width,d.height)),i.lineWidth&&(r.globalAlpha=i.lineAlpha*a,r.strokeStyle='#'+('00000'+(0|p).toString(16)).substr(-6),r.strokeRect(d.x,d.y,d.width,d.height));else if(i.type===s.SHAPES.CIRC)r.beginPath(),r.arc(d.x,d.y,d.radius,0,2*Math.PI),r.closePath(),i.fill&&(r.globalAlpha=i.fillAlpha*a,r.fillStyle='#'+('00000'+(0|u).toString(16)).substr(-6),r.fill()),i.lineWidth&&(r.globalAlpha=i.lineAlpha*a,r.strokeStyle='#'+('00000'+(0|p).toString(16)).substr(-6),r.stroke());else if(i.type===s.SHAPES.ELIP){var g=2*d.width,f=2*d.height,h=d.x-g/2,m=d.y-f/2;r.beginPath();var y=.5522848,x=g/2*y,_=f/2*y,b=h+g,T=m+f,v=h+g/2,E=m+f/2;r.moveTo(h,E),r.bezierCurveTo(h,E-_,v-x,m,v,m),r.bezierCurveTo(v+x,m,b,E-_,b,E),r.bezierCurveTo(b,E+_,v+x,T,v,T),r.bezierCurveTo(v-x,T,h,E+_,h,E),r.closePath(),i.fill&&(r.globalAlpha=i.fillAlpha*a,r.fillStyle='#'+('00000'+(0|u).toString(16)).substr(-6),r.fill()),i.lineWidth&&(r.globalAlpha=i.lineAlpha*a,r.strokeStyle='#'+('00000'+(0|p).toString(16)).substr(-6),r.stroke())}else if(i.type===s.SHAPES.RREC){var S=d.x,C=d.y,P=d.width,w=d.height,M=d.radius,A=0|Math.min(P,w)/2;M=M>A?A:M,r.beginPath(),r.moveTo(S,C+M),r.lineTo(S,C+w-M),r.quadraticCurveTo(S,C+w,S+M,C+w),r.lineTo(S+P-M,C+w),r.quadraticCurveTo(S+P,C+w,S+P,C+w-M),r.lineTo(S+P,C+M),r.quadraticCurveTo(S+P,C,S+P-M,C),r.lineTo(S+M,C),r.quadraticCurveTo(S,C,S,C+M),r.closePath(),(i.fillColor||0===i.fillColor)&&(r.globalAlpha=i.fillAlpha*a,r.fillStyle='#'+('00000'+(0|u).toString(16)).substr(-6),r.fill()),i.lineWidth&&(r.globalAlpha=i.lineAlpha*a,r.strokeStyle='#'+('00000'+(0|p).toString(16)).substr(-6),r.stroke())}}},e.prototype.updateGraphicsTint=function(e){e._prevTint=e.tint;for(var t=(255&e.tint>>16)/255,r=(255&e.tint>>8)/255,a=(255&e.tint)/255,n=0;n<e.graphicsData.length;++n){var o=e.graphicsData[n],i=0|o.fillColor,s=0|o.lineColor;o._fillTint=(255*((255&i>>16)/255*t)<<16)+(255*((255&i>>8)/255*r)<<8)+255*((255&i)/255*a),o._lineTint=(255*((255&s>>16)/255*t)<<16)+(255*((255&s>>8)/255*r)<<8)+255*((255&s)/255*a)}},e.prototype.renderPolygon=function(e,t,r){r.moveTo(e[0],e[1]);for(var a=1;a<e.length/2;++a)r.lineTo(e[2*a],e[2*a+1]);t&&r.closePath()},e.prototype.destroy=function(){this.renderer=null},e}();t.default=i,o.default.registerPlugin('graphics',i)},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var n=Math.floor;t.__esModule=!0;var o=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),s=r(0),i=r(2),l=function(){function e(t,r){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;a(this,e),this.baseTexture=t,this.textures={},this.data=r,this.resolution=this._updateResolution(n||this.baseTexture.imageUrl),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return o(e,null,[{key:'BATCH_SIZE',get:function(){return 1e3}}]),e.prototype._updateResolution=function(e){var t=this.data.meta.scale,r=(0,i.getResolutionOfUrl)(e,null);return null===r&&(r=void 0===t?1:parseFloat(t)),1!==r&&(this.baseTexture.resolution=r,this.baseTexture.update()),r},e.prototype.parse=function(t){this._batchIndex=0,this._callback=t,this._frameKeys.length<=e.BATCH_SIZE?(this._processFrames(0),this._parseComplete()):this._nextBatch()},e.prototype._processFrames=function(t){for(var r=t,a=e.BATCH_SIZE,o=this.baseTexture.sourceScale;r-t<a&&r<this._frameKeys.length;){var l=this._frameKeys[r],i=this._frames[l],d=i.frame;if(d){var u=null,p=null,c=!1!==i.trimmed&&i.sourceSize?i.sourceSize:i.frame,h=new s.Rectangle(0,0,n(c.w*o)/this.resolution,n(c.h*o)/this.resolution);u=i.rotated?new s.Rectangle(n(d.x*o)/this.resolution,n(d.y*o)/this.resolution,n(d.h*o)/this.resolution,n(d.w*o)/this.resolution):new s.Rectangle(n(d.x*o)/this.resolution,n(d.y*o)/this.resolution,n(d.w*o)/this.resolution,n(d.h*o)/this.resolution),!1!==i.trimmed&&i.spriteSourceSize&&(p=new s.Rectangle(n(i.spriteSourceSize.x*o)/this.resolution,n(i.spriteSourceSize.y*o)/this.resolution,n(d.w*o)/this.resolution,n(d.h*o)/this.resolution)),this.textures[l]=new s.Texture(this.baseTexture,u,h,p,i.rotated?2:0),s.Texture.addToCache(this.textures[l],l)}r++}},e.prototype._parseComplete=function(){var e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)},e.prototype._nextBatch=function(){var t=this;this._processFrames(this._batchIndex*e.BATCH_SIZE),this._batchIndex++,setTimeout(function(){t._batchIndex*e.BATCH_SIZE<t._frameKeys.length?t._nextBatch():t._parseComplete()},0)},e.prototype.destroy=function(){var e=!!(0<arguments.length&&void 0!==arguments[0])&&arguments[0];for(var t in this.textures)this.textures[t].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&this.baseTexture.destroy(),this.baseTexture=null},e}();t.default=l},function(e,t){'use strict';function r(e){var t=new Error().stack;'undefined'==typeof t?console.warn('Deprecation Warning: ',e):(t=t.split('\n').splice(3).join('\n'),console.groupCollapsed?(console.groupCollapsed('%cDeprecation Warning: %c%s','color:#614108;background:#fffbe6','font-weight:normal;color:#614108;background:#fffbe6',e),console.warn(t),console.groupEnd()):(console.warn('Deprecation Warning: ',e),console.warn(t)))}t.__esModule=!0,t.default=function(e){var t=e.mesh,a=e.particles,n=e.extras,o=e.filters,s=e.prepare,l=e.loaders,d=e.interaction;Object.defineProperties(e,{SpriteBatch:{get:function(){throw new ReferenceError('SpriteBatch does not exist any more, please use the new ParticleContainer instead.')}},AssetLoader:{get:function(){throw new ReferenceError('The loader system was overhauled in PixiJS v3, please see the new PIXI.loaders.Loader class.')}},Stage:{get:function(){return r('You do not need to use a PIXI Stage any more, you can simply render any container.'),e.Container}},DisplayObjectContainer:{get:function(){return r('DisplayObjectContainer has been shortened to Container, please use Container from now on.'),e.Container}},Strip:{get:function(){return r('The Strip class has been renamed to Mesh and moved to mesh.Mesh, please use mesh.Mesh from now on.'),t.Mesh}},Rope:{get:function(){return r('The Rope class has been moved to mesh.Rope, please use mesh.Rope from now on.'),t.Rope}},ParticleContainer:{get:function(){return r('The ParticleContainer class has been moved to particles.ParticleContainer, please use particles.ParticleContainer from now on.'),a.ParticleContainer}},MovieClip:{get:function(){return r('The MovieClip class has been moved to extras.AnimatedSprite, please use extras.AnimatedSprite.'),n.AnimatedSprite}},TilingSprite:{get:function(){return r('The TilingSprite class has been moved to extras.TilingSprite, please use extras.TilingSprite from now on.'),n.TilingSprite}},BitmapText:{get:function(){return r('The BitmapText class has been moved to extras.BitmapText, please use extras.BitmapText from now on.'),n.BitmapText}},blendModes:{get:function(){return r('The blendModes has been moved to BLEND_MODES, please use BLEND_MODES from now on.'),e.BLEND_MODES}},scaleModes:{get:function(){return r('The scaleModes has been moved to SCALE_MODES, please use SCALE_MODES from now on.'),e.SCALE_MODES}},BaseTextureCache:{get:function(){return r('The BaseTextureCache class has been moved to utils.BaseTextureCache, please use utils.BaseTextureCache from now on.'),e.utils.BaseTextureCache}},TextureCache:{get:function(){return r('The TextureCache class has been moved to utils.TextureCache, please use utils.TextureCache from now on.'),e.utils.TextureCache}},math:{get:function(){return r('The math namespace is deprecated, please access members already accessible on PIXI.'),e}},AbstractFilter:{get:function(){return r('AstractFilter has been renamed to Filter, please use PIXI.Filter'),e.Filter}},TransformManual:{get:function(){return r('TransformManual has been renamed to TransformBase, please update your pixi-spine'),e.TransformBase}},TARGET_FPMS:{get:function(){return r('PIXI.TARGET_FPMS has been deprecated, please use PIXI.settings.TARGET_FPMS'),e.settings.TARGET_FPMS},set:function(t){r('PIXI.TARGET_FPMS has been deprecated, please use PIXI.settings.TARGET_FPMS'),e.settings.TARGET_FPMS=t}},FILTER_RESOLUTION:{get:function(){return r('PIXI.FILTER_RESOLUTION has been deprecated, please use PIXI.settings.FILTER_RESOLUTION'),e.settings.FILTER_RESOLUTION},set:function(t){r('PIXI.FILTER_RESOLUTION has been deprecated, please use PIXI.settings.FILTER_RESOLUTION'),e.settings.FILTER_RESOLUTION=t}},RESOLUTION:{get:function(){return r('PIXI.RESOLUTION has been deprecated, please use PIXI.settings.RESOLUTION'),e.settings.RESOLUTION},set:function(t){r('PIXI.RESOLUTION has been deprecated, please use PIXI.settings.RESOLUTION'),e.settings.RESOLUTION=t}},MIPMAP_TEXTURES:{get:function(){return r('PIXI.MIPMAP_TEXTURES has been deprecated, please use PIXI.settings.MIPMAP_TEXTURES'),e.settings.MIPMAP_TEXTURES},set:function(t){r('PIXI.MIPMAP_TEXTURES has been deprecated, please use PIXI.settings.MIPMAP_TEXTURES'),e.settings.MIPMAP_TEXTURES=t}},SPRITE_BATCH_SIZE:{get:function(){return r('PIXI.SPRITE_BATCH_SIZE has been deprecated, please use PIXI.settings.SPRITE_BATCH_SIZE'),e.settings.SPRITE_BATCH_SIZE},set:function(t){r('PIXI.SPRITE_BATCH_SIZE has been deprecated, please use PIXI.settings.SPRITE_BATCH_SIZE'),e.settings.SPRITE_BATCH_SIZE=t}},SPRITE_MAX_TEXTURES:{get:function(){return r('PIXI.SPRITE_MAX_TEXTURES has been deprecated, please use PIXI.settings.SPRITE_MAX_TEXTURES'),e.settings.SPRITE_MAX_TEXTURES},set:function(t){r('PIXI.SPRITE_MAX_TEXTURES has been deprecated, please use PIXI.settings.SPRITE_MAX_TEXTURES'),e.settings.SPRITE_MAX_TEXTURES=t}},RETINA_PREFIX:{get:function(){return r('PIXI.RETINA_PREFIX has been deprecated, please use PIXI.settings.RETINA_PREFIX'),e.settings.RETINA_PREFIX},set:function(t){r('PIXI.RETINA_PREFIX has been deprecated, please use PIXI.settings.RETINA_PREFIX'),e.settings.RETINA_PREFIX=t}},DEFAULT_RENDER_OPTIONS:{get:function(){return r('PIXI.DEFAULT_RENDER_OPTIONS has been deprecated, please use PIXI.settings.DEFAULT_RENDER_OPTIONS'),e.settings.RENDER_OPTIONS}}});for(var u=[{parent:'TRANSFORM_MODE',target:'TRANSFORM_MODE'},{parent:'GC_MODES',target:'GC_MODE'},{parent:'WRAP_MODES',target:'WRAP_MODE'},{parent:'SCALE_MODES',target:'SCALE_MODE'},{parent:'PRECISION',target:'PRECISION_FRAGMENT'}],p=function(t){var a=u[t];Object.defineProperty(e[a.parent],'DEFAULT',{get:function(){return r('PIXI.'+a.parent+'.DEFAULT has been deprecated, '+('please use PIXI.settings.'+a.target)),e.settings[a.target]},set:function(t){r('PIXI.'+a.parent+'.DEFAULT has been deprecated, '+('please use PIXI.settings.'+a.target)),e.settings[a.target]=t}})},c=0;c<u.length;c++)p(c);Object.defineProperties(e.settings,{PRECISION:{get:function(){return r('PIXI.settings.PRECISION has been deprecated, please use PIXI.settings.PRECISION_FRAGMENT'),e.settings.PRECISION_FRAGMENT},set:function(t){r('PIXI.settings.PRECISION has been deprecated, please use PIXI.settings.PRECISION_FRAGMENT'),e.settings.PRECISION_FRAGMENT=t}}}),n.AnimatedSprite&&Object.defineProperties(n,{MovieClip:{get:function(){return r('The MovieClip class has been renamed to AnimatedSprite, please use AnimatedSprite from now on.'),n.AnimatedSprite}}}),n&&Object.defineProperties(n,{TextureTransform:{get:function(){return r('The TextureTransform class has been renamed to TextureMatrix, please use PIXI.TextureMatrix from now on.'),e.TextureMatrix}}}),e.DisplayObject.prototype.generateTexture=function(e,t,a){return r('generateTexture has moved to the renderer, please use renderer.generateTexture(displayObject)'),e.generateTexture(this,t,a)},e.Graphics.prototype.generateTexture=function(e,t){return r('graphics generate texture has moved to the renderer. Or to render a graphics to a texture using canvas please use generateCanvasTexture'),this.generateCanvasTexture(e,t)},e.GroupD8.isSwapWidthHeight=function(t){return r('GroupD8.isSwapWidthHeight was renamed to GroupD8.isVertical'),e.GroupD8.isVertical(t)},e.RenderTexture.prototype.render=function(e,t,a,n){this.legacyRenderer.render(e,this,a,t,!n),r('RenderTexture.render is now deprecated, please use renderer.render(displayObject, renderTexture)')},e.RenderTexture.prototype.getImage=function(e){return r('RenderTexture.getImage is now deprecated, please use renderer.extract.image(target)'),this.legacyRenderer.extract.image(e)},e.RenderTexture.prototype.getBase64=function(e){return r('RenderTexture.getBase64 is now deprecated, please use renderer.extract.base64(target)'),this.legacyRenderer.extract.base64(e)},e.RenderTexture.prototype.getCanvas=function(e){return r('RenderTexture.getCanvas is now deprecated, please use renderer.extract.canvas(target)'),this.legacyRenderer.extract.canvas(e)},e.RenderTexture.prototype.getPixels=function(e){return r('RenderTexture.getPixels is now deprecated, please use renderer.extract.pixels(target)'),this.legacyRenderer.pixels(e)},e.Sprite.prototype.setTexture=function(e){this.texture=e,r('setTexture is now deprecated, please use the texture property, e.g : sprite.texture = texture;')},n.BitmapText&&(n.BitmapText.prototype.setText=function(e){this.text=e,r('setText is now deprecated, please use the text property, e.g : myBitmapText.text = \'my text\';')}),e.Text.prototype.setText=function(e){this.text=e,r('setText is now deprecated, please use the text property, e.g : myText.text = \'my text\';')},e.Text.calculateFontProperties=function(t){return r('Text.calculateFontProperties is now deprecated, please use the TextMetrics.measureFont'),e.TextMetrics.measureFont(t)},Object.defineProperties(e.Text,{fontPropertiesCache:{get:function(){return r('Text.fontPropertiesCache is deprecated'),e.TextMetrics._fonts}},fontPropertiesCanvas:{get:function(){return r('Text.fontPropertiesCanvas is deprecated'),e.TextMetrics._canvas}},fontPropertiesContext:{get:function(){return r('Text.fontPropertiesContext is deprecated'),e.TextMetrics._context}}}),e.Text.prototype.setStyle=function(e){this.style=e,r('setStyle is now deprecated, please use the style property, e.g : myText.style = style;')},e.Text.prototype.determineFontProperties=function(t){return r('determineFontProperties is now deprecated, please use TextMetrics.measureFont method'),e.TextMetrics.measureFont(t)},e.Text.getFontStyle=function(t){return r('getFontStyle is now deprecated, please use TextStyle.toFontString() instead'),t=t||{},t instanceof e.TextStyle||(t=new e.TextStyle(t)),t.toFontString()},Object.defineProperties(e.TextStyle.prototype,{font:{get:function(){r('text style property \'font\' is now deprecated, please use the \'fontFamily\', \'fontSize\', \'fontStyle\', \'fontVariant\' and \'fontWeight\' properties from now on');var e='number'==typeof this._fontSize?this._fontSize+'px':this._fontSize;return this._fontStyle+' '+this._fontVariant+' '+this._fontWeight+' '+e+' '+this._fontFamily},set:function(e){r('text style property \'font\' is now deprecated, please use the \'fontFamily\',\'fontSize\',fontStyle\',\'fontVariant\' and \'fontWeight\' properties from now on'),this._fontStyle=1<e.indexOf('italic')?'italic':-1<e.indexOf('oblique')?'oblique':'normal',this._fontVariant=-1<e.indexOf('small-caps')?'small-caps':'normal';var t=e.split(' '),a=-1;this._fontSize=26;for(var n=0;n<t.length;++n)if(t[n].match(/(px|pt|em|%)/)){a=n,this._fontSize=t[n];break}this._fontWeight='normal';for(var o=0;o<a;++o)if(t[o].match(/(bold|bolder|lighter|100|200|300|400|500|600|700|800|900)/)){this._fontWeight=t[o];break}if(-1<a&&a<t.length-1){this._fontFamily='';for(var i=a+1;i<t.length;++i)this._fontFamily+=t[i]+' ';this._fontFamily=this._fontFamily.slice(0,-1)}else this._fontFamily='Arial';this.styleID++}}}),e.Texture.prototype.setFrame=function(e){this.frame=e,r('setFrame is now deprecated, please use the frame property, e.g: myTexture.frame = frame;')},e.Texture.addTextureToCache=function(t,a){e.Texture.addToCache(t,a),r('Texture.addTextureToCache is deprecated, please use Texture.addToCache from now on.')},e.Texture.removeTextureFromCache=function(t){return r('Texture.removeTextureFromCache is deprecated, please use Texture.removeFromCache from now on. Be aware that Texture.removeFromCache does not automatically its BaseTexture from the BaseTextureCache. For that, use BaseTexture.removeFromCache'),e.BaseTexture.removeFromCache(t),e.Texture.removeFromCache(t)},Object.defineProperties(o,{AbstractFilter:{get:function(){return r('AstractFilter has been renamed to Filter, please use PIXI.Filter'),e.AbstractFilter}},SpriteMaskFilter:{get:function(){return r('filters.SpriteMaskFilter is an undocumented alias, please use SpriteMaskFilter from now on.'),e.SpriteMaskFilter}},VoidFilter:{get:function(){return r('VoidFilter has been renamed to AlphaFilter, please use PIXI.filters.AlphaFilter'),o.AlphaFilter}}}),e.utils.uuid=function(){return r('utils.uuid() is deprecated, please use utils.uid() from now on.'),e.utils.uid()},e.utils.canUseNewCanvasBlendModes=function(){return r('utils.canUseNewCanvasBlendModes() is deprecated, please use CanvasTinter.canUseMultiply from now on'),e.CanvasTinter.canUseMultiply};var i=!0;if(Object.defineProperty(e.utils,'_saidHello',{set:function(e){e&&(r('PIXI.utils._saidHello is deprecated, please use PIXI.utils.skipHello()'),this.skipHello()),i=e},get:function(){return i}}),s.BasePrepare&&(s.BasePrepare.prototype.register=function(e,t){return r('renderer.plugins.prepare.register is now deprecated, please use renderer.plugins.prepare.registerFindHook & renderer.plugins.prepare.registerUploadHook'),e&&this.registerFindHook(e),t&&this.registerUploadHook(t),this}),s.canvas&&Object.defineProperty(s.canvas,'UPLOADS_PER_FRAME',{set:function(){r('PIXI.CanvasPrepare.UPLOADS_PER_FRAME has been removed. Please set renderer.plugins.prepare.limiter.maxItemsPerFrame on your renderer')},get:function(){return r('PIXI.CanvasPrepare.UPLOADS_PER_FRAME has been removed. Please use renderer.plugins.prepare.limiter'),NaN}}),s.webgl&&Object.defineProperty(s.webgl,'UPLOADS_PER_FRAME',{set:function(){r('PIXI.WebGLPrepare.UPLOADS_PER_FRAME has been removed. Please set renderer.plugins.prepare.limiter.maxItemsPerFrame on your renderer')},get:function(){return r('PIXI.WebGLPrepare.UPLOADS_PER_FRAME has been removed. Please use renderer.plugins.prepare.limiter'),NaN}}),l.Loader){var h=l.Resource,g=l.Loader;Object.defineProperties(h.prototype,{isJson:{get:function(){return r('The isJson property is deprecated, please use `resource.type === Resource.TYPE.JSON`.'),this.type===h.TYPE.JSON}},isXml:{get:function(){return r('The isXml property is deprecated, please use `resource.type === Resource.TYPE.XML`.'),this.type===h.TYPE.XML}},isImage:{get:function(){return r('The isImage property is deprecated, please use `resource.type === Resource.TYPE.IMAGE`.'),this.type===h.TYPE.IMAGE}},isAudio:{get:function(){return r('The isAudio property is deprecated, please use `resource.type === Resource.TYPE.AUDIO`.'),this.type===h.TYPE.AUDIO}},isVideo:{get:function(){return r('The isVideo property is deprecated, please use `resource.type === Resource.TYPE.VIDEO`.'),this.type===h.TYPE.VIDEO}}}),Object.defineProperties(g.prototype,{before:{get:function(){return r('The before() method is deprecated, please use pre().'),this.pre}},after:{get:function(){return r('The after() method is deprecated, please use use().'),this.use}}})}d.interactiveTarget&&Object.defineProperty(d.interactiveTarget,'defaultCursor',{set:function(e){r('Property defaultCursor has been replaced with \'cursor\'. '),this.cursor=e},get:function(){return r('Property defaultCursor has been replaced with \'cursor\'. '),this.cursor}}),d.InteractionManager&&(Object.defineProperty(d.InteractionManager,'defaultCursorStyle',{set:function(e){r('Property defaultCursorStyle has been replaced with \'cursorStyles.default\'. '),this.cursorStyles.default=e},get:function(){return r('Property defaultCursorStyle has been replaced with \'cursorStyles.default\'. '),this.cursorStyles.default}}),Object.defineProperty(d.InteractionManager,'currentCursorStyle',{set:function(e){r('Property currentCursorStyle has been removed.See the currentCursorMode property, which works differently.'),this.currentCursorMode=e},get:function(){return r('Property currentCursorStyle has been removed.See the currentCursorMode property, which works differently.'),this.currentCursorMode}}))}},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var n=r(79);Object.defineProperty(t,'accessibleTarget',{enumerable:!0,get:function(){return a(n).default}});var o=r(167);Object.defineProperty(t,'AccessibilityManager',{enumerable:!0,get:function(){return a(o).default}})},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var o=r(0),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(o),i=r(37),l=a(i),d=r(79),u=a(d);s.utils.mixins.delayMixin(s.DisplayObject.prototype,u.default);var p=100,c=2,h=1,g=function(){function e(t){n(this,e),(l.default.tablet||l.default.phone)&&!navigator.isCocoonJS&&this.createTouchHook();var r=document.createElement('div');r.style.width=p+'px',r.style.height=p+'px',r.style.position='absolute',r.style.top=0+'px',r.style.left=0+'px',r.style.zIndex=c,this.div=r,this.pool=[],this.renderId=0,this.debug=!1,this.renderer=t,this.children=[],this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this.isActive=!1,this.isMobileAccessabillity=!1,window.addEventListener('keydown',this._onKeyDown,!1)}return e.prototype.createTouchHook=function(){var e=this,t=document.createElement('button');t.style.width=h+'px',t.style.height=h+'px',t.style.position='absolute',t.style.top=-1e3+'px',t.style.left=-1e3+'px',t.style.zIndex=2,t.style.backgroundColor='#FF0000',t.title='HOOK DIV',t.addEventListener('focus',function(){e.isMobileAccessabillity=!0,e.activate(),document.body.removeChild(t)}),document.body.appendChild(t)},e.prototype.activate=function(){this.isActive||(this.isActive=!0,window.document.addEventListener('mousemove',this._onMouseMove,!0),window.removeEventListener('keydown',this._onKeyDown,!1),this.renderer.on('postrender',this.update,this),this.renderer.view.parentNode&&this.renderer.view.parentNode.appendChild(this.div))},e.prototype.deactivate=function(){!this.isActive||this.isMobileAccessabillity||(this.isActive=!1,window.document.removeEventListener('mousemove',this._onMouseMove),window.addEventListener('keydown',this._onKeyDown,!1),this.renderer.off('postrender',this.update),this.div.parentNode&&this.div.parentNode.removeChild(this.div))},e.prototype.updateAccessibleObjects=function(e){if(e.visible){e.accessible&&e.interactive&&(!e._accessibleActive&&this.addChild(e),e.renderId=this.renderId);for(var t=e.children,r=t.length-1;0<=r;r--)this.updateAccessibleObjects(t[r])}},e.prototype.update=function(){if(this.renderer.renderingToScreen){this.updateAccessibleObjects(this.renderer._lastObjectRendered);var e=this.renderer.view.getBoundingClientRect(),t=e.width/this.renderer.width,r=e.height/this.renderer.height,a=this.div;a.style.left=e.left+'px',a.style.top=e.top+'px',a.style.width=this.renderer.width+'px',a.style.height=this.renderer.height+'px';for(var n=0,o;n<this.children.length;n++)if(o=this.children[n],o.renderId!==this.renderId)o._accessibleActive=!1,s.utils.removeItems(this.children,n,1),this.div.removeChild(o._accessibleDiv),this.pool.push(o._accessibleDiv),o._accessibleDiv=null,n--,0===this.children.length&&this.deactivate();else{a=o._accessibleDiv;var i=o.hitArea,l=o.worldTransform;o.hitArea?(a.style.left=(l.tx+i.x*l.a)*t+'px',a.style.top=(l.ty+i.y*l.d)*r+'px',a.style.width=i.width*l.a*t+'px',a.style.height=i.height*l.d*r+'px'):(i=o.getBounds(),this.capHitArea(i),a.style.left=i.x*t+'px',a.style.top=i.y*r+'px',a.style.width=i.width*t+'px',a.style.height=i.height*r+'px')}this.renderId++}},e.prototype.capHitArea=function(e){0>e.x&&(e.width+=e.x,e.x=0),0>e.y&&(e.height+=e.y,e.y=0),e.x+e.width>this.renderer.width&&(e.width=this.renderer.width-e.x),e.y+e.height>this.renderer.height&&(e.height=this.renderer.height-e.y)},e.prototype.addChild=function(e){var t=this.pool.pop();t||(t=document.createElement('button'),t.style.width=p+'px',t.style.height=p+'px',t.style.backgroundColor=this.debug?'rgba(255,0,0,0.5)':'transparent',t.style.position='absolute',t.style.zIndex=c,t.style.borderStyle='none',t.addEventListener('click',this._onClick.bind(this)),t.addEventListener('focus',this._onFocus.bind(this)),t.addEventListener('focusout',this._onFocusOut.bind(this))),e.accessibleTitle?t.title=e.accessibleTitle:!e.accessibleTitle&&!e.accessibleHint&&(t.title='displayObject '+this.tabIndex),e.accessibleHint&&t.setAttribute('aria-label',e.accessibleHint),e._accessibleActive=!0,e._accessibleDiv=t,t.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex},e.prototype._onClick=function(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,'click',e.eventData)},e.prototype._onFocus=function(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,'mouseover',e.eventData)},e.prototype._onFocusOut=function(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,'mouseout',e.eventData)},e.prototype._onKeyDown=function(t){t.keyCode!==9||this.activate()},e.prototype._onMouseMove=function(){this.deactivate()},e.prototype.destroy=function(){this.div=null;for(var e=0;e<this.children.length;e++)this.children[e].div=null;window.document.removeEventListener('mousemove',this._onMouseMove),window.removeEventListener('keydown',this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},e}();t.default=g,s.WebGLRenderer.registerPlugin('accessibility',g),s.CanvasRenderer.registerPlugin('accessibility',g)},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var n=r(169);Object.defineProperty(t,'webgl',{enumerable:!0,get:function(){return a(n).default}});var o=r(170);Object.defineProperty(t,'canvas',{enumerable:!0,get:function(){return a(o).default}})},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=new o.Rectangle,s=4,l=function(){function e(t){a(this,e),this.renderer=t,t.extract=this}return e.prototype.image=function(e){var t=new Image;return t.src=this.base64(e),t},e.prototype.base64=function(e){return this.canvas(e).toDataURL()},e.prototype.canvas=function(e){var t=this.renderer,r=!1,a=!1,n,l,d,u;e&&(e instanceof o.RenderTexture?u=e:(u=this.renderer.generateTexture(e),a=!0)),u?(n=u.baseTexture._glRenderTargets[this.renderer.CONTEXT_UID],l=n.resolution,d=u.frame,r=!1):(n=this.renderer.rootRenderTarget,l=n.resolution,r=!0,d=i,d.width=n.size.width,d.height=n.size.height);var p=d.width*l,c=d.height*l,h=new o.CanvasRenderTarget(p,c);if(n){t.bindRenderTarget(n);var g=new Uint8Array(s*p*c),f=t.gl;f.readPixels(d.x*l,d.y*l,p,c,f.RGBA,f.UNSIGNED_BYTE,g);var m=h.context.getImageData(0,0,p,c);m.data.set(g),h.context.putImageData(m,0,0),r&&(h.context.scale(1,-1),h.context.drawImage(h.canvas,0,-c))}return a&&u.destroy(!0),h.canvas},e.prototype.pixels=function(e){var t=this.renderer,r=!1,a,n,l,d;e&&(e instanceof o.RenderTexture?d=e:(d=this.renderer.generateTexture(e),r=!0)),d?(a=d.baseTexture._glRenderTargets[this.renderer.CONTEXT_UID],n=a.resolution,l=d.frame):(a=this.renderer.rootRenderTarget,n=a.resolution,l=i,l.width=a.size.width,l.height=a.size.height);var u=l.width*n,p=l.height*n,c=new Uint8Array(s*u*p);if(a){t.bindRenderTarget(a);var h=t.gl;h.readPixels(l.x*n,l.y*n,u,p,h.RGBA,h.UNSIGNED_BYTE,c)}return r&&d.destroy(!0),c},e.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},e}();t.default=l,o.WebGLRenderer.registerPlugin('extract',l)},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=new o.Rectangle,s=function(){function e(t){a(this,e),this.renderer=t,t.extract=this}return e.prototype.image=function(e){var t=new Image;return t.src=this.base64(e),t},e.prototype.base64=function(e){return this.canvas(e).toDataURL()},e.prototype.canvas=function(e){var t=this.renderer,r,a,n,s;e&&(e instanceof o.RenderTexture?s=e:s=t.generateTexture(e)),s?(r=s.baseTexture._canvasRenderTarget.context,a=s.baseTexture._canvasRenderTarget.resolution,n=s.frame):(r=t.rootContext,n=i,n.width=this.renderer.width,n.height=this.renderer.height);var l=n.width*a,d=n.height*a,u=new o.CanvasRenderTarget(l,d),p=r.getImageData(n.x*a,n.y*a,l,d);return u.context.putImageData(p,0,0),u.canvas},e.prototype.pixels=function(e){var t=this.renderer,r,a,n,s;return e&&(e instanceof o.RenderTexture?s=e:s=t.generateTexture(e)),s?(r=s.baseTexture._canvasRenderTarget.context,a=s.baseTexture._canvasRenderTarget.resolution,n=s.frame):(r=t.rootContext,n=i,n.width=t.width,n.height=t.height),r.getImageData(0,0,n.width*a,n.height*a).data},e.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},e}();t.default=s,o.CanvasRenderer.registerPlugin('extract',s)},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function n(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function o(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=Math.floor;t.__esModule=!0;var s=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),l=r(0),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(l),u=function(e){function t(r,o){a(this,t);var i=n(this,e.call(this,r[0]instanceof d.Texture?r[0]:r[0].texture));return i._textures=null,i._durations=null,i.textures=r,i._autoUpdate=!1!==o,i.animationSpeed=1,i.loop=!0,i.onComplete=null,i.onFrameChange=null,i.onLoop=null,i._currentTime=0,i.playing=!1,i}return o(t,e),t.prototype.stop=function(){this.playing&&(this.playing=!1,this._autoUpdate&&d.ticker.shared.remove(this.update,this))},t.prototype.play=function(){this.playing||(this.playing=!0,this._autoUpdate&&d.ticker.shared.add(this.update,this,d.UPDATE_PRIORITY.HIGH))},t.prototype.gotoAndStop=function(e){this.stop();var t=this.currentFrame;this._currentTime=e,t!==this.currentFrame&&this.updateTexture()},t.prototype.gotoAndPlay=function(e){var t=this.currentFrame;this._currentTime=e,t!==this.currentFrame&&this.updateTexture(),this.play()},t.prototype.update=function(e){var t=this.animationSpeed*e,r=this.currentFrame;if(null!==this._durations){var a=this._currentTime%1*this._durations[this.currentFrame];for(a+=1e3*(t/60);0>a;)this._currentTime--,a+=this._durations[this.currentFrame];var n=Math.sign(this.animationSpeed*e);for(this._currentTime=i(this._currentTime);a>=this._durations[this.currentFrame];)a-=this._durations[this.currentFrame]*n,this._currentTime+=n;this._currentTime+=a/this._durations[this.currentFrame]}else this._currentTime+=t;0>this._currentTime&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):r!==this.currentFrame&&(this.loop&&this.onLoop&&(0<this.animationSpeed&&this.currentFrame<r?this.onLoop():0>this.animationSpeed&&this.currentFrame>r&&this.onLoop()),this.updateTexture())},t.prototype.updateTexture=function(){this._texture=this._textures[this.currentFrame],this._textureID=-1,this.cachedTint=16777215,this.onFrameChange&&this.onFrameChange(this.currentFrame)},t.prototype.destroy=function(t){this.stop(),e.prototype.destroy.call(this,t)},t.fromFrames=function(e){for(var r=[],a=0;a<e.length;++a)r.push(d.Texture.fromFrame(e[a]));return new t(r)},t.fromImages=function(e){for(var r=[],a=0;a<e.length;++a)r.push(d.Texture.fromImage(e[a]));return new t(r)},s(t,[{key:'totalFrames',get:function(){return this._textures.length}},{key:'textures',get:function(){return this._textures},set:function(e){if(e[0]instanceof d.Texture)this._textures=e,this._durations=null;else{this._textures=[],this._durations=[];for(var t=0;t<e.length;t++)this._textures.push(e[t].texture),this._durations.push(e[t].time)}this.gotoAndStop(0),this.updateTexture()}},{key:'currentFrame',get:function(){var e=i(this._currentTime)%this._textures.length;return 0>e&&(e+=this._textures.length),e}}]),t}(d.Sprite);t.default=u},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function n(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function o(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var i=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),s=r(0),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(s),d=r(43),u=function(e){return e&&e.__esModule?e:{default:e}}(d),p=new l.Point,c=function(e){function t(r){var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:100,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:100;a(this,t);var s=n(this,e.call(this,r));return s.tileTransform=new l.TransformStatic,s._width=o,s._height=i,s._canvasPattern=null,s.uvTransform=r.transform||new l.TextureMatrix(r),s.pluginName='tilingSprite',s.uvRespectAnchor=!1,s}return o(t,e),t.prototype._onTextureUpdate=function(){this.uvTransform&&(this.uvTransform.texture=this._texture),this.cachedTint=16777215},t.prototype._renderWebGL=function(e){var t=this._texture;t&&t.valid&&(this.tileTransform.updateLocalTransform(),this.uvTransform.update(),e.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this))},t.prototype._renderCanvas=function(e){var t=this._texture;if(t.baseTexture.hasLoaded){var r=e.context,a=this.worldTransform,n=e.resolution,o=t.baseTexture,i=o.resolution,s=this.tilePosition.x/this.tileScale.x%t._frame.width*i,d=this.tilePosition.y/this.tileScale.y%t._frame.height*i;if(this._textureID!==this._texture._updateID||this.cachedTint!==this.tint){this._textureID=this._texture._updateID;var p=new l.CanvasRenderTarget(t._frame.width,t._frame.height,i);16777215===this.tint?p.context.drawImage(o.source,-t._frame.x*i,-t._frame.y*i):(this.tintedTexture=u.default.getTintedTexture(this,this.tint),p.context.drawImage(this.tintedTexture,0,0)),this.cachedTint=this.tint,this._canvasPattern=p.context.createPattern(p.canvas,'repeat')}r.globalAlpha=this.worldAlpha,r.setTransform(a.a*n,a.b*n,a.c*n,a.d*n,a.tx*n,a.ty*n),e.setBlendMode(this.blendMode),r.fillStyle=this._canvasPattern,r.scale(this.tileScale.x/i,this.tileScale.y/i);var c=this.anchor.x*-this._width,h=this.anchor.y*-this._height;this.uvRespectAnchor?(r.translate(s,d),r.fillRect(-s+c,-d+h,this._width/this.tileScale.x*i,this._height/this.tileScale.y*i)):(r.translate(s+c,d+h),r.fillRect(-s,-d,this._width/this.tileScale.x*i,this._height/this.tileScale.y*i))}},t.prototype._calculateBounds=function(){var e=this._width*-this._anchor._x,t=this._height*-this._anchor._y,r=this._width*(1-this._anchor._x),a=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,e,t,r,a)},t.prototype.getLocalBounds=function(t){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._x),t||(!this._localBoundsRect&&(this._localBoundsRect=new l.Rectangle),t=this._localBoundsRect),this._bounds.getRectangle(t)):e.prototype.getLocalBounds.call(this,t)},t.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,p);var t=this._width,r=this._height,a=-t*this.anchor._x;if(p.x>=a&&p.x<a+t){var n=-r*this.anchor._y;if(p.y>=n&&p.y<n+r)return!0}return!1},t.prototype.destroy=function(t){e.prototype.destroy.call(this,t),this.tileTransform=null,this.uvTransform=null},t.from=function(e,r,a){return new t(l.Texture.from(e),r,a)},t.fromFrame=function(e,r,a){var n=l.utils.TextureCache[e];if(!n)throw new Error('The frameId "'+e+'" does not exist in the texture cache '+this);return new t(n,r,a)},t.fromImage=function(e,r,a,n,o){return new t(l.Texture.fromImage(e,n,o),r,a)},i(t,[{key:'clampMargin',get:function(){return this.uvTransform.clampMargin},set:function(e){this.uvTransform.clampMargin=e,this.uvTransform.update(!0)}},{key:'tileScale',get:function(){return this.tileTransform.scale},set:function(e){this.tileTransform.scale.copy(e)}},{key:'tilePosition',get:function(){return this.tileTransform.position},set:function(e){this.tileTransform.position.copy(e)}},{key:'width',get:function(){return this._width},set:function(e){this._width=e}},{key:'height',get:function(){return this._height},set:function(e){this._height=e}}]),t}(l.Sprite);t.default=c},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function n(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function o(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var i=r(0),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(i),l=r(1),d=r(9),u=new s.Matrix,p=function(e){function t(r){a(this,t);var o=n(this,e.call(this,r));return o.shader=null,o.simpleShader=null,o.quad=null,o}return o(t,e),t.prototype.onContextChange=function(){var e=this.renderer.gl;this.shader=new s.Shader(e,'attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n','varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = mod(vTextureCoord - uClampOffset, vec2(1.0, 1.0)) + uClampOffset;\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 sample = texture2D(uSampler, coord);\n    gl_FragColor = sample * uColor;\n}\n'),this.simpleShader=new s.Shader(e,'attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n','varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 sample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = sample * uColor;\n}\n'),this.renderer.bindVao(null),this.quad=new s.Quad(e,this.renderer.state.attribState),this.quad.initVao(this.shader)},t.prototype.render=function(e){var t=this.renderer,r=this.quad;t.bindVao(r.vao);var a=r.vertices;a[0]=a[6]=e._width*-e.anchor.x,a[1]=a[3]=e._height*-e.anchor.y,a[2]=a[4]=e._width*(1-e.anchor.x),a[5]=a[7]=e._height*(1-e.anchor.y),e.uvRespectAnchor&&(a=r.uvs,a[0]=a[6]=-e.anchor.x,a[1]=a[3]=-e.anchor.y,a[2]=a[4]=1-e.anchor.x,a[5]=a[7]=1-e.anchor.y),r.upload();var n=e._texture,o=n.baseTexture,i=e.tileTransform.localTransform,d=e.uvTransform,p=o.isPowerOfTwo&&n.frame.width===o.width&&n.frame.height===o.height;p&&(o._glTextures[t.CONTEXT_UID]?p=o.wrapMode!==l.WRAP_MODES.CLAMP:o.wrapMode===l.WRAP_MODES.CLAMP&&(o.wrapMode=l.WRAP_MODES.REPEAT));var c=p?this.simpleShader:this.shader;t.bindShader(c);var g=n.width,f=n.height,h=e._width,m=e._height;u.set(i.a*g/h,i.b*g/m,i.c*f/h,i.d*f/m,i.tx/h,i.ty/m),u.invert(),p?u.prepend(d.mapCoord):(c.uniforms.uMapCoord=d.mapCoord.toArray(!0),c.uniforms.uClampFrame=d.uClampFrame,c.uniforms.uClampOffset=d.uClampOffset),c.uniforms.uTransform=u.toArray(!0),c.uniforms.uColor=s.utils.premultiplyTintToRgba(e.tint,e.worldAlpha,c.uniforms.uColor,o.premultipliedAlpha),c.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),c.uniforms.uSampler=t.bindTexture(n),t.setBlendMode(s.utils.correctBlendMode(e.blendMode,o.premultipliedAlpha)),r.vao.draw(this.renderer.gl.TRIANGLES,6,0)},t}(s.ObjectRenderer);t.default=p,s.WebGLRenderer.registerPlugin('tilingSprite',p)},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=Math.max;t.__esModule=!0;var l=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),d=r(0),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(d),p=r(47),c=a(p),h=r(2),g=r(3),f=a(g),m=function(e){function t(r){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};n(this,t);var i=o(this,e.call(this));return i._textWidth=0,i._textHeight=0,i._glyphs=[],i._font={tint:void 0===a.tint?16777215:a.tint,align:a.align||'left',name:null,size:0},i.font=a.font,i._text=r,i._maxWidth=0,i._maxLineHeight=0,i._anchor=new c.default(function(){i.dirty=!0},i,0,0),i.dirty=!1,i.updateText(),i}return i(t,e),t.prototype.updateText=function(){for(var e=t.fonts[this._font.name],r=this._font.size/e.size,a=new u.Point,n=[],o=[],l=null,d=0,p=0,h=0,g=-1,f=0,m=0,y=0,x=0,i;x<this.text.length;x++){if(i=this.text.charCodeAt(x),/(\s)/.test(this.text.charAt(x))&&(g=x,f=d),/(?:\r\n|\r|\n)/.test(this.text.charAt(x))){o.push(d),p=s(p,d),h++,a.x=0,a.y+=e.lineHeight,l=null;continue}if(-1!==g&&0<this._maxWidth&&a.x*r>this._maxWidth){u.utils.removeItems(n,g-m,x-g),x=g,g=-1,++m,o.push(f),p=s(p,f),h++,a.x=0,a.y+=e.lineHeight,l=null;continue}var _=e.chars[i];_&&(l&&_.kerning[l]&&(a.x+=_.kerning[l]),n.push({texture:_.texture,line:h,charCode:i,position:new u.Point(a.x+_.xOffset,a.y+_.yOffset)}),d=a.x+(_.texture.width+_.xOffset),a.x+=_.xAdvance,y=s(y,_.yOffset+_.texture.height),l=i)}o.push(d),p=s(p,d);for(var b=[],T=0,v;T<=h;T++)v=0,'right'===this._font.align?v=p-o[T]:'center'===this._font.align&&(v=(p-o[T])/2),b.push(v);for(var E=n.length,S=this.tint,C=0,P;C<E;C++)P=this._glyphs[C],P?P.texture=n[C].texture:(P=new u.Sprite(n[C].texture),this._glyphs.push(P)),P.position.x=(n[C].position.x+b[n[C].line])*r,P.position.y=n[C].position.y*r,P.scale.x=P.scale.y=r,P.tint=S,P.parent||this.addChild(P);for(var c=E;c<this._glyphs.length;++c)this.removeChild(this._glyphs[c]);if(this._textWidth=p*r,this._textHeight=(a.y+e.lineHeight)*r,0!==this.anchor.x||0!==this.anchor.y)for(var w=0;w<E;w++)this._glyphs[w].x-=this._textWidth*this.anchor.x,this._glyphs[w].y-=this._textHeight*this.anchor.y;this._maxLineHeight=y*r},t.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},t.prototype.getLocalBounds=function(){return this.validate(),e.prototype.getLocalBounds.call(this)},t.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},t.registerFont=function(e,r){var a={},n=e.getElementsByTagName('info')[0],o=e.getElementsByTagName('common')[0],s=e.getElementsByTagName('page')[0].getAttribute('file'),l=(0,h.getResolutionOfUrl)(s,f.default.RESOLUTION);a.font=n.getAttribute('face'),a.size=parseInt(n.getAttribute('size'),10),a.lineHeight=parseInt(o.getAttribute('lineHeight'),10)/l,a.chars={};for(var d=e.getElementsByTagName('char'),p=0;p<d.length;p++){var i=d[p],c=parseInt(i.getAttribute('id'),10),g=new u.Rectangle(parseInt(i.getAttribute('x'),10)/l+r.frame.x/l,parseInt(i.getAttribute('y'),10)/l+r.frame.y/l,parseInt(i.getAttribute('width'),10)/l,parseInt(i.getAttribute('height'),10)/l);a.chars[c]={xOffset:parseInt(i.getAttribute('xoffset'),10)/l,yOffset:parseInt(i.getAttribute('yoffset'),10)/l,xAdvance:parseInt(i.getAttribute('xadvance'),10)/l,kerning:{},texture:new u.Texture(r.baseTexture,g)}}for(var m=e.getElementsByTagName('kerning'),y=0;y<m.length;y++){var x=m[y],_=parseInt(x.getAttribute('first'),10)/l,b=parseInt(x.getAttribute('second'),10)/l,T=parseInt(x.getAttribute('amount'),10)/l;a.chars[b]&&(a.chars[b].kerning[_]=T)}return t.fonts[a.font]=a,a},l(t,[{key:'tint',get:function(){return this._font.tint},set:function(e){this._font.tint='number'==typeof e&&0<=e?e:16777215,this.dirty=!0}},{key:'align',get:function(){return this._font.align},set:function(e){this._font.align=e||'left',this.dirty=!0}},{key:'anchor',get:function(){return this._anchor},set:function(e){'number'==typeof e?this._anchor.set(e):this._anchor.copy(e)}},{key:'font',get:function(){return this._font},set:function(e){e&&('string'==typeof e?(e=e.split(' '),this._font.name=1===e.length?e[0]:e.slice(1).join(' '),this._font.size=2<=e.length?parseInt(e[0],10):t.fonts[this._font.name].size):(this._font.name=e.name,this._font.size='number'==typeof e.size?e.size:parseInt(e.size,10)),this.dirty=!0)}},{key:'text',get:function(){return this._text},set:function(e){e=e.toString()||' ',this._text===e||(this._text=e,this.dirty=!0)}},{key:'maxWidth',get:function(){return this._maxWidth},set:function(e){this._maxWidth===e||(this._maxWidth=e,this.dirty=!0)}},{key:'maxLineHeight',get:function(){return this.validate(),this._maxLineHeight}},{key:'textWidth',get:function(){return this.validate(),this._textWidth}},{key:'textHeight',get:function(){return this.validate(),this._textHeight}}]),t}(u.Container);t.default=m,m.fonts={}},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var o=r(0),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(o),s=r(11),l=a(s),d=r(14),u=a(d),p=r(2),c=i.DisplayObject,h=new i.Matrix;c.prototype._cacheAsBitmap=!1,c.prototype._cacheData=!1;var g=function e(){n(this,e),this.textureCacheId=null,this.originalRenderWebGL=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalHitTest=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.sprite=null};Object.defineProperties(c.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(e){if(this._cacheAsBitmap!==e){this._cacheAsBitmap=e;var t;e?(!this._cacheData&&(this._cacheData=new g),t=this._cacheData,t.originalRenderWebGL=this.renderWebGL,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this._calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.renderWebGL=this._renderCachedWebGL,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.renderWebGL=t.originalRenderWebGL,this.renderCanvas=t.originalRenderCanvas,this._calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}}}),c.prototype._renderCachedWebGL=function(e){this.visible&&!(0>=this.worldAlpha)&&this.renderable&&(this._initCachedDisplayObject(e),this._cacheData.sprite._transformID=-1,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderWebGL(e))},c.prototype._initCachedDisplayObject=function(e){if(!(this._cacheData&&this._cacheData.sprite)){var t=this.alpha;this.alpha=1,e.currentRenderer.flush();var r=this.getLocalBounds().clone();if(this._filters){var a=this._filters[0].padding;r.pad(a)}var n=e._activeRenderTarget,o=e.filterManager.filterStack,s=i.RenderTexture.create(0|r.width,0|r.height),d='cacheAsBitmap_'+(0,p.uid)();this._cacheData.textureCacheId=d,u.default.addToCache(s.baseTexture,d),l.default.addToCache(s,d);var c=h;c.tx=-r.x,c.ty=-r.y,this.transform.worldTransform.identity(),this.renderWebGL=this._cacheData.originalRenderWebGL,e.render(this,s,!0,c,!0),e.bindRenderTarget(n),e.filterManager.filterStack=o,this.renderWebGL=this._renderCachedWebGL,this.updateTransform=this.displayObjectUpdateTransform,this._mask=null,this.filterArea=null;var g=new i.Sprite(s);g.transform.worldTransform=this.transform.worldTransform,g.anchor.x=-(r.x/r.width),g.anchor.y=-(r.y/r.height),g.alpha=t,g._bounds=this._bounds,this._calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._cacheData.sprite=g,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=e._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=g.containsPoint.bind(g)}},c.prototype._renderCachedCanvas=function(e){this.visible&&!(0>=this.worldAlpha)&&this.renderable&&(this._initCachedDisplayObjectCanvas(e),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite.renderCanvas(e))},c.prototype._initCachedDisplayObjectCanvas=function(e){if(!(this._cacheData&&this._cacheData.sprite)){var t=this.getLocalBounds(),r=this.alpha;this.alpha=1;var a=e.context,n=i.RenderTexture.create(0|t.width,0|t.height),o='cacheAsBitmap_'+(0,p.uid)();this._cacheData.textureCacheId=o,u.default.addToCache(n.baseTexture,o),l.default.addToCache(n,o);var s=h;this.transform.localTransform.copy(s),s.invert(),s.tx-=t.x,s.ty-=t.y,this.renderCanvas=this._cacheData.originalRenderCanvas,e.render(this,n,!0,s,!1),e.context=a,this.renderCanvas=this._renderCachedCanvas,this._calculateBounds=this._calculateCachedBounds,this._mask=null,this.filterArea=null;var d=new i.Sprite(n);d.transform.worldTransform=this.transform.worldTransform,d.anchor.x=-(t.x/t.width),d.anchor.y=-(t.y/t.height),d._bounds=this._bounds,d.alpha=r,this.parent?this.updateTransform():(this.parent=e._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.updateTransform=this.displayObjectUpdateTransform,this._cacheData.sprite=d,this.containsPoint=d.containsPoint.bind(d)}},c.prototype._calculateCachedBounds=function(){this._cacheData.sprite._calculateBounds()},c.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds()},c.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,u.default.removeFromCache(this._cacheData.textureCacheId),l.default.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},c.prototype._cacheAsBitmapDestroy=function(e){this.cacheAsBitmap=!1,this.destroy(e)}},function(e,t,r){'use strict';var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a);n.DisplayObject.prototype.name=null,n.Container.prototype.getChildByName=function(e){for(var t=0;t<this.children.length;t++)if(this.children[t].name===e)return this.children[t];return null}},function(e,t,r){'use strict';var a=r(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a);n.DisplayObject.prototype.getGlobalPosition=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new n.Point,t=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1];return this.parent?this.parent.toGlobal(this.position,e,t):(e.x=this.position.x,e.y=this.position.y),e}},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var n=r(179);Object.defineProperty(t,'FXAAFilter',{enumerable:!0,get:function(){return a(n).default}});var o=r(180);Object.defineProperty(t,'NoiseFilter',{enumerable:!0,get:function(){return a(o).default}});var i=r(181);Object.defineProperty(t,'DisplacementFilter',{enumerable:!0,get:function(){return a(i).default}});var s=r(182);Object.defineProperty(t,'BlurFilter',{enumerable:!0,get:function(){return a(s).default}});var l=r(81);Object.defineProperty(t,'BlurXFilter',{enumerable:!0,get:function(){return a(l).default}});var d=r(85);Object.defineProperty(t,'BlurYFilter',{enumerable:!0,get:function(){return a(d).default}});var u=r(183);Object.defineProperty(t,'ColorMatrixFilter',{enumerable:!0,get:function(){return a(u).default}});var p=r(184);Object.defineProperty(t,'AlphaFilter',{enumerable:!0,get:function(){return a(p).default}})},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function n(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function o(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var i=r(0),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(i),l=r(9),d=function(e){function t(){return a(this,t),n(this,e.call(this,'\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nuniform vec4 filterArea;\n\nvarying vec2 vTextureCoord;\n\nvec2 mapCoord( vec2 coord )\n{\n    coord *= filterArea.xy;\n    coord += filterArea.zw;\n\n    return coord;\n}\n\nvec2 unmapCoord( vec2 coord )\n{\n    coord -= filterArea.zw;\n    coord /= filterArea.xy;\n\n    return coord;\n}\n\nvoid texcoords(vec2 fragCoord, vec2 resolution,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    vec2 inverseVP = 1.0 / resolution.xy;\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n   vTextureCoord = aTextureCoord;\n\n   vec2 fragCoord = vTextureCoord * filterArea.xy;\n\n   texcoords(fragCoord, filterArea.xy, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}','varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n \n --\n \n From:\n https://github.com/mitsuhiko/webgl-meincraft\n \n Copyright (c) 2011 by Armin Ronacher.\n \n Some rights reserved.\n \n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n \n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n \n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n \n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n \n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 resolution,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    mediump vec2 inverseVP = vec2(1.0 / resolution.x, 1.0 / resolution.y);\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n    \n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n    \n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n    \n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n    \n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n    \n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec2 fragCoord = vTextureCoord * filterArea.xy;\n\n      vec4 color;\n\n    color = fxaa(uSampler, fragCoord, filterArea.xy, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n'))}return o(t,e),t}(s.Filter);t.default=d},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function n(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function o(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var i=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),s=r(0),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(s),d=r(9),u=function(e){function t(){var r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:.5,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Math.random();a(this,t);var i=n(this,e.call(this,'attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}','precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n'));return i.noise=r,i.seed=o,i}return o(t,e),i(t,[{key:'noise',get:function(){return this.uniforms.uNoise},set:function(e){this.uniforms.uNoise=e}},{key:'seed',get:function(){return this.uniforms.uSeed},set:function(e){this.uniforms.uSeed=e}}]),t}(l.Filter);t.default=u},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function n(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function o(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var i=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),s=r(0),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(s),d=r(9),u=function(e){function t(r,o){a(this,t);var i=new l.Matrix;r.renderable=!1;var s=n(this,e.call(this,'attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nvoid main(void)\n{\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n   vTextureCoord = aTextureCoord;\n}','varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\n\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy *= scale / filterArea.xy;\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), filterClamp.xy, filterClamp.zw));\n}\n'));return s.maskSprite=r,s.maskMatrix=i,s.uniforms.mapSampler=r._texture,s.uniforms.filterMatrix=i,s.uniforms.scale={x:1,y:1},(null===o||void 0===o)&&(o=20),s.scale=new l.Point(o,o),s}return o(t,e),t.prototype.apply=function(e,t,r){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y,e.applyFilter(this,t,r)},i(t,[{key:'map',get:function(){return this.uniforms.mapSampler},set:function(e){this.uniforms.mapSampler=e}}]),t}(l.Filter);t.default=u},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=Math.abs,l=Math.max;t.__esModule=!0;var d=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),u=r(0),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(u),c=r(81),h=a(c),g=r(85),f=a(g),m=function(e){function t(r,a,i,s){n(this,t);var l=o(this,e.call(this));return l.blurXFilter=new h.default(r,a,i,s),l.blurYFilter=new f.default(r,a,i,s),l.padding=0,l.resolution=i||p.settings.RESOLUTION,l.quality=a||4,l.blur=r||8,l}return i(t,e),t.prototype.apply=function(e,t,r){var a=e.getRenderTarget(!0);this.blurXFilter.apply(e,t,a,!0),this.blurYFilter.apply(e,a,r,!1),e.returnRenderTarget(a)},d(t,[{key:'blur',get:function(){return this.blurXFilter.blur},set:function(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.padding=2*l(s(this.blurXFilter.strength),s(this.blurYFilter.strength))}},{key:'quality',get:function(){return this.blurXFilter.quality},set:function(e){this.blurXFilter.quality=this.blurYFilter.quality=e}},{key:'blurX',get:function(){return this.blurXFilter.blur},set:function(e){this.blurXFilter.blur=e,this.padding=2*l(s(this.blurXFilter.strength),s(this.blurYFilter.strength))}},{key:'blurY',get:function(){return this.blurYFilter.blur},set:function(e){this.blurYFilter.blur=e,this.padding=2*l(s(this.blurXFilter.strength),s(this.blurYFilter.strength))}},{key:'blendMode',get:function(){return this.blurYFilter._blendMode},set:function(e){this.blurYFilter._blendMode=e}}]),t}(p.Filter);t.default=m},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function n(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function o(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var i=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),s=r(0),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(s),d=r(9),u=function(e){function t(){a(this,t);var r=n(this,e.call(this,'attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}','varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n'));return r.uniforms.m=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],r.alpha=1,r}return o(t,e),t.prototype._loadMatrix=function(e){var t=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1],r=e;t&&(this._multiply(r,this.uniforms.m,e),r=this._colorMatrix(r)),this.uniforms.m=r},t.prototype._multiply=function(e,t,r){return e[0]=t[0]*r[0]+t[1]*r[5]+t[2]*r[10]+t[3]*r[15],e[1]=t[0]*r[1]+t[1]*r[6]+t[2]*r[11]+t[3]*r[16],e[2]=t[0]*r[2]+t[1]*r[7]+t[2]*r[12]+t[3]*r[17],e[3]=t[0]*r[3]+t[1]*r[8]+t[2]*r[13]+t[3]*r[18],e[4]=t[0]*r[4]+t[1]*r[9]+t[2]*r[14]+t[3]*r[19]+t[4],e[5]=t[5]*r[0]+t[6]*r[5]+t[7]*r[10]+t[8]*r[15],e[6]=t[5]*r[1]+t[6]*r[6]+t[7]*r[11]+t[8]*r[16],e[7]=t[5]*r[2]+t[6]*r[7]+t[7]*r[12]+t[8]*r[17],e[8]=t[5]*r[3]+t[6]*r[8]+t[7]*r[13]+t[8]*r[18],e[9]=t[5]*r[4]+t[6]*r[9]+t[7]*r[14]+t[8]*r[19]+t[9],e[10]=t[10]*r[0]+t[11]*r[5]+t[12]*r[10]+t[13]*r[15],e[11]=t[10]*r[1]+t[11]*r[6]+t[12]*r[11]+t[13]*r[16],e[12]=t[10]*r[2]+t[11]*r[7]+t[12]*r[12]+t[13]*r[17],e[13]=t[10]*r[3]+t[11]*r[8]+t[12]*r[13]+t[13]*r[18],e[14]=t[10]*r[4]+t[11]*r[9]+t[12]*r[14]+t[13]*r[19]+t[14],e[15]=t[15]*r[0]+t[16]*r[5]+t[17]*r[10]+t[18]*r[15],e[16]=t[15]*r[1]+t[16]*r[6]+t[17]*r[11]+t[18]*r[16],e[17]=t[15]*r[2]+t[16]*r[7]+t[17]*r[12]+t[18]*r[17],e[18]=t[15]*r[3]+t[16]*r[8]+t[17]*r[13]+t[18]*r[18],e[19]=t[15]*r[4]+t[16]*r[9]+t[17]*r[14]+t[18]*r[19]+t[19],e},t.prototype._colorMatrix=function(e){var t=new Float32Array(e);return t[4]/=255,t[9]/=255,t[14]/=255,t[19]/=255,t},t.prototype.brightness=function(e,t){this._loadMatrix([e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0],t)},t.prototype.greyscale=function(e,t){this._loadMatrix([e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0],t)},t.prototype.blackAndWhite=function(e){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],e)},t.prototype.hue=function(e,t){e=(e||0)/180*Math.PI;var r=Math.cos(e),a=Math.sin(e),n=Math.sqrt,o=1/3,i=n(o);this._loadMatrix([r+(1-r)*o,o*(1-r)-i*a,o*(1-r)+i*a,0,0,o*(1-r)+i*a,r+o*(1-r),o*(1-r)-i*a,0,0,o*(1-r)-i*a,o*(1-r)+i*a,r+o*(1-r),0,0,0,0,0,1,0],t)},t.prototype.contrast=function(e,t){var r=(e||0)+1,a=-.5*(r-1);this._loadMatrix([r,0,0,0,a,0,r,0,0,a,0,0,r,0,a,0,0,0,1,0],t)},t.prototype.saturate=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=arguments[1],r=2*e/3+1,a=-.5*(r-1);this._loadMatrix([r,a,a,0,0,a,r,a,0,0,a,a,r,0,0,0,0,0,1,0],t)},t.prototype.desaturate=function(){this.saturate(-1)},t.prototype.negative=function(e){this._loadMatrix([0,1,1,0,0,1,0,1,0,0,1,1,0,0,0,0,0,0,1,0],e)},t.prototype.sepia=function(e){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],e)},t.prototype.technicolor=function(e){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],e)},t.prototype.polaroid=function(e){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],e)},t.prototype.toBGR=function(e){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],e)},t.prototype.kodachrome=function(e){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],e)},t.prototype.browni=function(e){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],e)},t.prototype.vintage=function(e){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],e)},t.prototype.colorTone=function(e,t,r,a,n){e=e||.2,t=t||.15,r=r||16770432,a=a||3375104;var o=(255&r>>16)/255,i=(255&r>>8)/255,s=(255&r)/255,l=(255&a>>16)/255,d=(255&a>>8)/255,u=(255&a)/255,p=[.3,.59,.11,0,0,o,i,s,e,0,l,d,u,t,0,o-l,i-d,s-u,0,0];this._loadMatrix(p,n)},t.prototype.night=function(e,t){e=e||.1;var r=[-2*e,-e,0,0,0,-e,0,e,0,0,0,e,2*e,0,0,0,0,0,1,0];this._loadMatrix(r,t)},t.prototype.predator=function(e,t){this._loadMatrix([11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0],t)},t.prototype.lsd=function(e){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],e)},t.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},i(t,[{key:'matrix',get:function(){return this.uniforms.m},set:function(e){this.uniforms.m=e}},{key:'alpha',get:function(){return this.uniforms.uAlpha},set:function(e){this.uniforms.uAlpha=e}}]),t}(l.Filter);t.default=u,u.prototype.grayscale=u.prototype.greyscale},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function n(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function o(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var i=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),s=r(0),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(s),d=r(9),u=function(e){function t(){var r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;a(this,t);var o=n(this,e.call(this,'attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}','varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n'));return o.alpha=r,o.glShaderKey='alpha',o}return o(t,e),i(t,[{key:'alpha',get:function(){return this.uniforms.uAlpha},set:function(e){this.uniforms.uAlpha=e}}]),t}(l.Filter);t.default=u},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var n=r(86);Object.defineProperty(t,'InteractionData',{enumerable:!0,get:function(){return a(n).default}});var o=r(186);Object.defineProperty(t,'InteractionManager',{enumerable:!0,get:function(){return a(o).default}});var i=r(89);Object.defineProperty(t,'interactiveTarget',{enumerable:!0,get:function(){return a(i).default}});var s=r(88);Object.defineProperty(t,'InteractionTrackingData',{enumerable:!0,get:function(){return a(s).default}});var l=r(87);Object.defineProperty(t,'InteractionEvent',{enumerable:!0,get:function(){return a(l).default}})},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&'function'==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?'symbol':typeof e},l=r(0),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(l),u=r(86),p=a(u),c=r(87),h=a(c),g=r(88),f=a(g),m=r(12),y=a(m),x=r(89),_=a(x);d.utils.mixins.delayMixin(d.DisplayObject.prototype,_.default);var b=1,T={target:null,data:{global:null}},v=function(e){function t(r,a){n(this,t);var i=o(this,e.call(this));return a=a||{},i.renderer=r,i.autoPreventDefault=void 0===a.autoPreventDefault||a.autoPreventDefault,i.interactionFrequency=a.interactionFrequency||10,i.mouse=new p.default,i.mouse.identifier=b,i.mouse.global.set(-999999),i.activeInteractionData={},i.activeInteractionData[b]=i.mouse,i.interactionDataPool=[],i.eventData=new h.default,i.interactionDOMElement=null,i.moveWhenInside=!1,i.eventsAdded=!1,i.mouseOverRenderer=!1,i.supportsTouchEvents='ontouchstart'in window,i.supportsPointerEvents=!!window.PointerEvent,i.onPointerUp=i.onPointerUp.bind(i),i.processPointerUp=i.processPointerUp.bind(i),i.onPointerCancel=i.onPointerCancel.bind(i),i.processPointerCancel=i.processPointerCancel.bind(i),i.onPointerDown=i.onPointerDown.bind(i),i.processPointerDown=i.processPointerDown.bind(i),i.onPointerMove=i.onPointerMove.bind(i),i.processPointerMove=i.processPointerMove.bind(i),i.onPointerOut=i.onPointerOut.bind(i),i.processPointerOverOut=i.processPointerOverOut.bind(i),i.onPointerOver=i.onPointerOver.bind(i),i.cursorStyles={default:'inherit',pointer:'pointer'},i.currentCursorMode=null,i.cursor=null,i._tempPoint=new d.Point,i.resolution=1,i.setTargetElement(i.renderer.view,i.renderer.resolution),i}return i(t,e),t.prototype.hitTest=function(e,t){return T.target=null,T.data.global=e,t||(t=this.renderer._lastObjectRendered),this.processInteractive(T,t,null,!0),T.target},t.prototype.setTargetElement=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;this.removeEvents(),this.interactionDOMElement=e,this.resolution=t,this.addEvents()},t.prototype.addEvents=function(){this.interactionDOMElement&&(d.ticker.shared.add(this.update,this,d.UPDATE_PRIORITY.INTERACTION),window.navigator.msPointerEnabled?(this.interactionDOMElement.style['-ms-content-zooming']='none',this.interactionDOMElement.style['-ms-touch-action']='none'):this.supportsPointerEvents&&(this.interactionDOMElement.style['touch-action']='none'),this.supportsPointerEvents?(window.document.addEventListener('pointermove',this.onPointerMove,!0),this.interactionDOMElement.addEventListener('pointerdown',this.onPointerDown,!0),this.interactionDOMElement.addEventListener('pointerleave',this.onPointerOut,!0),this.interactionDOMElement.addEventListener('pointerover',this.onPointerOver,!0),window.addEventListener('pointercancel',this.onPointerCancel,!0),window.addEventListener('pointerup',this.onPointerUp,!0)):(window.document.addEventListener('mousemove',this.onPointerMove,!0),this.interactionDOMElement.addEventListener('mousedown',this.onPointerDown,!0),this.interactionDOMElement.addEventListener('mouseout',this.onPointerOut,!0),this.interactionDOMElement.addEventListener('mouseover',this.onPointerOver,!0),window.addEventListener('mouseup',this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener('touchstart',this.onPointerDown,!0),this.interactionDOMElement.addEventListener('touchcancel',this.onPointerCancel,!0),this.interactionDOMElement.addEventListener('touchend',this.onPointerUp,!0),this.interactionDOMElement.addEventListener('touchmove',this.onPointerMove,!0)),this.eventsAdded=!0)},t.prototype.removeEvents=function(){this.interactionDOMElement&&(d.ticker.shared.remove(this.update,this),window.navigator.msPointerEnabled?(this.interactionDOMElement.style['-ms-content-zooming']='',this.interactionDOMElement.style['-ms-touch-action']=''):this.supportsPointerEvents&&(this.interactionDOMElement.style['touch-action']=''),this.supportsPointerEvents?(window.document.removeEventListener('pointermove',this.onPointerMove,!0),this.interactionDOMElement.removeEventListener('pointerdown',this.onPointerDown,!0),this.interactionDOMElement.removeEventListener('pointerleave',this.onPointerOut,!0),this.interactionDOMElement.removeEventListener('pointerover',this.onPointerOver,!0),window.removeEventListener('pointercancel',this.onPointerCancel,!0),window.removeEventListener('pointerup',this.onPointerUp,!0)):(window.document.removeEventListener('mousemove',this.onPointerMove,!0),this.interactionDOMElement.removeEventListener('mousedown',this.onPointerDown,!0),this.interactionDOMElement.removeEventListener('mouseout',this.onPointerOut,!0),this.interactionDOMElement.removeEventListener('mouseover',this.onPointerOver,!0),window.removeEventListener('mouseup',this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener('touchstart',this.onPointerDown,!0),this.interactionDOMElement.removeEventListener('touchcancel',this.onPointerCancel,!0),this.interactionDOMElement.removeEventListener('touchend',this.onPointerUp,!0),this.interactionDOMElement.removeEventListener('touchmove',this.onPointerMove,!0)),this.interactionDOMElement=null,this.eventsAdded=!1)},t.prototype.update=function(e){if((this._deltaTime+=e,!(this._deltaTime<this.interactionFrequency))&&(this._deltaTime=0,!!this.interactionDOMElement)){if(this.didMove)return void(this.didMove=!1);for(var t in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(t)){var r=this.activeInteractionData[t];if(r.originalEvent&&'touch'!==r.pointerType){var a=this.configureInteractionEventForDOMEvent(this.eventData,r.originalEvent,r);this.processInteractive(a,this.renderer._lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},t.prototype.setCursorMode=function(e){if(e=e||'default',this.currentCursorMode!==e){this.currentCursorMode=e;var t=this.cursorStyles[e];if(t)switch('undefined'==typeof t?'undefined':s(t)){case'string':this.interactionDOMElement.style.cursor=t;break;case'function':t(e);break;case'object':Object.assign(this.interactionDOMElement.style,t);}else'string'!=typeof e||Object.prototype.hasOwnProperty.call(this.cursorStyles,e)||(this.interactionDOMElement.style.cursor=e)}},t.prototype.dispatchEvent=function(e,t,r){r.stopped||(r.currentTarget=e,r.type=t,e.emit(t,r),e[t]&&e[t](r))},t.prototype.mapPositionToPoint=function(e,t,r){var a=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:0,height:0};var n=navigator.isCocoonJS?this.resolution:1/this.resolution;e.x=(t-a.left)*(this.interactionDOMElement.width/a.width)*n,e.y=(r-a.top)*(this.interactionDOMElement.height/a.height)*n},t.prototype.processInteractive=function(e,t,r,a,n){if(!t||!t.visible)return!1;var o=e.data.global;n=t.interactive||n;var s=!1,l=n,d=!0;if(t.hitArea?(a&&(t.worldTransform.applyInverse(o,this._tempPoint),t.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?s=!0:(a=!1,d=!1)),l=!1):t._mask&&a&&!t._mask.containsPoint(o)&&(a=!1,d=!1),d&&t.interactiveChildren&&t.children)for(var u=t.children,p=u.length-1;0<=p;p--){var i=u[p],c=this.processInteractive(e,i,r,a,l);if(c){if(!i.parent)continue;l=!1,c&&(e.target&&(a=!1),s=!0)}}return n&&(a&&!e.target&&!t.hitArea&&t.containsPoint&&t.containsPoint(o)&&(s=!0),t.interactive&&(s&&!e.target&&(e.target=t),r&&r(e,t,!!s))),s},t.prototype.onPointerDown=function(e){if(!(this.supportsTouchEvents&&'touch'===e.pointerType)){var t=this.normalizeToPointerData(e);this.autoPreventDefault&&t[0].isNormalized&&e.preventDefault();for(var r=t.length,a=0;a<r;a++){var n=t[a],o=this.getInteractionDataForPointerId(n),i=this.configureInteractionEventForDOMEvent(this.eventData,n,o);if(i.data.originalEvent=e,this.processInteractive(i,this.renderer._lastObjectRendered,this.processPointerDown,!0),this.emit('pointerdown',i),'touch'===n.pointerType)this.emit('touchstart',i);else if('mouse'===n.pointerType||'pen'===n.pointerType){var s=2===n.button;this.emit(s?'rightdown':'mousedown',this.eventData)}}}},t.prototype.processPointerDown=function(e,t,r){var a=e.data,n=e.data.identifier;if(r)if(t.trackedPointers[n]||(t.trackedPointers[n]=new f.default(n)),this.dispatchEvent(t,'pointerdown',e),'touch'===a.pointerType)this.dispatchEvent(t,'touchstart',e);else if('mouse'===a.pointerType||'pen'===a.pointerType){var o=2===a.button;o?t.trackedPointers[n].rightDown=!0:t.trackedPointers[n].leftDown=!0,this.dispatchEvent(t,o?'rightdown':'mousedown',e)}},t.prototype.onPointerComplete=function(e,t,r){for(var a=this.normalizeToPointerData(e),n=a.length,o=e.target===this.interactionDOMElement?'':'outside',s=0;s<n;s++){var i=a[s],l=this.getInteractionDataForPointerId(i),d=this.configureInteractionEventForDOMEvent(this.eventData,i,l);if(d.data.originalEvent=e,this.processInteractive(d,this.renderer._lastObjectRendered,r,t||!o),this.emit(t?'pointercancel':'pointerup'+o,d),'mouse'===i.pointerType||'pen'===i.pointerType){var u=2===i.button;this.emit(u?'rightup'+o:'mouseup'+o,d)}else'touch'===i.pointerType&&(this.emit(t?'touchcancel':'touchend'+o,d),this.releaseInteractionDataForPointerId(i.pointerId,l))}},t.prototype.onPointerCancel=function(e){this.supportsTouchEvents&&'touch'===e.pointerType||this.onPointerComplete(e,!0,this.processPointerCancel)},t.prototype.processPointerCancel=function(e,t){var r=e.data,a=e.data.identifier;void 0!==t.trackedPointers[a]&&(delete t.trackedPointers[a],this.dispatchEvent(t,'pointercancel',e),'touch'===r.pointerType&&this.dispatchEvent(t,'touchcancel',e))},t.prototype.onPointerUp=function(e){this.supportsTouchEvents&&'touch'===e.pointerType||this.onPointerComplete(e,!1,this.processPointerUp)},t.prototype.processPointerUp=function(e,t,r){var a=e.data,n=e.data.identifier,o=t.trackedPointers[n],i='touch'===a.pointerType,s='mouse'===a.pointerType||'pen'===a.pointerType;if(s){var l=2===a.button,d=f.default.FLAGS,u=l?d.RIGHT_DOWN:d.LEFT_DOWN,p=void 0!==o&&o.flags&u;r?(this.dispatchEvent(t,l?'rightup':'mouseup',e),p&&this.dispatchEvent(t,l?'rightclick':'click',e)):p&&this.dispatchEvent(t,l?'rightupoutside':'mouseupoutside',e),o&&(l?o.rightDown=!1:o.leftDown=!1)}r?(this.dispatchEvent(t,'pointerup',e),i&&this.dispatchEvent(t,'touchend',e),o&&(this.dispatchEvent(t,'pointertap',e),i&&(this.dispatchEvent(t,'tap',e),o.over=!1))):o&&(this.dispatchEvent(t,'pointerupoutside',e),i&&this.dispatchEvent(t,'touchendoutside',e)),o&&o.none&&delete t.trackedPointers[n]},t.prototype.onPointerMove=function(e){if(!(this.supportsTouchEvents&&'touch'===e.pointerType)){var t=this.normalizeToPointerData(e);'mouse'===t[0].pointerType&&(this.didMove=!0,this.cursor=null);for(var r=t.length,a=0;a<r;a++){var n=t[a],o=this.getInteractionDataForPointerId(n),i=this.configureInteractionEventForDOMEvent(this.eventData,n,o);i.data.originalEvent=e;var s='touch'!==n.pointerType||this.moveWhenInside;this.processInteractive(i,this.renderer._lastObjectRendered,this.processPointerMove,s),this.emit('pointermove',i),'touch'===n.pointerType&&this.emit('touchmove',i),('mouse'===n.pointerType||'pen'===n.pointerType)&&this.emit('mousemove',i)}'mouse'===t[0].pointerType&&this.setCursorMode(this.cursor)}},t.prototype.processPointerMove=function(e,t,r){var a=e.data,n='touch'===a.pointerType,o='mouse'===a.pointerType||'pen'===a.pointerType;o&&this.processPointerOverOut(e,t,r),(!this.moveWhenInside||r)&&(this.dispatchEvent(t,'pointermove',e),n&&this.dispatchEvent(t,'touchmove',e),o&&this.dispatchEvent(t,'mousemove',e))},t.prototype.onPointerOut=function(e){if(!(this.supportsTouchEvents&&'touch'===e.pointerType)){var t=this.normalizeToPointerData(e),r=t[0];'mouse'===r.pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var a=this.getInteractionDataForPointerId(r),n=this.configureInteractionEventForDOMEvent(this.eventData,r,a);n.data.originalEvent=r,this.processInteractive(n,this.renderer._lastObjectRendered,this.processPointerOverOut,!1),this.emit('pointerout',n),'mouse'===r.pointerType||'pen'===r.pointerType?this.emit('mouseout',n):this.releaseInteractionDataForPointerId(a.identifier)}},t.prototype.processPointerOverOut=function(e,t,r){var a=e.data,n=e.data.identifier,o='mouse'===a.pointerType||'pen'===a.pointerType,i=t.trackedPointers[n];r&&!i&&(i=t.trackedPointers[n]=new f.default(n)),void 0===i||(r&&this.mouseOverRenderer?(!i.over&&(i.over=!0,this.dispatchEvent(t,'pointerover',e),o&&this.dispatchEvent(t,'mouseover',e)),o&&null===this.cursor&&(this.cursor=t.cursor)):i.over&&(i.over=!1,this.dispatchEvent(t,'pointerout',this.eventData),o&&this.dispatchEvent(t,'mouseout',e),i.none&&delete t.trackedPointers[n]))},t.prototype.onPointerOver=function(e){var t=this.normalizeToPointerData(e),r=t[0],a=this.getInteractionDataForPointerId(r),n=this.configureInteractionEventForDOMEvent(this.eventData,r,a);n.data.originalEvent=r,'mouse'===r.pointerType&&(this.mouseOverRenderer=!0),this.emit('pointerover',n),('mouse'===r.pointerType||'pen'===r.pointerType)&&this.emit('mouseover',n)},t.prototype.getInteractionDataForPointerId=function(e){var t=e.pointerId,r;return t===b||'mouse'===e.pointerType?r=this.mouse:this.activeInteractionData[t]?r=this.activeInteractionData[t]:(r=this.interactionDataPool.pop()||new p.default,r.identifier=t,this.activeInteractionData[t]=r),r._copyEvent(e),r},t.prototype.releaseInteractionDataForPointerId=function(e){var t=this.activeInteractionData[e];t&&(delete this.activeInteractionData[e],t._reset(),this.interactionDataPool.push(t))},t.prototype.configureInteractionEventForDOMEvent=function(e,t,r){return e.data=r,this.mapPositionToPoint(r.global,t.clientX,t.clientY),navigator.isCocoonJS&&'touch'===t.pointerType&&(r.global.x/=this.resolution,r.global.y/=this.resolution),'touch'===t.pointerType&&(t.globalX=r.global.x,t.globalY=r.global.y),r.originalEvent=t,e._reset(),e},t.prototype.normalizeToPointerData=function(e){var t=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(var r=0,a=e.changedTouches.length,n;r<a;r++)n=e.changedTouches[r],'undefined'==typeof n.button&&(n.button=e.touches.length?1:0),'undefined'==typeof n.buttons&&(n.buttons=e.touches.length?1:0),'undefined'==typeof n.isPrimary&&(n.isPrimary=1===e.touches.length&&'touchstart'===e.type),'undefined'==typeof n.width&&(n.width=n.radiusX||1),'undefined'==typeof n.height&&(n.height=n.radiusY||1),'undefined'==typeof n.tiltX&&(n.tiltX=0),'undefined'==typeof n.tiltY&&(n.tiltY=0),'undefined'==typeof n.pointerType&&(n.pointerType='touch'),'undefined'==typeof n.pointerId&&(n.pointerId=n.identifier||0),'undefined'==typeof n.pressure&&(n.pressure=n.force||.5),n.twist=0,n.tangentialPressure=0,'undefined'==typeof n.layerX&&(n.layerX=n.offsetX=n.clientX),'undefined'==typeof n.layerY&&(n.layerY=n.offsetY=n.clientY),n.isNormalized=!0,t.push(n);else!(e instanceof MouseEvent)||this.supportsPointerEvents&&e instanceof window.PointerEvent?t.push(e):('undefined'==typeof e.isPrimary&&(e.isPrimary=!0),'undefined'==typeof e.width&&(e.width=1),'undefined'==typeof e.height&&(e.height=1),'undefined'==typeof e.tiltX&&(e.tiltX=0),'undefined'==typeof e.tiltY&&(e.tiltY=0),'undefined'==typeof e.pointerType&&(e.pointerType='mouse'),'undefined'==typeof e.pointerId&&(e.pointerId=b),'undefined'==typeof e.pressure&&(e.pressure=.5),e.twist=0,e.tangentialPressure=0,e.isNormalized=!0,t.push(e));return t},t.prototype.destroy=function(){this.removeEvents(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this._tempPoint=null},t}(y.default);t.default=v,d.WebGLRenderer.registerPlugin('interaction',v),d.CanvasRenderer.registerPlugin('interaction',v)},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0,t.shared=t.Resource=t.textureParser=t.getResourcePath=t.spritesheetParser=t.parseBitmapFontData=t.bitmapFontParser=t.Loader=void 0;var n=r(90);Object.defineProperty(t,'bitmapFontParser',{enumerable:!0,get:function(){return a(n).default}}),Object.defineProperty(t,'parseBitmapFontData',{enumerable:!0,get:function(){return n.parse}});var o=r(95);Object.defineProperty(t,'spritesheetParser',{enumerable:!0,get:function(){return a(o).default}}),Object.defineProperty(t,'getResourcePath',{enumerable:!0,get:function(){return o.getResourcePath}});var i=r(96);Object.defineProperty(t,'textureParser',{enumerable:!0,get:function(){return a(i).default}});var s=r(19);Object.defineProperty(t,'Resource',{enumerable:!0,get:function(){return s.Resource}});var l=r(77),d=a(l),u=r(189),p=a(u);t.Loader=p.default;var c=new p.default;c.destroy=function(){},t.shared=c;var h=d.default.prototype;h._loader=null,Object.defineProperty(h,'loader',{get:function(){if(!this._loader){var e=this._options.sharedLoader;this._loader=e?c:new p.default}return this._loader}}),h._parentDestroy=h.destroy,h.destroy=function(e){this._loader&&(this._loader.destroy(),this._loader=null),this._parentDestroy(e)}},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var o='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&'function'==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?'symbol':typeof e},i=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),s=r(91),l=a(s),d=r(92),u=a(d),p=r(93),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(p),h=r(45),g=a(h),f=/(#[\w-]+)?$/,m=function(){function e(){var t=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:'',a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:10;n(this,e),this.baseUrl=r,this.progress=0,this.loading=!1,this.defaultQueryString='',this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(e,r){return t._loadResource(e,r)},this._queue=c.queue(this._boundLoadResource,a),this._queue.pause(),this.resources={},this.onProgress=new l.default,this.onError=new l.default,this.onLoad=new l.default,this.onStart=new l.default,this.onComplete=new l.default}return e.prototype.add=function(e,t,r,a){if(Array.isArray(e)){for(var n=0;n<e.length;++n)this.add(e[n]);return this}if('object'===('undefined'==typeof e?'undefined':o(e))&&(a=t||e.callback||e.onComplete,r=e,t=e.url,e=e.name||e.key||e.url),'string'!=typeof t&&(a=r,r=t,t=e),'string'!=typeof t)throw new Error('No url passed to add resource to loader.');if('function'==typeof r&&(a=r,r=null),this.loading&&(!r||!r.parentResource))throw new Error('Cannot add resources while the loader is running.');if(this.resources[e])throw new Error('Resource named "'+e+'" already exists.');if(t=this._prepareUrl(t),this.resources[e]=new g.default(e,t,r),'function'==typeof a&&this.resources[e].onAfterMiddleware.once(a),this.loading){for(var i=r.parentResource,s=[],l=0;l<i.children.length;++l)i.children[l].isComplete||s.push(i.children[l]);var d=i.progressChunk*(s.length+1),u=d/(s.length+2);i.children.push(this.resources[e]),i.progressChunk=u;for(var p=0;p<s.length;++p)s[p].progressChunk=u;this.resources[e].progressChunk=u}return this._queue.push(this.resources[e]),this},e.prototype.pre=function(e){return this._beforeMiddleware.push(e),this},e.prototype.use=function(e){return this._afterMiddleware.push(e),this},e.prototype.reset=function(){for(var e in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var t=this.resources[e];t._onLoadBinding&&t._onLoadBinding.detach(),t.isLoading&&t.abort()}return this.resources={},this},e.prototype.load=function(e){if('function'==typeof e&&this.onComplete.once(e),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var t=this._queue._tasks.length,r=0;r<this._queue._tasks.length;++r)this._queue._tasks[r].data.progressChunk=100/t;this._onStart(),this._queue.resume()}return this},e.prototype._prepareUrl=function(e){var t=(0,u.default)(e,{strictMode:!0}),r;if(r=t.protocol||!t.path||0===e.indexOf('//')?e:this.baseUrl.length&&this.baseUrl.lastIndexOf('/')!==this.baseUrl.length-1&&'/'!==e.charAt(0)?this.baseUrl+'/'+e:this.baseUrl+e,this.defaultQueryString){var a=f.exec(r)[0];r=r.substr(0,r.length-a.length),r+=-1===r.indexOf('?')?'?'+this.defaultQueryString:'&'+this.defaultQueryString,r+=a}return r},e.prototype._loadResource=function(e,t){var r=this;e._dequeue=t,c.eachSeries(this._beforeMiddleware,function(t,a){t.call(r,e,function(){a(e.isComplete?{}:null)})},function(){e.isComplete?r._onLoad(e):(e._onLoadBinding=e.onComplete.once(r._onLoad,r),e.load())},!0)},e.prototype._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},e.prototype._onComplete=function(){this.progress=100,this.loading=!1,this.onComplete.dispatch(this,this.resources)},e.prototype._onLoad=function(e){var t=this;e._onLoadBinding=null,this._resourcesParsing.push(e),e._dequeue(),c.eachSeries(this._afterMiddleware,function(r,a){r.call(t,e,a)},function(){e.onAfterMiddleware.dispatch(e),t.progress+=e.progressChunk,t.onProgress.dispatch(t,e),e.error?t.onError.dispatch(e.error,t,e):t.onLoad.dispatch(t,e),t._resourcesParsing.splice(t._resourcesParsing.indexOf(e),1),t._queue.idle()&&0===t._resourcesParsing.length&&t._onComplete()},!0)},i(e,[{key:'concurrency',get:function(){return this._queue.concurrency},set:function(e){this._queue.concurrency=e}}]),e}();t.default=m},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=r(19),l=a(s),d=r(190),u=r(12),p=a(u),c=r(96),h=a(c),g=r(95),f=a(g),m=r(90),y=a(m),x=function(e){function t(r,a){n(this,t);var s=o(this,e.call(this,r,a));p.default.call(s);for(var l=0;l<t._pixiMiddleware.length;++l)s.use(t._pixiMiddleware[l]());return s.onStart.add(function(e){return s.emit('start',e)}),s.onProgress.add(function(e,t){return s.emit('progress',e,t)}),s.onError.add(function(t,e,a){return s.emit('error',t,e,a)}),s.onLoad.add(function(e,t){return s.emit('load',e,t)}),s.onComplete.add(function(e,t){return s.emit('complete',e,t)}),s}return i(t,e),t.addPixiMiddleware=function(e){t._pixiMiddleware.push(e)},t.prototype.destroy=function(){this.removeAllListeners(),this.reset()},t}(l.default);for(var _ in t.default=x,p.default.prototype)x.prototype[_]=p.default.prototype[_];x._pixiMiddleware=[d.blobMiddlewareFactory,h.default,f.default,y.default];var b=l.default.Resource;b.setExtensionXhrType('fnt',b.XHR_RESPONSE_TYPE.DOCUMENT)},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var n='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&'function'==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?'symbol':typeof e};t.blobMiddlewareFactory=function(){return function(e,t){if(!e.data)return void t();if(e.xhr&&e.xhrType===i.default.XHR_RESPONSE_TYPE.BLOB)if(!window.Blob||'string'==typeof e.data){var r=e.xhr.getResponseHeader('content-type');if(r&&0===r.indexOf('image'))return e.data=new Image,e.data.src='data:'+r+';base64,'+l.default.encodeBinary(e.xhr.responseText),e.type=i.default.TYPE.IMAGE,void(e.data.onload=function(){e.data.onload=null,t()})}else if(0===e.data.type.indexOf('image')){var a=function(){var r=d.createObjectURL(e.data);return e.blob=e.data,e.data=new Image,e.data.src=r,e.type=i.default.TYPE.IMAGE,e.data.onload=function(){d.revokeObjectURL(r),e.data.onload=null,t()},{v:void 0}}();if('object'===('undefined'==typeof a?'undefined':n(a)))return a.v}t()}};var o=r(45),i=a(o),s=r(94),l=a(s),d=window.URL||window.webkitURL},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var n=r(20);Object.defineProperty(t,'Mesh',{enumerable:!0,get:function(){return a(n).default}});var o=r(192);Object.defineProperty(t,'MeshRenderer',{enumerable:!0,get:function(){return a(o).default}});var i=r(193);Object.defineProperty(t,'CanvasMeshRenderer',{enumerable:!0,get:function(){return a(i).default}});var s=r(97);Object.defineProperty(t,'Plane',{enumerable:!0,get:function(){return a(s).default}});var l=r(194);Object.defineProperty(t,'NineSlicePlane',{enumerable:!0,get:function(){return a(l).default}});var d=r(195);Object.defineProperty(t,'Rope',{enumerable:!0,get:function(){return a(d).default}})},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=r(0),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(s),d=r(7),u=a(d),p=r(20),c=a(p),h=r(9),g=l.Matrix.IDENTITY,f=function(e){function t(r){n(this,t);var a=o(this,e.call(this,r));return a.shader=null,a}return i(t,e),t.prototype.onContextChange=function(){var e=this.renderer.gl;this.shader=new l.Shader(e,'attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n','varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n')},t.prototype.render=function(e){var t=this.renderer,r=t.gl,a=e._texture;if(a.valid){var n=e._glDatas[t.CONTEXT_UID];n||(t.bindVao(null),n={shader:this.shader,vertexBuffer:u.default.GLBuffer.createVertexBuffer(r,e.vertices,r.STREAM_DRAW),uvBuffer:u.default.GLBuffer.createVertexBuffer(r,e.uvs,r.STREAM_DRAW),indexBuffer:u.default.GLBuffer.createIndexBuffer(r,e.indices,r.STATIC_DRAW),vao:null,dirty:e.dirty,indexDirty:e.indexDirty},n.vao=new u.default.VertexArrayObject(r).addIndex(n.indexBuffer).addAttribute(n.vertexBuffer,n.shader.attributes.aVertexPosition,r.FLOAT,!1,8,0).addAttribute(n.uvBuffer,n.shader.attributes.aTextureCoord,r.FLOAT,!1,8,0),e._glDatas[t.CONTEXT_UID]=n),t.bindVao(n.vao),e.dirty!==n.dirty&&(n.dirty=e.dirty,n.uvBuffer.upload(e.uvs)),e.indexDirty!==n.indexDirty&&(n.indexDirty=e.indexDirty,n.indexBuffer.upload(e.indices)),n.vertexBuffer.upload(e.vertices),t.bindShader(n.shader),n.shader.uniforms.uSampler=t.bindTexture(a),t.state.setBlendMode(l.utils.correctBlendMode(e.blendMode,a.baseTexture.premultipliedAlpha)),n.shader.uniforms.uTransform&&(e.uploadUvTransform?n.shader.uniforms.uTransform=e._uvTransform.mapCoord.toArray(!0):n.shader.uniforms.uTransform=g.toArray(!0)),n.shader.uniforms.translationMatrix=e.worldTransform.toArray(!0),n.shader.uniforms.uColor=l.utils.premultiplyRgba(e.tintRgb,e.worldAlpha,n.shader.uniforms.uColor,a.baseTexture.premultipliedAlpha);var o=e.drawMode===c.default.DRAW_MODES.TRIANGLE_MESH?r.TRIANGLE_STRIP:r.TRIANGLES;n.vao.draw(o,e.indices.length,0)}},t}(l.ObjectRenderer);t.default=f,l.WebGLRenderer.registerPlugin('mesh',f)},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var n=Math.sqrt,o=Math.abs;t.__esModule=!0;var i=r(0),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(i),l=r(20),d=function(e){return e&&e.__esModule?e:{default:e}}(l),u=function(){function e(t){a(this,e),this.renderer=t}return e.prototype.render=function(e){var t=this.renderer,r=t.context,a=e.worldTransform,n=t.resolution;t.roundPixels?r.setTransform(a.a*n,a.b*n,a.c*n,a.d*n,0|a.tx*n,0|a.ty*n):r.setTransform(a.a*n,a.b*n,a.c*n,a.d*n,a.tx*n,a.ty*n),t.context.globalAlpha=e.worldAlpha,t.setBlendMode(e.blendMode),e.drawMode===d.default.DRAW_MODES.TRIANGLE_MESH?this._renderTriangleMesh(e):this._renderTriangles(e)},e.prototype._renderTriangleMesh=function(e){for(var t=e.vertices.length/2,r=0,a;r<t-2;r++)a=2*r,this._renderDrawTriangle(e,a,a+2,a+4)},e.prototype._renderTriangles=function(e){for(var t=e.indices,r=t.length,a=0;a<r;a+=3){var n=2*t[a],o=2*t[a+1],i=2*t[a+2];this._renderDrawTriangle(e,n,o,i)}},e.prototype._renderDrawTriangle=function(e,t,r,a){var i=this.renderer.context,s=e.uvs,l=e.vertices,d=e._texture;if(d.valid){var u=d.baseTexture,p=u.source,c=u.width,h=u.height,g,f,m,y,x,_;if(e.uploadUvTransform){var b=e._uvTransform.mapCoord;g=(s[t]*b.a+s[t+1]*b.c+b.tx)*u.width,f=(s[r]*b.a+s[r+1]*b.c+b.tx)*u.width,m=(s[a]*b.a+s[a+1]*b.c+b.tx)*u.width,y=(s[t]*b.b+s[t+1]*b.d+b.ty)*u.height,x=(s[r]*b.b+s[r+1]*b.d+b.ty)*u.height,_=(s[a]*b.b+s[a+1]*b.d+b.ty)*u.height}else g=s[t]*u.width,f=s[r]*u.width,m=s[a]*u.width,y=s[t+1]*u.height,x=s[r+1]*u.height,_=s[a+1]*u.height;var T=l[t],v=l[r],E=l[a],S=l[t+1],C=l[r+1],P=l[a+1],w=e.canvasPadding/this.renderer.resolution;if(0<w){var M=w/o(e.worldTransform.a),A=w/o(e.worldTransform.d),I=(T+v+E)/3,R=(S+C+P)/3,D=T-I,O=S-R,k=n(D*D+O*O);T=I+D/k*(k+M),S=R+O/k*(k+A),D=v-I,O=C-R,k=n(D*D+O*O),v=I+D/k*(k+M),C=R+O/k*(k+A),D=E-I,O=P-R,k=n(D*D+O*O),E=I+D/k*(k+M),P=R+O/k*(k+A)}i.save(),i.beginPath(),i.moveTo(T,S),i.lineTo(v,C),i.lineTo(E,P),i.closePath(),i.clip();var L=g*x+y*m+f*_-x*m-y*f-g*_,N=T*x+y*E+v*_-x*E-y*v-T*_,F=g*v+T*m+f*E-v*m-T*f-g*E,B=g*x*E+y*v*m+T*f*_-T*x*m-y*f*E-g*v*_,U=S*x+y*P+C*_-x*P-y*C-S*_,G=g*C+S*m+f*P-C*m-S*f-g*P,V=g*x*P+y*C*m+S*f*_-S*x*m-y*f*P-g*C*_;i.transform(N/L,U/L,F/L,G/L,B/L,V/L),i.drawImage(p,0,0,c*u.resolution,h*u.resolution,0,0,c,h),i.restore(),this.renderer.invalidateBlendMode()}},e.prototype.renderMeshFlat=function(e){var t=this.renderer.context,r=e.vertices,a=r.length/2;t.beginPath();for(var n=1;n<a-2;++n){var o=2*n,i=r[o],s=r[o+1],l=r[o+2],d=r[o+3],u=r[o+4],p=r[o+5];t.moveTo(i,s),t.lineTo(l,d),t.lineTo(u,p)}t.fillStyle='#FF0000',t.fill(),t.closePath()},e.prototype.destroy=function(){this.renderer=null},e}();t.default=u,s.CanvasRenderer.registerPlugin('mesh',u)},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function n(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function o(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var i=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),s=r(97),l=function(e){return e&&e.__esModule?e:{default:e}}(s),d=10,u=function(e){function t(r,o,i,s,l){a(this,t);var u=n(this,e.call(this,r,4,4));return u._origWidth=r.orig.width,u._origHeight=r.orig.height,u._width=u._origWidth,u._height=u._origHeight,u.leftWidth='undefined'==typeof o?d:o,u.rightWidth='undefined'==typeof s?d:s,u.topHeight='undefined'==typeof i?d:i,u.bottomHeight='undefined'==typeof l?d:l,u.refresh(!0),u}return o(t,e),t.prototype.updateHorizontalVertices=function(){var e=this.vertices;e[9]=e[11]=e[13]=e[15]=this._topHeight,e[17]=e[19]=e[21]=e[23]=this._height-this._bottomHeight,e[25]=e[27]=e[29]=e[31]=this._height},t.prototype.updateVerticalVertices=function(){var e=this.vertices;e[2]=e[10]=e[18]=e[26]=this._leftWidth,e[4]=e[12]=e[20]=e[28]=this._width-this._rightWidth,e[6]=e[14]=e[22]=e[30]=this._width},t.prototype._renderCanvas=function(e){var t=e.context;t.globalAlpha=this.worldAlpha,e.setBlendMode(this.blendMode);var r=this.worldTransform,a=e.resolution;e.roundPixels?t.setTransform(r.a*a,r.b*a,r.c*a,r.d*a,0|r.tx*a,0|r.ty*a):t.setTransform(r.a*a,r.b*a,r.c*a,r.d*a,r.tx*a,r.ty*a);var n=this._texture.baseTexture,o=n.source,i=n.width*n.resolution,s=n.height*n.resolution;this.drawSegment(t,o,i,s,0,1,10,11),this.drawSegment(t,o,i,s,2,3,12,13),this.drawSegment(t,o,i,s,4,5,14,15),this.drawSegment(t,o,i,s,8,9,18,19),this.drawSegment(t,o,i,s,10,11,20,21),this.drawSegment(t,o,i,s,12,13,22,23),this.drawSegment(t,o,i,s,16,17,26,27),this.drawSegment(t,o,i,s,18,19,28,29),this.drawSegment(t,o,i,s,20,21,30,31)},t.prototype.drawSegment=function(e,t,r,a,n,o,i,s){var l=this.uvs,d=this.vertices,u=(l[i]-l[n])*r,p=(l[s]-l[o])*a,c=d[i]-d[n],h=d[s]-d[o];1>u&&(u=1),1>p&&(p=1),1>c&&(c=1),1>h&&(h=1),e.drawImage(t,l[n]*r,l[o]*a,u,p,d[n],d[o],c,h)},t.prototype._refresh=function(){e.prototype._refresh.call(this);var t=this.uvs,r=this._texture;this._origWidth=r.orig.width,this._origHeight=r.orig.height;var a=1/this._origWidth,n=1/this._origHeight;t[0]=t[8]=t[16]=t[24]=0,t[1]=t[3]=t[5]=t[7]=0,t[6]=t[14]=t[22]=t[30]=1,t[25]=t[27]=t[29]=t[31]=1,t[2]=t[10]=t[18]=t[26]=a*this._leftWidth,t[4]=t[12]=t[20]=t[28]=1-a*this._rightWidth,t[9]=t[11]=t[13]=t[15]=n*this._topHeight,t[17]=t[19]=t[21]=t[23]=1-n*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.dirty++,this.multiplyUvs()},i(t,[{key:'width',get:function(){return this._width},set:function(e){this._width=e,this._refresh()}},{key:'height',get:function(){return this._height},set:function(e){this._height=e,this._refresh()}},{key:'leftWidth',get:function(){return this._leftWidth},set:function(e){this._leftWidth=e,this._refresh()}},{key:'rightWidth',get:function(){return this._rightWidth},set:function(e){this._rightWidth=e,this._refresh()}},{key:'topHeight',get:function(){return this._topHeight},set:function(e){this._topHeight=e,this._refresh()}},{key:'bottomHeight',get:function(){return this._bottomHeight},set:function(e){this._bottomHeight=e,this._refresh()}}]),t}(l.default);t.default=u},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function n(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function o(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var i=r(20),s=function(e){return e&&e.__esModule?e:{default:e}}(i),l=function(e){function t(r,o){a(this,t);var i=n(this,e.call(this,r));return i.points=o,i.vertices=new Float32Array(4*o.length),i.uvs=new Float32Array(4*o.length),i.colors=new Float32Array(2*o.length),i.indices=new Uint16Array(2*o.length),i.autoUpdate=!0,i.refresh(),i}return o(t,e),t.prototype._refresh=function(){var e=this.points;if(!(1>e.length)&&this._texture._uvs){this.vertices.length/4!==e.length&&(this.vertices=new Float32Array(4*e.length),this.uvs=new Float32Array(4*e.length),this.colors=new Float32Array(2*e.length),this.indices=new Uint16Array(2*e.length));var t=this.uvs,r=this.indices,a=this.colors;t[0]=0,t[1]=0,t[2]=0,t[3]=1,a[0]=1,a[1]=1,r[0]=0,r[1]=1;for(var n=e.length,o=1;o<n;o++){var i=4*o,s=o/(n-1);t[i]=s,t[i+1]=0,t[i+2]=s,t[i+3]=1,i=2*o,a[i]=1,a[i+1]=1,i=2*o,r[i]=i,r[i+1]=i+1}this.dirty++,this.indexDirty++,this.multiplyUvs(),this.refreshVertices()}},t.prototype.refreshVertices=function(){var e=this.points;if(!(1>e.length))for(var t=e[0],r=void 0,a=0,n=0,o=this.vertices,s=e.length,l=0;l<s;l++){var i=e[l],d=4*l;r=l<e.length-1?e[l+1]:i,n=-(r.x-t.x),a=r.y-t.y;var u=10*(1-l/(s-1));1<u&&(u=1);var p=Math.sqrt(a*a+n*n),c=this._texture.height/2;a/=p,n/=p,a*=c,n*=c,o[d]=i.x+a,o[d+1]=i.y+n,o[d+2]=i.x-a,o[d+3]=i.y-n,t=i}},t.prototype.updateTransform=function(){this.autoUpdate&&this.refreshVertices(),this.containerUpdateTransform()},t}(s.default);t.default=l},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var n=r(197);Object.defineProperty(t,'ParticleContainer',{enumerable:!0,get:function(){return a(n).default}});var o=r(198);Object.defineProperty(t,'ParticleRenderer',{enumerable:!0,get:function(){return a(o).default}})},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function n(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function o(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var i=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),s=r(0),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(s),d=r(2),u=function(e){function t(){var r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1500,o=arguments[1],i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:16384,s=!!(3<arguments.length&&void 0!==arguments[3])&&arguments[3];a(this,t);var d=n(this,e.call(this)),u=16384;return i>u&&(i=u),i>r&&(i=r),d._properties=[!1,!0,!1,!1,!1],d._maxSize=r,d._batchSize=i,d._glBuffers={},d._bufferToUpdate=0,d.interactiveChildren=!1,d.blendMode=l.BLEND_MODES.NORMAL,d.autoResize=s,d.roundPixels=!0,d.baseTexture=null,d.setProperties(o),d._tint=0,d.tintRgb=new Float32Array(4),d.tint=16777215,d}return o(t,e),t.prototype.setProperties=function(e){e&&(this._properties[0]='vertices'in e||'scale'in e?!!e.vertices||!!e.scale:this._properties[0],this._properties[1]='position'in e?!!e.position:this._properties[1],this._properties[2]='rotation'in e?!!e.rotation:this._properties[2],this._properties[3]='uvs'in e?!!e.uvs:this._properties[3],this._properties[4]='tint'in e||'alpha'in e?!!e.tint||!!e.alpha:this._properties[4])},t.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},t.prototype.renderWebGL=function(e){var t=this;this.visible&&!(0>=this.worldAlpha)&&this.children.length&&this.renderable&&(!this.baseTexture&&(this.baseTexture=this.children[0]._texture.baseTexture,!this.baseTexture.hasLoaded&&this.baseTexture.once('update',function(){return t.onChildrenChange(0)})),e.setObjectRenderer(e.plugins.particle),e.plugins.particle.render(this))},t.prototype.onChildrenChange=function(e){var t=Math.floor(e/this._batchSize);t<this._bufferToUpdate&&(this._bufferToUpdate=t)},t.prototype.renderCanvas=function(e){if(this.visible&&!(0>=this.worldAlpha)&&this.children.length&&this.renderable){var t=e.context,r=this.worldTransform,a=!0,n=0,o=0,s=0,l=0;e.setBlendMode(this.blendMode),t.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var d=0,i;d<this.children.length;++d)if(i=this.children[d],!!i.visible){var u=i._texture.frame;if(t.globalAlpha=this.worldAlpha*i.alpha,0==i.rotation%(2*Math.PI))a&&(t.setTransform(r.a,r.b,r.c,r.d,r.tx*e.resolution,r.ty*e.resolution),a=!1),n=i.anchor.x*(-u.width*i.scale.x)+i.position.x+.5,o=i.anchor.y*(-u.height*i.scale.y)+i.position.y+.5,s=u.width*i.scale.x,l=u.height*i.scale.y;else{a||(a=!0),i.displayObjectUpdateTransform();var p=i.worldTransform;e.roundPixels?t.setTransform(p.a,p.b,p.c,p.d,0|p.tx*e.resolution,0|p.ty*e.resolution):t.setTransform(p.a,p.b,p.c,p.d,p.tx*e.resolution,p.ty*e.resolution),n=i.anchor.x*-u.width+.5,o=i.anchor.y*-u.height+.5,s=u.width,l=u.height}var c=i._texture.baseTexture.resolution;t.drawImage(i._texture.baseTexture.source,u.x*c,u.y*c,u.width*c,u.height*c,n*e.resolution,o*e.resolution,s*e.resolution,l*e.resolution)}}},t.prototype.destroy=function(t){if(e.prototype.destroy.call(this,t),this._buffers)for(var r=0;r<this._buffers.length;++r)this._buffers[r].destroy();this._properties=null,this._buffers=null},i(t,[{key:'tint',get:function(){return this._tint},set:function(e){this._tint=e,(0,d.hex2rgb)(e,this.tintRgb)}}]),t}(l.Container);t.default=u},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=r(0),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(s),d=r(199),u=a(d),p=r(200),c=a(p),h=r(2),g=function(e){function t(r){n(this,t);var a=o(this,e.call(this,r));return a.shader=null,a.indexBuffer=null,a.properties=null,a.tempMatrix=new l.Matrix,a.CONTEXT_UID=0,a}return i(t,e),t.prototype.onContextChange=function(){var e=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.shader=new u.default(e),this.properties=[{attribute:this.shader.attributes.aVertexPosition,size:2,uploadFunction:this.uploadVertices,offset:0},{attribute:this.shader.attributes.aPositionCoord,size:2,uploadFunction:this.uploadPosition,offset:0},{attribute:this.shader.attributes.aRotation,size:1,uploadFunction:this.uploadRotation,offset:0},{attribute:this.shader.attributes.aTextureCoord,size:2,uploadFunction:this.uploadUvs,offset:0},{attribute:this.shader.attributes.aColor,size:1,unsignedByte:!0,uploadFunction:this.uploadTint,offset:0}]},t.prototype.start=function(){this.renderer.bindShader(this.shader)},t.prototype.render=function(e){var t=e.children,r=e._maxSize,a=e._batchSize,n=this.renderer,o=t.length;if(0!==o){o>r&&(o=r);var s=e._glBuffers[n.CONTEXT_UID];s||(s=e._glBuffers[n.CONTEXT_UID]=this.generateBuffers(e));var d=t[0]._texture.baseTexture;this.renderer.setBlendMode(l.utils.correctBlendMode(e.blendMode,d.premultipliedAlpha));var u=n.gl,p=e.worldTransform.copy(this.tempMatrix);p.prepend(n._activeRenderTarget.projectionMatrix),this.shader.uniforms.projectionMatrix=p.toArray(!0),this.shader.uniforms.uColor=l.utils.premultiplyRgba(e.tintRgb,e.worldAlpha,this.shader.uniforms.uColor,d.premultipliedAlpha),this.shader.uniforms.uSampler=n.bindTexture(d);for(var c=0,i=0,h;c<o;c+=a,i+=1){if(h=o-c,h>a&&(h=a),i>=s.length){if(!e.autoResize)break;s.push(this._generateOneMoreBuffer(e))}var g=s[i];g.uploadDynamic(t,c,h),e._bufferToUpdate===i&&(g.uploadStatic(t,c,h),e._bufferToUpdate=i+1),n.bindVao(g.vao),g.vao.draw(u.TRIANGLES,6*h)}}},t.prototype.generateBuffers=function(e){for(var t=this.renderer.gl,r=[],a=e._maxSize,n=e._batchSize,o=e._properties,s=0;s<a;s+=n)r.push(new c.default(t,this.properties,o,n));return r},t.prototype._generateOneMoreBuffer=function(e){var t=this.renderer.gl,r=e._batchSize,a=e._properties;return new c.default(t,this.properties,a,r)},t.prototype.uploadVertices=function(e,t,r,a,n,o){for(var s=0,l=0,d=0,u=0,p=0;p<r;++p){var i=e[t+p],c=i._texture,h=i.scale.x,g=i.scale.y,f=c.trim,m=c.orig;f?(l=f.x-i.anchor.x*m.width,s=l+f.width,u=f.y-i.anchor.y*m.height,d=u+f.height):(s=m.width*(1-i.anchor.x),l=m.width*-i.anchor.x,d=m.height*(1-i.anchor.y),u=m.height*-i.anchor.y),a[o]=l*h,a[o+1]=u*g,a[o+n]=s*h,a[o+n+1]=u*g,a[o+2*n]=s*h,a[o+2*n+1]=d*g,a[o+3*n]=l*h,a[o+3*n+1]=d*g,o+=4*n}},t.prototype.uploadPosition=function(e,t,r,a,n,o){for(var s=0,i;s<r;s++)i=e[t+s].position,a[o]=i.x,a[o+1]=i.y,a[o+n]=i.x,a[o+n+1]=i.y,a[o+2*n]=i.x,a[o+2*n+1]=i.y,a[o+3*n]=i.x,a[o+3*n+1]=i.y,o+=4*n},t.prototype.uploadRotation=function(e,t,r,a,n,o){for(var s=0,i;s<r;s++)i=e[t+s].rotation,a[o]=i,a[o+n]=i,a[o+2*n]=i,a[o+3*n]=i,o+=4*n},t.prototype.uploadUvs=function(e,t,r,a,n,o){for(var s=0,i;s<r;++s)i=e[t+s]._texture._uvs,i?(a[o]=i.x0,a[o+1]=i.y0,a[o+n]=i.x1,a[o+n+1]=i.y1,a[o+2*n]=i.x2,a[o+2*n+1]=i.y2,a[o+3*n]=i.x3,a[o+3*n+1]=i.y3,o+=4*n):(a[o]=0,a[o+1]=0,a[o+n]=0,a[o+n+1]=0,a[o+2*n]=0,a[o+2*n+1]=0,a[o+3*n]=0,a[o+3*n+1]=0,o+=4*n)},t.prototype.uploadTint=function(e,t,r,a,n,o){for(var s=0;s<r;++s){var i=e[t+s],l=i._texture.baseTexture.premultipliedAlpha,d=i.alpha,u=1>d&&l?(0,h.premultiplyTint)(i._tintRGB,d):i._tintRGB+(255*d<<24);a[o]=u,a[o+n]=u,a[o+2*n]=u,a[o+3*n]=u,o+=4*n}},t.prototype.destroy=function(){this.renderer.gl&&this.renderer.gl.deleteBuffer(this.indexBuffer),e.prototype.destroy.call(this),this.shader.destroy(),this.indices=null,this.tempMatrix=null},t}(l.ObjectRenderer);t.default=g,l.WebGLRenderer.registerPlugin('particle',g)},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function n(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function o(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var i=r(18),s=function(e){return e&&e.__esModule?e:{default:e}}(i),l=function(e){function t(r){return a(this,t),n(this,e.call(this,r,'attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute vec2 aPositionCoord;\nattribute float aRotation;\nuniform mat3 projectionMatrix;\nuniform vec4 uColor;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvoid main(void){\n   float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n   float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n   vec2 v = vec2(x, y);\n   v = v + aPositionCoord;\n   gl_Position = vec4((projectionMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vColor = aColor * uColor;\n}','varying vec2 vTextureCoord;\nvarying vec4 vColor;\nuniform sampler2D uSampler;\nvoid main(void){\n  vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n  gl_FragColor = color;\n}'))}return o(t,e),t}(s.default);t.default=l},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var o=r(7),s=a(o),i=r(44),l=a(i),d=function(){function e(t,r,a,o){n(this,e),this.gl=t,this.size=o,this.dynamicProperties=[],this.staticProperties=[];for(var s=0,i;s<r.length;++s)i=r[s],i={attribute:i.attribute,size:i.size,uploadFunction:i.uploadFunction,unsignedByte:i.unsignedByte,offset:i.offset},a[s]?this.dynamicProperties.push(i):this.staticProperties.push(i);this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.initBuffers()}return e.prototype.initBuffers=function(){var e=this.gl,t=0;this.indices=(0,l.default)(this.size),this.indexBuffer=s.default.GLBuffer.createIndexBuffer(e,this.indices,e.STATIC_DRAW),this.dynamicStride=0;for(var r=0,a;r<this.dynamicProperties.length;++r)a=this.dynamicProperties[r],a.offset=t,t+=a.size,this.dynamicStride+=a.size;var n=new ArrayBuffer(4*(4*(this.size*this.dynamicStride)));this.dynamicData=new Float32Array(n),this.dynamicDataUint32=new Uint32Array(n),this.dynamicBuffer=s.default.GLBuffer.createVertexBuffer(e,n,e.STREAM_DRAW);var o=0;this.staticStride=0;for(var i=0,d;i<this.staticProperties.length;++i)d=this.staticProperties[i],d.offset=o,o+=d.size,this.staticStride+=d.size;var u=new ArrayBuffer(4*(4*(this.size*this.staticStride)));this.staticData=new Float32Array(u),this.staticDataUint32=new Uint32Array(u),this.staticBuffer=s.default.GLBuffer.createVertexBuffer(e,u,e.STATIC_DRAW),this.vao=new s.default.VertexArrayObject(e).addIndex(this.indexBuffer);for(var p=0,c;p<this.dynamicProperties.length;++p)c=this.dynamicProperties[p],c.unsignedByte?this.vao.addAttribute(this.dynamicBuffer,c.attribute,e.UNSIGNED_BYTE,!0,4*this.dynamicStride,4*c.offset):this.vao.addAttribute(this.dynamicBuffer,c.attribute,e.FLOAT,!1,4*this.dynamicStride,4*c.offset);for(var h=0,g;h<this.staticProperties.length;++h)g=this.staticProperties[h],g.unsignedByte?this.vao.addAttribute(this.staticBuffer,g.attribute,e.UNSIGNED_BYTE,!0,4*this.staticStride,4*g.offset):this.vao.addAttribute(this.staticBuffer,g.attribute,e.FLOAT,!1,4*this.staticStride,4*g.offset)},e.prototype.uploadDynamic=function(e,t,r){for(var a=0,n;a<this.dynamicProperties.length;a++)n=this.dynamicProperties[a],n.uploadFunction(e,t,r,n.unsignedByte?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,n.offset);this.dynamicBuffer.upload()},e.prototype.uploadStatic=function(e,t,r){for(var a=0,n;a<this.staticProperties.length;a++)n=this.staticProperties[a],n.uploadFunction(e,t,r,n.unsignedByte?this.staticDataUint32:this.staticData,this.staticStride,n.offset);this.staticBuffer.upload()},e.prototype.destroy=function(){this.dynamicProperties=null,this.dynamicBuffer.destroy(),this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer.destroy(),this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null},e}();t.default=d},function(e,t,r){'use strict';function a(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var n=r(202);Object.defineProperty(t,'webgl',{enumerable:!0,get:function(){return a(n).default}});var o=r(203);Object.defineProperty(t,'canvas',{enumerable:!0,get:function(){return a(o).default}});var i=r(46);Object.defineProperty(t,'BasePrepare',{enumerable:!0,get:function(){return a(i).default}});var s=r(98);Object.defineProperty(t,'CountLimiter',{enumerable:!0,get:function(){return a(s).default}});var l=r(204);Object.defineProperty(t,'TimeLimiter',{enumerable:!0,get:function(){return a(l).default}})},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function n(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function o(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){return!!(t instanceof u.BaseTexture)&&(t._glTextures[e.CONTEXT_UID]||e.textureManager.updateTexture(t),!0)}function s(e,t){return!!(t instanceof u.Graphics)&&((t.dirty||t.clearDirty||!t._webGL[e.plugins.graphics.CONTEXT_UID])&&e.plugins.graphics.updateGraphics(t),!0)}function l(e,t){return!!(e instanceof u.Graphics)&&(t.push(e),!0)}t.__esModule=!0;var d=r(0),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(d),p=r(46),c=function(e){return e&&e.__esModule?e:{default:e}}(p),h=function(e){function t(r){a(this,t);var o=n(this,e.call(this,r));return o.uploadHookHelper=o.renderer,o.registerFindHook(l),o.registerUploadHook(i),o.registerUploadHook(s),o}return o(t,e),t}(c.default);t.default=h,u.WebGLRenderer.registerPlugin('prepare',h)},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function n(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function o(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){if(t instanceof d.BaseTexture){var r=t.source,a=0===r.width?e.canvas.width:s(e.canvas.width,r.width),n=0===r.height?e.canvas.height:s(e.canvas.height,r.height);return e.ctx.drawImage(r,0,0,a,n,0,0,e.canvas.width,e.canvas.height),!0}return!1}var s=Math.min;t.__esModule=!0;var l=r(0),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(l),u=r(46),p=function(e){return e&&e.__esModule?e:{default:e}}(u),c=16,h=function(e){function t(r){a(this,t);var o=n(this,e.call(this,r));return o.uploadHookHelper=o,o.canvas=document.createElement('canvas'),o.canvas.width=c,o.canvas.height=c,o.ctx=o.canvas.getContext('2d'),o.registerUploadHook(i),o}return o(t,e),t.prototype.destroy=function(){e.prototype.destroy.call(this),this.ctx=null,this.canvas=null},t}(p.default);t.default=h,d.CanvasRenderer.registerPlugin('prepare',h)},function(e,t){'use strict';function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}t.__esModule=!0;var a=function(){function e(t){r(this,e),this.maxMilliseconds=t,this.frameStart=0}return e.prototype.beginFrame=function(){this.frameStart=Date.now()},e.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds},e}();t.default=a},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});const a=r(29),n=r(5);t.Audio=class{constructor(){this.buffers={},this.loops={},this.context=new AudioContext,this.sourceNames=['fire-hit','ship-horn','out-of-ammo','background','walker-0','walker-1','walker-2','walker-3','walker-4','walker-5','bouncer-0','bouncer-1','bouncer-2','bouncer-3','bouncer-4','bouncer-5','beat-break','time-fwd']}load(e){return Promise.all(this.sourceNames.map((t)=>new Promise((r)=>{this.context.decodeAudioData(e[t].data).then((e)=>{this.buffers[t]=e,r()})}))).then(()=>{for(let e of['background','time-fwd']){let t=this.context.createBufferSource(),r=this.context.createGain();t.connect(r),t.buffer=this.buffers[e],t.loop=!0,r.gain.value=0,r.connect(this.context.destination),t.start(0),this.loops[e]={source:t,gain:r}}})}getDuration(e){return 1e3*this.buffers[e].duration}play(e,t=1,r=0){if(r){let o=n.Game.screenMan.level;console.assert(!!o),o.animator.add(new a.Animation(r,a.Animation.LINEAR,(r)=>{this.loops[e].gain.gain.value=t*r}))}else this.loops[e].gain.gain.value=t}setVolume(e,t){this.loops[e].gain.gain.value=t}mute(e,t=0){if(t){let r=n.Game.screenMan.level;console.assert(!!r);let o=this.loops[e].gain.gain.value;r.animator.add(new a.Animation(t,a.Animation.LINEAR,(t)=>{this.loops[e].gain.gain.value=o*(1-t)}))}else this.loops[e].gain.gain.value=0}crossfade(e,t,r,o,i){let s=n.Game.screenMan.level;console.assert(!!s),s.animator.add(new a.Animation(i,a.Animation.LINEAR,(a)=>{this.loops[e].gain.gain.value=t+(0-t)*a,this.loops[r].gain.gain.value=0+(o-0)*a}))}playOnce(e,r=1,o){let t=n.Game.screenMan.level;console.assert(!!t);let i=this.context.createBufferSource(),s=this.context.createGain();i.connect(s),i.buffer=this.buffers[e],i.loop=!1;let l=1e3*i.buffer.duration;o?t.animator.add(new a.Animation(l,a.Animation.LINEAR,(e)=>{let a=l*e;s.gain.value=a<o.in?r*a/o.in:a>l-o.out?r*(1-(l-a)/o.out):r})):s.gain.value=r,i.start(0),s.connect(this.context.destination)}playTrack(e,t){let r=this.context.createBufferSource(),a=this.context.createGain();return r.connect(a),r.buffer=this.buffers[e],r.loop=!0,r.start(0),a.gain.value=t,a.connect(this.context.destination),{source:r,gain:a}}}},function(e,t,r){'use strict';var a=Math.abs,n=Math.max;Object.defineProperty(t,'__esModule',{value:!0});const o=r(8),s=r(99),i=r(5);class l{constructor(e){this.eventCallbacks={},this.svg=e,e.style.display='none';let t=this.svg.querySelectorAll('.button');for(let r of t)r.style.cursor='pointer',r.addEventListener('click',()=>{for(let e=0;e<r.classList.length;e++){let t=r.classList.item(e),a=/event-([a-zA-Z0-9-]+)/.exec(t);a&&this.trigger(a[1])}}),r.addEventListener('mouseover',()=>{let e=r.getAttribute('id'),t=this.svg.querySelector(`#${e}-shadow`);t&&(t.style.display='inherit')}),r.addEventListener('mouseout',()=>{let e=r.getAttribute('id'),t=this.svg.querySelector(`#${e}-shadow`);t&&(t.style.display='none')});let r=this.svg.querySelectorAll('.button-shadow');for(let t of r)t.style.display='none'}on(e,t){this.eventCallbacks[e]=t}trigger(e,t){this.eventCallbacks[e]&&this.eventCallbacks[e](t)}show(){this.svg.style.display='inherit'}clear(){this.svg.style.display='none'}handleKeyPress(e){return'Enter'===e.code&&this.trigger('ok'),!0}handleKeyUp(e){return e,!1}handleKeyDown(e){return e,!1}}t.Screen=l;t.ResultScreen=class extends l{constructor(e){super(e),this.valueRange=[],this.origin=[i.Game.docWidth/6,5*i.Game.docHeight/6],this.width=2*i.Game.docWidth/3,this.height=2*i.Game.docHeight/3}populateValues(e,t){let r=this.svg;r.querySelector(`#score-value-text tspan`).textContent=`${t.value}`,r.querySelector(`#diff-text tspan`).textContent=t.difficulty;let a=9-t.nFactoidsSaved;for(let n=0;9>n;n++)n<a&&(r.querySelector(`#gold-present-${n}`).style.display='none');this.score=t;let o=-Infinity,s=Infinity;for(let r=0;r<t.scoreIdx;r++)o=n(o,t.scoreHistory[2*r+1]),s=Math.min(s,t.scoreHistory[2*r+1]);this.valueRange=[s,o],r.querySelectorAll('.plot').forEach((t)=>t.remove()),this.plotScoreHistory(),this.plotWaveHistory(),this.plotTowerHistory(),this.plotEnemyEscape(),this.plotEnemyPathLength()}getTLast(){return this.score.scoreHistory[2*(this.score.scoreIdx-1)]}getTimeScale(){let e=this.score.scoreHistory[2*(this.score.scoreIdx-1)];return this.width/e}getValueScale(){let[e,t]=this.valueRange;return this.height/(t-e)}getSampleGoldNode(e,t){let r=this.svg.querySelector(`#gold-sample`),a=r.cloneNode();return a.style.display='inherit',a.setAttribute('transform',`translate(${e},${t})scale(0.8,0.8)`),a}plotEnemyEscape(){let e=o.createSVGElement('g');e.classList.add('plot');let t=o.createSVGElement('path'),r=this.getTimeScale(),n=this.score.enemyEscapeIdx+1,i=0,s=(n-i)/n,l=this.height/(n-i),u=this.score.scoreHistory[0],p='';for(let n=0,o;n<this.score.enemyEscapeIdx;n++){if(o=this.score.enemyEscapeHistory[n],0<o){let t=this.origin[0]+(o-u)*r-10,a=this.origin[1]-n*s*l-10,i=this.getSampleGoldNode(t,a);e.appendChild(i)}if(o=a(o),0===n)p=`M ${this.origin[0]+(o-u)*r},${this.origin[1]} `;else{let e=this.origin[0]+(o-u)*r,t=this.origin[1]-n*s*l;p+=`V ${t.toFixed(2)} H ${e.toFixed(2)} `}}p+=`H ${this.origin[0]+this.width}`,t.setAttribute('d',p),t.setAttribute('style','fill:none;stroke:#ffff00'),e.appendChild(t),this.svg.appendChild(e)}plotEnemyPathLengthAvg(){let e=o.createSVGElement('path');e.classList.add('plot');let r=this.getTimeScale(),a=this.getValueScale(),[t,i]=this.valueRange,s=this.score.scoreHistory[0],l=-Infinity;for(let e=0;e<this.score.enemyPathIdx;e++)l=n(l,this.score.enemyPathHistory[2*e+1]);let u=(i-t)/l,p=0,c='';for(let e=0;e<this.score.enemyPathIdx;e++){let n=this.score.enemyPathHistory[2*e],t=this.score.enemyPathHistory[2*e+1];p+=t;let o=p/(e+1);0===e&&(c=`M ${this.origin[0]+(n-s)*r},${this.origin[1]}`);let i=this.origin[0]+(n-s)*r,l=this.origin[1]-o*u*a;c+=`L ${i.toFixed(2)},${l.toFixed(2)} `}e.setAttribute('d',c),e.setAttribute('style','fill:none;stroke:#00ff00'),this.svg.appendChild(e)}plotEnemyPathLength(){let e=o.createSVGElement('path');e.classList.add('plot');let r=this.getTimeScale(),a=this.getValueScale(),[t,i]=this.valueRange,s=this.score.scoreHistory[0],l=-Infinity;for(let e=0;e<this.score.enemyPathIdx;e++)l=n(l,this.score.enemyPathHistory[2*e+1]);let u=(i-t)/l,p='';for(let e=0;e<this.score.enemyPathIdx;e++){let n=this.score.enemyPathHistory[2*e],t=this.score.enemyPathHistory[2*e+1];0===e&&(p=`M ${this.origin[0]+(n-s)*r},${this.origin[1]}`);let o=this.origin[0]+(n-s)*r,i=this.origin[1]-t*u*a;p+=`V ${i.toFixed(2)} H ${o.toFixed(2)} `}p+=`H ${this.origin[0]+this.width}`,e.setAttribute('d',p),e.setAttribute('style','fill:none;stroke:#00ff00'),this.svg.appendChild(e)}plotTowerHistory(){let e=this.score,r=e.scoreHistory[0],n=this.getTimeScale(),s=this.getValueScale(),[t,i]=this.valueRange,l=0;for(let t=0;t<e.towerIdx;t++)0<e.towerHistory[t]&&l++;l++;let u=(i-t)/l,p=o.createSVGElement('path');p.classList.add('plot');let c=0,h=`M ${this.origin[0]},${this.origin[1]} `;for(let o=0,i;o<e.towerIdx;o++){i=e.towerHistory[o],0<i?c++:c--,i=a(i);let t=this.origin[0]+(i-r)*n,l=this.origin[1]-c*u*s;h+=`V ${l.toFixed(2)} H ${t.toFixed(2)} `}h+=`H ${this.origin[0]+this.width}`,p.setAttribute('d',h),p.setAttribute('style','fill:none;stroke:#ffffff'),this.svg.appendChild(p)}plotWaveHistory(){let e=this.score,r=0,t=this.origin[0],a=this.getTimeScale(),i=o.createSVGElement('g');i.classList.add('plot');let s=o.createSVGElement('defs');i.appendChild(s);let l=0,d=n.apply(Array,e.waves.map((e)=>e.total));for(let n of e.waves)if(r<e.duration){let e=1e3*n.duration*a,u=o.createSVGElement('linearGradient');u.setAttribute('id',`lgrad${l}`);let p=o.createSVGElement('stop');p.setAttribute('style',`stop-color:#ffffff;stop-opacity:0`),p.setAttribute('offset','0');let c=o.createSVGElement('stop'),h=.5*n.total/d;c.setAttribute('style',`stop-color:#ffffff;stop-opacity:${h}`),c.setAttribute('offset','1'),u.appendChild(p),u.appendChild(c),s.appendChild(u);let g=o.createSVGElement('rect');g.setAttribute('x',`${t}px`),g.setAttribute('y',`${this.origin[1]-this.height}px`),g.setAttribute('width',`${e}px`),g.setAttribute('height',`${this.height}px`),g.setAttribute('style',`fill:url(#lgrad${l})`),i.appendChild(g),t+=e,r+=1e3*n.duration,l++}this.svg.appendChild(i)}plotScoreHistory(){let e=this.score;if(1>e.scoreHistory.length)return;let r=this.getTimeScale(),t=o.createSVGElement('path'),n=e.scoreHistory[0],s=e.scoreHistory[1],[i,l]=this.valueRange;if(i===l)return;let u=this.getValueScale(),p=a(i),c=`M ${this.origin[0]},${this.origin[1]-p*u} `;for(let a=1;a<e.scoreIdx;a++){let o=e.scoreHistory[2*a],t=e.scoreHistory[2*a+1],i=this.origin[0]+(o-n)*r,l=this.origin[1]-(t-s+p)*u;c+=`L ${i.toFixed(2)},${l.toFixed(2)} `}t.classList.add('plot'),t.setAttribute('d',c),t.setAttribute('style',`stroke:#ffffff;fill:none`),this.svg.appendChild(t)}};t.LevelSelectionScreen=class extends l{constructor(e,t,r){super(e),this.nrows=t,this.ncols=r;const a=30;let n=(1920-(r+1)*a)/r,l=(1080-(t+1)*a)/t,d=this.svg.querySelector('#levels-grid'),u=o.createSVGElement('rect');u.setAttribute('x',`0px`),u.setAttribute('y',`0px`),u.setAttribute('width',`1920px`),u.setAttribute('height',`1080px`),u.setAttribute('style','stroke:none;fill:#224865'),d.appendChild(u);for(let u=0;u<t;u++)for(let e=0;e<r;e++){let t=u*r+e,p=a+e*(n+a)+n/2,c=a+u*(l+a)+l/2,h=o.createSVGElement('rect');h.setAttribute('x',`${p-n/2}px`),h.setAttribute('y',`${c-l/2}px`),h.setAttribute('width',`${n}px`),h.setAttribute('height',`${l}px`);let g=t<s.ScreenManager.levelClasses.length?.5:.9,f=t<s.ScreenManager.levelClasses.length?'pointer':'auto';if(h.setAttribute('style',`stroke:none;fill:#000000;fill-opacity:${g};
          cursor:${f}`),h.setAttribute('id',`${t}`),h.addEventListener('click',()=>{i.Game.screenMan.loadLevel(t)}),d.appendChild(h),t<s.ScreenManager.levelClasses.length){let e=o.createSVGElement('text');e.setAttribute('x',`${p}px`),e.setAttribute('y',`${c}px`),e.setAttribute('style',`fill:#ffffff;stroke:none;font-family:"Josefin Sans";
            font-size:42px;fill-opacity:1.0`);let r=o.createSVGElement('tspan');r.setAttribute('x',`${p}px`),r.setAttribute('y',`${c}px`),r.textContent=`${t+1}`,e.appendChild(r),d.appendChild(e)}}}handleKeyPress(e){throw e,new Error('Method not implemented.')}}},function(e,t,r){'use strict';var a=Math.PI;Object.defineProperty(t,'__esModule',{value:!0});const n=r(22),o=r(13),i=r(5);class s extends n.Level{constructor(){super(0),this.id='1'}load(e='normal'){super.loadRes(),this.addFloorPlan('M 0,400 H 400 L 600,200 H 900 L 1100,0 h 820 V 1080 H 700 v -80 L 900,800 800,700 H 0 Z',2246757,20,100),this.setupCitySlabs([{width:1280,height:1080,from:[0,0],to:[0,0],period:1e10,color:1057327,shadowoffset:[10,10]},{width:800,height:800,from:[-500,-850],to:[500,i.Game.docHeight+100],period:6e4,color:2770781,shadowoffset:[10,10]},{width:800,height:800,from:[-500,i.Game.docHeight+100],to:[500,-850],period:3e4,color:1057327,shadowoffset:[10,10]},{width:300,height:300,from:[200,-350],to:[200,i.Game.docHeight+100],period:24e3,color:2770781,shadowoffset:[10,10]}]),this.setupCity('city1'),this.definePavilion([7,14]),this.difficulty=e,'easy'===e?(super.addShip([3,5],[{type:'walker',total:16,duration:32,resrate:5},{type:'walker',total:32,duration:32,resrate:3},{type:'walker',total:32,duration:16,resrate:2},{type:'walker',total:16,duration:16,resrate:2},{type:'walker',total:16,duration:8,resrate:1},{type:'walker',total:32,duration:8,resrate:1}],{from:{pos:[0,-200],rot:135*a/180},to:{pos:[500,300],rot:135*a/180},duration:12e3}),this.productionRate=4,this.economy.produce(2*o.spec.towers.gun.construction.cost)):'normal'===e?(super.addShip([3,5],[{type:'walker',total:16,duration:32,resrate:5},{type:'walker',total:16,duration:32,resrate:3},{type:'walker',total:32,duration:16,resrate:2},{type:'walker',total:32,duration:32,resrate:2},{type:'walker',total:32,duration:32,resrate:2},{type:'walker',total:32,duration:16,resrate:1},{type:'walker',total:32,duration:16,resrate:1},{type:'walker',total:64,duration:16,resrate:1}],{from:{pos:[0,-200],rot:135*a/180},to:{pos:[500,300],rot:135*a/180},duration:12e3}),this.productionRate=4):'hard'===e&&(super.addShip([3,5],[{type:'walker',total:32,duration:32,resrate:6.5},{type:'walker',total:32,duration:32,resrate:3.5},{type:'walker',total:64,duration:16,resrate:2.5},{type:'walker',total:64,duration:32,resrate:2.5},{type:'walker',total:64,duration:32,resrate:2.5},{type:'walker',total:64,duration:16,resrate:2},{type:'walker',total:64,duration:16,resrate:2},{type:'walker',total:64,duration:8,resrate:2},{type:'walker',total:64,duration:8,resrate:1},{type:'walker',total:64,duration:8,resrate:1},{type:'walker',total:64,duration:8,resrate:1},{type:'walker',total:64,duration:8,resrate:.5},{type:'walker',total:128,duration:16,resrate:0}],{from:{pos:[0,-200],rot:135*a/180},to:{pos:[500,300],rot:135*a/180},duration:12e3}),this.productionRate=2.2)}}t.Level1=s},function(e,t,r){'use strict';var a=Math.abs,n=Math.max,o=Math.PI;Object.defineProperty(t,'__esModule',{value:!0});const i=r(6);r(23);const s=r(101),l=r(100),d=r(8),u=r(10),p=r(5),c=r(13);class h extends s.Actor{constructor(e,t,r,a){super(a),this.type=e,this.spine=t,this.cell=r,this.ghostsInRange=[],this.creationInstant=0,this.activePeriod=0,this.lastActivityBeginInstant=NaN,this.laserEngaged=!1,this.uid=a.genTowerId(),this.container.addChild(t),t.state.timeScale=4,t.scale.set(a.terra.cellsize/100),'gun'===e?this.spec=c.spec.towers.gun:'canon'===e?this.spec=c.spec.towers.canon:'laser'===e?this.spec=c.spec.towers.laser:'block'===e?this.spec=c.spec.towers.block:(this.spec=c.spec.towers.gun,u.Log.assert(!1,'Invalid gun type'));let o=n(this.spine.width,this.spine.height);this.radius=o/2;let s=new i.Graphics;s.beginFill(16777215,.1),s.drawCircle(0,0,this.spec.range),s.endFill(),s.visible=!1,this.underContainer.addChild(s),this.rangeGraphic=s;let l=this.spine.skeleton.findSlot('ammo');if(l&&(l.currentSprite.visible=!1),'laser'===this.type){const e=8;let t=new i.Graphics;t.beginFill(16769081,1),t.drawRect(0,-e/2,1,e),t.endFill(),this.laserGraphic=t}this.fireTimer=new d.Timer(1e3/this.spec.rate,()=>{if(this.track)this.fire(this.track);else if(this.aim)this.fireTimer.freezeTrigger();else{let e=this.pickTarget();e?this.setFiringTarget(e):this.fireTimer.freezeTrigger()}}),this.level.supportsWebGL()&&(this.blurFilter=new i.filters.BlurFilter,this.spine.filters=[this.blurFilter])}setAnimation(e,t=!0){this.spine.state.setAnimation(0,e,t)}static getBestAmmoDamageRate(e){return'gun'===e?c.spec.towers.gun.rate*n(c.spec.towers.gun.ammo.damage.health,c.spec.towers.gun.ammo.damage.shield):'canon'===e?c.spec.towers.canon.rate*n(c.spec.towers.canon.ammo.damage.health,c.spec.towers.canon.ammo.damage.shield):'laser'===e?c.spec.towers.laser.rate*n(c.spec.towers.laser.ammo.damage.health,c.spec.towers.laser.ammo.damage.shield):(u.Log.assert(!1,'Unknown type '+e),0)}static getTowerConstructionCost(e){return'gun'===e?c.spec.towers.gun.construction.cost:'canon'===e?c.spec.towers.canon.construction.cost:'laser'===e?c.spec.towers.laser.construction.cost:(u.Log.assert(!1,'Unknown type '+e),0)}pickTarget(){let e=null;for(let t of this.ghostsInRange)if(e=t,('canon'===this.type||'laser'===this.type)&&e.hasfactoid)break;return e}toString(){return`T(${this.type}-${super.toString()})`}setConstructionProgress(e){this.level.supportsWebGL()?this.blurFilter.blur=10*(1-e):this.spine.alpha=.2+.8*e,1<=e&&(this.creationInstant=this.level.getGameTime())}fire(e){if(!this.level.economy.canAfford(this.spec.ammo.cost))this.level.resourceMeter.flashOutOfResources(),p.Game.audio.playOnce('out-of-ammo');else if(this.level.economy.consume(this.spec.ammo.cost),this.level.score.countGunFire(),'laser'===this.type)this.laserEngaged||this.spine.state.setAnimation(0,'engage',!1),this.laserEngaged=!0,this.level.startLaserBeam(this),this.level.effectLaserDamage(this,e);else{let t=this.spine.state.setAnimation(0,'fire',!1);t.listener={event:(t,r)=>{t,'launch-ammo'===r.data.name&&(this.level.fireProjectile(this,e),p.Game.audio.playOnce('fire-hit',this.level.getFireVolume()))}}}}tick(e,t){if(this.aim){let e=this.spec.angspeed*t/1e3,{diff:r,sense:a}=this.angularDistanceToAim(this.aim);if(r<20*o/180)this.aimSetCallback&&(this.aimSetCallback(this.aim),this.aimSetCallback=void 0),this.aim=void 0;else{let t=a?1:-1;this.rotation+=t*e}}else this.track&&(this.rotation=this.getRotationToPointAtGhost(this.track));this.fireTimer.tick(e)}onVisibilityStart(e){this.ghostsInRange.push(e);let t=this.pickTarget();u.Log.assert(!!t,'At least latest ghost should be target');let r=this.aim||this.track;r?('canon'===this.type||'laser'===this.type)&&!r.hasfactoid&&t.hasfactoid&&this.setFiringTarget(t):this.setFiringTarget(t)}setFiringTarget(e){this.beginActivePeriod(),this.aimAtGhost(e).then((e)=>{if(e.isdead){let e=this.pickTarget();e?this.setFiringTarget(e):this.endActivePeriod()}else this.trackGhost(e)})}beginActivePeriod(){isNaN(this.lastActivityBeginInstant)&&(this.lastActivityBeginInstant=this.level.getGameTime())}endActivePeriod(){let e=this.level.getGameTime();this.activePeriod+=e-this.lastActivityBeginInstant,this.lastActivityBeginInstant=NaN}getEfficiency(){let e=this.level.getGameTime(),t=e-this.creationInstant,r=0;return isNaN(this.lastActivityBeginInstant)||(r=e-this.lastActivityBeginInstant),(this.activePeriod+r)/t}getDamageInflictedPerSecondAt(e){let t=this.spec.range,r=this.spec.ammo.damage.health+this.spec.ammo.damage.shield,a=this.spec.rate;return d.vec2.distSq(this.position,e)<t*t?a*r:0}onVisibilityEnd(e){e instanceof l.Ghost&&this.removeGhost(e)}removeGhost(e){let t=!1,r=this.ghostsInRange.indexOf(e);if(0<=r&&this.ghostsInRange.splice(r,1),this.aim===e&&(this.aim=void 0,this.aimSetCallback=void 0,t=!0),this.track===e&&(this.track=void 0,t=!0),t){let e=this.pickTarget();e?this.setFiringTarget(e):this.endActivePeriod()}'laser'===this.type&&this.laserEngaged&&(this.level.stopLaserBeam(this),this.spine.state.setAnimation(0,'disengage',!1))}getRotationToPointAtGhost(e){let t=d.vec2.dir(this.position,e.position),r=0<=d.vec2.cross(t,[0,-1])?-1:1,a=Math.acos(d.vec2.dot(t,[0,-1]));return r*a}angularDistanceToAim(e){let t=this.rotation,r=this.getRotationToPointAtGhost(e),n=r-t,i=a(d.wrapAngle(n))<o;return{diff:a(d.wrapAngle(n)),sense:i}}trackGhost(e){this.spine.alpha=1,this.fireTimer.unfreezeTrigger(),this.track=e}aimAtGhost(e){return new Promise((t)=>{this.aim=e,this.aimSetCallback=t})}getAmmoSprite(){let e=this.spine.skeleton.findSlot('ammo');return new i.Sprite(e.currentSprite.texture)}getNeighbors(){let[e,t]=this.cell,r=[],a=[];for(let a of[[e-1,t],[e+1,t],[e,t-1],[e,t+1]])if(this.level.terra.isValidCell(a)){let e=this.level.getTowerAt(a);e&&r.push(e)}for(let r of[[e-1,t-1],[e-1,t+1],[e+1,t-1],[e+1,t+1]])if(this.level.terra.isValidCell(r)){let e=this.level.getTowerAt(r);e&&a.push(e)}return[r,a]}}t.Tower=h},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});const a=r(30);t.CollisionSystem=class{constructor(e,t,r){this.level=r,this.grid=new a.GridBit(e,t),this.grid.fill(0)}analyse(){for(let e=0;e<this.level.ghosts.length;e++){let t=this.level.ghosts[e],[r,a]=t.position;for(let e=0;e<this.level.towers.length;e++){let n=this.level.towers[e],[o,i]=n.position,s=o-r,l=i-a,d=this.grid.get(t.uid,n.uid);s*s+l*l<n.spec.range*n.spec.range?!d&&(n.onVisibilityStart(t),t.onVisibilityEnd(n),this.grid.set(t.uid,n.uid,!0)):d&&(n.onVisibilityEnd(t),t.onVisibilityEnd(n),this.grid.set(t.uid,n.uid,!1))}}}}},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0});t.Animator=class{constructor(){this._queue=[]}add(e){this._queue.push(e)}tick(e){for(let t=0,r;t<this._queue.length;t++)r=this._queue[t],r.isStarted()||r.start(e),r.eval(e),r.isPastEnd(e)&&(r.end(),this._queue.splice(t,1),t--)}}},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0});t.Economy=class{constructor(e){this.level=e,this.resources=0}updateHUD(){this.level.resourceMeter.update(this.resources)}produce(e){this.resources+=e,this.updateHUD()}consume(e){console.assert(e<=this.resources),this.resources-=e,this.updateHUD()}canAfford(e){return this.resources>=e}}},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});const a=r(6);r(23);const n=r(22),o=r(8);class i extends a.Container{constructor(e,t){super(),this.entryCell=e,this.level=t,this.pathlanes=[],this.nfactoids=9,this.stolen=0,this.goldSprites=[];let[r,i]=e;this.gridpath=[[r,i],[r,i+1],[r,i+2],[r+1,i+2],[r+2,i+2],[r+2,i+1],[r+2,i],[r+1,i],[r,i]];let s=this.level.terra.getCellCenter(e),l=this.level.terra.cellsize;s=o.vec2.sub(s,[l/2,l/2]),this.position.set(s[0],s[1]);for(let r=1;r<this.gridpath.length-1;r++)this.level.terra.setWallAt(this.gridpath[r]);this.level.terra.setWallAt([r+1,i+1]);let d=this.gridpath.map((e)=>t.terra.getCellCenter(e));this.pathlanes.push(t.laneMaker(d.slice(),0)),this.pathlanes.push(t.laneMaker(d.slice(),1)),this.pathlanes.push(t.laneMaker(d.slice(),2)),this.pathlanes.forEach((e)=>n.Level.smoothenPath(e)),this.graphics=new a.Graphics,this.addChild(this.graphics),this.draw()}nextCell(e){let[t,r]=e,[a,n]=this.entryCell;if(t===a&&r===n)return[a,n+1];if(t===a&&r===n+1)return[a,n+2];if(t===a&&r===n+2)return[a+1,n+2];if(t===a+1&&r===n+2)return[a+2,n+2];if(t===a+2&&r===n+2)return[a+2,n+1];if(t===a+2&&r===n+1)return[a+2,n];if(t===a+2&&r===n)return[a+1,n];if(t===a+1&&r===n)return[a,n];throw new Error('Invalid pavilion cell')}occupiesCell(e){let[t,r]=e,[a,n]=this.entryCell;return 0<=t-a&&2>=t-a&&0<=r-n&&2>=r-n}draw(){let e=this.level.terra.cellsize,t=this.graphics;t.clear(),t.lineStyle(0),t.beginFill(0,.4),t.drawRect(0,0,3*e,3*e),t.endFill(),this.refreshGold()}refreshGold(){let e=this.level.terra.cellsize;for(let e of this.goldSprites)this.removeChild(e);this.goldSprites=[];let t=this.level.terra.cellsize/100,r=Math.sqrt(this.nfactoids);console.assert(Number.isInteger(r));let n=e/(2*r+1),o=this.stolen;for(let s=0;s<r;s++)for(let i=0;i<r;i++){let r;0<o?(r=a.Sprite.from('gold-not-in-mine'),o--):r=a.Sprite.from('gold-in-mine'),r.scale.set(t),r.position.set(e+n+2*s*n,e+n+2*i*n),this.goldSprites.push(r),this.addChild(r)}}getFactoidGraphics(){let e=this.level.terra.cellsize/100,t=a.Sprite.from('gold-in-mine');return t.scale.set(e),t}redraw(){this.graphics.clear(),this.draw()}stealFactoid(){return!(this.stolen>=this.nfactoids)&&(this.stolen++,this.redraw(),!0)}returnFactoid(){this.stolen--,console.assert(0<=this.stolen),this.redraw()}getEntranceCell(){return this.entryCell}getExitCell(){return this.entryCell}getCenter(){let[e,t]=this.entryCell;return this.level.terra.getCellCenter(e+1,t+1)}}t.Pavilion=i},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});const a=r(6),n=r(13),o=30;class i extends a.Container{constructor(e){super(),this.level=e,this.lastFullUnits=0,this.scaleGraphics=new a.Graphics,this.drawScale(0),this.addChild(this.scaleGraphics)}update(e){let t=n.spec.towers.gun.construction.cost,r=Math.floor(e/t);this.scaleGraphics.clear(),this.drawScale(e%t/t),this.drawFullUnits(r),this.lastFullUnits=r}flashOutOfResources(){this.drawEmpty()}drawEmpty(){let e=this.scaleGraphics;e.clear();const t=4*o;e.lineStyle(0),e.beginFill(16777215,.3),e.moveTo(o,o),e.lineTo(o+t,o),e.lineTo(o+t+o,2*o),e.lineTo(2*o,2*o),e.lineTo(o,o),e.endFill()}drawScale(e){let t=this.scaleGraphics;const r=4*o;t.lineStyle(0),t.beginFill(0,.3),t.moveTo(o,o),t.lineTo(o+r,o),t.lineTo(o+r+o,2*o),t.lineTo(2*o,2*o),t.lineTo(o,o),t.endFill();let a=r*(1-e);t.beginFill(16777215,1),t.moveTo(o+a,o),t.lineTo(o+r,o),t.lineTo(o+r+o,2*o),t.lineTo(2*o+a,2*o),t.lineTo(o+a,o),t.endFill()}drawFullUnits(e){let t=this.scaleGraphics,r=o/3;t.lineStyle(0);for(let a=0;a<e;a++){if(t.beginFill(16777215,1),5===a){let e=7*o-r-(o+2*a*r);t.drawRect(e+r/3,2*o+r,r/3,r),t.drawRect(e,2*o+r+r/3,r,r/3);break}else{let e=7*o-r-(o+2*a*r);t.drawRect(e,2*o+r,r,r)}t.endFill()}}}t.ResourceMeter=i},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});const a=r(6),n=r(5),o=5,i=90,s=20;class l extends a.Container{constructor(e,t){super(),this.level=t,this.barWidth=e.length*(i+2*o),this.barHeight=i+2*o;let r=new a.Graphics;r.beginFill(0,.6),r.drawRect(0,0,this.barWidth,this.barHeight),r.endFill(),this.addChild(r);let n=0;this.legends=new a.Sprite(a.Texture.from('tower-chart-legends')),this.charts={gun:new a.Sprite(a.Texture.from('gun-chart')),canon:new a.Sprite(a.Texture.from('canon-chart')),laser:new a.Sprite(a.Texture.from('laser-chart')),block:new a.Sprite(a.Texture.from('block-chart'))},this.icons={gun:new a.Sprite(a.Texture.from('gun-icon')),canon:new a.Sprite(a.Texture.from('canon-icon')),laser:new a.Sprite(a.Texture.from('laser-icon')),block:new a.Sprite(a.Texture.from('block-icon'))},this.keyIcons={gun:new a.Sprite(a.Texture.from('keyQ')),canon:new a.Sprite(a.Texture.from('keyW')),laser:new a.Sprite(a.Texture.from('keyE')),block:new a.Sprite(a.Texture.from('keyA'))},this.detailWidth=3*s+this.charts.gun.width+this.legends.width,this.detailHeight=3*s+this.charts.gun.height+this.keyIcons.gun.width;let l=(e)=>{let t=this.icons[e];t.interactive=!0,t.buttonMode=!0;let r=t.width,a=t.height,s=o+n*(i+o)+(i-r)/2;t.position.set(s,o+(i-a)/2),t.on('mouseup',(t)=>{this.level.addTower(e),this.hide(),t.stopPropagation()}),t.on('mouseover',(t)=>{this.clearDetail(),this.showDetail(e),t.stopPropagation()}),this.addChild(t)};0<=e.indexOf('gun')&&(l('gun'),n++),0<=e.indexOf('canon')&&(l('canon'),n++),0<=e.indexOf('laser')&&(l('laser'),n++),0<=e.indexOf('block')&&(l('block'),n++)}show(e){let t=this.level.terra.cellsize,r;r=e[1]>this.barHeight?e[1]-this.barHeight-t/2:e[1]+t/2;let a=e[0]-this.barWidth/2;a=Math.max(a,0),a=Math.min(a,n.Game.docWidth-this.barWidth),this.position.set(a,r),this.clearDetail(),this.visible=!0}showDetail(e){let t=this.barWidth/2-this.detailWidth/2,r=this.barHeight,o=this.keyIcons[e].height,i=this.charts[e].height,{x:l,y:d}=this.position,u,p,c;d>this.detailHeight?(u=-i-2*s,p=-this.detailHeight+s,c=-this.detailHeight):(u=this.barHeight+s,p=this.barHeight+this.detailHeight-o-s,c=r),0>l+t&&(t=-l),l+t>n.Game.docWidth-this.detailWidth&&(t=n.Game.docWidth-this.detailWidth-l),this.detailBG=new a.Graphics,this.detailBG.beginFill(0,.6),this.detailBG.drawRect(0,0,this.detailWidth,this.detailHeight),this.detailBG.endFill(),this.detailBG.position.set(t,c),this.addChild(this.detailBG),this.legends.position.set(t+s,u),this.addChild(this.legends),this.charts[e].position.set(t+this.detailWidth/2+s,u),this.addChild(this.charts[e]),this.keyIcons[e].position.set(t+s,p),this.addChild(this.keyIcons[e])}clearDetail(){for(let e in this.detailBG&&0<=this.children.indexOf(this.detailBG)&&this.removeChild(this.detailBG),0<=this.children.indexOf(this.legends)&&this.removeChild(this.legends),this.charts)0<=this.children.indexOf(this.charts[e])&&this.removeChild(this.charts[e]);for(let e in this.keyIcons)0<=this.children.indexOf(this.keyIcons[e])&&this.removeChild(this.keyIcons[e])}hide(){this.clearDetail(),this.visible=!1}}t.TowerMenuContextual=l;class d extends a.Container{constructor(e,t){super(),this.level=t,this.barWidth=i+2*o,this.barHeight=e.length*(i+2*o);let r=new a.Graphics;r.beginFill(0,.6),r.drawRect(0,0,this.barWidth,this.barHeight),r.endFill(),this.addChild(r);let n=0;this.legends=new a.Sprite(a.Texture.from('tower-chart-legends')),this.charts={gun:new a.Sprite(a.Texture.from('gun-chart')),canon:new a.Sprite(a.Texture.from('canon-chart')),laser:new a.Sprite(a.Texture.from('laser-chart')),block:new a.Sprite(a.Texture.from('block-chart'))},this.icons={gun:new a.Sprite(a.Texture.from('gun-icon')),canon:new a.Sprite(a.Texture.from('canon-icon')),laser:new a.Sprite(a.Texture.from('laser-icon')),block:new a.Sprite(a.Texture.from('block-icon'))},this.keyIcons={gun:new a.Sprite(a.Texture.from('keyQ')),canon:new a.Sprite(a.Texture.from('keyW')),laser:new a.Sprite(a.Texture.from('keyE')),block:new a.Sprite(a.Texture.from('keyA'))},this.detailWidth=3*s+this.charts.gun.width+this.legends.width,this.detailHeight=3*s+this.charts.gun.height+this.keyIcons.gun.height,this.detailBG=new a.Graphics,this.detailBG.beginFill(0,.6),this.detailBG.drawRect(0,0,this.detailWidth,this.detailHeight),this.detailBG.endFill();let l=(e)=>{let t=this.icons[e];t.interactive=!0,t.buttonMode=!0;let r=t.width,a=t.height,s=o+n*(i+o)+(i-a)/2;t.position.set(o+(i-r)/2,s),t.on('mouseup',(t)=>{this.level.addTower(e),this.hide(),t.stopPropagation()}),t.on('mouseover',(t)=>{this.clearDetail(),this.showDetail(e),t.stopPropagation()}),this.addChild(t)};0<=e.indexOf('gun')&&(l('gun'),n++),0<=e.indexOf('canon')&&(l('canon'),n++),0<=e.indexOf('laser')&&(l('laser'),n++),0<=e.indexOf('block')&&(l('block'),n++)}show(){this.position.set(10,10),this.clearDetail(),this.visible=!0}hide(){this.clearDetail(),this.visible=!1}showDetail(e){let t=i+2*o,r=0,a=this.keyIcons[e].width,n=this.keyIcons[e].height;this.detailBG.position.set(t,r),this.addChild(this.detailBG),this.legends.position.set(t+s,r+s),this.addChild(this.legends),this.charts[e].position.set(t+this.legends.width+2*s,r+s),this.addChild(this.charts[e]),this.keyIcons[e].position.set(t+this.detailWidth-a-s,r+this.detailHeight-n-s),this.addChild(this.keyIcons[e])}clearDetail(){for(let e in 0<=this.children.indexOf(this.detailBG)&&this.removeChild(this.detailBG),0<=this.children.indexOf(this.legends)&&this.removeChild(this.legends),this.charts)0<=this.children.indexOf(this.charts[e])&&this.removeChild(this.charts[e]);for(let e in this.keyIcons)0<=this.children.indexOf(this.keyIcons[e])&&this.removeChild(this.keyIcons[e])}}t.TowerMenu=d},function(e,t,r){'use strict';var n=Math.abs,a=Math.PI;Object.defineProperty(t,'__esModule',{value:!0});const o=r(6),s=r(8),l=r(102);class i extends l.VectorGraphics{constructor(e,t,r,a){super(),this.lineStyle(a,0,.4),this.drawVectorShape(e,[]);for(let n of t)this.drawVectorShape(n,[]);this.lineStyle(0),this.beginFill(r,1),this.drawVectorShape(e,t),this.endFill();let n=new l.VectorGraphics;n.lineStyle(0),n.beginFill(16711935,1),n.drawVectorShape(e,t),n.endFill(),this.fmask=n}}class d extends o.Container{constructor(e,t=16711680,r){if(super(),this.holes=[],Array.isArray(e)){this.polygon=l.VectorGraphics.parsePathData(e[0]);for(let t=1;t<e.length;t++)this.holes.push(l.VectorGraphics.parsePathData(e[t]))}else this.polygon=l.VectorGraphics.parsePathData(e);this.floor=new i(this.polygon,this.holes,t,r),this.addChild(this.floor)}isPointOnFloor(e){let t=this.isPointInsidePolygon(e,this.polygon);if(this.holes)for(let r of this.holes)t=t&&!this.isPointInsidePolygon(e,r);return t}isPointInsidePolygon(e,t){let r=(e,t)=>{let[r,a]=e,o=s.vec2.cross(s.vec2.sub(r,a),s.vec2.sub(t,a));return 1e-4>n(o)?0:o/n(o)};const o=1,l=3;let a=(e,t)=>{let[n,a]=e,[i,s]=t,d=r(e,i),u=r(e,s),p=r(t,n),c=r(t,a);return d&&u&&p&&c&&d!==u&&p!==c?o:d||u||p||c?2:l},d=[[-100,e[1]],e],u=0;for(let n=0;n<t.length;n++){let e=n,i=n<t.length-1?n+1:0,s=[t[e],t[i]],p=a(d,s);if(p===o)u++;else if(p===l){let e=0===n?t.length-1:n-1,a=n<t.length-2?n+2:0,o=r(s,t[e]),i=r(s,t[a]);console.assert(!!(o&&i)),o!==i&&u++}}return 0!=u%2}isPointOnFloor_Angle(e){let t=0;for(let r=0;r<this.polygon.length;r++){let o=r,i=r>=this.polygon.length-1?0:r+1,l=this.polygon[o],d=this.polygon[i],u=s.vec2.dirToAngle(s.vec2.dir(e,l)),p=s.vec2.dirToAngle(s.vec2.dir(e,d)),c=0;0<=u&&0<=p?c=p-u:0>=u&&0>=p?c=p-u:0>=u&&0<=p?c=a-n(u)+a-n(p):0<=u&&0>=p?c=-(n(u)+n(p)):console.assert(!1),t+=c}return .01<n(t)}}t.FloorPlan=d},function(e,t,r){'use strict';function a(e){return 1e3*(e.duration/e.total)}var n=Math.max;Object.defineProperty(t,'__esModule',{value:!0});const o=r(6),i=r(8),s=r(29),l=r(5),d=r(10),u=r(102),p=r(21);class c extends o.spine.Spine{audioPause(){}audioResume(){}audioReset(){}}t.ShipOld=c;let h=3289650;class g extends o.Container{constructor(e,t){super(),this.wave=e,this.ship=t,this.height_=36,this.seatWidth=40,this.width_=t.frontSlotWidth,this.rectBase=new u.VectorGraphics().makeRectangle(this.width_,this.height_,16777215,1),this.rectBase.position.x=-this.width_/2,this.addChild(this.rectBase);let r=.8*(this.width_-this.seatWidth),a=this.seatWidth+r*(e.total/t.maxWaveTotal),n=.8*this.height_*(e.duration/t.maxWaveDuration);this.rectContent=new u.VectorGraphics().makeRectangle(a,n,h,1),this.rectContent.position.x=-a/2,this.rectContent.position.y=(this.height_-n)/2,this.addChild(this.rectContent),this.rectSeat=new u.VectorGraphics().makeRectangle(this.seatWidth,this.height_,16777215,1),this.rectSeat.position.x=-this.seatWidth/2,this.addChild(this.rectSeat),this.sprGhost=o.Sprite.from(`${e.type}-body`),this.sprGhost.tint=h,this.sprGhost.scale.set(.6,.6),this.sprGhost.position.x=-this.sprGhost.width/2,this.sprGhost.position.y=2,this.addChild(this.sprGhost)}setDeployment(e){let t=this.wave.total-e,r=t/this.wave.total,a=.8*this.height_*(this.wave.duration/this.ship.maxWaveDuration)*r;this.rectContent.height=a,this.rectContent.y=(this.height_-a)/2}prepareToDeploy(){return this.ship.setCurGhost(this.wave.type),this.ship.level.animate(1e3,s.Animation.LINEAR,(e)=>{this.sprGhost.alpha=1-e,this.rectSeat.alpha=1-e,this.ship.sprCurGhost.alpha=e})}fadeOut(){return this.ship.level.animate(1e3,s.Animation.LINEAR,(e)=>{this.alpha=1-e,this.ship.sprCurGhost.alpha=1-e})}}class f extends o.Container{constructor(e,t,r,a){super(),this.docking=e,this.source=t,this.waves=r,this.level=a,this.gold=0,this.allWavesDeployed=!1,this.frontGap=60,this.frontSlots=[],this.backSlots=[],this.waveIdx=-1,this.slotgap=4,this.backSlotHeights=[29,24,19,8];let i=o.Sprite.from('shipbase');this.maxWaveTotal=0,this.maxWaveDuration=0;for(let o of r)this.maxWaveTotal=n(o.total||0,this.maxWaveTotal),this.maxWaveDuration=n(o.duration,this.maxWaveDuration);this.width=i.width,i.position.x=-i.width/2,this.addChild(i),this.frontSlotWidth=.75*this.width,this.backSlotWidth=.75*this.frontSlotWidth;let s=this.frontGap;for(let n=0,o;n<Math.min(r.length,7);n++){if(o=r[n],3>n){let e=new g(o,this);this.frontSlots.push(e),e.position.y=s,this.addChild(e),s+=e.height_}else{let e=this.backSlotWidth,t=this.backSlotHeights[n-3],r=new u.VectorGraphics().makeRectangle(e,t);r.position.set(-e/2,s),this.addChild(r),this.backSlots.push(r),s+=t}s+=this.slotgap}}setCurGhost(e){this.sprCurGhost&&this.removeChild(this.sprCurGhost),this.sprCurGhost=o.Sprite.from(`${e}-body`),this.sprCurGhost.position.x=-this.sprCurGhost.width/2,this.sprCurGhost.position.y=17,this.sprCurGhost.scale.set(.9),this.addChild(this.sprCurGhost)}dock(){return new Promise((e)=>{let{from:t,to:r,duration:a}=this.docking;this.level.animator.add(new s.Animation(a,s.Animation.LINEAR,(e)=>{let[a,n]=i.vec2.add(t.pos,i.vec2.mul(i.vec2.sub(r.pos,t.pos),e)),o=t.rot+(r.rot-t.rot)*e;this.position.set(a,n),this.rotation=o},()=>{e()}))})}start(){l.Game.audio.playOnce('ship-horn',.1),this.level.delay(l.Game.audio.getDuration('ship-horn')).then(()=>{this.processWave()})}executeWave(e){return new Promise((t)=>{if('pause'===e.type)this.level.delay(e.duration).then(()=>{t()});else{this.level.announceWave(e),this.waveTimer&&this.level.removeTimer(this.waveTimer),this.waveTimer=new i.Timer(a(e),(r)=>{if(r>=e.total)t();else{let t=this.level.spawnGhost(e.type,this);t.lane=r%3,this.frontSlots[0].setDeployment(r)}}),this.level.addTimer(this.waveTimer)}})}processWave(){let e=this.getNextWave();e?(this.setBeatName(e),this.nextWaveAnimation().then(()=>this.frontSlots[0].prepareToDeploy()).then(()=>{let t=this.executeWave(e);return!this.level.isTimeFwd()&&this.curBeatName&&(this.curBeatTrack=l.Game.audio.playTrack(this.curBeatName,p.FG_BEAT_VOLUME)),t}).then(()=>{this.waveIdx<this.waves.length-1&&this.curBeatTrack&&this.curBeatTrack.source.stop(),this.processWave()})):this.finish()}finish(){this.waveTimer&&this.level.removeTimer(this.waveTimer),this.frontSlots[0].fadeOut(),this.waveTimer=void 0,this.allWavesDeployed=!0,this.level.notifyAllWavesDeployed()}setBeatName(e){let t=e.duration/e.total;i.isEqualFloat(t,4)?this.curBeatName=`${e.type}-0`:i.isEqualFloat(t,2)?this.curBeatName=`${e.type}-1`:i.isEqualFloat(t,1)?this.curBeatName=`${e.type}-2`:i.isEqualFloat(t,.5)?this.curBeatName=`${e.type}-3`:i.isEqualFloat(t,.25)?this.curBeatName=`${e.type}-4`:i.isEqualFloat(t,.125)?this.curBeatName=`${e.type}-5`:d.Log.assert(!1,'No beat found for wave @'+t)}getNextWave(){return this.waveIdx<this.waves.length-1?this.waves[++this.waveIdx]:null}nextWaveAnimation(){return new Promise((e)=>{if(0===this.waveIdx)return void e();this.frontSlots[0].fadeOut().then(()=>{let e=this.frontSlots[0].height_,t=this.frontSlots.slice(1,3);t=t.concat(this.backSlots);let r=t.map((e)=>e.position.y),a=[e+this.slotgap,e+this.slotgap,e+this.slotgap,this.backSlotHeights[0]+this.slotgap,this.backSlotHeights[1]+this.slotgap,this.backSlotHeights[2]+this.slotgap],n=[e,e,this.backSlotHeights[0],this.backSlotHeights[1],this.backSlotHeights[2],this.backSlotHeights[3]],o=[e,e,e,this.backSlotHeights[0],this.backSlotHeights[1],this.backSlotHeights[2]];return this.level.animateLin(1e3,(e)=>{t.forEach((t,i)=>{if(t.position.y=r[i]-e*a[i],2<=i){let r=n[i],a=o[i];t.height=r+(a-r)*e}})})}).then(()=>{let e=this.backSlotWidth,t=this.frontSlotWidth,r;return this.waveIdx+7<=this.waves.length&&(r=new u.VectorGraphics().makeRectangle(this.backSlotWidth,this.backSlotHeights[3],16777215,1),r.alpha=0,r.position.y=this.backSlots[3].position.y+this.backSlotHeights[2]+this.slotgap,r.position.x=-this.backSlotWidth/2,this.addChild(r)),new Promise((a)=>{this.level.animator.add(new s.Animation(1e3,s.Animation.LINEAR,(a)=>{let n=e+(t-e)*a;0<this.backSlots.length&&(this.backSlots[0].width=n,this.backSlots[0].position.x=-n/2),r&&(r.alpha=a)},()=>{if(0<this.backSlots.length){let e=this.backSlots.shift();this.removeChild(e)}r&&(this.backSlots.push(r),r.alpha=1),a()}))})}).then(()=>{if(this.frontSlots.shift(),this.waveIdx+2<this.waves.length){let e=new g(this.waves[this.waveIdx+2],this);this.frontSlots.push(e),e.position.y=this.frontSlots[1].position.y+this.frontSlots[1].height_+this.slotgap,this.addChild(e)}e()});let t=this.waves.length-this.waveIdx;d.Log.assert(0<t,'No waves remaining for nextWave'),1<=t&&!this.level.isTimeFwd()&&l.Game.audio.playOnce('beat-break',p.FG_BEAT_VOLUME)})}claimGold(){this.gold++,this.level.checkOutcome(),this.level.emanateShipWave()}tick(e){}}t.Ship=f},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});const a=r(24);t.Terra=a.Terra;const n=r(218);t.TriTerra=n.TriTerra;const o=r(219);t.HexTerra=o.HexTerra;const i=r(220);t.RectTerra=i.RectTerra;const s=r(30);t.Grid=s.Grid},function(e,t,r){'use strict';var a=Math.ceil,n=Math.sin,o=Math.abs,s=Math.PI;Object.defineProperty(t,'__esModule',{value:!0});const i=r(24),l=r(10);class d extends i.Terra{clone(){return l.Log.warn('Unsupported'),new d({nrows:this.nrows,ncols:this.ncols,cellsize:this.cellsize,resolvable:!1})}resolveCell(e,t){throw e,t,new Error('Not implemented')}deriveGridSize(){let e=this.cellsize,t=this.cellsize*n(s/3);this.nrows=a(this.height/t)-1,this.ncols=2*a(this.width/e)-2}deriveTerraDimensions(){let e=this.cellsize,t=this.cellsize*n(s/3);this.width=(this.ncols+2)*e/2,this.height=(this.nrows+1)*t}getNeighbors(e,t){let r=this.nrows,a=this.ncols,n;return n=(e+t)%2?[[e,t-1],[e,t+1],[e+1,t]]:[[e-1,t],[e,t-1],[e,t+1]],n.filter(([e,t])=>0<=e&&e<r&&0<=t&&t<a)}isValidCellCoord(e){return e,!0}distanceManhattan(e,t){return o(t[0]-e[0])+o(t[1]-e[1])}heuristic(e,t){return this.distanceManhattan(e,t)}getCellCenter(e,t){return console.error('Not implemented'),[e,t]}getCellCorners(e,t){let r=this.cellsize,a=r*n(s/3);return(e+t)%2?[[t*r/2+r/2,e*a],[(t-1)*r/2+r/2,(e+1)*a],[(t+1)*r/2+r/2,(e+1)*a]]:[[(t-1)*r/2+r/2,e*a],[(t+1)*r/2+r/2,e*a],[t*r/2+r/2,(e+1)*a]]}}t.TriTerra=d},function(e,t,r){'use strict';var a=Math.floor,n=Math.abs;Object.defineProperty(t,'__esModule',{value:!0});const o=r(24),i=r(10);class s extends o.Terra{constructor(e){super(e)}clone(){return i.Log.warn('Unsupported'),new s({nrows:this.nrows,ncols:this.ncols,cellsize:this.cellsize,resolvable:!1})}resolveCell(e,t){throw e,t,new Error('Not implemented')}get radiusInner(){return this.cellsize*Math.sin(Math.PI/3)}get radiusOuter(){return this.cellsize}deriveGridSize(){let e=this.cellsize,t=this.radiusInner,r=this.width,n=this.height;this.ncols=a(r/e*(2/3)+1),this.nrows=Math.ceil(n/(2*t)+1)}deriveTerraDimensions(){let e=this.cellsize,t=this.radiusInner;this.width=3*e*(this.ncols-1)/2,this.height=2*(this.nrows-1)*t}getCellCenter(e,t){let r=this.cellsize,n=this.radiusInner,o,i;return t%2?(o=(.5+t+a(t/2))*r,i=(2*e+1)*n):(o=3*t/2*r,i=2*e*n),[o,i]}getCellCorners(e,t){let r=this.cellsize,a=this.radiusInner,[n,o]=this.getCellCenter(e,t);return[[n+r,o],[n+r/2,o+a],[n-r/2,o+a],[n-r,o],[n-r/2,o-a],[n+r/2,o-a]]}distanceManhattan(e,t){return n(e[0]-t[0])+n(e[1]-t[1])}isValidCellCoord(e){let[t,r]=e;if(0>t)return!1;if(r%2){if(t>=this.nrows-1)return!1;}else if(t>=this.nrows)return!1;return!(0>r)&&!(r>=this.ncols)}getNeighbors(e,t){let r=[[e+1,t],[e-1,t]];return t%2?(r.push([e,t-1]),r.push([e+1,t-1]),r.push([e,t+1]),r.push([e+1,t+1])):(r.push([e-1,t-1]),r.push([e,t-1]),r.push([e-1,t+1]),r.push([e,t+1])),r.filter((e)=>this.isValidCellCoord(e))}heuristic(e,t){return this.distanceManhattan(e,t)}}t.HexTerra=s},function(e,t,r){'use strict';var a=Math.ceil,n=Math.abs,o=Math.round;Object.defineProperty(t,'__esModule',{value:!0});const i=r(24),s=r(10);class l extends i.Terra{constructor(e){e.resolvable=!1,super(e)}clone(){return s.Log.warn('Unsupported'),new l({nrows:this.nrows,ncols:this.ncols,cellsize:this.cellsize,resolvable:!1})}get radiusInner(){return this.cellsize/2}get radiusOuter(){return this.cellsize/1.4142135623730951}deriveGridSize(){this.ncols=a(this.width/this.cellsize),this.nrows=a(this.height/this.cellsize)}deriveTerraDimensions(){this.width=this.ncols*this.cellsize,this.height=this.nrows*this.cellsize}getCellCenter(e,t){let[r,a]=this.coord(e,t);return[this.cellsize/2+a*this.cellsize,this.cellsize/2+r*this.cellsize]}getCellCorners(e,t){let[r,a]=this.coord(e,t),[n,o]=this.getCellCenter(r,a);return[[n-this.cellsize/2,o-this.cellsize/2],[n-this.cellsize/2,o+this.cellsize/2],[n+this.cellsize/2,o+this.cellsize/2],[n+this.cellsize/2,o-this.cellsize/2]]}distanceManhattan(e,t){return n(e[0]-t[0])+n(e[1]-t[1])}getNeighbors(e,t){let[r,a]=this.coord(e,t),n=[[r,a-1],[r,a+1],[r+1,a],[r-1,a]];return this.isWallAt(r,a-1)||this.isWallAt(r-1,a)||n.push([r-1,a-1]),this.isWallAt(r,a+1)||this.isWallAt(r+1,a)||n.push([r+1,a+1]),this.isWallAt(r,a-1)||this.isWallAt(r+1,a)||n.push([r+1,a-1]),this.isWallAt(r-1,a)||this.isWallAt(r,a+1)||n.push([r-1,a+1]),n.filter((e)=>this.isValidCell(e))}heuristic(e,t){return this.distanceManhattan(e,t)}resolveCell(e,t){let[r,a]=this.coord(e,t),n=this.cellsize;return[o((a-n/2)/n),o((r-n/2)/n)]}}t.RectTerra=l},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0});class r{constructor(e){this.level=e,this.value=0,this.nTowersBuilt=0,this.nTowersReclaimed=0,this.nKills=0,this.nAmmoFired=0,this.nFactoidsSaved=0,this.scoreIdx=0,this.towerIdx=0,this.enemyEscapeIdx=0,this.enemyPathIdx=0,this.goldIdx=0,this.goldLossIdx=0,this.duration=0,this.nFactoidsSaved=e.pavilion.nfactoids,this.waves=[];let t=0,a=0;e.ship.waves.forEach((e)=>{this.waves.push({type:e.type,duration:e.duration,total:e.total}),t+=e.duration,a+=e.total||0});let n=2*t,o=2*e.terra.nrows*e.terra.ncols;this.towerHistory=Array(o),this.towerIdx=0,this.scoreHistory=Array(1e3*(2*n)/r.sampleRate),this.scoreIdx=0,this.goldLossHistory=Array(e.pavilion.nfactoids),this.goldLossIdx=0,this.goldHistory=Array(2*e.pavilion.nfactoids*this.waves.length),this.goldIdx=0,this.enemyEscapeHistory=Array(a),this.enemyEscapeIdx=0,this.enemyPathHistory=Array(o),this.enemyPathIdx=0,this.difficulty=e.difficulty}toString(){return JSON.stringify({value:this.value,nTowersBuilt:this.nTowersBuilt,nTowersReclaimed:this.nTowersReclaimed,nKills:this.nKills,nAmmoFired:this.nAmmoFired,nFactoidsSaved:this.nFactoidsSaved,scoreHistory:this.scoreHistory,scoreIdx:this.scoreIdx,towerHistory:this.towerHistory,towerIdx:this.towerIdx,enemyExpiryHistory:this.enemyEscapeHistory,enemyExpiryIdx:this.enemyEscapeIdx,enemyPathHistory:this.enemyPathHistory,enemyPathIdx:this.enemyPathIdx,goldHistory:this.goldHistory,goldIdx:this.goldIdx,waves:this.waves,duration:this.duration})}fromString(e){let t=JSON.parse(e);this.value=t.value,this.nTowersBuilt=t.nTowersBuilt,this.nTowersReclaimed=t.nTowersReclaimed,this.nKills=t.nKills,this.nAmmoFired=t.nAmmoFired,this.nFactoidsSaved=t.nFactoidsSaved,this.scoreHistory=t.scoreHistory,this.scoreIdx=t.scoreIdx,this.towerHistory=t.towerHistory,this.towerIdx=t.towerIdx,this.enemyEscapeHistory=t.enemyExpiryHistory,this.enemyEscapeIdx=t.enemyExpiryIdx,this.enemyPathHistory=t.enemyPathHistory,this.enemyPathIdx=t.enemyPathIdx,this.goldHistory=t.goldHistory,this.goldIdx=t.goldIdx,this.waves=t.waves,this.duration=t.duration}sample(e){this.scoreHistory[2*this.scoreIdx]=e,this.scoreHistory[2*this.scoreIdx+1]=this.value,this.scoreIdx++}countGoldLoss(e){this.goldLossHistory[this.goldLossIdx++]=e,this.nFactoidsSaved--}countGoldSteal(e){this.goldHistory[this.goldIdx++]=-e}countGoldReturn(e){this.goldHistory[this.goldIdx--]=e}countGunFire(){this.value-=0,this.nAmmoFired++}countTowerBuild(e,t){this.value-=40,this.towerHistory[this.towerIdx++]=e,this.nTowersBuilt++,this.enemyPathHistory[2*this.enemyPathIdx]=e,this.enemyPathHistory[2*this.enemyPathIdx+1]=t,this.enemyPathIdx++}countTowerReclaim(e,r){this.value+=8,this.towerHistory[this.towerIdx++]=-e,this.nTowersReclaimed++,this.enemyPathHistory[2*this.enemyPathIdx]=e,this.enemyPathHistory[2*this.enemyPathIdx+1]=r,this.enemyPathIdx++}countGhostKill(){let e=this.level.pavilion.nfactoids,t=e-this.level.pavilion.stolen,r=this.level.ship.gold;this.value+=10+20*t+10*(e-r-t),this.nKills++}countGhostEscape(e,t){let r=t.hasfactoid?1:-1;this.enemyEscapeHistory[this.enemyEscapeIdx++]=r*e}close(e){this.duration=e}}r.sampleRate=1e3,t.Score=r},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});const a=r(6),n=r(5);class o extends a.Container{constructor(e){super(),this.level=e,this.glassesOn=!1,this.effOn=!1;const t=10,r=50;this.position.set(0,n.Game.docHeight-r-t),this.rangeIcon=new a.Sprite(a.Texture.from('range-tray-icon')),this.rangeIcon.alpha=.5,this.rangeIcon.scale.set(.7),this.rangeIcon.position.set(n.Game.docWidth-this.rangeIcon.width-t,r-this.rangeIcon.height-t),this.addChild(this.rangeIcon),this.rangeIcon.interactive=!0,this.rangeIcon.buttonMode=!0,this.rangeIcon.on('click',(e)=>{this.glassesOn?(this.glassesOn=!1,this.rangeIcon.alpha=.5,this.level.hideAllTowerRanges()):(this.glassesOn=!0,this.rangeIcon.alpha=1,this.level.showAllTowerRanges()),e.stopPropagation()}),this.effIcon=new a.Sprite(a.Texture.from('eff-tray-icon')),this.effIcon.alpha=.5,this.effIcon.scale.set(.7),this.effIcon.position.set(n.Game.docWidth-2*this.effIcon.width-2*t,r-this.effIcon.height-t),this.addChild(this.effIcon),this.effIcon.interactive=!0,this.effIcon.buttonMode=!0,this.effIcon.on('click',(e)=>{this.effOn?(this.effOn=!1,this.effIcon.alpha=.5,this.level.hideTowerMetric()):(this.effOn=!0,this.effIcon.alpha=1,this.level.showTowerMetric()),e.stopPropagation()}),this.timeScaleText=new a.Text(``,{fontFamily:'monospace',fontSize:40,fontWeight:'bold',fill:'#ffffff'}),this.timeScaleText.position.set(t,r-this.timeScaleText.height-t),this.timeScaleText.visible=!1,this.addChild(this.timeScaleText)}setTimeScaleText(e){e?(this.timeScaleText.text=e,this.timeScaleText.visible=!0):this.timeScaleText.visible=!1}}t.Tray=o},function(e,t,r){'use strict';var a=Math.PI;Object.defineProperty(t,'__esModule',{value:!0});const n=r(22),o=r(13),i=r(5);class s extends n.Level{constructor(){super(0),this.id='2',this.towerTypes=['gun','canon']}load(e='normal'){super.loadRes(),this.addFloorPlan('M 0,900 H 100 V 700 L 300,500 600,800 h 200 l 200,200 v 80 h 600 V 700 L 1800,500 V 0 H 0 Z',2246757,20,100),this.setupCitySlabs([{width:1280,height:1080,from:[800,0],to:[500,0],period:1e10,color:2770781,shadowoffset:[10,10]},{width:1280,height:1080,from:[0,0],to:[0,0],period:1e10,color:1057327,shadowoffset:[10,10]},{width:800,height:800,from:[-500,-850],to:[500,i.Game.docHeight+100],period:6e4,color:2770781,shadowoffset:[10,10]},{width:800,height:800,from:[1200,i.Game.docHeight+100],to:[1200,-850],period:3e4,color:1057327,shadowoffset:[10,10]},{width:300,height:300,from:[1920,-350],to:[200,i.Game.docHeight+100],period:24e3,color:2770781,shadowoffset:[10,10]}]),this.setupCity('city2'),this.definePavilion([2,14]),this.difficulty=e,'easy'===e?(super.addShip([6,5],[{type:'bouncer',total:4,duration:16,resrate:4},{type:'walker',total:16,duration:16,resrate:3},{type:'bouncer',total:8,duration:16,resrate:3},{type:'bouncer',total:16,duration:16,resrate:3},{type:'walker',total:32,duration:32,resrate:2},{type:'walker',total:64,duration:32,resrate:2},{type:'bouncer',total:8,duration:8,resrate:2},{type:'bouncer',total:16,duration:8,resrate:2},{type:'walker',total:32,duration:16,resrate:1},{type:'walker',total:64,duration:16,resrate:1}],{from:{pos:[50,1080],rot:0},to:{pos:[500,700],rot:45*a/180},duration:12e3}),this.productionRate=5,this.economy.produce(o.spec.towers.canon.construction.cost)):'normal'===e?(super.addShip([6,5],[{type:'bouncer',total:8,duration:16,resrate:3.5},{type:'walker',total:32,duration:32,resrate:3},{type:'bouncer',total:8,duration:16,resrate:3},{type:'bouncer',total:16,duration:16,resrate:2},{type:'walker',total:32,duration:32,resrate:2},{type:'bouncer',total:16,duration:16,resrate:1.5},{type:'walker',total:64,duration:32,resrate:1.5},{type:'bouncer',total:16,duration:16,resrate:1.5},{type:'walker',total:64,duration:32,resrate:1.5},{type:'bouncer',total:8,duration:8,resrate:1.5},{type:'bouncer',total:16,duration:8,resrate:1.5},{type:'walker',total:32,duration:16,resrate:1},{type:'bouncer',total:32,duration:16,resrate:1},{type:'walker',total:64,duration:16,resrate:1},{type:'bouncer',total:64,duration:16,resrate:1}],{from:{pos:[50,1080],rot:0},to:{pos:[500,700],rot:45*a/180},duration:12e3}),this.productionRate=5.5):'hard'===e&&(super.addShip([6,5],[{type:'bouncer',total:8,duration:16,resrate:3.5},{type:'walker',total:32,duration:32,resrate:3},{type:'bouncer',total:16,duration:16,resrate:3},{type:'bouncer',total:32,duration:16,resrate:2},{type:'walker',total:32,duration:32,resrate:1.5},{type:'bouncer',total:16,duration:16,resrate:1.5},{type:'walker',total:64,duration:32,resrate:1.5},{type:'bouncer',total:16,duration:16,resrate:1.5},{type:'walker',total:64,duration:32,resrate:1.5},{type:'bouncer',total:32,duration:8,resrate:1.5},{type:'bouncer',total:32,duration:8,resrate:1.5},{type:'walker',total:64,duration:16,resrate:1.5},{type:'bouncer',total:64,duration:16,resrate:1.5},{type:'walker',total:64,duration:16,resrate:1},{type:'walker',total:64,duration:16,resrate:1},{type:'bouncer',total:128,duration:16,resrate:1}],{from:{pos:[50,1080],rot:0},to:{pos:[500,700],rot:45*a/180},duration:12e3}),this.productionRate=5.5)}}t.Level2=s},function(e,t,r){'use strict';var a=Math.PI;Object.defineProperty(t,'__esModule',{value:!0});const n=r(22),o=r(5);class i extends n.Level{constructor(){super(0),this.id='3',this.towerTypes=['gun','canon','laser']}load(e='normal'){super.loadRes(),this.addFloorPlan(['M 0,700 h 300 l 380,380 h 820 V 900 L 1920,480 V 0 H 0 Z','M 900,300 h 500 L 1600,100 V 500 H 1300 V 800 H 800 V 500 L 900,400 Z'],2246757,20,100),this.setupCitySlabs([{width:1280,height:1080,from:[800,0],to:[500,0],period:1e10,color:2770781,shadowoffset:[10,10]},{width:1280,height:1080,from:[0,0],to:[0,0],period:1e10,color:1057327,shadowoffset:[10,10]},{width:800,height:800,from:[-500,-850],to:[500,o.Game.docHeight+100],period:6e4,color:2770781,shadowoffset:[10,10]},{width:800,height:800,from:[1200,o.Game.docHeight+100],to:[1200,-850],period:3e4,color:1057327,shadowoffset:[10,10]},{width:300,height:300,from:[1920,-350],to:[200,o.Game.docHeight+100],period:24e3,color:2770781,shadowoffset:[10,10]}]),this.setupCity('city2'),this.definePavilion([0,5]),this.difficulty=e,'easy'===e?(super.addShip([7,15],[{type:'sprinter',total:4,duration:16,resrate:4},{type:'walker',total:16,duration:32,resrate:3},{type:'bouncer',total:8,duration:8,resrate:3},{type:'sprinter',total:16,duration:16,resrate:2},{type:'walker',total:32,duration:32,resrate:2},{type:'bouncer',total:16,duration:4,resrate:1},{type:'sprinter',total:32,duration:32,resrate:1},{type:'walker',total:32,duration:32,resrate:1},{type:'bouncer',total:16,duration:4,resrate:1},{type:'sprinter',total:64,duration:32,resrate:1}],{from:{pos:[2400,1100],rot:0},to:{pos:[1600,800],rot:-45*a/180},duration:12e3}),this.productionRate=6):'normal'===e?(super.addShip([7,15],[{type:'sprinter',total:4,duration:16,resrate:4.5},{type:'walker',total:16,duration:32,resrate:3.5},{type:'bouncer',total:16,duration:8,resrate:3},{type:'sprinter',total:32,duration:16,resrate:2.5},{type:'walker',total:32,duration:32,resrate:2},{type:'bouncer',total:32,duration:4,resrate:1},{type:'sprinter',total:32,duration:32,resrate:1},{type:'walker',total:64,duration:32,resrate:1},{type:'bouncer',total:32,duration:4,resrate:1},{type:'sprinter',total:64,duration:32,resrate:1}],{from:{pos:[2400,1100],rot:0},to:{pos:[1600,800],rot:-45*a/180},duration:12e3}),this.productionRate=4):'hard'===e&&(super.addShip([7,15],[{type:'sprinter',total:4,duration:16,resrate:4},{type:'walker',total:16,duration:32,resrate:3},{type:'bouncer',total:16,duration:8,resrate:3},{type:'sprinter',total:32,duration:16,resrate:2.5},{type:'walker',total:32,duration:32,resrate:2},{type:'bouncer',total:32,duration:4,resrate:2},{type:'sprinter',total:32,duration:32,resrate:2},{type:'walker',total:64,duration:32,resrate:1},{type:'bouncer',total:32,duration:4,resrate:1},{type:'sprinter',total:64,duration:32,resrate:1},{type:'bouncer',total:32,duration:4,resrate:1},{type:'sprinter',total:64,duration:32,resrate:1}],{from:{pos:[2400,1100],rot:0},to:{pos:[1600,800],rot:-45*a/180},duration:12e3}),this.productionRate=3.5)}}t.Level3=i},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});const a=r(22),n=r(13),o=r(5);class i extends a.Level{constructor(){super(0),this.id='4',this.towerTypes=['gun','canon','laser','block']}load(e='normal'){super.loadRes(),this.addFloorPlan(['M 0,200 h 400 l 50,-50 H 950 L 1100,0 h 400 v 100 h 420 v 600 h -320 v 300 h -300 v 80 H 700 v -80 H 450 L 300,850 V 700 H 0 Z','M 500,450 h 250 l 50,-50 H 900 L 1000,300 H 450 v 100 z','M 950,600 v 250 h 150 v 50 h 100 L 1300,800 V 650 L 1200,550 V 450 l 50,-50 h -100 z'],2246757,20,50),this.setupCitySlabs([{width:1920,height:1080,from:[0,0],to:[0,0],period:1e10,color:1057327,shadowoffset:[10,10]},{width:800,height:800,from:[-500,-850],to:[500,o.Game.docHeight+100],period:6e4,color:2770781,shadowoffset:[10,10]},{width:800,height:800,from:[-500,o.Game.docHeight+100],to:[500,-850],period:3e4,color:1057327,shadowoffset:[10,10]},{width:300,height:300,from:[200,-350],to:[200,o.Game.docHeight+100],period:24e3,color:2770781,shadowoffset:[10,10]}]),this.setupCity('city1'),this.definePavilion([6,2]),this.difficulty=e;let t=[13,34],r={from:{pos:[1750,1080],rot:0},to:{pos:[1750,700],rot:0},duration:1e3};'easy'===e?(super.addShip(t,[{type:'walker',total:16,duration:32,resrate:5},{type:'walker',total:32,duration:32,resrate:3},{type:'walker',total:32,duration:16,resrate:2},{type:'walker',total:16,duration:16,resrate:2},{type:'walker',total:16,duration:8,resrate:1},{type:'walker',total:32,duration:8,resrate:1}],r),this.productionRate=4,this.economy.produce(2*n.spec.towers.gun.construction.cost)):'normal'===e?(super.addShip(t,[{type:'walker',total:16,duration:32,resrate:5},{type:'bouncer',total:16,duration:32,resrate:3},{type:'sprinter',total:32,duration:16,resrate:2},{type:'walker',total:32,duration:32,resrate:2},{type:'walker',total:32,duration:32,resrate:2},{type:'walker',total:32,duration:16,resrate:1},{type:'walker',total:32,duration:16,resrate:1},{type:'walker',total:64,duration:16,resrate:1}],r),this.productionRate=4):'hard'===e&&(super.addShip(t,[{type:'walker',total:32,duration:32,resrate:6.5},{type:'walker',total:32,duration:32,resrate:3.5},{type:'walker',total:64,duration:16,resrate:2.5},{type:'walker',total:64,duration:32,resrate:2.5},{type:'walker',total:64,duration:32,resrate:2.5},{type:'walker',total:64,duration:16,resrate:2},{type:'walker',total:64,duration:16,resrate:2},{type:'walker',total:64,duration:8,resrate:2},{type:'walker',total:64,duration:8,resrate:1},{type:'walker',total:64,duration:8,resrate:1},{type:'walker',total:64,duration:8,resrate:1},{type:'walker',total:64,duration:8,resrate:.5},{type:'walker',total:128,duration:16,resrate:0}],r),this.productionRate=2.2)}}t.Level4=i},function(e,t){'use strict';var r=Math.round;Object.defineProperty(t,'__esModule',{value:!0}),t.PerfStats=function(){function e(e){return a.appendChild(e.dom),e}function t(e){for(var t=0;t<a.children.length;t++)a.children[t].style.display=t===e?'block':'none';r=e}var r=0,a=document.createElement('div');a.style.cssText='position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000',a.addEventListener('click',function(e){e.preventDefault(),t(++r%a.children.length)},!1);var n=(performance||Date).now(),o=n,i=0,s=e(new c('FPS','#0ff','#002')),l=e(new c('MS','#0f0','#020'));if(self.performance&&self.performance.memory)var d=e(new c('MB','#f08','#201'));return t(0),{REVISION:16,dom:a,addPanel:e,showPanel:t,begin:function(){n=(performance||Date).now()},end:function(){i++;var e=(performance||Date).now();if(l.update(e-n,200),e>o+1e3&&(s.update(1e3*i/(e-o),100),o=e,i=0,d)){var t=performance.memory;d.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){n=this.end()},domElement:a,setMode:t}};var a=r(window.devicePixelRatio||1),n=80*a,o=48*a,i=3*a,s=2*a,l=3*a,d=15*a,u=74*a,p=30*a;class c{constructor(e,t,r){this.name=e,this.fg=t,this.bg=r,this.min=Infinity,this.max=0;var c=document.createElement('canvas');c.width=n,c.height=o,c.style.cssText='width:80px;height:48px';var h=c.getContext('2d');h.font='bold '+9*a+'px Helvetica,Arial,sans-serif',h.textBaseline='top',h.fillStyle=r,h.fillRect(0,0,n,o),h.fillStyle=t,h.fillText(e,i,s),h.fillRect(l,d,u,p),h.fillStyle=r,h.globalAlpha=.9,h.fillRect(l,d,u,p),this.dom=c,this.context=h}update(e,t){let o=Math.min(this.min,e),c=Math.max(this.max,e),h=r,g=this.context;g.fillStyle=this.bg,g.globalAlpha=1,g.fillRect(0,0,n,d),g.fillStyle=this.fg,g.fillText(h(e)+' '+this.name+' ('+h(o)+'-'+h(c)+')',i,s),g.drawImage(this.dom,l+a,d,u-a,p,l,d,u-a,p),g.fillRect(l+u-a,d,a,p),g.fillStyle=this.bg,g.globalAlpha=.9,g.fillRect(l+u-a,d,a,h((1-e/t)*p))}}},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0});class r{static get(e){return window.localStorage.getItem(e)}static set(e,t){window.localStorage.setItem(e,t)}static clear(){window.localStorage.clear()}}r.CINEMATIC_PLAYED_ONCE='cin-played-once',t.Config=r}]);